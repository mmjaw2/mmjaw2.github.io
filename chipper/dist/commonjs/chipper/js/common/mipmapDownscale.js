"use strict";

// Copyright 2015-2024, University of Colorado Boulder

/* eslint-env node */

/**
 * Takes in a mipmap object with data/width/height and returns another mipmap object with data/width/height that is
 * downscaled by a factor of 2. Needs to round the width/height up to include all of the image (if it's not a
 * power of 2).
 *
 * mipmap.data should be array-accessible with bytes (typed array, Buffer, etc.)
 *
 * Handles alpha blending of 4 pixels into 1, and does so with the proper gamma corrections so that we only add/blend
 * colors in the linear sRGB colorspace.
 *
 * @param {Object} mipmap - Mipmap object with { data: {Buffer}, width: {number}, height: {number} }
 * @param {function} createData - function( width, height ), creates an array-accessible data container, Buffer
 *                                for Node.js, or presumably a typed array otherwise, with 4*width*height components
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */
function mipmapDownscale(mipmap, createData) {
  // array index constants for the channels
  var R = 0;
  var G = 1;
  var B = 2;
  var A = 3;

  // hard-coded gamma (assuming the exponential part of the sRGB curve as a simplification)
  var GAMMA = 2.2;

  // dimension handling for the larger image
  var width = mipmap.width;
  var height = mipmap.height;
  var data = mipmap.data;
  function inside(row, col) {
    return row < height && col < width;
  }

  // grabbing pixel data for a row/col, applying corrections into the [0,1] range.
  function pixel(row, col) {
    if (!inside(row, col)) {
      return [0, 0, 0, 0];
    }
    var index = 4 * (row * width + col);
    return [
    // maps to [0,1]
    Math.pow(data[index + R] / 255, GAMMA),
    // red
    Math.pow(data[index + G] / 255, GAMMA),
    // green
    Math.pow(data[index + B] / 255, GAMMA),
    // blue
    Math.pow(data[index + A] / 255, GAMMA) // alpha
    ];
  }

  // dimension h andling for the smaller downscaled image
  var smallWidth = Math.ceil(width / 2);
  var smallHeight = Math.ceil(height / 2);
  var smallData = createData(smallWidth, smallHeight);
  function smallPixel(row, col) {
    return 4 * (row * smallWidth + col);
  }

  // for each pixel in our downscaled image
  for (var row = 0; row < height; row++) {
    for (var col = 0; col < width; col++) {
      // Original pixel values for the quadrant
      var p1 = pixel(2 * row, 2 * col); // upper-left
      var p2 = pixel(2 * row, 2 * col + 1); // upper-right
      var p3 = pixel(2 * row + 1, 2 * col); // lower-left
      var p4 = pixel(2 * row + 1, 2 * col + 1); // lower-right
      var output = [0, 0, 0, 0];
      var alphaSum = p1[A] + p2[A] + p3[A] + p4[A];

      // blending of pixels, weighted by alphas
      output[R] = (p1[R] * p1[A] + p2[R] * p2[A] + p3[R] * p3[A] + p4[R] * p4[A]) / alphaSum;
      output[G] = (p1[G] * p1[A] + p2[G] * p2[A] + p3[G] * p3[A] + p4[G] * p4[A]) / alphaSum;
      output[B] = (p1[B] * p1[A] + p2[B] * p2[A] + p3[B] * p3[A] + p4[B] * p4[A]) / alphaSum;
      output[A] = alphaSum / 4; // average of alphas

      // convert back into [0,255] range with reverse corrections, and store in our buffer
      var outputIndex = smallPixel(row, col);
      smallData[outputIndex + R] = Math.floor(Math.pow(output[R], 1 / GAMMA) * 255);
      smallData[outputIndex + G] = Math.floor(Math.pow(output[G], 1 / GAMMA) * 255);
      smallData[outputIndex + B] = Math.floor(Math.pow(output[B], 1 / GAMMA) * 255);
      smallData[outputIndex + A] = Math.floor(Math.pow(output[A], 1 / GAMMA) * 255);
    }
  }
  return {
    data: smallData,
    width: smallWidth,
    height: smallHeight
  };
}
module.exports = mipmapDownscale;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtaXBtYXBEb3duc2NhbGUiLCJtaXBtYXAiLCJjcmVhdGVEYXRhIiwiUiIsIkciLCJCIiwiQSIsIkdBTU1BIiwid2lkdGgiLCJoZWlnaHQiLCJkYXRhIiwiaW5zaWRlIiwicm93IiwiY29sIiwicGl4ZWwiLCJpbmRleCIsIk1hdGgiLCJwb3ciLCJzbWFsbFdpZHRoIiwiY2VpbCIsInNtYWxsSGVpZ2h0Iiwic21hbGxEYXRhIiwic21hbGxQaXhlbCIsInAxIiwicDIiLCJwMyIsInA0Iiwib3V0cHV0IiwiYWxwaGFTdW0iLCJvdXRwdXRJbmRleCIsImZsb29yIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbIm1pcG1hcERvd25zY2FsZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxNS0yMDI0LCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qIGVzbGludC1lbnYgbm9kZSAqL1xyXG5cclxuXHJcbi8qKlxyXG4gKiBUYWtlcyBpbiBhIG1pcG1hcCBvYmplY3Qgd2l0aCBkYXRhL3dpZHRoL2hlaWdodCBhbmQgcmV0dXJucyBhbm90aGVyIG1pcG1hcCBvYmplY3Qgd2l0aCBkYXRhL3dpZHRoL2hlaWdodCB0aGF0IGlzXHJcbiAqIGRvd25zY2FsZWQgYnkgYSBmYWN0b3Igb2YgMi4gTmVlZHMgdG8gcm91bmQgdGhlIHdpZHRoL2hlaWdodCB1cCB0byBpbmNsdWRlIGFsbCBvZiB0aGUgaW1hZ2UgKGlmIGl0J3Mgbm90IGFcclxuICogcG93ZXIgb2YgMikuXHJcbiAqXHJcbiAqIG1pcG1hcC5kYXRhIHNob3VsZCBiZSBhcnJheS1hY2Nlc3NpYmxlIHdpdGggYnl0ZXMgKHR5cGVkIGFycmF5LCBCdWZmZXIsIGV0Yy4pXHJcbiAqXHJcbiAqIEhhbmRsZXMgYWxwaGEgYmxlbmRpbmcgb2YgNCBwaXhlbHMgaW50byAxLCBhbmQgZG9lcyBzbyB3aXRoIHRoZSBwcm9wZXIgZ2FtbWEgY29ycmVjdGlvbnMgc28gdGhhdCB3ZSBvbmx5IGFkZC9ibGVuZFxyXG4gKiBjb2xvcnMgaW4gdGhlIGxpbmVhciBzUkdCIGNvbG9yc3BhY2UuXHJcbiAqXHJcbiAqIEBwYXJhbSB7T2JqZWN0fSBtaXBtYXAgLSBNaXBtYXAgb2JqZWN0IHdpdGggeyBkYXRhOiB7QnVmZmVyfSwgd2lkdGg6IHtudW1iZXJ9LCBoZWlnaHQ6IHtudW1iZXJ9IH1cclxuICogQHBhcmFtIHtmdW5jdGlvbn0gY3JlYXRlRGF0YSAtIGZ1bmN0aW9uKCB3aWR0aCwgaGVpZ2h0ICksIGNyZWF0ZXMgYW4gYXJyYXktYWNjZXNzaWJsZSBkYXRhIGNvbnRhaW5lciwgQnVmZmVyXHJcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgTm9kZS5qcywgb3IgcHJlc3VtYWJseSBhIHR5cGVkIGFycmF5IG90aGVyd2lzZSwgd2l0aCA0KndpZHRoKmhlaWdodCBjb21wb25lbnRzXHJcbiAqXHJcbiAqIEBhdXRob3IgSm9uYXRoYW4gT2xzb24gPGpvbmF0aGFuLm9sc29uQGNvbG9yYWRvLmVkdT5cclxuICovXHJcbmZ1bmN0aW9uIG1pcG1hcERvd25zY2FsZSggbWlwbWFwLCBjcmVhdGVEYXRhICkge1xyXG4gIC8vIGFycmF5IGluZGV4IGNvbnN0YW50cyBmb3IgdGhlIGNoYW5uZWxzXHJcbiAgY29uc3QgUiA9IDA7XHJcbiAgY29uc3QgRyA9IDE7XHJcbiAgY29uc3QgQiA9IDI7XHJcbiAgY29uc3QgQSA9IDM7XHJcblxyXG4gIC8vIGhhcmQtY29kZWQgZ2FtbWEgKGFzc3VtaW5nIHRoZSBleHBvbmVudGlhbCBwYXJ0IG9mIHRoZSBzUkdCIGN1cnZlIGFzIGEgc2ltcGxpZmljYXRpb24pXHJcbiAgY29uc3QgR0FNTUEgPSAyLjI7XHJcblxyXG4gIC8vIGRpbWVuc2lvbiBoYW5kbGluZyBmb3IgdGhlIGxhcmdlciBpbWFnZVxyXG4gIGNvbnN0IHdpZHRoID0gbWlwbWFwLndpZHRoO1xyXG4gIGNvbnN0IGhlaWdodCA9IG1pcG1hcC5oZWlnaHQ7XHJcbiAgY29uc3QgZGF0YSA9IG1pcG1hcC5kYXRhO1xyXG5cclxuICBmdW5jdGlvbiBpbnNpZGUoIHJvdywgY29sICkge1xyXG4gICAgcmV0dXJuIHJvdyA8IGhlaWdodCAmJiBjb2wgPCB3aWR0aDtcclxuICB9XHJcblxyXG4gIC8vIGdyYWJiaW5nIHBpeGVsIGRhdGEgZm9yIGEgcm93L2NvbCwgYXBwbHlpbmcgY29ycmVjdGlvbnMgaW50byB0aGUgWzAsMV0gcmFuZ2UuXHJcbiAgZnVuY3Rpb24gcGl4ZWwoIHJvdywgY29sICkge1xyXG4gICAgaWYgKCAhaW5zaWRlKCByb3csIGNvbCApICkge1xyXG4gICAgICByZXR1cm4gWyAwLCAwLCAwLCAwIF07XHJcbiAgICB9XHJcbiAgICBjb25zdCBpbmRleCA9IDQgKiAoIHJvdyAqIHdpZHRoICsgY29sICk7XHJcbiAgICByZXR1cm4gW1xyXG4gICAgICAvLyBtYXBzIHRvIFswLDFdXHJcbiAgICAgIE1hdGgucG93KCBkYXRhWyBpbmRleCArIFIgXSAvIDI1NSwgR0FNTUEgKSwgLy8gcmVkXHJcbiAgICAgIE1hdGgucG93KCBkYXRhWyBpbmRleCArIEcgXSAvIDI1NSwgR0FNTUEgKSwgLy8gZ3JlZW5cclxuICAgICAgTWF0aC5wb3coIGRhdGFbIGluZGV4ICsgQiBdIC8gMjU1LCBHQU1NQSApLCAvLyBibHVlXHJcbiAgICAgIE1hdGgucG93KCBkYXRhWyBpbmRleCArIEEgXSAvIDI1NSwgR0FNTUEgKSAvLyBhbHBoYVxyXG4gICAgXTtcclxuICB9XHJcblxyXG4gIC8vIGRpbWVuc2lvbiBoIGFuZGxpbmcgZm9yIHRoZSBzbWFsbGVyIGRvd25zY2FsZWQgaW1hZ2VcclxuICBjb25zdCBzbWFsbFdpZHRoID0gTWF0aC5jZWlsKCB3aWR0aCAvIDIgKTtcclxuICBjb25zdCBzbWFsbEhlaWdodCA9IE1hdGguY2VpbCggaGVpZ2h0IC8gMiApO1xyXG4gIGNvbnN0IHNtYWxsRGF0YSA9IGNyZWF0ZURhdGEoIHNtYWxsV2lkdGgsIHNtYWxsSGVpZ2h0ICk7XHJcblxyXG4gIGZ1bmN0aW9uIHNtYWxsUGl4ZWwoIHJvdywgY29sICkge1xyXG4gICAgcmV0dXJuIDQgKiAoIHJvdyAqIHNtYWxsV2lkdGggKyBjb2wgKTtcclxuICB9XHJcblxyXG4gIC8vIGZvciBlYWNoIHBpeGVsIGluIG91ciBkb3duc2NhbGVkIGltYWdlXHJcbiAgZm9yICggbGV0IHJvdyA9IDA7IHJvdyA8IGhlaWdodDsgcm93KysgKSB7XHJcbiAgICBmb3IgKCBsZXQgY29sID0gMDsgY29sIDwgd2lkdGg7IGNvbCsrICkge1xyXG4gICAgICAvLyBPcmlnaW5hbCBwaXhlbCB2YWx1ZXMgZm9yIHRoZSBxdWFkcmFudFxyXG4gICAgICBjb25zdCBwMSA9IHBpeGVsKCAyICogcm93LCAyICogY29sICk7IC8vIHVwcGVyLWxlZnRcclxuICAgICAgY29uc3QgcDIgPSBwaXhlbCggMiAqIHJvdywgMiAqIGNvbCArIDEgKTsgLy8gdXBwZXItcmlnaHRcclxuICAgICAgY29uc3QgcDMgPSBwaXhlbCggMiAqIHJvdyArIDEsIDIgKiBjb2wgKTsgLy8gbG93ZXItbGVmdFxyXG4gICAgICBjb25zdCBwNCA9IHBpeGVsKCAyICogcm93ICsgMSwgMiAqIGNvbCArIDEgKTsgLy8gbG93ZXItcmlnaHRcclxuICAgICAgY29uc3Qgb3V0cHV0ID0gWyAwLCAwLCAwLCAwIF07XHJcblxyXG4gICAgICBjb25zdCBhbHBoYVN1bSA9IHAxWyBBIF0gKyBwMlsgQSBdICsgcDNbIEEgXSArIHA0WyBBIF07XHJcblxyXG4gICAgICAvLyBibGVuZGluZyBvZiBwaXhlbHMsIHdlaWdodGVkIGJ5IGFscGhhc1xyXG4gICAgICBvdXRwdXRbIFIgXSA9ICggcDFbIFIgXSAqIHAxWyBBIF0gKyBwMlsgUiBdICogcDJbIEEgXSArIHAzWyBSIF0gKiBwM1sgQSBdICsgcDRbIFIgXSAqIHA0WyBBIF0gKSAvIGFscGhhU3VtO1xyXG4gICAgICBvdXRwdXRbIEcgXSA9ICggcDFbIEcgXSAqIHAxWyBBIF0gKyBwMlsgRyBdICogcDJbIEEgXSArIHAzWyBHIF0gKiBwM1sgQSBdICsgcDRbIEcgXSAqIHA0WyBBIF0gKSAvIGFscGhhU3VtO1xyXG4gICAgICBvdXRwdXRbIEIgXSA9ICggcDFbIEIgXSAqIHAxWyBBIF0gKyBwMlsgQiBdICogcDJbIEEgXSArIHAzWyBCIF0gKiBwM1sgQSBdICsgcDRbIEIgXSAqIHA0WyBBIF0gKSAvIGFscGhhU3VtO1xyXG4gICAgICBvdXRwdXRbIEEgXSA9IGFscGhhU3VtIC8gNDsgLy8gYXZlcmFnZSBvZiBhbHBoYXNcclxuXHJcbiAgICAgIC8vIGNvbnZlcnQgYmFjayBpbnRvIFswLDI1NV0gcmFuZ2Ugd2l0aCByZXZlcnNlIGNvcnJlY3Rpb25zLCBhbmQgc3RvcmUgaW4gb3VyIGJ1ZmZlclxyXG4gICAgICBjb25zdCBvdXRwdXRJbmRleCA9IHNtYWxsUGl4ZWwoIHJvdywgY29sICk7XHJcbiAgICAgIHNtYWxsRGF0YVsgb3V0cHV0SW5kZXggKyBSIF0gPSBNYXRoLmZsb29yKCBNYXRoLnBvdyggb3V0cHV0WyBSIF0sIDEgLyBHQU1NQSApICogMjU1ICk7XHJcbiAgICAgIHNtYWxsRGF0YVsgb3V0cHV0SW5kZXggKyBHIF0gPSBNYXRoLmZsb29yKCBNYXRoLnBvdyggb3V0cHV0WyBHIF0sIDEgLyBHQU1NQSApICogMjU1ICk7XHJcbiAgICAgIHNtYWxsRGF0YVsgb3V0cHV0SW5kZXggKyBCIF0gPSBNYXRoLmZsb29yKCBNYXRoLnBvdyggb3V0cHV0WyBCIF0sIDEgLyBHQU1NQSApICogMjU1ICk7XHJcbiAgICAgIHNtYWxsRGF0YVsgb3V0cHV0SW5kZXggKyBBIF0gPSBNYXRoLmZsb29yKCBNYXRoLnBvdyggb3V0cHV0WyBBIF0sIDEgLyBHQU1NQSApICogMjU1ICk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZXR1cm4ge1xyXG4gICAgZGF0YTogc21hbGxEYXRhLFxyXG4gICAgd2lkdGg6IHNtYWxsV2lkdGgsXHJcbiAgICBoZWlnaHQ6IHNtYWxsSGVpZ2h0XHJcbiAgfTtcclxufVxyXG5cclxubW9kdWxlLmV4cG9y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