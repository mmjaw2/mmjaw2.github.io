// Copyright 2013-2024, University of Colorado Boulder

/**
 * The view portion of a Screen, specifies the layout strategy for the visual view.
 *
 * For the PDOM view, this type creates  the three organizing elements associated with each screen:
 * - The `ScreenSummaryNode` is introductory description that outlines the screen and sets the scene for the user.
 * - The `PlayAreaNode` holds content that is considered the main interaction and pedagogy to be learned from the screen.
 * - The `ControlAreaNode` houses controls and other content that is secondary to the main interaction. Ideally the user
 *       would encounter this after exploring the PlayAreaNode.
 * The screenSummaryNode instance is not available on the ScreenView, instead content can be added to it via a constructor
 * option or `ScreenView.setScreenSummaryContent`. This is because some accessible descriptions in the screen summary
 * are the same throughout all simulations. The pdomPlayAreaNode and pdomControlAreaNode instances are protected, read-only Nodes
 * that are meant to have their pdomOrder and children set to achieve the proper PDOM structure. Do not set
 * `pdomOrder` directly on the ScreenView, as ScreenView set's its own pdomOrder
 *
 * @author Sam Reid (PhET Interactive Simulations)
 */

import Property from '../../axon/js/Property.js';
import Bounds2 from '../../dot/js/Bounds2.js';
import Matrix3 from '../../dot/js/Matrix3.js';
import optionize from '../../phet-core/js/optionize.js';
import ControlAreaNode from '../../scenery-phet/js/accessibility/nodes/ControlAreaNode.js';
import PlayAreaNode from '../../scenery-phet/js/accessibility/nodes/PlayAreaNode.js';
import ScreenSummaryNode from '../../scenery-phet/js/accessibility/nodes/ScreenSummaryNode.js';
import { Node } from '../../scenery/js/imports.js';
import Tandem from '../../tandem/js/Tandem.js';
import joist from './joist.js';
/*
 * Default width and height for iPad2, iPad3, iPad4 running Safari with default tabs and decorations
 * These bounds were added in Sep 2014 and are based on a screenshot from a non-Retina iPad, in Safari, iOS7.
 * It therefore accounts for the nav bar on the bottom and the space consumed by the browser on the top.
 * As of this writing, this is the resolution being used by PhET's sim designers for their mockups.
 * For more information see https://github.com/phetsims/joist/issues/126
 */
const DEFAULT_LAYOUT_BOUNDS = new Bounds2(0, 0, 1024, 618);

// Documented where the defaults are defined

class ScreenView extends Node {
  // The visible bounds of the ScreenView in ScreenView coordinates.  This includes top/bottom or left/right margins
  // depending on the aspect ratio of the screen. Clients should not set this value

  // Keep track of the content added to the summary Node, so that if it is set more than once, the previous one can be
  // removed. Supports an ES6 getter/setter for this.
  _screenSummaryContent = null;
  static DEFAULT_LAYOUT_BOUNDS = DEFAULT_LAYOUT_BOUNDS;
  constructor(providedOptions) {
    const options = optionize()({
      // {Bounds2} the bounds that are safe to draw in on all supported platforms
      layoutBounds: DEFAULT_LAYOUT_BOUNDS.copy(),
      // Node options
      layerSplit: true,
      // so we're not in the same layer as the navbar, etc.
      excludeInvisible: true,
      // so we don't keep invisible screens in the SVG tree

      // phet-io
      tandem: Tandem.REQUIRED,
      visiblePropertyOptions: {
        phetioState: false,
        phetioReadOnly: true
      },
      // pdom options
      containerTagName: 'article',
      tagName: 'div',
      // {Node|null} the Node with screen summary content to be added to the ScreenSummaryNode, and into PDOM above
      // the Play Area. This Node is added as a child to the ScreenSummaryNode.
      screenSummaryContent: null,
      // {boolean} whether or not to add the screen summary, play area, and control area Nodes to the PDOM
      includePDOMNodes: true
    }, providedOptions);
    super(options);
    if (assert && this.isPhetioInstrumented()) {
      assert && assert(options.tandem.name === 'view', 'tandem name should be view');
    }

    // the bounds the confine the layout of the view.
    this.layoutBounds = options.layoutBounds;

    // Initialized to default layout bounds, then updated as soon as layout() is called, which is before the
    // ScreenView is displayed.
    this.visibleBoundsProperty = new Property(options.layoutBounds);

    // this cannot be a label to this ScreenView, because it needs to be focusable.
    this.pdomTitleNode = new Node({
      tagName: 'h1',
      focusHighlight: 'invisible'
    });

    // add children and set accessible order to these to organize and structure the PDOM.
    this.pdomPlayAreaNode = new PlayAreaNode();
    this.pdomControlAreaNode = new ControlAreaNode();

    // This container has the intro "{{SIM}} is an interactive sim, it changes as you . . ."
    this.pdomScreenSummaryNode = new ScreenSummaryNode();

    // at the Node from options in the same way that can be done at any time
    options.screenSummaryContent && this.setScreenSummaryContent(options.screenSummaryContent);

    // To make sure that the title "h1" is the first, focused item on a screen when that screen is selected, toggle the
    // focusability of the title, and then focus it. See https://github.com/phetsims/ratio-and-proportion/issues/321
    this.visibleProperty.lazyLink(visible => {
      if (visible) {
        assert && assert(!this.pdomTitleNode.focusable, 'about to set to be focusable');
        this.pdomTitleNode.focusable = true;
        this.pdomTitleNode.focus();
      } else {
        this.pdomTitleNode.focusable = false;
      }
    });

    // after initial focus, the titleNode should be removed from the focus order
    this.pdomTitleNode.addInputListener({
      blur: () => {
        this.pdomTitleNode.focusable = false;
      }
    });
    this.pdomParentNode = new Node({
      // order of Nodes for the PDOM that makes most sense for graphical rendering, "Play Area" components
      // on top of "Control Area" components.
      children: options.includePDOMNodes ? [this.pdomTitleNode, this.pdomScreenSummaryNode, this.pdomControlAreaNode, this.pdomPlayAreaNode] : [this.pdomTitleNode]
    });
    this.addChild(this.pdomParentNode);

    // pdom - "Play Area" comes before "Control Area" in PDOM
    this.pdomParentNode.pdomOrder = options.includePDOMNodes ? [this.pdomTitleNode, this.pdomScreenSummaryNode, this.pdomPlayAreaNode, this.pdomControlAreaNode] : [this.pdomTitleNode];
  }

  /**
   * This method should not be called because ScreenView defines child Nodes that organize the PDOM structure of a
   * screen. See this.pdomScreenSummaryNode, this.pdomPlayAreaNode, and this.pdomControlAreaNode and set their accessible
   * order accordingly when adding accessible content to the PDOM for this screen.
   */
  setPDOMOrder(pdomOrder) {
    throw new Error('should not need to set accessible order on a ScreenView');
  }

  /**
   * Override to make sure that setting children doesn't blow away Nodes set by ScreenView.
   */
  setChildren(children) {
    Node.prototype.setChildren.call(this, children);

    // mutate may call setChildren before pdomParentNode is constructed
    if (this.pdomParentNode && !this.hasChild(this.pdomParentNode)) {
      this.addChild(this.pdomParentNode);
      this.pdomParentNode.moveToBack();
    }
    return this;
  }

  /**
   * Get the scale to use for laying out the sim components and the navigation bar, so its size will track
   * with the sim size
   * (joist-internal)
   */
  getLayoutScale(viewBounds) {
    return ScreenView.getLayoutScale(this.layoutBounds, viewBounds);
  }

  /**
   * Default layout function uses the layoutWidth and layoutHeight to scale the content (based on whichever is more limiting: width or height)
   * and centers the content in the screen vertically and horizontally
   * This function can be replaced by subclasses that wish to perform their own custom layout.
   * @param viewBounds - desired bounds for the view
   * (joist-internal)
   */
  layout(viewBounds, layoutMatrixOptions) {
    this.matrix = ScreenView.getLayoutMatrix(this.layoutBounds, viewBounds, layoutMatrixOptions);
    this.visibleBoundsProperty.value = this.parentToLocalBounds(viewBounds);
  }
  get screenSummaryContent() {
    return this._screenSummaryContent;
  }
  set screenSummaryContent(node) {
    this.setScreenSummaryContent(node);
  }

  /**
   * Set the screen summary Node for the PDOM of this Screen View. Prefer passing in a screen summary Node via
   * constructor options, but this method can be used directly when necessary.
   */
  setScreenSummaryContent(node) {
    assert && assert(node !== this._screenSummaryContent, 'this is already the screen summary Node content');
    this._screenSummaryContent && this.pdomScreenSummaryNode.removeChild(this._screenSummaryContent);
    this._screenSummaryContent = node;
    if (node) {
      this.pdomScreenSummaryNode.addChild(node);
    }
  }

  /**
   * Set the screen summary Node intro string
   * (joist-internal)
   */
  setScreenSummaryIntroAndTitle(simName, screenDisplayName, simTitle, isMultiScreen) {
    // TODO: Should use PatternStringProperty, see https://github.com/phetsims/joist/issues/885
    this.pdomScreenSummaryNode.setIntroString(simName, screenDisplayName, isMultiScreen);
    this.pdomTitleNode.innerContent = simTitle;
  }

  /**
   * Create the alert content for this ScreenView when the Voicing feature is enabled and the "Overview" button
   * is pressed.
   * Must be implemented if supporting voicing in your ScreenView.
   */
  getVoicingOverviewContent() {
    throw new Error('The ScreenView should implement getVoicingOverviewContent if Voicing is enabled');
  }

  /**
   * Create the alert content for this ScreenView when the Voicing feature is enabled and the "Details" button is
   * pressed.
   * Must be implemented if supporting voicing in your ScreenView.
   */
  getVoicingDetailsContent() {
    throw new Error('The ScreenView should implement getVoicingDetailsContent when the Voicing feature is enabled.');
  }

  /**
   * Create the alert content for this ScreenView when the Voicing feature is enabled and the "Hint" button is pressed.
   * Must be implemented if supporting voicing in your ScreenView.
   */
  getVoicingHintContent() {
    throw new Error('The ScreenView should implement getVoicingHintContent when Voicing is enabled.');
  }

  /**
   * Interrupts all input listeners that are attached to either this node, or a descendant node.
   *
   * Overridden here so we can interrupt all of the listeners in the Display, see
   * https://github.com/phetsims/scenery/issues/1582.
   */
  interruptSubtreeInput() {
    window.phet?.joist?.display?.interruptOtherPointers();
    return super.interruptSubtreeInput();
  }

  /**
   * Get the scale to use for laying out the sim components and the navigation bar, so its size will track
   * with the sim size
   */
  static getLayoutScale(layoutBounds, viewBounds) {
    return Math.min(viewBounds.width / layoutBounds.width, viewBounds.height / layoutBounds.height);
  }
  static getLayoutMatrix(layoutBounds, viewBounds, providedOptions) {
    const options = optionize()({
      verticalAlign: 'center' // 'center' or 'bottom'
    }, providedOptions);
    const width = viewBounds.width;
    const height = viewBounds.height;
    const scale = ScreenView.getLayoutScale(layoutBounds, viewBounds);
    let dx = 0;
    let dy = 0;
    if (scale === width / layoutBounds.width) {
      // vertically float to bottom
      dy = height / scale - layoutBounds.height;

      // center vertically
      if (options.verticalAlign === 'center') {
        dy /= 2;
      }
    } else if (scale === height / layoutBounds.height) {
      // center horizontally
      dx = (width / scale - layoutBounds.width) / 2;
    }
    return Matrix3.rowMajor(scale, 0, dx * scale + viewBounds.left, 0, scale, dy * scale + viewBounds.top, 0, 0, 1);
  }

  // Noops for consistent API
  step(dt) {
    // See subclass for implementation
  }
}
joist.register('ScreenView', ScreenView);
export default ScreenView;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQcm9wZXJ0eSIsIkJvdW5kczIiLCJNYXRyaXgzIiwib3B0aW9uaXplIiwiQ29udHJvbEFyZWFOb2RlIiwiUGxheUFyZWFOb2RlIiwiU2NyZWVuU3VtbWFyeU5vZGUiLCJOb2RlIiwiVGFuZGVtIiwiam9pc3QiLCJERUZBVUxUX0xBWU9VVF9CT1VORFMiLCJTY3JlZW5WaWV3IiwiX3NjcmVlblN1bW1hcnlDb250ZW50IiwiY29uc3RydWN0b3IiLCJwcm92aWRlZE9wdGlvbnMiLCJvcHRpb25zIiwibGF5b3V0Qm91bmRzIiwiY29weSIsImxheWVyU3BsaXQiLCJleGNsdWRlSW52aXNpYmxlIiwidGFuZGVtIiwiUkVRVUlSRUQiLCJ2aXNpYmxlUHJvcGVydHlPcHRpb25zIiwicGhldGlvU3RhdGUiLCJwaGV0aW9SZWFkT25seSIsImNvbnRhaW5lclRhZ05hbWUiLCJ0YWdOYW1lIiwic2NyZWVuU3VtbWFyeUNvbnRlbnQiLCJpbmNsdWRlUERPTU5vZGVzIiwiYXNzZXJ0IiwiaXNQaGV0aW9JbnN0cnVtZW50ZWQiLCJuYW1lIiwidmlzaWJsZUJvdW5kc1Byb3BlcnR5IiwicGRvbVRpdGxlTm9kZSIsImZvY3VzSGlnaGxpZ2h0IiwicGRvbVBsYXlBcmVhTm9kZSIsInBkb21Db250cm9sQXJlYU5vZGUiLCJwZG9tU2NyZWVuU3VtbWFyeU5vZGUiLCJzZXRTY3JlZW5TdW1tYXJ5Q29udGVudCIsInZpc2libGVQcm9wZXJ0eSIsImxhenlMaW5rIiwidmlzaWJsZSIsImZvY3VzYWJsZSIsImZvY3VzIiwiYWRkSW5wdXRMaXN0ZW5lciIsImJsdXIiLCJwZG9tUGFyZW50Tm9kZSIsImNoaWxkcmVuIiwiYWRkQ2hpbGQiLCJwZG9tT3JkZXIiLCJzZXRQRE9NT3JkZXIiLCJFcnJvciIsInNldENoaWxkcmVuIiwicHJvdG90eXBlIiwiY2FsbCIsImhhc0NoaWxkIiwibW92ZVRvQmFjayIsImdldExheW91dFNjYWxlIiwidmlld0JvdW5kcyIsImxheW91dCIsImxheW91dE1hdHJpeE9wdGlvbnMiLCJtYXRyaXgiLCJnZXRMYXlvdXRNYXRyaXgiLCJ2YWx1ZSIsInBhcmVudFRvTG9jYWxCb3VuZHMiLCJub2RlIiwicmVtb3ZlQ2hpbGQiLCJzZXRTY3JlZW5TdW1tYXJ5SW50cm9BbmRUaXRsZSIsInNpbU5hbWUiLCJzY3JlZW5EaXNwbGF5TmFtZSIsInNpbVRpdGxlIiwiaXNNdWx0aVNjcmVlbiIsInNldEludHJvU3RyaW5nIiwiaW5uZXJDb250ZW50IiwiZ2V0Vm9pY2luZ092ZXJ2aWV3Q29udGVudCIsImdldFZvaWNpbmdEZXRhaWxzQ29udGVudCIsImdldFZvaWNpbmdIaW50Q29udGVudCIsImludGVycnVwdFN1YnRyZWVJbnB1dCIsIndpbmRvdyIsInBoZXQiLCJkaXNwbGF5IiwiaW50ZXJydXB0T3RoZXJQb2ludGVycyIsIk1hdGgiLCJtaW4iLCJ3aWR0aCIsImhlaWdodCIsInZlcnRpY2FsQWxpZ24iLCJzY2FsZSIsImR4IiwiZHkiLCJyb3dNYWpvciIsImxlZnQiLCJ0b3AiLCJzdGVwIiwiZHQiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIlNjcmVlblZpZXcudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTMtMjAyNCwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogVGhlIHZpZXcgcG9ydGlvbiBvZiBhIFNjcmVlbiwgc3BlY2lmaWVzIHRoZSBsYXlvdXQgc3RyYXRlZ3kgZm9yIHRoZSB2aXN1YWwgdmlldy5cclxuICpcclxuICogRm9yIHRoZSBQRE9NIHZpZXcsIHRoaXMgdHlwZSBjcmVhdGVzICB0aGUgdGhyZWUgb3JnYW5pemluZyBlbGVtZW50cyBhc3NvY2lhdGVkIHdpdGggZWFjaCBzY3JlZW46XHJcbiAqIC0gVGhlIGBTY3JlZW5TdW1tYXJ5Tm9kZWAgaXMgaW50cm9kdWN0b3J5IGRlc2NyaXB0aW9uIHRoYXQgb3V0bGluZXMgdGhlIHNjcmVlbiBhbmQgc2V0cyB0aGUgc2NlbmUgZm9yIHRoZSB1c2VyLlxyXG4gKiAtIFRoZSBgUGxheUFyZWFOb2RlYCBob2xkcyBjb250ZW50IHRoYXQgaXMgY29uc2lkZXJlZCB0aGUgbWFpbiBpbnRlcmFjdGlvbiBhbmQgcGVkYWdvZ3kgdG8gYmUgbGVhcm5lZCBmcm9tIHRoZSBzY3JlZW4uXHJcbiAqIC0gVGhlIGBDb250cm9sQXJlYU5vZGVgIGhvdXNlcyBjb250cm9scyBhbmQgb3RoZXIgY29udGVudCB0aGF0IGlzIHNlY29uZGFyeSB0byB0aGUgbWFpbiBpbnRlcmFjdGlvbi4gSWRlYWxseSB0aGUgdXNlclxyXG4gKiAgICAgICB3b3VsZCBlbmNvdW50ZXIgdGhpcyBhZnRlciBleHBsb3JpbmcgdGhlIFBsYXlBcmVhTm9kZS5cclxuICogVGhlIHNjcmVlblN1bW1hcnlOb2RlIGluc3RhbmNlIGlzIG5vdCBhdmFpbGFibGUgb24gdGhlIFNjcmVlblZpZXcsIGluc3RlYWQgY29udGVudCBjYW4gYmUgYWRkZWQgdG8gaXQgdmlhIGEgY29uc3RydWN0b3JcclxuICogb3B0aW9uIG9yIGBTY3JlZW5WaWV3LnNldFNjcmVlblN1bW1hcnlDb250ZW50YC4gVGhpcyBpcyBiZWNhdXNlIHNvbWUgYWNjZXNzaWJsZSBkZXNjcmlwdGlvbnMgaW4gdGhlIHNjcmVlbiBzdW1tYXJ5XHJcbiAqIGFyZSB0aGUgc2FtZSB0aHJvdWdob3V0IGFsbCBzaW11bGF0aW9ucy4gVGhlIHBkb21QbGF5QXJlYU5vZGUgYW5kIHBkb21Db250cm9sQXJlYU5vZGUgaW5zdGFuY2VzIGFyZSBwcm90ZWN0ZWQsIHJlYWQtb25seSBOb2Rlc1xyXG4gKiB0aGF0IGFyZSBtZWFudCB0byBoYXZlIHRoZWlyIHBkb21PcmRlciBhbmQgY2hpbGRyZW4gc2V0IHRvIGFjaGlldmUgdGhlIHByb3BlciBQRE9NIHN0cnVjdHVyZS4gRG8gbm90IHNldFxyXG4gKiBgcGRvbU9yZGVyYCBkaXJlY3RseSBvbiB0aGUgU2NyZWVuVmlldywgYXMgU2NyZWVuVmlldyBzZXQncyBpdHMgb3duIHBkb21PcmRlclxyXG4gKlxyXG4gKiBAYXV0aG9yIFNhbSBSZWlkIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKi9cclxuXHJcbmltcG9ydCBQcm9wZXJ0eSBmcm9tICcuLi8uLi9heG9uL2pzL1Byb3BlcnR5LmpzJztcclxuaW1wb3J0IEJvdW5kczIgZnJvbSAnLi4vLi4vZG90L2pzL0JvdW5kczIuanMnO1xyXG5pbXBvcnQgTWF0cml4MyBmcm9tICcuLi8uLi9kb3QvanMvTWF0cml4My5qcyc7XHJcbmltcG9ydCBvcHRpb25pemUgZnJvbSAnLi4vLi4vcGhldC1jb3JlL2pzL29wdGlvbml6ZS5qcyc7XHJcbmltcG9ydCBDb250cm9sQXJlYU5vZGUgZnJvbSAnLi4vLi4vc2NlbmVyeS1waGV0L2pzL2FjY2Vzc2liaWxpdHkvbm9kZXMvQ29udHJvbEFyZWFOb2RlLmpzJztcclxuaW1wb3J0IFBsYXlBcmVhTm9kZSBmcm9tICcuLi8uLi9zY2VuZXJ5LXBoZXQvanMvYWNjZXNzaWJpbGl0eS9ub2Rlcy9QbGF5QXJlYU5vZGUuanMnO1xyXG5pbXBvcnQgU2NyZWVuU3VtbWFyeU5vZGUgZnJvbSAnLi4vLi4vc2NlbmVyeS1waGV0L2pzL2FjY2Vzc2liaWxpdHkvbm9kZXMvU2NyZWVuU3VtbWFyeU5vZGUuanMnO1xyXG5pbXBvcnQgeyBOb2RlLCBOb2RlT3B0aW9ucyB9IGZyb20gJy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBUYW5kZW0gZnJvbSAnLi4vLi4vdGFuZGVtL2pzL1RhbmRlbS5qcyc7XHJcbmltcG9ydCBqb2lzdCBmcm9tICcuL2pvaXN0LmpzJztcclxuaW1wb3J0IHsgU3BlYWthYmxlUmVzb2x2ZWRSZXNwb25zZSB9IGZyb20gJy4uLy4uL3V0dGVyYW5jZS1xdWV1ZS9qcy9SZXNwb25zZVBhY2tldC5qcyc7XHJcblxyXG4vKlxyXG4gKiBEZWZhdWx0IHdpZHRoIGFuZCBoZWlnaHQgZm9yIGlQYWQyLCBpUGFkMywgaVBhZDQgcnVubmluZyBTYWZhcmkgd2l0aCBkZWZhdWx0IHRhYnMgYW5kIGRlY29yYXRpb25zXHJcbiAqIFRoZXNlIGJvdW5kcyB3ZXJlIGFkZGVkIGluIFNlcCAyMDE0IGFuZCBhcmUgYmFzZWQgb24gYSBzY3JlZW5zaG90IGZyb20gYSBub24tUmV0aW5hIGlQYWQsIGluIFNhZmFyaSwgaU9TNy5cclxuICogSXQgdGhlcmVmb3JlIGFjY291bnRzIGZvciB0aGUgbmF2IGJhciBvbiB0aGUgYm90dG9tIGFuZCB0aGUgc3BhY2UgY29uc3VtZWQgYnkgdGhlIGJyb3dzZXIgb24gdGhlIHRvcC5cclxuICogQXMgb2YgdGhpcyB3cml0aW5nLCB0aGlzIGlzIHRoZSByZXNvbHV0aW9uIGJlaW5nIHVzZWQgYnkgUGhFVCdzIHNpbSBkZXNpZ25lcnMgZm9yIHRoZWlyIG1vY2t1cHMuXHJcbiAqIEZvciBtb3JlIGluZm9ybWF0aW9uIHNlZSBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMvam9pc3QvaXNzdWVzLzEyNlxyXG4gKi9cclxuY29uc3QgREVGQVVMVF9MQVlPVVRfQk9VTkRTID0gbmV3IEJvdW5kczIoIDAsIDAsIDEwMjQsIDYxOCApO1xyXG5cclxudHlwZSBHZXRMYXlvdXRNYXRyaXhPcHRpb25zID0ge1xyXG4gIHZlcnRpY2FsQWxpZ24/OiAnY2VudGVyJyB8ICdib3R0b20nO1xyXG59O1xyXG5cclxuLy8gRG9jdW1lbnRlZCB3aGVyZSB0aGUgZGVmYXVsdHMgYXJlIGRlZmluZWRcclxudHlwZSBTZWxmT3B0aW9ucyA9IHtcclxuICBsYXlvdXRCb3VuZHM/OiBCb3VuZHMyO1xyXG4gIHNjcmVlblN1bW1hcnlDb250ZW50PzogTm9kZSB8IG51bGw7XHJcbiAgaW5jbHVkZVBET01Ob2Rlcz86IGJvb2xlYW47XHJcbn07XHJcbmV4cG9ydCB0eXBlIFNjcmVlblZpZXdPcHRpb25zID0gU2VsZk9wdGlvbnMgJiBOb2RlT3B0aW9ucztcclxuXHJcbmNsYXNzIFNjcmVlblZpZXcgZXh0ZW5kcyBOb2RlIHtcclxuICBwdWJsaWMgcmVhZG9ubHkgbGF5b3V0Qm91bmRzOiBCb3VuZHMyO1xyXG5cclxuICAvLyBUaGUgdmlzaWJsZSBib3VuZHMgb2YgdGhlIFNjcmVlblZpZXcgaW4gU2NyZWVuVmlldyBjb29yZGluYXRlcy4gIFRoaXMgaW5jbHVkZXMgdG9wL2JvdHRvbSBvciBsZWZ0L3JpZ2h0IG1hcmdpbnNcclxuICAvLyBkZXBlbmRpbmcgb24gdGhlIGFzcGVjdCByYXRpbyBvZiB0aGUgc2NyZWVuLiBDbGllbnRzIHNob3VsZCBub3Qgc2V0IHRoaXMgdmFsdWVcclxuICBwdWJsaWMgcmVhZG9ubHkgdmlzaWJsZUJvdW5kc1Byb3BlcnR5OiBQcm9wZXJ0eTxCb3VuZHMyPjtcclxuICBwcml2YXRlIHJlYWRvbmx5IHBkb21UaXRsZU5vZGU6IE5vZGU7XHJcbiAgcHJvdGVjdGVkIHJlYWRvbmx5IHBkb21QbGF5QXJlYU5vZGU6IFBsYXlBcmVhTm9kZTtcclxuICBwcm90ZWN0ZWQgcmVhZG9ubHkgcGRvbUNvbnRyb2xBcmVhTm9kZTogQ29udHJvbEFyZWFOb2RlO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgcGRvbVNjcmVlblN1bW1hcnlOb2RlOiBTY3JlZW5TdW1tYXJ5Tm9kZTtcclxuICBwcml2YXRlIHJlYWRvbmx5IHBkb21QYXJlbnROb2RlOiBOb2RlO1xyXG5cclxuICAvLyBLZWVwIHRyYWNrIG9mIHRoZSBjb250ZW50IGFkZGVkIHRvIHRoZSBzdW1tYXJ5IE5vZGUsIHNvIHRoYXQgaWYgaXQgaXMgc2V0IG1vcmUgdGhhbiBvbmNlLCB0aGUgcHJldmlvdXMgb25lIGNhbiBiZVxyXG4gIC8vIHJlbW92ZWQuIFN1cHBvcnRzIGFuIEVTNiBnZXR0ZXIvc2V0dGVyIGZvciB0aGlzLlxyXG4gIHByaXZhdGUgX3NjcmVlblN1bW1hcnlDb250ZW50OiBOb2RlIHwgbnVsbCA9IG51bGw7XHJcblxyXG4gIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgREVGQVVMVF9MQVlPVVRfQk9VTkRTID0gREVGQVVMVF9MQVlPVVRfQk9VTkRTO1xyXG5cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIHByb3ZpZGVkT3B0aW9ucz86IFNjcmVlblZpZXdPcHRpb25zICkge1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSBvcHRpb25pemU8U2NyZWVuVmlld09wdGlvbnMsIFNlbGZPcHRpb25zLCBOb2RlT3B0aW9ucz4oKSgge1xyXG5cclxuICAgICAgLy8ge0JvdW5kczJ9IHRoZSBib3VuZHMgdGhhdCBhcmUgc2FmZSB0byBkcmF3IGluIG9uIGFsbCBzdXBwb3J0ZWQgcGxhdGZvcm1zXHJcbiAgICAgIGxheW91dEJvdW5kczogREVGQVVMVF9MQVlPVVRfQk9VTkRTLmNvcHkoKSxcclxuXHJcbiAgICAgIC8vIE5vZGUgb3B0aW9uc1xyXG4gICAgICBsYXllclNwbGl0OiB0cnVlLCAvLyBzbyB3ZSdyZSBub3QgaW4gdGhlIHNhbWUgbGF5ZXIgYXMgdGhlIG5hdmJhciwgZXRjLlxyXG4gICAgICBleGNsdWRlSW52aXNpYmxlOiB0cnVlLCAvLyBzbyB3ZSBkb24ndCBrZWVwIGludmlzaWJsZSBzY3JlZW5zIGluIHRoZSBTVkcgdHJlZVxyXG5cclxuICAgICAgLy8gcGhldC1pb1xyXG4gICAgICB0YW5kZW06IFRhbmRlbS5SRVFVSVJFRCxcclxuICAgICAgdmlzaWJsZVByb3BlcnR5T3B0aW9uczoge1xyXG4gICAgICAgIHBoZXRpb1N0YXRlOiBmYWxzZSxcclxuICAgICAgICBwaGV0aW9SZWFkT25seTogdHJ1ZVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgLy8gcGRvbSBvcHRpb25zXHJcbiAgICAgIGNvbnRhaW5lclRhZ05hbWU6ICdhcnRpY2xlJyxcclxuICAgICAgdGFnTmFtZTogJ2RpdicsXHJcblxyXG4gICAgICAvLyB7Tm9kZXxudWxsfSB0aGUgTm9kZSB3aXRoIHNjcmVlbiBzdW1tYXJ5IGNvbnRlbnQgdG8gYmUgYWRkZWQgdG8gdGhlIFNjcmVlblN1bW1hcnlOb2RlLCBhbmQgaW50byBQRE9NIGFib3ZlXHJcbiAgICAgIC8vIHRoZSBQbGF5IEFyZWEuIFRoaXMgTm9kZSBpcyBhZGRlZCBhcyBhIGNoaWxkIHRvIHRoZSBTY3JlZW5TdW1tYXJ5Tm9kZS5cclxuICAgICAgc2NyZWVuU3VtbWFyeUNvbnRlbnQ6IG51bGwsXHJcblxyXG4gICAgICAvLyB7Ym9vbGVhbn0gd2hldGhlciBvciBub3QgdG8gYWRkIHRoZSBzY3JlZW4gc3VtbWFyeSwgcGxheSBhcmVhLCBhbmQgY29udHJvbCBhcmVhIE5vZGVzIHRvIHRoZSBQRE9NXHJcbiAgICAgIGluY2x1ZGVQRE9NTm9kZXM6IHRydWVcclxuICAgIH0sIHByb3ZpZGVkT3B0aW9ucyApO1xyXG5cclxuICAgIHN1cGVyKCBvcHRpb25zICk7XHJcblxyXG4gICAgaWYgKCBhc3NlcnQgJiYgdGhpcy5pc1BoZXRpb0luc3RydW1lbnRlZCgpICkge1xyXG4gICAgICBhc3NlcnQgJiYgYXNzZXJ0KCBvcHRpb25zLnRhbmRlbS5uYW1lID09PSAndmlldycsICd0YW5kZW0gbmFtZSBzaG91bGQgYmUgdmlldycgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyB0aGUgYm91bmRzIHRoZSBjb25maW5lIHRoZSBsYXlvdXQgb2YgdGhlIHZpZXcuXHJcbiAgICB0aGlzLmxheW91dEJvdW5kcyA9IG9wdGlvbnMubGF5b3V0Qm91bmRzO1xyXG5cclxuICAgIC8vIEluaXRpYWxpemVkIHRvIGRlZmF1bHQgbGF5b3V0IGJvdW5kcywgdGhlbiB1cGRhdGVkIGFzIHNvb24gYXMgbGF5b3V0KCkgaXMgY2FsbGVkLCB3aGljaCBpcyBiZWZvcmUgdGhlXHJcbiAgICAvLyBTY3JlZW5WaWV3IGlzIGRpc3BsYXllZC5cclxuICAgIHRoaXMudmlzaWJsZUJvdW5kc1Byb3BlcnR5ID0gbmV3IFByb3BlcnR5KCBvcHRpb25zLmxheW91dEJvdW5kcyApO1xyXG5cclxuICAgIC8vIHRoaXMgY2Fubm90IGJlIGEgbGFiZWwgdG8gdGhpcyBTY3JlZW5WaWV3LCBiZWNhdXNlIGl0IG5lZWRzIHRvIGJlIGZvY3VzYWJsZS5cclxuICAgIHRoaXMucGRvbVRpdGxlTm9kZSA9IG5ldyBOb2RlKCB7IHRhZ05hbWU6ICdoMScsIGZvY3VzSGlnaGxpZ2h0OiAnaW52aXNpYmxlJyB9ICk7XHJcblxyXG4gICAgLy8gYWRkIGNoaWxkcmVuIGFuZCBzZXQgYWNjZXNzaWJsZSBvcmRlciB0byB0aGVzZSB0byBvcmdhbml6ZSBhbmQgc3RydWN0dXJlIHRoZSBQRE9NLlxyXG4gICAgdGhpcy5wZG9tUGxheUFyZWFOb2RlID0gbmV3IFBsYXlBcmVhTm9kZSgpO1xyXG4gICAgdGhpcy5wZG9tQ29udHJvbEFyZWFOb2RlID0gbmV3IENvbnRyb2xBcmVhTm9kZSgpO1xyXG5cclxuICAgIC8vIFRoaXMgY29udGFpbmVyIGhhcyB0aGUgaW50cm8gXCJ7e1NJTX19IGlzIGFuIGludGVyYWN0aXZlIHNpbSwgaXQgY2hhbmdlcyBhcyB5b3UgLiAuIC5cIlxyXG4gICAgdGhpcy5wZG9tU2NyZWVuU3VtbWFyeU5vZGUgPSBuZXcgU2NyZWVuU3VtbWFyeU5vZGUoKTtcclxuXHJcbiAgICAvLyBhdCB0aGUgTm9kZSBmcm9tIG9wdGlvbnMgaW4gdGhlIHNhbWUgd2F5IHRoYXQgY2FuIGJlIGRvbmUgYXQgYW55IHRpbWVcclxuICAgIG9wdGlvbnMuc2NyZWVuU3VtbWFyeUNvbnRlbnQgJiYgdGhpcy5zZXRTY3JlZW5TdW1tYXJ5Q29udGVudCggb3B0aW9ucy5zY3JlZW5TdW1tYXJ5Q29udGVudCApO1xyXG5cclxuICAgIC8vIFRvIG1ha2Ugc3VyZSB0aGF0IHRoZSB0aXRsZSBcImgxXCIgaXMgdGhlIGZpcnN0LCBmb2N1c2VkIGl0ZW0gb24gYSBzY3JlZW4gd2hlbiB0aGF0IHNjcmVlbiBpcyBzZWxlY3RlZCwgdG9nZ2xlIHRoZVxyXG4gICAgLy8gZm9jdXNhYmlsaXR5IG9mIHRoZSB0aXRsZSwgYW5kIHRoZW4gZm9jdXMgaXQuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMvcmF0aW8tYW5kLXByb3BvcnRpb24vaXNzdWVzLzMyMVxyXG4gICAgdGhpcy52aXNpYmxlUHJvcGVydHkubGF6eUxpbmsoIHZpc2libGUgPT4ge1xyXG4gICAgICBpZiAoIHZpc2libGUgKSB7XHJcbiAgICAgICAgYXNzZXJ0ICYmIGFzc2VydCggIXRoaXMucGRvbVRpdGxlTm9kZS5mb2N1c2FibGUsICdhYm91dCB0byBzZXQgdG8gYmUgZm9jdXNhYmxlJyApO1xyXG4gICAgICAgIHRoaXMucGRvbVRpdGxlTm9kZS5mb2N1c2FibGUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMucGRvbVRpdGxlTm9kZS5mb2N1cygpO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIHRoaXMucGRvbVRpdGxlTm9kZS5mb2N1c2FibGUgPSBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIGFmdGVyIGluaXRpYWwgZm9jdXMsIHRoZSB0aXRsZU5vZGUgc2hvdWxkIGJlIHJlbW92ZWQgZnJvbSB0aGUgZm9jdXMgb3JkZXJcclxuICAgIHRoaXMucGRvbVRpdGxlTm9kZS5hZGRJbnB1dExpc3RlbmVyKCB7XHJcbiAgICAgIGJsdXI6ICgpID0+IHtcclxuICAgICAgICB0aGlzLnBkb21UaXRsZU5vZGUuZm9jdXNhYmxlID0gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgIH0gKTtcclxuXHJcbiAgICB0aGlzLnBkb21QYXJlbnROb2RlID0gbmV3IE5vZGUoIHtcclxuXHJcbiAgICAgIC8vIG9yZGVyIG9mIE5vZGVzIGZvciB0aGUgUERPTSB0aGF0IG1ha2VzIG1vc3Qgc2Vuc2UgZm9yIGdyYXBoaWNhbCByZW5kZXJpbmcsIFwiUGxheSBBcmVhXCIgY29tcG9uZW50c1xyXG4gICAgICAvLyBvbiB0b3Agb2YgXCJDb250cm9sIEFyZWFcIiBjb21wb25lbnRzLlxyXG4gICAgICBjaGlsZHJlbjogb3B0aW9ucy5pbmNsdWRlUERPTU5vZGVzID8gW1xyXG4gICAgICAgIHRoaXMucGRvbVRpdGxlTm9kZSxcclxuICAgICAgICB0aGlzLnBkb21TY3JlZW5TdW1tYXJ5Tm9kZSxcclxuICAgICAgICB0aGlzLnBkb21Db250cm9sQXJlYU5vZGUsXHJcbiAgICAgICAgdGhpcy5wZG9tUGxheUFyZWFOb2RlXHJcbiAgICAgIF0gOiBbIHRoaXMucGRvbVRpdGxlTm9kZSBdXHJcbiAgICB9ICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCB0aGlzLnBkb21QYXJlbnROb2RlICk7XHJcblxyXG4gICAgLy8gcGRvbSAtIFwiUGxheSBBcmVhXCIgY29tZXMgYmVmb3JlIFwiQ29udHJvbCBBcmVhXCIgaW4gUERPTVxyXG4gICAgdGhpcy5wZG9tUGFyZW50Tm9kZS5wZG9tT3JkZXIgPSBvcHRpb25zLmluY2x1ZGVQRE9NTm9kZXMgPyBbXHJcbiAgICAgIHRoaXMucGRvbVRpdGxlTm9kZSxcclxuICAgICAgdGhpcy5wZG9tU2NyZWVuU3VtbWFyeU5vZGUsXHJcbiAgICAgIHRoaXMucGRvbVBsYXlBcmVhTm9kZSxcclxuICAgICAgdGhpcy5wZG9tQ29udHJvbEFyZWFOb2RlXHJcbiAgICBdIDogWyB0aGlzLnBkb21UaXRsZU5vZGUgXTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgbWV0aG9kIHNob3VsZCBub3QgYmUgY2FsbGVkIGJlY2F1c2UgU2NyZWVuVmlldyBkZWZpbmVzIGNoaWxkIE5vZGVzIHRoYXQgb3JnYW5pemUgdGhlIFBET00gc3RydWN0dXJlIG9mIGFcclxuICAgKiBzY3JlZW4uIFNlZSB0aGlzLnBkb21TY3JlZW5TdW1tYXJ5Tm9kZSwgdGhpcy5wZG9tUGxheUFyZWFOb2RlLCBhbmQgdGhpcy5wZG9tQ29udHJvbEFyZWFOb2RlIGFuZCBzZXQgdGhlaXIgYWNjZXNzaWJsZVxyXG4gICAqIG9yZGVyIGFjY29yZGluZ2x5IHdoZW4gYWRkaW5nIGFjY2Vzc2libGUgY29udGVudCB0byB0aGUgUERPTSBmb3IgdGhpcyBzY3JlZW4uXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIHNldFBET01PcmRlciggcGRvbU9yZGVyOiBBcnJheTxOb2RlIHwgbnVsbD4gfCBudWxsICk6IHZvaWQge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKCAnc2hvdWxkIG5vdCBuZWVkIHRvIHNldCBhY2Nlc3NpYmxlIG9yZGVyIG9uIGEgU2NyZWVuVmlldycgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIE92ZXJyaWRlIHRvIG1ha2Ugc3VyZSB0aGF0IHNldHRpbmcgY2hpbGRyZW4gZG9lc24ndCBibG93IGF3YXkgTm9kZXMgc2V0IGJ5IFNjcmVlblZpZXcuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIHNldENoaWxkcmVuKCBjaGlsZHJlbjogTm9kZVtdICk6IHRoaXMge1xyXG4gICAgTm9kZS5wcm90b3R5cGUuc2V0Q2hpbGRyZW4uY2FsbCggdGhpcywgY2hpbGRyZW4gKTtcclxuXHJcbiAgICAvLyBtdXRhdGUgbWF5IGNhbGwgc2V0Q2hpbGRyZW4gYmVmb3JlIHBkb21QYXJlbnROb2RlIGlzIGNvbnN0cnVjdGVkXHJcbiAgICBpZiAoIHRoaXMucGRvbVBhcmVudE5vZGUgJiYgIXRoaXMuaGFzQ2hpbGQoIHRoaXMucGRvbVBhcmVudE5vZGUgKSApIHtcclxuICAgICAgdGhpcy5hZGRDaGlsZCggdGhpcy5wZG9tUGFyZW50Tm9kZSApO1xyXG4gICAgICB0aGlzLnBkb21QYXJlbnROb2RlLm1vdmVUb0JhY2soKTtcclxuICAgIH1cclxuICAgIHJldHVybiB0aGlzO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IHRoZSBzY2FsZSB0byB1c2UgZm9yIGxheWluZyBvdXQgdGhlIHNpbSBjb21wb25lbnRzIGFuZCB0aGUgbmF2aWdhdGlvbiBiYXIsIHNvIGl0cyBzaXplIHdpbGwgdHJhY2tcclxuICAgKiB3aXRoIHRoZSBzaW0gc2l6ZVxyXG4gICAqIChqb2lzdC1pbnRlcm5hbClcclxuICAgKi9cclxuICBwdWJsaWMgZ2V0TGF5b3V0U2NhbGUoIHZpZXdCb3VuZHM6IEJvdW5kczIgKTogbnVtYmVyIHtcclxuICAgIHJldHVybiBTY3JlZW5WaWV3LmdldExheW91dFNjYWxlKCB0aGlzLmxheW91dEJvdW5kcywgdmlld0JvdW5kcyApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRGVmYXVsdCBsYXlvdXQgZnVuY3Rpb24gdXNlcyB0aGUgbGF5b3V0V2lkdGggYW5kIGxheW91dEhlaWdodCB0byBzY2FsZSB0aGUgY29udGVudCAoYmFzZWQgb24gd2hpY2hldmVyIGlzIG1vcmUgbGltaXRpbmc6IHdpZHRoIG9yIGhlaWdodClcclxuICAgKiBhbmQgY2VudGVycyB0aGUgY29udGVudCBpbiB0aGUgc2NyZWVuIHZlcnRpY2FsbHkgYW5kIGhvcml6b250YWxseVxyXG4gICAqIFRoaXMgZnVuY3Rpb24gY2FuIGJlIHJlcGxhY2VkIGJ5IHN1YmNsYXNzZXMgdGhhdCB3aXNoIHRvIHBlcmZvcm0gdGhlaXIgb3duIGN1c3RvbSBsYXlvdXQuXHJcbiAgICogQHBhcmFtIHZpZXdCb3VuZHMgLSBkZXNpcmVkIGJvdW5kcyBmb3IgdGhlIHZpZXdcclxuICAgKiAoam9pc3QtaW50ZXJuYWwpXHJcbiAgICovXHJcbiAgcHVibGljIGxheW91dCggdmlld0JvdW5kczogQm91bmRzMiwgbGF5b3V0TWF0cml4T3B0aW9ucz86IEdldExheW91dE1hdHJpeE9wdGlvbnMgKTogdm9pZCB7XHJcbiAgICB0aGlzLm1hdHJpeCA9IFNjcmVlblZpZXcuZ2V0TGF5b3V0TWF0cml4KCB0aGlzLmxheW91dEJvdW5kcywgdmlld0JvdW5kcywgbGF5b3V0TWF0cml4T3B0aW9ucyApO1xyXG4gICAgdGhpcy52aXNpYmxlQm91bmRzUHJvcGVydHkudmFsdWUgPSB0aGlzLnBhcmVudFRvTG9jYWxCb3VuZHMoIHZpZXdCb3VuZHMgKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBnZXQgc2NyZWVuU3VtbWFyeUNvbnRlbnQoKTogTm9kZSB8IG51bGwge1xyXG4gICAgcmV0dXJuIHRoaXMuX3NjcmVlblN1bW1hcnlDb250ZW50O1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHNldCBzY3JlZW5TdW1tYXJ5Q29udGVudCggbm9kZTogTm9kZSB8IG51bGwgKSB7XHJcbiAgICB0aGlzLnNldFNjcmVlblN1bW1hcnlDb250ZW50KCBub2RlICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTZXQgdGhlIHNjcmVlbiBzdW1tYXJ5IE5vZGUgZm9yIHRoZSBQRE9NIG9mIHRoaXMgU2NyZWVuIFZpZXcuIFByZWZlciBwYXNzaW5nIGluIGEgc2NyZWVuIHN1bW1hcnkgTm9kZSB2aWFcclxuICAgKiBjb25zdHJ1Y3RvciBvcHRpb25zLCBidXQgdGhpcyBtZXRob2QgY2FuIGJlIHVzZWQgZGlyZWN0bHkgd2hlbiBuZWNlc3NhcnkuXHJcbiAgICovXHJcbiAgcHVibGljIHNldFNjcmVlblN1bW1hcnlDb250ZW50KCBub2RlOiBOb2RlIHwgbnVsbCApOiB2b2lkIHtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIG5vZGUgIT09IHRoaXMuX3NjcmVlblN1bW1hcnlDb250ZW50LCAndGhpcyBpcyBhbHJlYWR5IHRoZSBzY3JlZW4gc3VtbWFyeSBOb2RlIGNvbnRlbnQnICk7XHJcblxyXG4gICAgdGhpcy5fc2NyZWVuU3VtbWFyeUNvbnRlbnQgJiYgdGhpcy5wZG9tU2NyZWVuU3VtbWFyeU5vZGUucmVtb3ZlQ2hpbGQoIHRoaXMuX3NjcmVlblN1bW1hcnlDb250ZW50ICk7XHJcblxyXG4gICAgdGhpcy5fc2NyZWVuU3VtbWFyeUNvbnRlbnQgPSBub2RlO1xyXG5cclxuICAgIGlmICggbm9kZSApIHtcclxuICAgICAgdGhpcy5wZG9tU2NyZWVuU3VtbWFyeU5vZGUuYWRkQ2hpbGQoIG5vZGUgKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFNldCB0aGUgc2NyZWVuIHN1bW1hcnkgTm9kZSBpbnRybyBzdHJpbmdcclxuICAgKiAoam9pc3QtaW50ZXJuYWwpXHJcbiAgICovXHJcbiAgcHVibGljIHNldFNjcmVlblN1bW1hcnlJbnRyb0FuZFRpdGxlKCBzaW1OYW1lOiBzdHJpbmcsIHNjcmVlbkRpc3BsYXlOYW1lOiBzdHJpbmcgfCBudWxsLCBzaW1UaXRsZTogc3RyaW5nLCBpc011bHRpU2NyZWVuOiBib29sZWFuICk6IHZvaWQge1xyXG4gICAgLy8gVE9ETzogU2hvdWxkIHVzZSBQYXR0ZXJuU3RyaW5nUHJvcGVydHksIHNlZSBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMvam9pc3QvaXNzdWVzLzg4NVxyXG4gICAgdGhpcy5wZG9tU2NyZWVuU3VtbWFyeU5vZGUuc2V0SW50cm9TdHJpbmcoIHNpbU5hbWUsIHNjcmVlbkRpc3BsYXlOYW1lLCBpc011bHRpU2NyZWVuICk7XHJcbiAgICB0aGlzLnBkb21UaXRsZU5vZGUuaW5uZXJDb250ZW50ID0gc2ltVGl0bGU7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDcmVhdGUgdGhlIGFsZXJ0IGNvbnRlbnQgZm9yIHRoaXMgU2NyZWVuVmlldyB3aGVuIHRoZSBWb2ljaW5nIGZlYXR1cmUgaXMgZW5hYmxlZCBhbmQgdGhlIFwiT3ZlcnZpZXdcIiBidXR0b25cclxuICAgKiBpcyBwcmVzc2VkLlxyXG4gICAqIE11c3QgYmUgaW1wbGVtZW50ZWQgaWYgc3VwcG9ydGluZyB2b2ljaW5nIGluIHlvdXIgU2NyZWVuVmlldy5cclxuICAgKi9cclxuICBwdWJsaWMgZ2V0Vm9pY2luZ092ZXJ2aWV3Q29udGVudCgpOiBTcGVha2FibGVSZXNvbHZlZFJlc3BvbnNlIHtcclxuICAgIHRocm93IG5ldyBFcnJvciggJ1RoZSBTY3JlZW5WaWV3IHNob3VsZCBpbXBsZW1lbnQgZ2V0Vm9pY2luZ092ZXJ2aWV3Q29udGVudCBpZiBWb2ljaW5nIGlzIGVuYWJsZWQnICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDcmVhdGUgdGhlIGFsZXJ0IGNvbnRlbnQgZm9yIHRoaXMgU2NyZWVuVmlldyB3aGVuIHRoZSBWb2ljaW5nIGZlYXR1cmUgaXMgZW5hYmxlZCBhbmQgdGhlIFwiRGV0YWlsc1wiIGJ1dHRvbiBpc1xyXG4gICAqIHByZXNzZWQuXHJcbiAgICogTXVzdCBiZSBpbXBsZW1lbnRlZCBpZiBzdXBwb3J0aW5nIHZvaWNpbmcgaW4geW91ciBTY3JlZW5WaWV3LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBnZXRWb2ljaW5nRGV0YWlsc0NvbnRlbnQoKTogU3BlYWthYmxlUmVzb2x2ZWRSZXNwb25zZSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoICdUaGUgU2NyZWVuVmlldyBzaG91bGQgaW1wbGVtZW50IGdldFZvaWNpbmdEZXRhaWxzQ29udGVudCB3aGVuIHRoZSBWb2ljaW5nIGZlYXR1cmUgaXMgZW5hYmxlZC4nICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDcmVhdGUgdGhlIGFsZXJ0IGNvbnRlbnQgZm9yIHRoaXMgU2NyZWVuVmlldyB3aGVuIHRoZSBWb2ljaW5nIGZlYXR1cmUgaXMgZW5hYmxlZCBhbmQgdGhlIFwiSGludFwiIGJ1dHRvbiBpcyBwcmVzc2VkLlxyXG4gICAqIE11c3QgYmUgaW1wbGVtZW50ZWQgaWYgc3VwcG9ydGluZyB2b2ljaW5nIGluIHlvdXIgU2NyZWVuVmlldy5cclxuICAgKi9cclxuICBwdWJsaWMgZ2V0Vm9pY2luZ0hpbnRDb250ZW50KCk6IFNwZWFrYWJsZVJlc29sdmVkUmVzcG9uc2Uge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKCAnVGhlIFNjcmVlblZpZXcgc2hvdWxkIGltcGxlbWVudCBnZXRWb2ljaW5nSGludENvbnRlbnQgd2hlbiBWb2ljaW5nIGlzIGVuYWJsZWQuJyApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogSW50ZXJydXB0cyBhbGwgaW5wdXQgbGlzdGVuZXJzIHRoYXQgYXJlIGF0dGFjaGVkIHRvIGVpdGhlciB0aGlzIG5vZGUsIG9yIGEgZGVzY2VuZGFudCBub2RlLlxyXG4gICAqXHJcbiAgICogT3ZlcnJpZGRlbiBoZXJlIHNvIHdlIGNhbiBpbnRlcnJ1cHQgYWxsIG9mIHRoZSBsaXN0ZW5lcnMgaW4gdGhlIERpc3BsYXksIHNlZVxyXG4gICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9zY2VuZXJ5L2lzc3Vlcy8xNTgyLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBpbnRlcnJ1cHRTdWJ0cmVlSW5wdXQoKTogdGhpcyB7XHJcbiAgICB3aW5kb3cucGhldD8uam9pc3Q/LmRpc3BsYXk/LmludGVycnVwdE90aGVyUG9pbnRlcnMoKTtcclxuXHJcbiAgICByZXR1cm4gc3VwZXIuaW50ZXJydXB0U3VidHJlZUlucHV0KCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgdGhlIHNjYWxlIHRvIHVzZSBmb3IgbGF5aW5nIG91dCB0aGUgc2ltIGNvbXBvbmVudHMgYW5kIHRoZSBuYXZpZ2F0aW9uIGJhciwgc28gaXRzIHNpemUgd2lsbCB0cmFja1xyXG4gICAqIHdpdGggdGhlIHNpbSBzaXplXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBnZXRMYXlvdXRTY2FsZSggbGF5b3V0Qm91bmRzOiBCb3VuZHMyLCB2aWV3Qm91bmRzOiBCb3VuZHMyICk6IG51bWJlciB7XHJcbiAgICByZXR1cm4gTWF0aC5taW4oIHZpZXdCb3VuZHMud2lkdGggLyBsYXlvdXRCb3VuZHMud2lkdGgsIHZpZXdCb3VuZHMuaGVpZ2h0IC8gbGF5b3V0Qm91bmRzLmhlaWdodCApO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHN0YXRpYyBnZXRMYXlvdXRNYXRyaXgoIGxheW91dEJvdW5kczogQm91bmRzMiwgdmlld0JvdW5kczogQm91bmRzMiwgcHJvdmlkZWRPcHRpb25zPzogR2V0TGF5b3V0TWF0cml4T3B0aW9ucyApOiBNYXRyaXgzIHtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0gb3B0aW9uaXplPEdldExheW91dE1hdHJpeE9wdGlvbnM+KCkoIHtcclxuICAgICAgdmVydGljYWxBbGlnbjogJ2NlbnRlcicgLy8gJ2NlbnRlcicgb3IgJ2JvdHRvbSdcclxuICAgIH0sIHByb3ZpZGVkT3B0aW9ucyApO1xyXG5cclxuICAgIGNvbnN0IHdpZHRoID0gdmlld0JvdW5kcy53aWR0aDtcclxuICAgIGNvbnN0IGhlaWdodCA9IHZpZXdCb3VuZHMuaGVpZ2h0O1xyXG4gICAgY29uc3Qgc2NhbGUgPSBTY3JlZW5WaWV3LmdldExheW91dFNjYWxlKCBsYXlvdXRCb3VuZHMsIHZpZXdCb3VuZHMgKTtcclxuXHJcbiAgICBsZXQgZHggPSAwO1xyXG4gICAgbGV0IGR5ID0gMDtcclxuXHJcbiAgICBpZiAoIHNjYWxlID09PSB3aWR0aCAvIGxheW91dEJvdW5kcy53aWR0aCApIHtcclxuXHJcbiAgICAgIC8vIHZlcnRpY2FsbHkgZmxvYXQgdG8gYm90dG9tXHJcbiAgICAgIGR5ID0gKCBoZWlnaHQgLyBzY2FsZSAtIGxheW91dEJvdW5kcy5oZWlnaHQgKTtcclxuXHJcbiAgICAgIC8vIGNlbnRlciB2ZXJ0aWNhbGx5XHJcbiAgICAgIGlmICggb3B0aW9ucy52ZXJ0aWNhbEFsaWduID09PSAnY2VudGVyJyApIHtcclxuICAgICAgICBkeSAvPSAyO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICggc2NhbGUgPT09IGhlaWdodCAvIGxheW91dEJvdW5kcy5oZWlnaHQgKSB7XHJcblxyXG4gICAgICAvLyBjZW50ZXIgaG9yaXpvbnRhbGx5XHJcbiAgICAgIGR4ID0gKCB3aWR0aCAvIHNjYWxlIC0gbGF5b3V0Qm91bmRzLndpZHRoICkgLyAyO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBNYXRyaXgzLnJvd01ham9yKFxyXG4gICAgICBzY2FsZSwgMCwgZHggKiBzY2FsZSArIHZpZXdCb3VuZHMubGVmdCxcclxuICAgICAgMCwgc2NhbGUsIGR5ICogc2NhbGUgKyB2aWV3Qm91bmRzLnRvcCxcclxuICAgICAgMCwgMCwgMVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIC8vIE5vb3BzIGZvciBjb25zaXN0ZW50IEFQSVxyXG4gIHB1YmxpYyBzdGVwKCBkdDogbnVtYmVyICk6IHZvaWQge1xyXG4gICAgLy8gU2VlIHN1YmNsYXNzIGZvciBpbXBsZW1lbnRhdGlvblxyXG4gIH1cclxufVxyXG5cclxuam9pc3QucmVnaXN0ZXIoICdTY3JlZW5WaWV3JywgU2NyZWVu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