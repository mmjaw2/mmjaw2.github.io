// Copyright 2017-2023, University of Colorado Boulder

/**
 * Support for Legends of Learning platform. Sends init message after sim is constructed and supports pause/resume.
 *
 * To test this class, follow the 'Legends of Learning Test' instructions at
 * https://github.com/phetsims/QA/blob/main/documentation/qa-book.md#legends-of-learning-test
 *
 * @author Sam Reid (PhET Interactive Simulations)
 */

import joist from '../joist.js';
class LegendsOfLearningSupport {
  constructor(sim) {
    this.sim = sim;

    // Respond to pause/resume commands from the Legends of Learning platform
    window.addEventListener('message', message => {
      if (message.data.messageName === 'pause') {
        sim.stepOneFrame();
        sim.activeProperty.value = false;
      } else if (message.data.messageName === 'resume') {
        sim.activeProperty.value = true;
      }
    });
  }
  start() {
    // Send init message when sim has started up so that Legends of Learning can remove their splash screen
    this.sim.isConstructionCompleteProperty.link(isConstructionComplete => {
      isConstructionComplete && window.parent !== window && window.parent.postMessage({
        message: 'init'
      }, '*');
    });
  }
}
joist.register('LegendsOfLearningSupport', LegendsOfLearningSupport);
export default LegendsOfLearningSupport;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJqb2lzdCIsIkxlZ2VuZHNPZkxlYXJuaW5nU3VwcG9ydCIsImNvbnN0cnVjdG9yIiwic2ltIiwid2luZG93IiwiYWRkRXZlbnRMaXN0ZW5lciIsIm1lc3NhZ2UiLCJkYXRhIiwibWVzc2FnZU5hbWUiLCJzdGVwT25lRnJhbWUiLCJhY3RpdmVQcm9wZXJ0eSIsInZhbHVlIiwic3RhcnQiLCJpc0NvbnN0cnVjdGlvbkNvbXBsZXRlUHJvcGVydHkiLCJsaW5rIiwiaXNDb25zdHJ1Y3Rpb25Db21wbGV0ZSIsInBhcmVudCIsInBvc3RNZXNzYWdlIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJMZWdlbmRzT2ZMZWFybmluZ1N1cHBvcnQudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTctMjAyMywgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogU3VwcG9ydCBmb3IgTGVnZW5kcyBvZiBMZWFybmluZyBwbGF0Zm9ybS4gU2VuZHMgaW5pdCBtZXNzYWdlIGFmdGVyIHNpbSBpcyBjb25zdHJ1Y3RlZCBhbmQgc3VwcG9ydHMgcGF1c2UvcmVzdW1lLlxyXG4gKlxyXG4gKiBUbyB0ZXN0IHRoaXMgY2xhc3MsIGZvbGxvdyB0aGUgJ0xlZ2VuZHMgb2YgTGVhcm5pbmcgVGVzdCcgaW5zdHJ1Y3Rpb25zIGF0XHJcbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9RQS9ibG9iL21haW4vZG9jdW1lbnRhdGlvbi9xYS1ib29rLm1kI2xlZ2VuZHMtb2YtbGVhcm5pbmctdGVzdFxyXG4gKlxyXG4gKiBAYXV0aG9yIFNhbSBSZWlkIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKi9cclxuXHJcbmltcG9ydCBqb2lzdCBmcm9tICcuLi9qb2lzdC5qcyc7XHJcbmltcG9ydCBTaW0gZnJvbSAnLi4vU2ltLmpzJztcclxuXHJcbmNsYXNzIExlZ2VuZHNPZkxlYXJuaW5nU3VwcG9ydCB7XHJcblxyXG4gIHByaXZhdGUgcmVhZG9ubHkgc2ltOiBTaW07XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3Rvciggc2ltOiBTaW0gKSB7XHJcbiAgICB0aGlzLnNpbSA9IHNpbTtcclxuXHJcbiAgICAvLyBSZXNwb25kIHRvIHBhdXNlL3Jlc3VtZSBjb21tYW5kcyBmcm9tIHRoZSBMZWdlbmRzIG9mIExlYXJuaW5nIHBsYXRmb3JtXHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciggJ21lc3NhZ2UnLCBtZXNzYWdlID0+IHtcclxuICAgICAgaWYgKCBtZXNzYWdlLmRhdGEubWVzc2FnZU5hbWUgPT09ICdwYXVzZScgKSB7XHJcbiAgICAgICAgc2ltLnN0ZXBPbmVGcmFtZSgpO1xyXG4gICAgICAgIHNpbS5hY3RpdmVQcm9wZXJ0eS52YWx1ZSA9IGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgaWYgKCBtZXNzYWdlLmRhdGEubWVzc2FnZU5hbWUgPT09ICdyZXN1bWUnICkge1xyXG4gICAgICAgIHNpbS5hY3RpdmVQcm9wZXJ0eS52YWx1ZSA9IHRydWU7XHJcbiAgICAgIH1cclxuICAgIH0gKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzdGFydCgpOiB2b2lkIHtcclxuXHJcbiAgICAvLyBTZW5kIGluaXQgbWVzc2FnZSB3aGVuIHNpbSBoYXMgc3RhcnRlZCB1cCBzbyB0aGF0IExlZ2VuZHMgb2YgTGVhcm5pbmcgY2FuIHJlbW92ZSB0aGVpciBzcGxhc2ggc2NyZWVuXHJcbiAgICB0aGlzLnNpbS5pc0NvbnN0cnVjdGlvbkNvbXBsZXRlUHJvcGVydHkubGluayggaXNDb25zdHJ1Y3Rpb25Db21wbGV0ZSA9PiB7XHJcbiAgICAgIGlzQ29uc3RydWN0aW9uQ29tcGxldGUgJiYgKCB3aW5kb3cucGFyZW50ICE9PSB3aW5kb3cgKSAmJiB3aW5kb3cucGFyZW50LnBvc3RNZXNzYWdlKCB7IG1lc3NhZ2U6ICdpbml0JyB9LCAnKicgKTtcclxuICAgIH0gKTtcclxuICB9XHJcbn1cclxuXHJcbmpvaXN0LnJlZ2lzdGVyKCAnTGVnZW5kc09mTGVhcm5pbmdTdXBwb3J0JywgTGVnZW5kc09mTGVhcm5pbmdTdXBwb3J0ICk7XHJcbmV4cG9ydCBkZWZhdWx0IExlZ2VuZHNPZkxlYXJuaW5nU3VwcG9ydDsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsS0FBSyxNQUFNLGFBQWE7QUFHL0IsTUFBTUMsd0JBQXdCLENBQUM7RUFJdEJDLFdBQVdBLENBQUVDLEdBQVEsRUFBRztJQUM3QixJQUFJLENBQUNBLEdBQUcsR0FBR0EsR0FBRzs7SUFFZDtJQUNBQyxNQUFNLENBQUNDLGdCQUFnQixDQUFFLFNBQVMsRUFBRUMsT0FBTyxJQUFJO01BQzdDLElBQUtBLE9BQU8sQ0FBQ0MsSUFBSSxDQUFDQyxXQUFXLEtBQUssT0FBTyxFQUFHO1FBQzFDTCxHQUFHLENBQUNNLFlBQVksQ0FBQyxDQUFDO1FBQ2xCTixHQUFHLENBQUNPLGNBQWMsQ0FBQ0MsS0FBSyxHQUFHLEtBQUs7TUFDbEMsQ0FBQyxNQUNJLElBQUtMLE9BQU8sQ0FBQ0MsSUFBSSxDQUFDQyxXQUFXLEtBQUssUUFBUSxFQUFHO1FBQ2hETCxHQUFHLENBQUNPLGNBQWMsQ0FBQ0MsS0FBSyxHQUFHLElBQUk7TUFDakM7SUFDRixDQUFFLENBQUM7RUFDTDtFQUVPQyxLQUFLQSxDQUFBLEVBQVM7SUFFbkI7SUFDQSxJQUFJLENBQUNULEdBQUcsQ0FBQ1UsOEJBQThCLENBQUNDLElBQUksQ0FBRUMsc0JBQXNCLElBQUk7TUFDdEVBLHNCQUFzQixJQUFNWCxNQUFNLENBQUNZLE1BQU0sS0FBS1osTUFBUSxJQUFJQSxNQUFNLENBQUNZLE1BQU0sQ0FBQ0MsV0FBVyxDQUFFO1FBQUVYLE9BQU8sRUFBRTtNQUFPLENBQUMsRUFBRSxHQUFJLENBQUM7SUFDakgsQ0FBRSxDQUFDO0VBQ0w7QUFDRjtBQUVBTixLQUFLLENBQUNrQixRQUFRLENBQUUsMEJBQTBCLEVBQUVqQix3QkFBeUIsQ0FBQztBQUN0RSxlQUFlQSx3QkFBd0IiLCJpZ25vcmVMaXN0IjpbXX0=