// Copyright 2020-2024, University of Colorado Boulder

/**
 * A HomeScreenButton is displayed on the HomeScreen for choosing a screen. The button can be in a selected or
 * unselected state - it's large with a yellow frame in its selected state, and small in its unselected state.
 * Selecting the button when in its "selected" state will result in that screen being chosen.
 *
 * @author Michael Kauzmann (PhET Interactive Simulations)
 * @author Chris Klusendorf (PhET Interactive Simulations)
 */

import BooleanProperty from '../../axon/js/BooleanProperty.js';
import DerivedProperty from '../../axon/js/DerivedProperty.js';
import Utils from '../../dot/js/Utils.js';
import { Shape } from '../../kite/js/imports.js';
import merge from '../../phet-core/js/merge.js';
import optionize from '../../phet-core/js/optionize.js';
import PhetColorScheme from '../../scenery-phet/js/PhetColorScheme.js';
import PhetFont from '../../scenery-phet/js/PhetFont.js';
import { FireListener, Node, PDOMPeer, Rectangle, Text, VBox, Voicing } from '../../scenery/js/imports.js';
import EventType from '../../tandem/js/EventType.js';
import Frame from './Frame.js';
import joist from './joist.js';
import Utterance from '../../utterance-queue/js/Utterance.js';
// constants
const LARGE_ICON_HEIGHT = 140;
class HomeScreenButton extends Voicing(VBox) {
  constructor(screen, homeScreenModel, providedOptions) {
    const options = optionize()({
      cursor: 'pointer',
      showUnselectedHomeScreenIconFrame: false,
      // put a frame around unselected home screen icons

      // pdom
      tagName: 'button',
      appendDescription: true,
      containerTagName: 'li',
      // phet-io
      phetioEventType: EventType.USER,
      phetioDocumentation: 'A button on the home screen for choosing a simulation screen'
    }, providedOptions);

    // derives a boolean value from homeScreenModel.selectedScreenProperty that says if this button is selected on the
    // home screen.
    const isSelectedProperty = new DerivedProperty([homeScreenModel.selectedScreenProperty], selectedScreen => {
      return selectedScreen === screen;
    });

    // true if this button has focus or mouseover
    const isHighlightedProperty = new BooleanProperty(false);

    // maps the number of screens to a scale for the small icons. The scale is percentage of LARGE_ICON_HEIGHT.
    let smallIconScale = Utils.linear(2, 4, 0.875, 0.50, homeScreenModel.simScreens.length);
    if (homeScreenModel.simScreens.length >= 5) {
      smallIconScale = 0.4;
    }
    const smallIconHeight = smallIconScale * LARGE_ICON_HEIGHT;
    assert && assert(screen.homeScreenIcon, `homeScreenIcon is required for screen ${screen.nameProperty.value}`);
    const homeScreenIcon = screen.homeScreenIcon;

    // create an icon for each size
    const smallIcon = new Node({
      children: [homeScreenIcon],
      scale: smallIconHeight / homeScreenIcon.height
    });
    const largeIcon = new Node({
      children: [homeScreenIcon],
      scale: LARGE_ICON_HEIGHT / homeScreenIcon.height
    });

    // create a frame for each size
    const smallFrame = new Rectangle(0, 0, smallIcon.width, smallIcon.height, {
      stroke: options.showUnselectedHomeScreenIconFrame ? PhetColorScheme.SCREEN_ICON_FRAME : null,
      lineWidth: 0.7
    });
    const largeFrame = new Frame(largeIcon);

    // create one node for the each of large and small frame + icon pairs
    const smallNode = new Node({
      children: [smallFrame, smallIcon]
    });
    const largeNode = new Node({
      children: [largeFrame, largeIcon]
    });

    // container for the icon and frame, children updated when isSelectedProperty changes
    const nodeContainer = new Node({
      // pdom - the icon may have focusable components in its graphic but they should be invisible for Interactive
      // Description, the button is all we need for accessibility
      pdomVisible: false
    });

    // text for the button
    const text = new Text(screen.nameProperty);
    super(merge({
      children: [nodeContainer, text]
    }, options));
    this.screen = screen;
    this.addAriaDescribedbyAssociation({
      otherNode: this,
      otherElementName: PDOMPeer.DESCRIPTION_SIBLING,
      thisElementName: PDOMPeer.PRIMARY_SIBLING
    });

    // create large and small settings
    const settings = {
      small: {
        node: [smallNode],
        font: new PhetFont(18),
        spacing: 3
      },
      large: {
        node: [largeNode],
        font: new PhetFont(42),
        spacing: 0
      }
    };

    // sets the opacity of the icon and fill of the text
    const setOpacityAndFill = () => {
      const opacity = isSelectedProperty.value || isHighlightedProperty.value ? 1 : 0.5;
      largeIcon.opacity = opacity;
      smallIcon.opacity = opacity;
      text.fill = isSelectedProperty.value || isHighlightedProperty.value ? 'white' : 'gray';
    };

    // update pieces that change when the button is selected or unselected
    isSelectedProperty.link(isSelected => {
      const data = isSelected ? settings.large : settings.small;

      // apply settings for the current size
      nodeContainer.children = data.node;
      text.font = data.font;
      text.maxWidth = nodeContainer.width;
      setOpacityAndFill();
      this.setSpacing(data.spacing);
    });

    // update the appearance when the button is highlighted
    isHighlightedProperty.link(isHighlighted => {
      largeFrame.setHighlighted(isHighlighted);
      setOpacityAndFill();
    });

    // Create a new Utterance that isn't registered through Voicing so that it isn't silenced when the
    // home screen is hidden upon selection. (invisible nodes have their voicing silenced).
    const buttonSelectionUtterance = new Utterance();
    let buttonWasAlreadySelected = false;

    // If the button is already selected, then set the sim's screen to be its corresponding screen. Otherwise, make the
    // button selected. The one exception to the former sentence is due to the desired behavior of selecting on
    // touchover, in which case we need to guard on touchdown since we don't want to double fire for touchover and
    // touchdown, see https://github.com/phetsims/joist/issues/624
    const buttonFired = () => {
      const pointerIsTouchLike = fireListener.pointer && fireListener.pointer.isTouchLike();
      if (isSelectedProperty.value && (!pointerIsTouchLike || buttonWasAlreadySelected)) {
        // Select the screen that corresponds to this button.  This will make that screen appear to the user and the
        // home screen disappear.
        homeScreenModel.screenProperty.value = screen;
        this.voicingSpeakFullResponse({
          objectResponse: null,
          hintResponse: null,
          utterance: buttonSelectionUtterance
        });
      } else {
        // Select the screen button.  This causes the button to enlarge, but doesn't go to the screen.
        homeScreenModel.selectedScreenProperty.value = screen;
        this.voicingSpeakFullResponse({
          objectResponse: null,
          contextResponse: null
        });
      }
    };
    const fireListener = new FireListener({
      fire: buttonFired,
      tandem: options.tandem.createTandem('fireListener')
    });
    this.addInputListener(fireListener);
    this.addInputListener({
      focus: event => {
        !isSelectedProperty.value && fireListener.fire(event);
      }
    });

    // When a screen reader is in use, the button may be selected with the virtual cursor
    // without focus landing on the button - toggle focus (and therefore selection) in this case.
    this.addInputListener({
      click: () => !isSelectedProperty.value && this.focus()
    });
    this.addInputListener({
      focus: () => isHighlightedProperty.set(true),
      blur: () => isHighlightedProperty.set(false),
      over: () => isHighlightedProperty.set(true),
      out: () => isHighlightedProperty.set(false)
    });

    // If you touch an unselected button, it becomes selected. If then without lifting your finger you swipe over to the
    // next button, that one becomes selected instead.
    const onTouchLikeOver = () => {
      buttonWasAlreadySelected = homeScreenModel.selectedScreenProperty.value === screen;
      homeScreenModel.selectedScreenProperty.value = screen;
    };
    this.addInputListener({
      touchover: onTouchLikeOver,
      penover: onTouchLikeOver
    });

    // set the mouseArea and touchArea to be the whole local bounds of this node, because if it just relies on the
    // bounds of the icon and text, then there is a gap in between them. Since the button can change size, this
    // assignment needs to happen anytime the bounds change.
    this.boundsProperty.link(() => {
      this.mouseArea = this.touchArea = Shape.bounds(this.localBounds);
    });
  }
}
joist.register('HomeScreenButton', HomeScreenButton);
export default HomeScreenButton;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJCb29sZWFuUHJvcGVydHkiLCJEZXJpdmVkUHJvcGVydHkiLCJVdGlscyIsIlNoYXBlIiwibWVyZ2UiLCJvcHRpb25pemUiLCJQaGV0Q29sb3JTY2hlbWUiLCJQaGV0Rm9udCIsIkZpcmVMaXN0ZW5lciIsIk5vZGUiLCJQRE9NUGVlciIsIlJlY3RhbmdsZSIsIlRleHQiLCJWQm94IiwiVm9pY2luZyIsIkV2ZW50VHlwZSIsIkZyYW1lIiwiam9pc3QiLCJVdHRlcmFuY2UiLCJMQVJHRV9JQ09OX0hFSUdIVCIsIkhvbWVTY3JlZW5CdXR0b24iLCJjb25zdHJ1Y3RvciIsInNjcmVlbiIsImhvbWVTY3JlZW5Nb2RlbCIsInByb3ZpZGVkT3B0aW9ucyIsIm9wdGlvbnMiLCJjdXJzb3IiLCJzaG93VW5zZWxlY3RlZEhvbWVTY3JlZW5JY29uRnJhbWUiLCJ0YWdOYW1lIiwiYXBwZW5kRGVzY3JpcHRpb24iLCJjb250YWluZXJUYWdOYW1lIiwicGhldGlvRXZlbnRUeXBlIiwiVVNFUiIsInBoZXRpb0RvY3VtZW50YXRpb24iLCJpc1NlbGVjdGVkUHJvcGVydHkiLCJzZWxlY3RlZFNjcmVlblByb3BlcnR5Iiwic2VsZWN0ZWRTY3JlZW4iLCJpc0hpZ2hsaWdodGVkUHJvcGVydHkiLCJzbWFsbEljb25TY2FsZSIsImxpbmVhciIsInNpbVNjcmVlbnMiLCJsZW5ndGgiLCJzbWFsbEljb25IZWlnaHQiLCJhc3NlcnQiLCJob21lU2NyZWVuSWNvbiIsIm5hbWVQcm9wZXJ0eSIsInZhbHVlIiwic21hbGxJY29uIiwiY2hpbGRyZW4iLCJzY2FsZSIsImhlaWdodCIsImxhcmdlSWNvbiIsInNtYWxsRnJhbWUiLCJ3aWR0aCIsInN0cm9rZSIsIlNDUkVFTl9JQ09OX0ZSQU1FIiwibGluZVdpZHRoIiwibGFyZ2VGcmFtZSIsInNtYWxsTm9kZSIsImxhcmdlTm9kZSIsIm5vZGVDb250YWluZXIiLCJwZG9tVmlzaWJsZSIsInRleHQiLCJhZGRBcmlhRGVzY3JpYmVkYnlBc3NvY2lhdGlvbiIsIm90aGVyTm9kZSIsIm90aGVyRWxlbWVudE5hbWUiLCJERVNDUklQVElPTl9TSUJMSU5HIiwidGhpc0VsZW1lbnROYW1lIiwiUFJJTUFSWV9TSUJMSU5HIiwic2V0dGluZ3MiLCJzbWFsbCIsIm5vZGUiLCJmb250Iiwic3BhY2luZyIsImxhcmdlIiwic2V0T3BhY2l0eUFuZEZpbGwiLCJvcGFjaXR5IiwiZmlsbCIsImxpbmsiLCJpc1NlbGVjdGVkIiwiZGF0YSIsIm1heFdpZHRoIiwic2V0U3BhY2luZyIsImlzSGlnaGxpZ2h0ZWQiLCJzZXRIaWdobGlnaHRlZCIsImJ1dHRvblNlbGVjdGlvblV0dGVyYW5jZSIsImJ1dHRvbldhc0FscmVhZHlTZWxlY3RlZCIsImJ1dHRvbkZpcmVkIiwicG9pbnRlcklzVG91Y2hMaWtlIiwiZmlyZUxpc3RlbmVyIiwicG9pbnRlciIsImlzVG91Y2hMaWtlIiwic2NyZWVuUHJvcGVydHkiLCJ2b2ljaW5nU3BlYWtGdWxsUmVzcG9uc2UiLCJvYmplY3RSZXNwb25zZSIsImhpbnRSZXNwb25zZSIsInV0dGVyYW5jZSIsImNvbnRleHRSZXNwb25zZSIsImZpcmUiLCJ0YW5kZW0iLCJjcmVhdGVUYW5kZW0iLCJhZGRJbnB1dExpc3RlbmVyIiwiZm9jdXMiLCJldmVudCIsImNsaWNrIiwic2V0IiwiYmx1ciIsIm92ZXIiLCJvdXQiLCJvblRvdWNoTGlrZU92ZXIiLCJ0b3VjaG92ZXIiLCJwZW5vdmVyIiwiYm91bmRzUHJvcGVydHkiLCJtb3VzZUFyZWEiLCJ0b3VjaEFyZWEiLCJib3VuZHMiLCJsb2NhbEJvdW5kcyIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiSG9tZVNjcmVlbkJ1dHRvbi50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAyMC0yMDI0LCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBBIEhvbWVTY3JlZW5CdXR0b24gaXMgZGlzcGxheWVkIG9uIHRoZSBIb21lU2NyZWVuIGZvciBjaG9vc2luZyBhIHNjcmVlbi4gVGhlIGJ1dHRvbiBjYW4gYmUgaW4gYSBzZWxlY3RlZCBvclxyXG4gKiB1bnNlbGVjdGVkIHN0YXRlIC0gaXQncyBsYXJnZSB3aXRoIGEgeWVsbG93IGZyYW1lIGluIGl0cyBzZWxlY3RlZCBzdGF0ZSwgYW5kIHNtYWxsIGluIGl0cyB1bnNlbGVjdGVkIHN0YXRlLlxyXG4gKiBTZWxlY3RpbmcgdGhlIGJ1dHRvbiB3aGVuIGluIGl0cyBcInNlbGVjdGVkXCIgc3RhdGUgd2lsbCByZXN1bHQgaW4gdGhhdCBzY3JlZW4gYmVpbmcgY2hvc2VuLlxyXG4gKlxyXG4gKiBAYXV0aG9yIE1pY2hhZWwgS2F1em1hbm4gKFBoRVQgSW50ZXJhY3RpdmUgU2ltdWxhdGlvbnMpXHJcbiAqIEBhdXRob3IgQ2hyaXMgS2x1c2VuZG9yZiAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcblxyXG5pbXBvcnQgQm9vbGVhblByb3BlcnR5IGZyb20gJy4uLy4uL2F4b24vanMvQm9vbGVhblByb3BlcnR5LmpzJztcclxuaW1wb3J0IERlcml2ZWRQcm9wZXJ0eSBmcm9tICcuLi8uLi9heG9uL2pzL0Rlcml2ZWRQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBVdGlscyBmcm9tICcuLi8uLi9kb3QvanMvVXRpbHMuanMnO1xyXG5pbXBvcnQgeyBTaGFwZSB9IGZyb20gJy4uLy4uL2tpdGUvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBtZXJnZSBmcm9tICcuLi8uLi9waGV0LWNvcmUvanMvbWVyZ2UuanMnO1xyXG5pbXBvcnQgb3B0aW9uaXplIGZyb20gJy4uLy4uL3BoZXQtY29yZS9qcy9vcHRpb25pemUuanMnO1xyXG5pbXBvcnQgSW50ZW50aW9uYWxBbnkgZnJvbSAnLi4vLi4vcGhldC1jb3JlL2pzL3R5cGVzL0ludGVudGlvbmFsQW55LmpzJztcclxuaW1wb3J0IFBoZXRDb2xvclNjaGVtZSBmcm9tICcuLi8uLi9zY2VuZXJ5LXBoZXQvanMvUGhldENvbG9yU2NoZW1lLmpzJztcclxuaW1wb3J0IFBoZXRGb250IGZyb20gJy4uLy4uL3NjZW5lcnktcGhldC9qcy9QaGV0Rm9udC5qcyc7XHJcbmltcG9ydCB7IEZpcmVMaXN0ZW5lciwgTm9kZSwgUERPTVBlZXIsIFJlY3RhbmdsZSwgVGV4dCwgVkJveCwgVkJveE9wdGlvbnMsIFZvaWNpbmcsIFZvaWNpbmdPcHRpb25zIH0gZnJvbSAnLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IEV2ZW50VHlwZSBmcm9tICcuLi8uLi90YW5kZW0vanMvRXZlbnRUeXBlLmpzJztcclxuaW1wb3J0IEZyYW1lIGZyb20gJy4vRnJhbWUuanMnO1xyXG5pbXBvcnQgSG9tZVNjcmVlbk1vZGVsIGZyb20gJy4vSG9tZVNjcmVlbk1vZGVsLmpzJztcclxuaW1wb3J0IGpvaXN0IGZyb20gJy4vam9pc3QuanMnO1xyXG5pbXBvcnQgU2NyZWVuIGZyb20gJy4vU2NyZWVuLmpzJztcclxuaW1wb3J0IFV0dGVyYW5jZSBmcm9tICcuLi8uLi91dHRlcmFuY2UtcXVldWUvanMvVXR0ZXJhbmNlLmpzJztcclxuaW1wb3J0IFBpY2tSZXF1aXJlZCBmcm9tICcuLi8uLi9waGV0LWNvcmUvanMvdHlwZXMvUGlja1JlcXVpcmVkLmpzJztcclxuXHJcbi8vIGNvbnN0YW50c1xyXG5jb25zdCBMQVJHRV9JQ09OX0hFSUdIVCA9IDE0MDtcclxuXHJcbnR5cGUgU2VsZk9wdGlvbnMgPSB7XHJcbiAgc2hvd1Vuc2VsZWN0ZWRIb21lU2NyZWVuSWNvbkZyYW1lPzogYm9vbGVhbjtcclxufTtcclxudHlwZSBQYXJlbnRPcHRpb25zID0gVm9pY2luZ09wdGlvbnMgJiBWQm94T3B0aW9ucztcclxuZXhwb3J0IHR5cGUgSG9tZVNjcmVlbkJ1dHRvbk9wdGlvbnMgPSBTZWxmT3B0aW9ucyAmIFBhcmVudE9wdGlvbnMgJiBQaWNrUmVxdWlyZWQ8UGFyZW50T3B0aW9ucywgJ3RhbmRlbSc+O1xyXG5cclxuY2xhc3MgSG9tZVNjcmVlbkJ1dHRvbiBleHRlbmRzIFZvaWNpbmcoIFZCb3ggKSB7XHJcbiAgcHVibGljIHJlYWRvbmx5IHNjcmVlbjogU2NyZWVuPEludGVudGlvbmFsQW55LCBJbnRlbnRpb25hbEFueT47XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3Rvciggc2NyZWVuOiBTY3JlZW48SW50ZW50aW9uYWxBbnksIEludGVudGlvbmFsQW55PiwgaG9tZVNjcmVlbk1vZGVsOiBIb21lU2NyZWVuTW9kZWwsIHByb3ZpZGVkT3B0aW9ucz86IEhvbWVTY3JlZW5CdXR0b25PcHRpb25zICkge1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSBvcHRpb25pemU8SG9tZVNjcmVlbkJ1dHRvbk9wdGlvbnMsIFNlbGZPcHRpb25zLCBQYXJlbnRPcHRpb25zPigpKCB7XHJcbiAgICAgIGN1cnNvcjogJ3BvaW50ZXInLFxyXG4gICAgICBzaG93VW5zZWxlY3RlZEhvbWVTY3JlZW5JY29uRnJhbWU6IGZhbHNlLCAvLyBwdXQgYSBmcmFtZSBhcm91bmQgdW5zZWxlY3RlZCBob21lIHNjcmVlbiBpY29uc1xyXG5cclxuICAgICAgLy8gcGRvbVxyXG4gICAgICB0YWdOYW1lOiAnYnV0dG9uJyxcclxuICAgICAgYXBwZW5kRGVzY3JpcHRpb246IHRydWUsXHJcbiAgICAgIGNvbnRhaW5lclRhZ05hbWU6ICdsaScsXHJcblxyXG4gICAgICAvLyBwaGV0LWlvXHJcbiAgICAgIHBoZXRpb0V2ZW50VHlwZTogRXZlbnRUeXBlLlVTRVIsXHJcbiAgICAgIHBoZXRpb0RvY3VtZW50YXRpb246ICdBIGJ1dHRvbiBvbiB0aGUgaG9tZSBzY3JlZW4gZm9yIGNob29zaW5nIGEgc2ltdWxhdGlvbiBzY3JlZW4nXHJcbiAgICB9LCBwcm92aWRlZE9wdGlvbnMgKTtcclxuXHJcbiAgICAvLyBkZXJpdmVzIGEgYm9vbGVhbiB2YWx1ZSBmcm9tIGhvbWVTY3JlZW5Nb2RlbC5zZWxlY3RlZFNjcmVlblByb3BlcnR5IHRoYXQgc2F5cyBpZiB0aGlzIGJ1dHRvbiBpcyBzZWxlY3RlZCBvbiB0aGVcclxuICAgIC8vIGhvbWUgc2NyZWVuLlxyXG4gICAgY29uc3QgaXNTZWxlY3RlZFByb3BlcnR5ID0gbmV3IERlcml2ZWRQcm9wZXJ0eSggWyBob21lU2NyZWVuTW9kZWwuc2VsZWN0ZWRTY3JlZW5Qcm9wZXJ0eSBdLCBzZWxlY3RlZFNjcmVlbiA9PiB7XHJcbiAgICAgIHJldHVybiBzZWxlY3RlZFNjcmVlbiA9PT0gc2NyZWVuO1xyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIHRydWUgaWYgdGhpcyBidXR0b24gaGFzIGZvY3VzIG9yIG1vdXNlb3ZlclxyXG4gICAgY29uc3QgaXNIaWdobGlnaHRlZFByb3BlcnR5ID0gbmV3IEJvb2xlYW5Qcm9wZXJ0eSggZmFsc2UgKTtcclxuXHJcbiAgICAvLyBtYXBzIHRoZSBudW1iZXIgb2Ygc2NyZWVucyB0byBhIHNjYWxlIGZvciB0aGUgc21hbGwgaWNvbnMuIFRoZSBzY2FsZSBpcyBwZXJjZW50YWdlIG9mIExBUkdFX0lDT05fSEVJR0hULlxyXG4gICAgbGV0IHNtYWxsSWNvblNjYWxlID0gVXRpbHMubGluZWFyKCAyLCA0LCAwLjg3NSwgMC41MCwgaG9tZVNjcmVlbk1vZGVsLnNpbVNjcmVlbnMubGVuZ3RoICk7XHJcbiAgICBpZiAoIGhvbWVTY3JlZW5Nb2RlbC5zaW1TY3JlZW5zLmxlbmd0aCA+PSA1ICkge1xyXG4gICAgICBzbWFsbEljb25TY2FsZSA9IDAuNDtcclxuICAgIH1cclxuICAgIGNvbnN0IHNtYWxsSWNvbkhlaWdodCA9IHNtYWxsSWNvblNjYWxlICogTEFSR0VfSUNPTl9IRUlHSFQ7XHJcblxyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggc2NyZWVuLmhvbWVTY3JlZW5JY29uLCBgaG9tZVNjcmVlbkljb24gaXMgcmVxdWlyZWQgZm9yIHNjcmVlbiAke3NjcmVlbi5uYW1lUHJvcGVydHkudmFsdWV9YCApO1xyXG4gICAgY29uc3QgaG9tZVNjcmVlbkljb24gPSBzY3JlZW4uaG9tZVNjcmVlbkljb24hO1xyXG5cclxuICAgIC8vIGNyZWF0ZSBhbiBpY29uIGZvciBlYWNoIHNpemVcclxuICAgIGNvbnN0IHNtYWxsSWNvbiA9IG5ldyBOb2RlKCB7XHJcbiAgICAgIGNoaWxkcmVuOiBbIGhvbWVTY3JlZW5JY29uIF0sXHJcbiAgICAgIHNjYWxlOiBzbWFsbEljb25IZWlnaHQgLyBob21lU2NyZWVuSWNvbi5oZWlnaHRcclxuICAgIH0gKTtcclxuICAgIGNvbnN0IGxhcmdlSWNvbiA9IG5ldyBOb2RlKCB7XHJcbiAgICAgIGNoaWxkcmVuOiBbIGhvbWVTY3JlZW5JY29uIF0sXHJcbiAgICAgIHNjYWxlOiBMQVJHRV9JQ09OX0hFSUdIVCAvIGhvbWVTY3JlZW5JY29uLmhlaWdodFxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIGNyZWF0ZSBhIGZyYW1lIGZvciBlYWNoIHNpemVcclxuICAgIGNvbnN0IHNtYWxsRnJhbWUgPSBuZXcgUmVjdGFuZ2xlKCAwLCAwLCBzbWFsbEljb24ud2lkdGgsIHNtYWxsSWNvbi5oZWlnaHQsIHtcclxuICAgICAgc3Ryb2tlOiBvcHRpb25zLnNob3dVbnNlbGVjdGVkSG9tZVNjcmVlbkljb25GcmFtZSA/IFBoZXRDb2xvclNjaGVtZS5TQ1JFRU5fSUNPTl9GUkFNRSA6IG51bGwsXHJcbiAgICAgIGxpbmVXaWR0aDogMC43XHJcbiAgICB9ICk7XHJcbiAgICBjb25zdCBsYXJnZUZyYW1lID0gbmV3IEZyYW1lKCBsYXJnZUljb24gKTtcclxuXHJcbiAgICAvLyBjcmVhdGUgb25lIG5vZGUgZm9yIHRoZSBlYWNoIG9mIGxhcmdlIGFuZCBzbWFsbCBmcmFtZSArIGljb24gcGFpcnNcclxuICAgIGNvbnN0IHNtYWxsTm9kZSA9IG5ldyBOb2RlKCB7IGNoaWxkcmVuOiBbIHNtYWxsRnJhbWUsIHNtYWxsSWNvbiBdIH0gKTtcclxuICAgIGNvbnN0IGxhcmdlTm9kZSA9IG5ldyBOb2RlKCB7IGNoaWxkcmVuOiBbIGxhcmdlRnJhbWUsIGxhcmdlSWNvbiBdIH0gKTtcclxuXHJcbiAgICAvLyBjb250YWluZXIgZm9yIHRoZSBpY29uIGFuZCBmcmFtZSwgY2hpbGRyZW4gdXBkYXRlZCB3aGVuIGlzU2VsZWN0ZWRQcm9wZXJ0eSBjaGFuZ2VzXHJcbiAgICBjb25zdCBub2RlQ29udGFpbmVyID0gbmV3IE5vZGUoIHtcclxuXHJcbiAgICAgIC8vIHBkb20gLSB0aGUgaWNvbiBtYXkgaGF2ZSBmb2N1c2FibGUgY29tcG9uZW50cyBpbiBpdHMgZ3JhcGhpYyBidXQgdGhleSBzaG91bGQgYmUgaW52aXNpYmxlIGZvciBJbnRlcmFjdGl2ZVxyXG4gICAgICAvLyBEZXNjcmlwdGlvbiwgdGhlIGJ1dHRvbiBpcyBhbGwgd2UgbmVlZCBmb3IgYWNjZXNzaWJpbGl0eVxyXG4gICAgICBwZG9tVmlzaWJsZTogZmFsc2VcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyB0ZXh0IGZvciB0aGUgYnV0dG9uXHJcbiAgICBjb25zdCB0ZXh0ID0gbmV3IFRleHQoIHNjcmVlbi5uYW1lUHJvcGVydHkgKTtcclxuXHJcbiAgICBzdXBlciggbWVyZ2UoIHsgY2hpbGRyZW46IFsgbm9kZUNvbnRhaW5lciwgdGV4dCBdIH0sIG9wdGlvbnMgKSApO1xyXG5cclxuICAgIHRoaXMuc2NyZWVuID0gc2NyZWVuO1xyXG5cclxuICAgIHRoaXMuYWRkQXJpYURlc2NyaWJlZGJ5QXNzb2NpYXRpb24oIHtcclxuICAgICAgb3RoZXJOb2RlOiB0aGlzLFxyXG4gICAgICBvdGhlckVsZW1lbnROYW1lOiBQRE9NUGVlci5ERVNDUklQVElPTl9TSUJMSU5HLFxyXG4gICAgICB0aGlzRWxlbWVudE5hbWU6IFBET01QZWVyLlBSSU1BUllfU0lCTElOR1xyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIGNyZWF0ZSBsYXJnZSBhbmQgc21hbGwgc2V0dGluZ3NcclxuICAgIGNvbnN0IHNldHRpbmdzID0ge1xyXG4gICAgICBzbWFsbDoge1xyXG4gICAgICAgIG5vZGU6IFsgc21hbGxOb2RlIF0sXHJcbiAgICAgICAgZm9udDogbmV3IFBoZXRGb250KCAxOCApLFxyXG4gICAgICAgIHNwYWNpbmc6IDNcclxuICAgICAgfSxcclxuICAgICAgbGFyZ2U6IHtcclxuICAgICAgICBub2RlOiBbIGxhcmdlTm9kZSBdLFxyXG4gICAgICAgIGZvbnQ6IG5ldyBQaGV0Rm9udCggNDIgKSxcclxuICAgICAgICBzcGFjaW5nOiAwXHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLy8gc2V0cyB0aGUgb3BhY2l0eSBvZiB0aGUgaWNvbiBhbmQgZmlsbCBvZiB0aGUgdGV4dFxyXG4gICAgY29uc3Qgc2V0T3BhY2l0eUFuZEZpbGwgPSAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IG9wYWNpdHkgPSAoIGlzU2VsZWN0ZWRQcm9wZXJ0eS52YWx1ZSB8fCBpc0hpZ2hsaWdodGVkUHJvcGVydHkudmFsdWUgKSA/IDEgOiAwLjU7XHJcbiAgICAgIGxhcmdlSWNvbi5vcGFjaXR5ID0gb3BhY2l0eTtcclxuICAgICAgc21hbGxJY29uLm9wYWNpdHkgPSBvcGFjaXR5O1xyXG4gICAgICB0ZXh0LmZpbGwgPSAoIGlzU2VsZWN0ZWRQcm9wZXJ0eS52YWx1ZSB8fCBpc0hpZ2hsaWdodGVkUHJvcGVydHkudmFsdWUgKSA/ICd3aGl0ZScgOiAnZ3JheSc7XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIHVwZGF0ZSBwaWVjZXMgdGhhdCBjaGFuZ2Ugd2hlbiB0aGUgYnV0dG9uIGlzIHNlbGVjdGVkIG9yIHVuc2VsZWN0ZWRcclxuICAgIGlzU2VsZWN0ZWRQcm9wZXJ0eS5saW5rKCBpc1NlbGVjdGVkID0+IHtcclxuICAgICAgY29uc3QgZGF0YSA9IGlzU2VsZWN0ZWQgPyBzZXR0aW5ncy5sYXJnZSA6IHNldHRpbmdzLnNtYWxsO1xyXG5cclxuICAgICAgLy8gYXBwbHkgc2V0dGluZ3MgZm9yIHRoZSBjdXJyZW50IHNpemVcclxuICAgICAgbm9kZUNvbnRhaW5lci5jaGlsZHJlbiA9IGRhdGEubm9kZTtcclxuICAgICAgdGV4dC5mb250ID0gZGF0YS5mb250O1xyXG4gICAgICB0ZXh0Lm1heFdpZHRoID0gbm9kZUNvbnRhaW5lci53aWR0aDtcclxuICAgICAgc2V0T3BhY2l0eUFuZEZpbGwoKTtcclxuICAgICAgdGhpcy5zZXRTcGFjaW5nKCBkYXRhLnNwYWNpbmcgKTtcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyB1cGRhdGUgdGhlIGFwcGVhcmFuY2Ugd2hlbiB0aGUgYnV0dG9uIGlzIGhpZ2hsaWdodGVkXHJcbiAgICBpc0hpZ2hsaWdodGVkUHJvcGVydHkubGluayggaXNIaWdobGlnaHRlZCA9PiB7XHJcbiAgICAgIGxhcmdlRnJhbWUuc2V0SGlnaGxpZ2h0ZWQoIGlzSGlnaGxpZ2h0ZWQgKTtcclxuICAgICAgc2V0T3BhY2l0eUFuZEZpbGwoKTtcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBDcmVhdGUgYSBuZXcgVXR0ZXJhbmNlIHRoYXQgaXNuJ3QgcmVnaXN0ZXJlZCB0aHJvdWdoIFZvaWNpbmcgc28gdGhhdCBpdCBpc24ndCBzaWxlbmNlZCB3aGVuIHRoZVxyXG4gICAgLy8gaG9tZSBzY3JlZW4gaXMgaGlkZGVuIHVwb24gc2VsZWN0aW9uLiAoaW52aXNpYmxlIG5vZGVzIGhhdmUgdGhlaXIgdm9pY2luZyBzaWxlbmNlZCkuXHJcbiAgICBjb25zdCBidXR0b25TZWxlY3Rpb25VdHRlcmFuY2UgPSBuZXcgVXR0ZXJhbmNlKCk7XHJcblxyXG4gICAgbGV0IGJ1dHRvbldhc0FscmVhZHlTZWxlY3RlZCA9IGZhbHNlO1xyXG5cclxuICAgIC8vIElmIHRoZSBidXR0b24gaXMgYWxyZWFkeSBzZWxlY3RlZCwgdGhlbiBzZXQgdGhlIHNpbSdzIHNjcmVlbiB0byBiZSBpdHMgY29ycmVzcG9uZGluZyBzY3JlZW4uIE90aGVyd2lzZSwgbWFrZSB0aGVcclxuICAgIC8vIGJ1dHRvbiBzZWxlY3RlZC4gVGhlIG9uZSBleGNlcHRpb24gdG8gdGhlIGZvcm1lciBzZW50ZW5jZSBpcyBkdWUgdG8gdGhlIGRlc2lyZWQgYmVoYXZpb3Igb2Ygc2VsZWN0aW5nIG9uXHJcbiAgICAvLyB0b3VjaG92ZXIsIGluIHdoaWNoIGNhc2Ugd2UgbmVlZCB0byBndWFyZCBvbiB0b3VjaGRvd24gc2luY2Ugd2UgZG9uJ3Qgd2FudCB0byBkb3VibGUgZmlyZSBmb3IgdG91Y2hvdmVyIGFuZFxyXG4gICAgLy8gdG91Y2hkb3duLCBzZWUgaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL2pvaXN0L2lzc3Vlcy82MjRcclxuICAgIGNvbnN0IGJ1dHRvbkZpcmVkID0gKCkgPT4ge1xyXG5cclxuICAgICAgY29uc3QgcG9pbnRlcklzVG91Y2hMaWtlID0gZmlyZUxpc3RlbmVyLnBvaW50ZXIgJiYgZmlyZUxpc3RlbmVyLnBvaW50ZXIuaXNUb3VjaExpa2UoKTtcclxuXHJcbiAgICAgIGlmICggaXNTZWxlY3RlZFByb3BlcnR5LnZhbHVlICYmICggIXBvaW50ZXJJc1RvdWNoTGlrZSB8fCBidXR0b25XYXNBbHJlYWR5U2VsZWN0ZWQgKSApIHtcclxuXHJcbiAgICAgICAgLy8gU2VsZWN0IHRoZSBzY3JlZW4gdGhhdCBjb3JyZXNwb25kcyB0byB0aGlzIGJ1dHRvbi4gIFRoaXMgd2lsbCBtYWtlIHRoYXQgc2NyZWVuIGFwcGVhciB0byB0aGUgdXNlciBhbmQgdGhlXHJcbiAgICAgICAgLy8gaG9tZSBzY3JlZW4gZGlzYXBwZWFyLlxyXG4gICAgICAgIGhvbWVTY3JlZW5Nb2RlbC5zY3JlZW5Qcm9wZXJ0eS52YWx1ZSA9IHNjcmVlbjtcclxuXHJcbiAgICAgICAgdGhpcy52b2ljaW5nU3BlYWtGdWxsUmVzcG9uc2UoIHtcclxuICAgICAgICAgIG9iamVjdFJlc3BvbnNlOiBudWxsLFxyXG4gICAgICAgICAgaGludFJlc3BvbnNlOiBudWxsLFxyXG4gICAgICAgICAgdXR0ZXJhbmNlOiBidXR0b25TZWxlY3Rpb25VdHRlcmFuY2VcclxuICAgICAgICB9ICk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcblxyXG4gICAgICAgIC8vIFNlbGVjdCB0aGUgc2NyZWVuIGJ1dHRvbi4gIFRoaXMgY2F1c2VzIHRoZSBidXR0b24gdG8gZW5sYXJnZSwgYnV0IGRvZXNuJ3QgZ28gdG8gdGhlIHNjcmVlbi5cclxuICAgICAgICBob21lU2NyZWVuTW9kZWwuc2VsZWN0ZWRTY3JlZW5Qcm9wZXJ0eS52YWx1ZSA9IHNjcmVlbjtcclxuXHJcbiAgICAgICAgdGhpcy52b2ljaW5nU3BlYWtGdWxsUmVzcG9uc2UoIHtcclxuICAgICAgICAgIG9iamVjdFJlc3BvbnNlOiBudWxsLFxyXG4gICAgICAgICAgY29udGV4dFJlc3BvbnNlOiBudWxsXHJcbiAgICAgICAgfSApO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IGZpcmVMaXN0ZW5lciA9IG5ldyBGaXJlTGlzdGVuZXIoIHtcclxuICAgICAgZmlyZTogYnV0dG9uRmlyZWQsXHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnZmlyZUxpc3RlbmVyJyApXHJcbiAgICB9ICk7XHJcbiAgICB0aGlzLmFkZElucHV0TGlzdGVuZXIoIGZpcmVMaXN0ZW5lciApO1xyXG4gICAgdGhpcy5hZGRJbnB1dExpc3RlbmVyKCB7IGZvY3VzOiBldmVudCA9PiB7ICFpc1NlbGVjdGVkUHJvcGVydHkudmFsdWUgJiYgZmlyZUxpc3RlbmVyLmZpcmUoIGV2ZW50ICk7IH0gfSApO1xyXG5cclxuICAgIC8vIFdoZW4gYSBzY3JlZW4gcmVhZGVyIGlzIGluIHVzZSwgdGhlIGJ1dHRvbiBtYXkgYmUgc2VsZWN0ZWQgd2l0aCB0aGUgdmlydHVhbCBjdXJzb3JcclxuICAgIC8vIHdpdGhvdXQgZm9jdXMgbGFuZGluZyBvbiB0aGUgYnV0dG9uIC0gdG9nZ2xlIGZvY3VzIChhbmQgdGhlcmVmb3JlIHNlbGVjdGlvbikgaW4gdGhpcyBjYXNlLlxyXG4gICAgdGhpcy5hZGRJbnB1dExpc3RlbmVyKCB7XHJcbiAgICAgIGNsaWNrOiAoKSA9PiAhaXNTZWxlY3RlZFByb3BlcnR5LnZhbHVlICYmIHRoaXMuZm9jdXMoKVxyXG4gICAgfSApO1xyXG5cclxuICAgIHRoaXMuYWRkSW5wdXRMaXN0ZW5lcigge1xyXG4gICAgICBmb2N1czogKCkgPT4gaXNIaWdobGlnaHRlZFByb3BlcnR5LnNldCggdHJ1ZSApLFxyXG4gICAgICBibHVyOiAoKSA9PiBpc0hpZ2hsaWdodGVkUHJvcGVydHkuc2V0KCBmYWxzZSApLFxyXG4gICAgICBvdmVyOiAoKSA9PiBpc0hpZ2hsaWdodGVkUHJvcGVydHkuc2V0KCB0cnVlICksXHJcbiAgICAgIG91dDogKCkgPT4gaXNIaWdobGlnaHRlZFByb3BlcnR5LnNldCggZmFsc2UgKVxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIElmIHlvdSB0b3VjaCBhbiB1bnNlbGVjdGVkIGJ1dHRvbiwgaXQgYmVjb21lcyBzZWxlY3RlZC4gSWYgdGhlbiB3aXRob3V0IGxpZnRpbmcgeW91ciBmaW5nZXIgeW91IHN3aXBlIG92ZXIgdG8gdGhlXHJcbiAgICAvLyBuZXh0IGJ1dHRvbiwgdGhhdCBvbmUgYmVjb21lcyBzZWxlY3RlZCBpbnN0ZWFkLlxyXG4gICAgY29uc3Qgb25Ub3VjaExpa2VPdmVyID0gKCkgPT4ge1xyXG4gICAgICBidXR0b25XYXNBbHJlYWR5U2VsZWN0ZWQgPSBob21lU2NyZWVuTW9kZWwuc2VsZWN0ZWRTY3JlZW5Qcm9wZXJ0eS52YWx1ZSA9PT0gc2NyZWVuO1xyXG4gICAgICBob21lU2NyZWVuTW9kZWwuc2VsZWN0ZWRTY3JlZW5Qcm9wZXJ0eS52YWx1ZSA9IHNjcmVlbjtcclxuICAgIH07XHJcbiAgICB0aGlzLmFkZElucHV0TGlzdGVuZXIoIHtcclxuICAgICAgdG91Y2hvdmVyOiBvblRvdWNoTGlrZU92ZXIsXHJcbiAgICAgIHBlbm92ZXI6IG9uVG91Y2hMaWtlT3ZlclxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIHNldCB0aGUgbW91c2VBcmVhIGFuZCB0b3VjaEFyZWEgdG8gYmUgdGhlIHdob2xlIGxvY2FsIGJvdW5kcyBvZiB0aGlzIG5vZGUsIGJlY2F1c2UgaWYgaXQganVzdCByZWxpZXMgb24gdGhlXHJcbiAgICAvLyBib3VuZHMgb2YgdGhlIGljb24gYW5kIHRleHQsIHRoZW4gdGhlcmUgaXMgYSBnYXAgaW4gYmV0d2VlbiB0aGVtLiBTaW5jZSB0aGUgYnV0dG9uIGNhbiBjaGFuZ2Ugc2l6ZSwgdGhpc1xyXG4gICAgLy8gYXNzaWdubWVudCBuZWVkcyB0byBoYXBwZW4gYW55dGltZSB0aGUgYm91bmRzIGNoYW5nZS5cclxuICAgIHRoaXMuYm91bmRzUHJvcGVydHkubGluayggKCkgPT4ge1xyXG4gICAgICB0aGlzLm1vdXNlQXJlYSA9IHRoaXMudG91Y2hBcmVhID0gU2hhcGUuYm91bmRzKCB0aGlzLmxvY2FsQm91bmRzICk7XHJcbiAgICB9ICk7XHJcbiAgfVxyXG59XHJcblxyXG5qb2lzdC5yZWdpc3RlciggJ0hvbWVTY3JlZW5CdXR0b24nLCBIb21lU2NyZWVuQnV0dG9uICk7XHJcbmV4cG9ydCBkZWZhdWx0IEhvbWVTY3JlZW5CdXR0b247Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLGVBQWUsTUFBTSxrQ0FBa0M7QUFDOUQsT0FBT0MsZUFBZSxNQUFNLGtDQUFrQztBQUM5RCxPQUFPQyxLQUFLLE1BQU0sdUJBQXVCO0FBQ3pDLFNBQVNDLEtBQUssUUFBUSwwQkFBMEI7QUFDaEQsT0FBT0MsS0FBSyxNQUFNLDZCQUE2QjtBQUMvQyxPQUFPQyxTQUFTLE1BQU0saUNBQWlDO0FBRXZELE9BQU9DLGVBQWUsTUFBTSwwQ0FBMEM7QUFDdEUsT0FBT0MsUUFBUSxNQUFNLG1DQUFtQztBQUN4RCxTQUFTQyxZQUFZLEVBQUVDLElBQUksRUFBRUMsUUFBUSxFQUFFQyxTQUFTLEVBQUVDLElBQUksRUFBRUMsSUFBSSxFQUFlQyxPQUFPLFFBQXdCLDZCQUE2QjtBQUN2SSxPQUFPQyxTQUFTLE1BQU0sOEJBQThCO0FBQ3BELE9BQU9DLEtBQUssTUFBTSxZQUFZO0FBRTlCLE9BQU9DLEtBQUssTUFBTSxZQUFZO0FBRTlCLE9BQU9DLFNBQVMsTUFBTSx1Q0FBdUM7QUFHN0Q7QUFDQSxNQUFNQyxp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