// Copyright 2013-2024, University of Colorado Boulder

/**
 * AboutDialog displays information about the simulation -- its title, version number, credits, etc.
 *
 * @author Sam Reid (PhET Interactive Simulations)
 */

import DerivedProperty from '../../axon/js/DerivedProperty.js';
import stepTimer from '../../axon/js/stepTimer.js';
import optionize from '../../phet-core/js/optionize.js';
import StringUtils from '../../phetcommon/js/util/StringUtils.js';
import PhetFont from '../../scenery-phet/js/PhetFont.js';
import { allowLinksProperty, Node, PDOMPeer, RichText, VBox, VoicingRichText, VoicingText, VStrut } from '../../scenery/js/imports.js';
import Dialog from '../../sun/js/Dialog.js';
import Tandem from '../../tandem/js/Tandem.js';
import CreditsNode from './CreditsNode.js';
import joist from './joist.js';
import JoistStrings from './JoistStrings.js';
import packageJSON from './packageJSON.js';
import updateCheck from './updateCheck.js';
import UpdateNodes from './UpdateNodes.js';
import UpdateState from './UpdateState.js';
import DerivedStringProperty from '../../axon/js/DerivedStringProperty.js';

// constants
const MAX_WIDTH = 550; // Maximum width of elements in the dialog
const NOMINAL_FONT_SIZE = 16; // Change this to make everything larger or smaller

export default class AboutDialog extends Dialog {
  // Listener that should be called every frame where we are shown, with {number} dt as a single parameter.

  // Listener that should be called whenever our update state changes (while we are displayed)

  /**
   * @param nameStringProperty - name of the simulation
   * @param version - version of the simulation
   * @param credits - credits for the simulation
   * @param locale - locale string
   * @param [providedOptions]
   */
  constructor(nameStringProperty, version, credits, locale, providedOptions) {
    const options = optionize()({
      xSpacing: 26,
      topMargin: 26,
      bottomMargin: 26,
      leftMargin: 26,
      phetioReadOnly: true,
      // the AboutDialog should not be settable
      phetioDynamicElement: true,
      isDisposable: false,
      tandem: Tandem.REQUIRED
    }, providedOptions);

    // Dynamic modules are loaded in simLauncher and accessed through their namespace
    const Brand = phet.brand.Brand;
    assert && assert(Brand, 'Brand should exist by now');
    let children = [];
    const titleText = new VoicingText(nameStringProperty, {
      font: new PhetFont(2 * NOMINAL_FONT_SIZE),
      maxWidth: MAX_WIDTH,
      tagName: 'h1'
    });
    children.push(titleText);
    const versionStringProperty = new DerivedProperty([JoistStrings.versionPatternStringProperty], versionPattern => {
      return StringUtils.format(versionPattern, version);
    });
    children.push(new VoicingText(versionStringProperty, {
      font: new PhetFont(NOMINAL_FONT_SIZE),
      maxWidth: MAX_WIDTH,
      tagName: 'p'
    }));

    // Built versions will have a build timestamp
    if (phet.chipper.buildTimestamp) {
      children.push(new VoicingText(phet.chipper.buildTimestamp, {
        font: new PhetFont(0.65 * NOMINAL_FONT_SIZE),
        maxWidth: MAX_WIDTH,
        tagName: 'p',
        innerContent: phet.chipper.buildTimestamp
      }));
    }
    let updateStepListener = null;
    let updateVisibilityListener = null;
    let updatePanel = null;

    // brand=phet versions that are not running in the phet-app should check update status.
    if (updateCheck.areUpdatesChecked) {
      const positionOptions = {
        left: 0,
        top: 0
      };
      const checkingNode = UpdateNodes.createCheckingNode(positionOptions);
      const upToDateNode = UpdateNodes.createUpToDateNode(positionOptions);
      const outOfDateNode = UpdateNodes.createOutOfDateAboutNode(positionOptions);
      const offlineNode = UpdateNodes.createOfflineNode(positionOptions);
      updateStepListener = checkingNode.stepListener;
      updateVisibilityListener = state => {
        checkingNode.visible = state === UpdateState.CHECKING;
        upToDateNode.visible = state === UpdateState.UP_TO_DATE;
        outOfDateNode.visible = state === UpdateState.OUT_OF_DATE;
        offlineNode.visible = state === UpdateState.OFFLINE;

        // pdom - make update content visible/invisible for screen readers by explicitly removing content
        // from the DOM, necessary because AT will ready hidden content in a Dialog.
        checkingNode.pdomVisible = checkingNode.visible;
        upToDateNode.pdomVisible = upToDateNode.visible;
        outOfDateNode.pdomVisible = outOfDateNode.visible;
        offlineNode.pdomVisible = offlineNode.visible;
      };
      updatePanel = new Node({
        children: [checkingNode, upToDateNode, outOfDateNode, offlineNode],
        maxWidth: MAX_WIDTH,
        visibleProperty: allowLinksProperty
      });
      children.push(updatePanel);
    }
    const brandChildren = [];

    // Show the brand name, if it exists
    if (Brand.name) {
      brandChildren.push(new VoicingRichText(Brand.name, {
        font: new PhetFont(NOMINAL_FONT_SIZE),
        supScale: 0.5,
        supYOffset: 3,
        maxWidth: MAX_WIDTH,
        // pdom
        tagName: 'h2',
        innerContent: Brand.name
      }));
    }

    // Show the brand copyright statement, if it exists
    if (Brand.copyright) {
      const year = phet.chipper.buildTimestamp ?
      // defined for built versions
      phet.chipper.buildTimestamp.split('-')[0] :
      // e.g. "2017-04-20 19:04:59 UTC" -> "2017"
      new Date().getFullYear(); // in unbuilt mode

      const copyright = StringUtils.fillIn(Brand.copyright, {
        year: year
      });
      brandChildren.push(new VoicingText(copyright, {
        font: new PhetFont(0.75 * NOMINAL_FONT_SIZE),
        maxWidth: MAX_WIDTH,
        // pdom
        tagName: 'p',
        innerContent: copyright
      }));
    }
    let additionalLicenseStatement = null;

    // Optional additionalLicenseStatement, used in phet-io
    if (Brand.additionalLicenseStatement) {
      additionalLicenseStatement = new VoicingRichText(Brand.additionalLicenseStatement, {
        font: new PhetFont(0.65 * NOMINAL_FONT_SIZE),
        fill: 'gray',
        align: 'left',
        maxWidth: MAX_WIDTH,
        // pdom
        tagName: 'p',
        innerContent: Brand.additionalLicenseStatement
      });
      brandChildren.push(additionalLicenseStatement);
    }
    if (brandChildren.length > 0) {
      children.push(new VStrut(15));
      children = children.concat(brandChildren);
    }
    let creditsNode = null;

    // Add credits for specific brands
    if (Brand.id === 'phet' || Brand.id === 'phet-io') {
      children.push(new VStrut(15));
      creditsNode = new CreditsNode(credits, {
        titleFont: new PhetFont({
          size: NOMINAL_FONT_SIZE,
          weight: 'bold'
        }),
        textFont: new PhetFont(0.75 * NOMINAL_FONT_SIZE),
        maxWidth: MAX_WIDTH
      });
      children.push(creditsNode);
    }

    // Show any links identified in the brand
    const linksChildren = [];
    const links = Brand.getLinks(packageJSON.name, locale);
    if (links && links.length > 0) {
      linksChildren.push(new VStrut(15));
      for (let i = 0; i < links.length; i++) {
        const link = links[i];

        // If links are allowed, use hyperlinks. Otherwise, just output the URL. This doesn't need to be internationalized.
        const stringProperty = new DerivedStringProperty([allowLinksProperty, link.textStringProperty], (allowLinks, linkText) => {
          return allowLinks ? `<a href="{{url}}">${linkText}</a>` : `${linkText}: ${link.url}`;
        });

        // This is PhET-iO instrumented because it is a keyboard navigation focusable element.
        linksChildren.push(new RichText(stringProperty, {
          links: {
            url: link.url
          },
          // RichText must fill in URL for link
          font: new PhetFont(NOMINAL_FONT_SIZE)
        }));
      }

      // Show the links in a separate VBox so they will have the same MAX_WIDTH and hence the same font size.
      const linksParent = new VBox({
        spacing: 6,
        align: 'left',
        children: linksChildren,
        maxWidth: MAX_WIDTH
      });
      children.push(linksParent);
    }
    const content = new VBox({
      align: 'left',
      spacing: 6,
      children: children,
      // pdom - accessible container for all AboutDialog content
      tagName: 'div'
    });
    super(content, options);
    this.updateStepListener = updateStepListener;
    this.updateVisibilityListener = updateVisibilityListener;

    // pdom - set label association so the title is read when focus enters the dialog
    this.addAriaLabelledbyAssociation({
      thisElementName: PDOMPeer.PRIMARY_SIBLING,
      otherElementName: PDOMPeer.PRIMARY_SIBLING,
      otherNode: titleText
    });
  }

  /**
   * When the dialog is shown, add update listeners.
   */
  show() {
    if (!this.shouldShowPopup()) {
      return;
    }
    if (updateCheck.areUpdatesChecked && !this.isShowingProperty.value) {
      updateCheck.resetTimeout();

      // Fire off a new update check if we were marked as offline or unchecked before, and we handle updates.
      if (updateCheck.stateProperty.value === UpdateState.OFFLINE || updateCheck.stateProperty.value === UpdateState.UNCHECKED) {
        updateCheck.check();
      }
      this.updateStepListener && stepTimer.addListener(this.updateStepListener);
      this.updateVisibilityListener && updateCheck.stateProperty.link(this.updateVisibilityListener);
    }
    super.show();
  }

  /**
   * When the dialog is hidden, remove update listeners.
   */
  hide() {
    if (this.isShowingProperty.value) {
      super.hide();
      if (updateCheck.areUpdatesChecked) {
        this.updateVisibilityListener && updateCheck.stateProperty.unlink(this.updateVisibilityListener);
        this.updateStepListener && stepTimer.removeListener(this.updateStepListener);
      }
    }
  }
}
joist.register('AboutDialog', AboutDialog);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEZXJpdmVkUHJvcGVydHkiLCJzdGVwVGltZXIiLCJvcHRpb25pemUiLCJTdHJpbmdVdGlscyIsIlBoZXRGb250IiwiYWxsb3dMaW5rc1Byb3BlcnR5IiwiTm9kZSIsIlBET01QZWVyIiwiUmljaFRleHQiLCJWQm94IiwiVm9pY2luZ1JpY2hUZXh0IiwiVm9pY2luZ1RleHQiLCJWU3RydXQiLCJEaWFsb2ciLCJUYW5kZW0iLCJDcmVkaXRzTm9kZSIsImpvaXN0IiwiSm9pc3RTdHJpbmdzIiwicGFja2FnZUpTT04iLCJ1cGRhdGVDaGVjayIsIlVwZGF0ZU5vZGVzIiwiVXBkYXRlU3RhdGUiLCJEZXJpdmVkU3RyaW5nUHJvcGVydHkiLCJNQVhfV0lEVEgiLCJOT01JTkFMX0ZPTlRfU0laRSIsIkFib3V0RGlhbG9nIiwiY29uc3RydWN0b3IiLCJuYW1lU3RyaW5nUHJvcGVydHkiLCJ2ZXJzaW9uIiwiY3JlZGl0cyIsImxvY2FsZSIsInByb3ZpZGVkT3B0aW9ucyIsIm9wdGlvbnMiLCJ4U3BhY2luZyIsInRvcE1hcmdpbiIsImJvdHRvbU1hcmdpbiIsImxlZnRNYXJnaW4iLCJwaGV0aW9SZWFkT25seSIsInBoZXRpb0R5bmFtaWNFbGVtZW50IiwiaXNEaXNwb3NhYmxlIiwidGFuZGVtIiwiUkVRVUlSRUQiLCJCcmFuZCIsInBoZXQiLCJicmFuZCIsImFzc2VydCIsImNoaWxkcmVuIiwidGl0bGVUZXh0IiwiZm9udCIsIm1heFdpZHRoIiwidGFnTmFtZSIsInB1c2giLCJ2ZXJzaW9uU3RyaW5nUHJvcGVydHkiLCJ2ZXJzaW9uUGF0dGVyblN0cmluZ1Byb3BlcnR5IiwidmVyc2lvblBhdHRlcm4iLCJmb3JtYXQiLCJjaGlwcGVyIiwiYnVpbGRUaW1lc3RhbXAiLCJpbm5lckNvbnRlbnQiLCJ1cGRhdGVTdGVwTGlzdGVuZXIiLCJ1cGRhdGVWaXNpYmlsaXR5TGlzdGVuZXIiLCJ1cGRhdGVQYW5lbCIsImFyZVVwZGF0ZXNDaGVja2VkIiwicG9zaXRpb25PcHRpb25zIiwibGVmdCIsInRvcCIsImNoZWNraW5nTm9kZSIsImNyZWF0ZUNoZWNraW5nTm9kZSIsInVwVG9EYXRlTm9kZSIsImNyZWF0ZVVwVG9EYXRlTm9kZSIsIm91dE9mRGF0ZU5vZGUiLCJjcmVhdGVPdXRPZkRhdGVBYm91dE5vZGUiLCJvZmZsaW5lTm9kZSIsImNyZWF0ZU9mZmxpbmVOb2RlIiwic3RlcExpc3RlbmVyIiwic3RhdGUiLCJ2aXNpYmxlIiwiQ0hFQ0tJTkciLCJVUF9UT19EQVRFIiwiT1VUX09GX0RBVEUiLCJPRkZMSU5FIiwicGRvbVZpc2libGUiLCJ2aXNpYmxlUHJvcGVydHkiLCJicmFuZENoaWxkcmVuIiwibmFtZSIsInN1cFNjYWxlIiwic3VwWU9mZnNldCIsImNvcHlyaWdodCIsInllYXIiLCJzcGxpdCIsIkRhdGUiLCJnZXRGdWxsWWVhciIsImZpbGxJbiIsImFkZGl0aW9uYWxMaWNlbnNlU3RhdGVtZW50IiwiZmlsbCIsImFsaWduIiwibGVuZ3RoIiwiY29uY2F0IiwiY3JlZGl0c05vZGUiLCJpZCIsInRpdGxlRm9udCIsInNpemUiLCJ3ZWlnaHQiLCJ0ZXh0Rm9udCIsImxpbmtzQ2hpbGRyZW4iLCJsaW5rcyIsImdldExpbmtzIiwiaSIsImxpbmsiLCJzdHJpbmdQcm9wZXJ0eSIsInRleHRTdHJpbmdQcm9wZXJ0eSIsImFsbG93TGlua3MiLCJsaW5rVGV4dCIsInVybCIsImxpbmtzUGFyZW50Iiwic3BhY2luZyIsImNvbnRlbnQiLCJhZGRBcmlhTGFiZWxsZWRieUFzc29jaWF0aW9uIiwidGhpc0VsZW1lbnROYW1lIiwiUFJJTUFSWV9TSUJMSU5HIiwib3RoZXJFbGVtZW50TmFtZSIsIm90aGVyTm9kZSIsInNob3ciLCJzaG91bGRTaG93UG9wdXAiLCJpc1Nob3dpbmdQcm9wZXJ0eSIsInZhbHVlIiwicmVzZXRUaW1lb3V0Iiwic3RhdGVQcm9wZXJ0eSIsIlVOQ0hFQ0tFRCIsImNoZWNrIiwiYWRkTGlzdGVuZXIiLCJoaWRlIiwidW5saW5rIiwicmVtb3ZlTGlzdGVuZXIiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIkFib3V0RGlhbG9nLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDEzLTIwMjQsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIEFib3V0RGlhbG9nIGRpc3BsYXlzIGluZm9ybWF0aW9uIGFib3V0IHRoZSBzaW11bGF0aW9uIC0tIGl0cyB0aXRsZSwgdmVyc2lvbiBudW1iZXIsIGNyZWRpdHMsIGV0Yy5cclxuICpcclxuICogQGF1dGhvciBTYW0gUmVpZCAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcblxyXG5cclxuaW1wb3J0IERlcml2ZWRQcm9wZXJ0eSBmcm9tICcuLi8uLi9heG9uL2pzL0Rlcml2ZWRQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBzdGVwVGltZXIgZnJvbSAnLi4vLi4vYXhvbi9qcy9zdGVwVGltZXIuanMnO1xyXG5pbXBvcnQgVFJlYWRPbmx5UHJvcGVydHkgZnJvbSAnLi4vLi4vYXhvbi9qcy9UUmVhZE9ubHlQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBUQnJhbmQgZnJvbSAnLi4vLi4vYnJhbmQvanMvVEJyYW5kLmpzJztcclxuaW1wb3J0IG9wdGlvbml6ZSwgeyBFbXB0eVNlbGZPcHRpb25zIH0gZnJvbSAnLi4vLi4vcGhldC1jb3JlL2pzL29wdGlvbml6ZS5qcyc7XHJcbmltcG9ydCBTdHJpbmdVdGlscyBmcm9tICcuLi8uLi9waGV0Y29tbW9uL2pzL3V0aWwvU3RyaW5nVXRpbHMuanMnO1xyXG5pbXBvcnQgUGhldEZvbnQgZnJvbSAnLi4vLi4vc2NlbmVyeS1waGV0L2pzL1BoZXRGb250LmpzJztcclxuaW1wb3J0IHsgYWxsb3dMaW5rc1Byb3BlcnR5LCBOb2RlLCBQRE9NUGVlciwgUmljaFRleHQsIFZCb3gsIFZvaWNpbmdSaWNoVGV4dCwgVm9pY2luZ1RleHQsIFZTdHJ1dCB9IGZyb20gJy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBEaWFsb2csIHsgRGlhbG9nT3B0aW9ucyB9IGZyb20gJy4uLy4uL3N1bi9qcy9EaWFsb2cuanMnO1xyXG5pbXBvcnQgVGFuZGVtIGZyb20gJy4uLy4uL3RhbmRlbS9qcy9UYW5kZW0uanMnO1xyXG5pbXBvcnQgQ3JlZGl0c05vZGUsIHsgQ3JlZGl0c0RhdGEgfSBmcm9tICcuL0NyZWRpdHNOb2RlLmpzJztcclxuaW1wb3J0IHsgTG9jYWxlIH0gZnJvbSAnLi9pMThuL2xvY2FsZVByb3BlcnR5LmpzJztcclxuaW1wb3J0IGpvaXN0IGZyb20gJy4vam9pc3QuanMnO1xyXG5pbXBvcnQgSm9pc3RTdHJpbmdzIGZyb20gJy4vSm9pc3RTdHJpbmdzLmpzJztcclxuaW1wb3J0IHBhY2thZ2VKU09OIGZyb20gJy4vcGFja2FnZUpTT04uanMnO1xyXG5pbXBvcnQgdXBkYXRlQ2hlY2sgZnJvbSAnLi91cGRhdGVDaGVjay5qcyc7XHJcbmltcG9ydCBVcGRhdGVOb2RlcyBmcm9tICcuL1VwZGF0ZU5vZGVzLmpzJztcclxuaW1wb3J0IFVwZGF0ZVN0YXRlIGZyb20gJy4vVXBkYXRlU3RhdGUuanMnO1xyXG5pbXBvcnQgRGVyaXZlZFN0cmluZ1Byb3BlcnR5IGZyb20gJy4uLy4uL2F4b24vanMvRGVyaXZlZFN0cmluZ1Byb3BlcnR5LmpzJztcclxuXHJcbi8vIGNvbnN0YW50c1xyXG5jb25zdCBNQVhfV0lEVEggPSA1NTA7IC8vIE1heGltdW0gd2lkdGggb2YgZWxlbWVudHMgaW4gdGhlIGRpYWxvZ1xyXG5jb25zdCBOT01JTkFMX0ZPTlRfU0laRSA9IDE2OyAvLyBDaGFuZ2UgdGhpcyB0byBtYWtlIGV2ZXJ5dGhpbmcgbGFyZ2VyIG9yIHNtYWxsZXJcclxuXHJcbnR5cGUgU2VsZk9wdGlvbnMgPSBFbXB0eVNlbGZPcHRpb25zO1xyXG5cclxuZXhwb3J0IHR5cGUgQWJvdXREaWFsb2dPcHRpb25zID0gU2VsZk9wdGlvbnMgJiBEaWFsb2dPcHRpb25zO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQWJvdXREaWFsb2cgZXh0ZW5kcyBEaWFsb2cge1xyXG5cclxuICAvLyBMaXN0ZW5lciB0aGF0IHNob3VsZCBiZSBjYWxsZWQgZXZlcnkgZnJhbWUgd2hlcmUgd2UgYXJlIHNob3duLCB3aXRoIHtudW1iZXJ9IGR0IGFzIGEgc2luZ2xlIHBhcmFtZXRlci5cclxuICBwcml2YXRlIHJlYWRvbmx5IHVwZGF0ZVN0ZXBMaXN0ZW5lcjogKCAoIGR0OiBudW1iZXIgKSA9PiB2b2lkICkgfCBudWxsO1xyXG5cclxuICAvLyBMaXN0ZW5lciB0aGF0IHNob3VsZCBiZSBjYWxsZWQgd2hlbmV2ZXIgb3VyIHVwZGF0ZSBzdGF0ZSBjaGFuZ2VzICh3aGlsZSB3ZSBhcmUgZGlzcGxheWVkKVxyXG4gIHByaXZhdGUgcmVhZG9ubHkgdXBkYXRlVmlzaWJpbGl0eUxpc3RlbmVyOiAoICggc3RhdGU6IFVwZGF0ZVN0YXRlICkgPT4gdm9pZCApIHwgbnVsbDtcclxuXHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIG5hbWVTdHJpbmdQcm9wZXJ0eSAtIG5hbWUgb2YgdGhlIHNpbXVsYXRpb25cclxuICAgKiBAcGFyYW0gdmVyc2lvbiAtIHZlcnNpb24gb2YgdGhlIHNpbXVsYXRpb25cclxuICAgKiBAcGFyYW0gY3JlZGl0cyAtIGNyZWRpdHMgZm9yIHRoZSBzaW11bGF0aW9uXHJcbiAgICogQHBhcmFtIGxvY2FsZSAtIGxvY2FsZSBzdHJpbmdcclxuICAgKiBAcGFyYW0gW3Byb3ZpZGVkT3B0aW9uc11cclxuICAgKi9cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIG5hbWVTdHJpbmdQcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8c3RyaW5nPiwgdmVyc2lvbjogc3RyaW5nLCBjcmVkaXRzOiBDcmVkaXRzRGF0YSwgbG9jYWxlOiBMb2NhbGUsIHByb3ZpZGVkT3B0aW9ucz86IEFib3V0RGlhbG9nT3B0aW9ucyApIHtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0gb3B0aW9uaXplPEFib3V0RGlhbG9nT3B0aW9ucywgU2VsZk9wdGlvbnMsIERpYWxvZ09wdGlvbnM+KCkoIHtcclxuICAgICAgeFNwYWNpbmc6IDI2LFxyXG4gICAgICB0b3BNYXJnaW46IDI2LFxyXG4gICAgICBib3R0b21NYXJnaW46IDI2LFxyXG4gICAgICBsZWZ0TWFyZ2luOiAyNixcclxuICAgICAgcGhldGlvUmVhZE9ubHk6IHRydWUsIC8vIHRoZSBBYm91dERpYWxvZyBzaG91bGQgbm90IGJlIHNldHRhYmxlXHJcbiAgICAgIHBoZXRpb0R5bmFtaWNFbGVtZW50OiB0cnVlLFxyXG4gICAgICBpc0Rpc3Bvc2FibGU6IGZhbHNlLFxyXG4gICAgICB0YW5kZW06IFRhbmRlbS5SRVFVSVJFRFxyXG4gICAgfSwgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgLy8gRHluYW1pYyBtb2R1bGVzIGFyZSBsb2FkZWQgaW4gc2ltTGF1bmNoZXIgYW5kIGFjY2Vzc2VkIHRocm91Z2ggdGhlaXIgbmFtZXNwYWNlXHJcbiAgICBjb25zdCBCcmFuZDogVEJyYW5kID0gcGhldC5icmFuZC5CcmFuZDtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIEJyYW5kLCAnQnJhbmQgc2hvdWxkIGV4aXN0IGJ5IG5vdycgKTtcclxuXHJcbiAgICBsZXQgY2hpbGRyZW4gPSBbXTtcclxuXHJcbiAgICBjb25zdCB0aXRsZVRleHQgPSBuZXcgVm9pY2luZ1RleHQoIG5hbWVTdHJpbmdQcm9wZXJ0eSwge1xyXG4gICAgICBmb250OiBuZXcgUGhldEZvbnQoIDIgKiBOT01JTkFMX0ZPTlRfU0laRSApLFxyXG4gICAgICBtYXhXaWR0aDogTUFYX1dJRFRILFxyXG4gICAgICB0YWdOYW1lOiAnaDEnXHJcbiAgICB9ICk7XHJcbiAgICBjaGlsZHJlbi5wdXNoKCB0aXRsZVRleHQgKTtcclxuXHJcbiAgICBjb25zdCB2ZXJzaW9uU3RyaW5nUHJvcGVydHkgPSBuZXcgRGVyaXZlZFByb3BlcnR5KCBbIEpvaXN0U3RyaW5ncy52ZXJzaW9uUGF0dGVyblN0cmluZ1Byb3BlcnR5IF0sIHZlcnNpb25QYXR0ZXJuID0+IHtcclxuICAgICAgcmV0dXJuIFN0cmluZ1V0aWxzLmZvcm1hdCggdmVyc2lvblBhdHRlcm4sIHZlcnNpb24gKTtcclxuICAgIH0gKTtcclxuICAgIGNoaWxkcmVuLnB1c2goIG5ldyBWb2ljaW5nVGV4dCggdmVyc2lvblN0cmluZ1Byb3BlcnR5LCB7XHJcbiAgICAgIGZvbnQ6IG5ldyBQaGV0Rm9udCggTk9NSU5BTF9GT05UX1NJWkUgKSxcclxuICAgICAgbWF4V2lkdGg6IE1BWF9XSURUSCxcclxuICAgICAgdGFnTmFtZTogJ3AnXHJcbiAgICB9ICkgKTtcclxuXHJcbiAgICAvLyBCdWlsdCB2ZXJzaW9ucyB3aWxsIGhhdmUgYSBidWlsZCB0aW1lc3RhbXBcclxuICAgIGlmICggcGhldC5jaGlwcGVyLmJ1aWxkVGltZXN0YW1wICkge1xyXG4gICAgICBjaGlsZHJlbi5wdXNoKCBuZXcgVm9pY2luZ1RleHQoIHBoZXQuY2hpcHBlci5idWlsZFRpbWVzdGFtcCwge1xyXG4gICAgICAgIGZvbnQ6IG5ldyBQaGV0Rm9udCggMC42NSAqIE5PTUlOQUxfRk9OVF9TSVpFICksXHJcbiAgICAgICAgbWF4V2lkdGg6IE1BWF9XSURUSCxcclxuICAgICAgICB0YWdOYW1lOiAncCcsXHJcbiAgICAgICAgaW5uZXJDb250ZW50OiBwaGV0LmNoaXBwZXIuYnVpbGRUaW1lc3RhbXBcclxuICAgICAgfSApICk7XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IHVwZGF0ZVN0ZXBMaXN0ZW5lcjogKCAoIGR0OiBudW1iZXIgKSA9PiB2b2lkICkgfCBudWxsID0gbnVsbDtcclxuICAgIGxldCB1cGRhdGVWaXNpYmlsaXR5TGlzdGVuZXI6ICggKCBzdGF0ZTogVXBkYXRlU3RhdGUgKSA9PiB2b2lkICkgfCBudWxsID0gbnVsbDtcclxuICAgIGxldCB1cGRhdGVQYW5lbDogTm9kZSB8IG51bGwgPSBudWxsO1xyXG5cclxuICAgIC8vIGJyYW5kPXBoZXQgdmVyc2lvbnMgdGhhdCBhcmUgbm90IHJ1bm5pbmcgaW4gdGhlIHBoZXQtYXBwIHNob3VsZCBjaGVjayB1cGRhdGUgc3RhdHVzLlxyXG4gICAgaWYgKCB1cGRhdGVDaGVjay5hcmVVcGRhdGVzQ2hlY2tlZCApIHtcclxuXHJcbiAgICAgIGNvbnN0IHBvc2l0aW9uT3B0aW9ucyA9IHsgbGVmdDogMCwgdG9wOiAwIH07XHJcbiAgICAgIGNvbnN0IGNoZWNraW5nTm9kZSA9IFVwZGF0ZU5vZGVzLmNyZWF0ZUNoZWNraW5nTm9kZSggcG9zaXRpb25PcHRpb25zICk7XHJcbiAgICAgIGNvbnN0IHVwVG9EYXRlTm9kZSA9IFVwZGF0ZU5vZGVzLmNyZWF0ZVVwVG9EYXRlTm9kZSggcG9zaXRpb25PcHRpb25zICk7XHJcbiAgICAgIGNvbnN0IG91dE9mRGF0ZU5vZGUgPSBVcGRhdGVOb2Rlcy5jcmVhdGVPdXRPZkRhdGVBYm91dE5vZGUoIHBvc2l0aW9uT3B0aW9ucyApO1xyXG4gICAgICBjb25zdCBvZmZsaW5lTm9kZSA9IFVwZGF0ZU5vZGVzLmNyZWF0ZU9mZmxpbmVOb2RlKCBwb3NpdGlvbk9wdGlvbnMgKTtcclxuXHJcbiAgICAgIHVwZGF0ZVN0ZXBMaXN0ZW5lciA9IGNoZWNraW5nTm9kZS5zdGVwTGlzdGVuZXI7XHJcblxyXG4gICAgICB1cGRhdGVWaXNpYmlsaXR5TGlzdGVuZXIgPSAoIHN0YXRlOiBVcGRhdGVTdGF0ZSApID0+IHtcclxuICAgICAgICBjaGVja2luZ05vZGUudmlzaWJsZSA9ICggc3RhdGUgPT09IFVwZGF0ZVN0YXRlLkNIRUNLSU5HICk7XHJcbiAgICAgICAgdXBUb0RhdGVOb2RlLnZpc2libGUgPSAoIHN0YXRlID09PSBVcGRhdGVTdGF0ZS5VUF9UT19EQVRFICk7XHJcbiAgICAgICAgb3V0T2ZEYXRlTm9kZS52aXNpYmxlID0gKCBzdGF0ZSA9PT0gVXBkYXRlU3RhdGUuT1VUX09GX0RBVEUgKTtcclxuICAgICAgICBvZmZsaW5lTm9kZS52aXNpYmxlID0gKCBzdGF0ZSA9PT0gVXBkYXRlU3RhdGUuT0ZGTElORSApO1xyXG5cclxuICAgICAgICAvLyBwZG9tIC0gbWFrZSB1cGRhdGUgY29udGVudCB2aXNpYmxlL2ludmlzaWJsZSBmb3Igc2NyZWVuIHJlYWRlcnMgYnkgZXhwbGljaXRseSByZW1vdmluZyBjb250ZW50XHJcbiAgICAgICAgLy8gZnJvbSB0aGUgRE9NLCBuZWNlc3NhcnkgYmVjYXVzZSBBVCB3aWxsIHJlYWR5IGhpZGRlbiBjb250ZW50IGluIGEgRGlhbG9nLlxyXG4gICAgICAgIGNoZWNraW5nTm9kZS5wZG9tVmlzaWJsZSA9IGNoZWNraW5nTm9kZS52aXNpYmxlO1xyXG4gICAgICAgIHVwVG9EYXRlTm9kZS5wZG9tVmlzaWJsZSA9IHVwVG9EYXRlTm9kZS52aXNpYmxlO1xyXG4gICAgICAgIG91dE9mRGF0ZU5vZGUucGRvbVZpc2libGUgPSBvdXRPZkRhdGVOb2RlLnZpc2libGU7XHJcbiAgICAgICAgb2ZmbGluZU5vZGUucGRvbVZpc2libGUgPSBvZmZsaW5lTm9kZS52aXNpYmxlO1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgdXBkYXRlUGFuZWwgPSBuZXcgTm9kZSgge1xyXG4gICAgICAgIGNoaWxkcmVuOiBbXHJcbiAgICAgICAgICBjaGVja2luZ05vZGUsXHJcbiAgICAgICAgICB1cFRvRGF0ZU5vZGUsXHJcbiAgICAgICAgICBvdXRPZkRhdGVOb2RlLFxyXG4gICAgICAgICAgb2ZmbGluZU5vZGVcclxuICAgICAgICBdLFxyXG4gICAgICAgIG1heFdpZHRoOiBNQVhfV0lEVEgsXHJcbiAgICAgICAgdmlzaWJsZVByb3BlcnR5OiBhbGxvd0xpbmtzUHJvcGVydHlcclxuICAgICAgfSApO1xyXG5cclxuICAgICAgY2hpbGRyZW4ucHVzaCggdXBkYXRlUGFuZWwgKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBicmFuZENoaWxkcmVuID0gW107XHJcblxyXG4gICAgLy8gU2hvdyB0aGUgYnJhbmQgbmFtZSwgaWYgaXQgZXhpc3RzXHJcbiAgICBpZiAoIEJyYW5kLm5hbWUgKSB7XHJcbiAgICAgIGJyYW5kQ2hpbGRyZW4ucHVzaCggbmV3IFZvaWNpbmdSaWNoVGV4dCggQnJhbmQubmFtZSwge1xyXG4gICAgICAgIGZvbnQ6IG5ldyBQaGV0Rm9udCggTk9NSU5BTF9GT05UX1NJWkUgKSxcclxuICAgICAgICBzdXBTY2FsZTogMC41LFxyXG4gICAgICAgIHN1cFlPZmZzZXQ6IDMsXHJcbiAgICAgICAgbWF4V2lkdGg6IE1BWF9XSURUSCxcclxuXHJcbiAgICAgICAgLy8gcGRvbVxyXG4gICAgICAgIHRhZ05hbWU6ICdoMicsXHJcbiAgICAgICAgaW5uZXJDb250ZW50OiBCcmFuZC5uYW1lXHJcbiAgICAgIH0gKSApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFNob3cgdGhlIGJyYW5kIGNvcHlyaWdodCBzdGF0ZW1lbnQsIGlmIGl0IGV4aXN0c1xyXG4gICAgaWYgKCBCcmFuZC5jb3B5cmlnaHQgKSB7XHJcbiAgICAgIGNvbnN0IHllYXIgPSBwaGV0LmNoaXBwZXIuYnVpbGRUaW1lc3RhbXAgPyAvLyBkZWZpbmVkIGZvciBidWlsdCB2ZXJzaW9uc1xyXG4gICAgICAgICAgICAgICAgICAgcGhldC5jaGlwcGVyLmJ1aWxkVGltZXN0YW1wLnNwbGl0KCAnLScgKVsgMCBdIDogLy8gZS5nLiBcIjIwMTctMDQtMjAgMTk6MDQ6NTkgVVRDXCIgLT4gXCIyMDE3XCJcclxuICAgICAgICAgICAgICAgICAgIG5ldyBEYXRlKCkuZ2V0RnVsbFllYXIoKTsgLy8gaW4gdW5idWlsdCBtb2RlXHJcblxyXG4gICAgICBjb25zdCBjb3B5cmlnaHQgPSBTdHJpbmdVdGlscy5maWxsSW4oIEJyYW5kLmNvcHlyaWdodCwgeyB5ZWFyOiB5ZWFyIH0gKTtcclxuXHJcbiAgICAgIGJyYW5kQ2hpbGRyZW4ucHVzaCggbmV3IFZvaWNpbmdUZXh0KCBjb3B5cmlnaHQsIHtcclxuICAgICAgICBmb250OiBuZXcgUGhldEZvbnQoIDAuNzUgKiBOT01JTkFMX0ZPTlRfU0laRSApLFxyXG4gICAgICAgIG1heFdpZHRoOiBNQVhfV0lEVEgsXHJcblxyXG4gICAgICAgIC8vIHBkb21cclxuICAgICAgICB0YWdOYW1lOiAncCcsXHJcbiAgICAgICAgaW5uZXJDb250ZW50OiBjb3B5cmlnaHRcclxuICAgICAgfSApICk7XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IGFkZGl0aW9uYWxMaWNlbnNlU3RhdGVtZW50OiBOb2RlIHwgbnVsbCA9IG51bGw7XHJcblxyXG4gICAgLy8gT3B0aW9uYWwgYWRkaXRpb25hbExpY2Vuc2VTdGF0ZW1lbnQsIHVzZWQgaW4gcGhldC1pb1xyXG4gICAgaWYgKCBCcmFuZC5hZGRpdGlvbmFsTGljZW5zZVN0YXRlbWVudCApIHtcclxuICAgICAgYWRkaXRpb25hbExpY2Vuc2VTdGF0ZW1lbnQgPSBuZXcgVm9pY2luZ1JpY2hUZXh0KCBCcmFuZC5hZGRpdGlvbmFsTGljZW5zZVN0YXRlbWVudCwge1xyXG4gICAgICAgICAgZm9udDogbmV3IFBoZXRGb250KCAwLjY1ICogTk9NSU5BTF9GT05UX1NJWkUgKSxcclxuICAgICAgICAgIGZpbGw6ICdncmF5JyxcclxuICAgICAgICAgIGFsaWduOiAnbGVmdCcsXHJcbiAgICAgICAgICBtYXhXaWR0aDogTUFYX1dJRFRILFxyXG5cclxuICAgICAgICAgIC8vIHBkb21cclxuICAgICAgICAgIHRhZ05hbWU6ICdwJyxcclxuICAgICAgICAgIGlubmVyQ29udGVudDogQnJhbmQuYWRkaXRpb25hbExpY2Vuc2VTdGF0ZW1lbnRcclxuICAgICAgICB9XHJcbiAgICAgICk7XHJcbiAgICAgIGJyYW5kQ2hpbGRyZW4ucHVzaCggYWRkaXRpb25hbExpY2Vuc2VTdGF0ZW1lbnQgKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIGJyYW5kQ2hpbGRyZW4ubGVuZ3RoID4gMCApIHtcclxuICAgICAgY2hpbGRyZW4ucHVzaCggbmV3IFZTdHJ1dCggMTUgKSApO1xyXG4gICAgICBjaGlsZHJlbiA9IGNoaWxkcmVuLmNvbmNhdCggYnJhbmRDaGlsZHJlbiApO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBjcmVkaXRzTm9kZTogTm9kZSB8IG51bGwgPSBudWxsO1xyXG5cclxuICAgIC8vIEFkZCBjcmVkaXRzIGZvciBzcGVjaWZpYyBicmFuZHNcclxuICAgIGlmICggKCBCcmFuZC5pZCA9PT0gJ3BoZXQnIHx8IEJyYW5kLmlkID09PSAncGhldC1pbycgKSApIHtcclxuICAgICAgY2hpbGRyZW4ucHVzaCggbmV3IFZTdHJ1dCggMTUgKSApO1xyXG4gICAgICBjcmVkaXRzTm9kZSA9IG5ldyBDcmVkaXRzTm9kZSggY3JlZGl0cywge1xyXG4gICAgICAgIHRpdGxlRm9udDogbmV3IFBoZXRGb250KCB7IHNpemU6IE5PTUlOQUxfRk9OVF9TSVpFLCB3ZWlnaHQ6ICdib2xkJyB9ICksXHJcbiAgICAgICAgdGV4dEZvbnQ6IG5ldyBQaGV0Rm9udCggMC43NSAqIE5PTUlOQUxfRk9OVF9TSVpFICksXHJcbiAgICAgICAgbWF4V2lkdGg6IE1BWF9XSURUSFxyXG4gICAgICB9ICk7XHJcbiAgICAgIGNoaWxkcmVuLnB1c2goIGNyZWRpdHNOb2RlICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gU2hvdyBhbnkgbGlua3MgaWRlbnRpZmllZCBpbiB0aGUgYnJhbmRcclxuICAgIGNvbnN0IGxpbmtzQ2hpbGRyZW46IE5vZGVbXSA9IFtdO1xyXG4gICAgY29uc3QgbGlua3MgPSBCcmFuZC5nZXRMaW5rcyggcGFja2FnZUpTT04ubmFtZSwgbG9jYWxlICk7XHJcbiAgICBpZiAoIGxpbmtzICYmIGxpbmtzLmxlbmd0aCA+IDAgKSB7XHJcblxyXG4gICAgICBsaW5rc0NoaWxkcmVuLnB1c2goIG5ldyBWU3RydXQoIDE1ICkgKTtcclxuXHJcbiAgICAgIGZvciAoIGxldCBpID0gMDsgaSA8IGxpbmtzLmxlbmd0aDsgaSsrICkge1xyXG4gICAgICAgIGNvbnN0IGxpbmsgPSBsaW5rc1sgaSBdO1xyXG5cclxuICAgICAgICAvLyBJZiBsaW5rcyBhcmUgYWxsb3dlZCwgdXNlIGh5cGVybGlua3MuIE90aGVyd2lzZSwganVzdCBvdXRwdXQgdGhlIFVSTC4gVGhpcyBkb2Vzbid0IG5lZWQgdG8gYmUgaW50ZXJuYXRpb25hbGl6ZWQuXHJcbiAgICAgICAgY29uc3Qgc3RyaW5nUHJvcGVydHkgPSBuZXcgRGVyaXZlZFN0cmluZ1Byb3BlcnR5KCBbIGFsbG93TGlua3NQcm9wZXJ0eSwgbGluay50ZXh0U3RyaW5nUHJvcGVydHkgXSwgKCBhbGxvd0xpbmtzLCBsaW5rVGV4dCApID0+IHtcclxuICAgICAgICAgIHJldHVybiBhbGxvd0xpbmtzID8gYDxhIGhyZWY9XCJ7e3VybH19XCI+JHtsaW5rVGV4dH08L2E+YCA6IGAke2xpbmtUZXh0fTogJHtsaW5rLnVybH1gO1xyXG4gICAgICAgIH0gKTtcclxuXHJcbiAgICAgICAgLy8gVGhpcyBpcyBQaEVULWlPIGluc3RydW1lbnRlZCBiZWNhdXNlIGl0IGlzIGEga2V5Ym9hcmQgbmF2aWdhdGlvbiBmb2N1c2FibGUgZWxlbWVudC5cclxuICAgICAgICBsaW5rc0NoaWxkcmVuLnB1c2goIG5ldyBSaWNoVGV4dCggc3RyaW5nUHJvcGVydHksIHtcclxuICAgICAgICAgIGxpbmtzOiB7IHVybDogbGluay51cmwgfSwgLy8gUmljaFRleHQgbXVzdCBmaWxsIGluIFVSTCBmb3IgbGlua1xyXG4gICAgICAgICAgZm9udDogbmV3IFBoZXRGb250KCBOT01JTkFMX0ZPTlRfU0laRSApXHJcbiAgICAgICAgfSApICk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIFNob3cgdGhlIGxpbmtzIGluIGEgc2VwYXJhdGUgVkJveCBzbyB0aGV5IHdpbGwgaGF2ZSB0aGUgc2FtZSBNQVhfV0lEVEggYW5kIGhlbmNlIHRoZSBzYW1lIGZvbnQgc2l6ZS5cclxuICAgICAgY29uc3QgbGlua3NQYXJlbnQgPSBuZXcgVkJveCgge1xyXG4gICAgICAgIHNwYWNpbmc6IDYsXHJcbiAgICAgICAgYWxpZ246ICdsZWZ0JyxcclxuICAgICAgICBjaGlsZHJlbjogbGlua3NDaGlsZHJlbiwgbWF4V2lkdGg6IE1BWF9XSURUSFxyXG4gICAgICB9ICk7XHJcbiAgICAgIGNoaWxkcmVuLnB1c2goIGxpbmtzUGFyZW50ICk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgY29udGVudCA9IG5ldyBWQm94KCB7XHJcbiAgICAgIGFsaWduOiAnbGVmdCcsXHJcbiAgICAgIHNwYWNpbmc6IDYsXHJcbiAgICAgIGNoaWxkcmVuOiBjaGlsZHJlbixcclxuXHJcbiAgICAgIC8vIHBkb20gLSBhY2Nlc3NpYmxlIGNvbnRhaW5lciBmb3IgYWxsIEFib3V0RGlhbG9nIGNvbnRlbnRcclxuICAgICAgdGFnTmFtZTogJ2RpdidcclxuICAgIH0gKTtcclxuXHJcbiAgICBzdXBlciggY29udGVudCwgb3B0aW9ucyApO1xyXG5cclxuICAgIHRoaXMudXBkYXRlU3RlcExpc3RlbmVyID0gdXBkYXRlU3RlcExpc3RlbmVyO1xyXG4gICAgdGhpcy51cGRhdGVWaXNpYmlsaXR5TGlzdGVuZXIgPSB1cGRhdGVWaXNpYmlsaXR5TGlzdGVuZXI7XHJcblxyXG4gICAgLy8gcGRvbSAtIHNldCBsYWJlbCBhc3NvY2lhdGlvbiBzbyB0aGUgdGl0bGUgaXMgcmVhZCB3aGVuIGZvY3VzIGVudGVycyB0aGUgZGlhbG9nXHJcbiAgICB0aGlzLmFkZEFyaWFMYWJlbGxlZGJ5QXNzb2NpYXRpb24oIHtcclxuICAgICAgdGhpc0VsZW1lbnROYW1lOiBQRE9NUGVlci5QUklNQVJZX1NJQkxJTkcsXHJcbiAgICAgIG90aGVyRWxlbWVudE5hbWU6IFBET01QZWVyLlBSSU1BUllfU0lCTElORyxcclxuICAgICAgb3RoZXJOb2RlOiB0aXRsZVRleHRcclxuICAgIH0gKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFdoZW4gdGhlIGRpYWxvZyBpcyBzaG93biwgYWRkIHVwZGF0ZSBsaXN0ZW5lcnMuXHJcbiAgICovXHJcbiAgcHVibGljIG92ZXJyaWRlIHNob3coKTogdm9pZCB7XHJcbiAgICBpZiAoICF0aGlzLnNob3VsZFNob3dQb3B1cCgpICkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZiAoIHVwZGF0ZUNoZWNrLmFyZVVwZGF0ZXNDaGVja2VkICYmICF0aGlzLmlzU2hvd2luZ1Byb3BlcnR5LnZhbHVlICkge1xyXG4gICAgICB1cGRhdGVDaGVjay5yZXNldFRpbWVvdXQoKTtcclxuXHJcbiAgICAgIC8vIEZpcmUgb2ZmIGEgbmV3IHVwZGF0ZSBjaGVjayBpZiB3ZSB3ZXJlIG1hcmtlZCBhcyBvZmZsaW5lIG9yIHVuY2hlY2tlZCBiZWZvcmUsIGFuZCB3ZSBoYW5kbGUgdXBkYXRlcy5cclxuICAgICAgaWYgKCB1cGRhdGVDaGVjay5zdGF0ZVByb3BlcnR5LnZhbHVlID09PSBVcGRhdGVTdGF0ZS5PRkZMSU5FIHx8IHVwZGF0ZUNoZWNrLnN0YXRlUHJvcGVydHkudmFsdWUgPT09IFVwZGF0ZVN0YXRlLlVOQ0hFQ0tFRCApIHtcclxuICAgICAgICB1cGRhdGVDaGVjay5jaGVjaygpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICB0aGlzLnVwZGF0ZVN0ZXBMaXN0ZW5lciAmJiBzdGVwVGltZXIuYWRkTGlzdGVuZXIoIHRoaXMudXBkYXRlU3RlcExpc3RlbmVyICk7XHJcbiAgICAgIHRoaXMudXBkYXRlVmlzaWJpbGl0eUxpc3RlbmVyICYmIHVwZGF0ZUNoZWNrLnN0YXRlUHJvcGVydHkubGluayggdGhpcy51cGRhdGVWaXNpYmlsaXR5TGlzdGVuZXIgKTtcclxuICAgIH1cclxuXHJcbiAgICBzdXBlci5zaG93KCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBXaGVuIHRoZSBkaWFsb2cgaXMgaGlkZGVuLCByZW1vdmUgdXBkYXRlIGxpc3RlbmVycy5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgaGlkZSgpOiB2b2lkIHtcclxuICAgIGlmICggdGhpcy5pc1Nob3dpbmdQcm9wZXJ0eS52YWx1ZSApIHtcclxuICAgICAgc3VwZXIuaGlkZSgpO1xyXG5cclxuICAgICAgaWYgKCB1cGRhdGVDaGVjay5hcmVVcGRhdGVzQ2hlY2tlZCApIHtcclxuICAgICAgICB0aGlzLnVwZGF0ZVZpc2liaWxpdHlMaXN0ZW5lciAmJiB1cGRhdGVDaGVjay5zdGF0ZVByb3BlcnR5LnVubGluayggdGhpcy51cGRhdGVWaXNpYmlsaXR5TGlzdGVuZXIgKTtcclxuICAgICAgICB0aGlzLnVwZGF0ZVN0ZXBMaXN0ZW5lciAmJiBzdGVwVGltZXIucmVtb3ZlTGlzdGVuZXIoIHRoaXMudXBkYXRlU3RlcExpc3RlbmVyICk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmpvaXN0LnJlZ2lzdGVyKCAnQWJvdXREaWFsb2cnLCBBYm91dERpYWxvZyApOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFHQSxPQUFPQSxlQUFlLE1BQU0sa0NBQWtDO0FBQzlELE9BQU9DLFNBQVMsTUFBTSw0QkFBNEI7QUFHbEQsT0FBT0MsU0FBUyxNQUE0QixpQ0FBaUM7QUFDN0UsT0FBT0MsV0FBVyxNQUFNLHlDQUF5QztBQUNqRSxPQUFPQyxRQUFRLE1BQU0sbUNBQW1DO0FBQ3hELFNBQVNDLGtCQUFrQixFQUFFQyxJQUFJLEVBQUVDLFFBQVEsRUFBRUMsUUFBUSxFQUFFQyxJQUFJLEVBQUVDLGVBQWUsRUFBRUMsV0FBVyxFQUFFQyxNQUFNLFFBQVEsNkJBQTZCO0FBQ3RJLE9BQU9DLE1BQU0sTUFBeUIsd0JBQXdCO0FBQzlELE9BQU9DLE1BQU0sTUFBTSwyQkFBMkI7QUFDOUMsT0FBT0MsV0FBVyxNQUF1QixrQkFBa0I7QUFFM0QsT0FBT0MsS0FBSyxNQUFNLFlBQVk7QUFDOUIsT0FBT0MsWUFBWSxNQUFNLG1CQUFtQjtBQUM1QyxPQUFPQyxXQUFXLE1BQU0sa0JBQWtCO0FBQzFDLE9BQU9DLFdBQVcsTUFBTSxrQkFBa0I7QUFDMUMsT0FBT0MsV0FBVyxNQUFNLGtCQUFrQjtBQUMxQyxPQUFPQyxXQUFXLE1BQU0sa0JBQWtCO0FBQzFDLE9BQU9DLHFCQUFxQixNQUFNLHdDQUF3Qzs7QUFFMUU7QUFDQSxNQUFNQyxTQUFTLEdBQUcs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