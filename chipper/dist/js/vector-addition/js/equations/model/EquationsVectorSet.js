// Copyright 2019-2023, University of Colorado Boulder

/**
 * EquationsVectorSet is a specialization of VectorSet for the 'Equations' screen.  It adds:
 *
 *  - a predefined set of vectors; vectors cannot be added or removed
 *  - an EquationsSumVector
 *
 * @author Brandon Li
 */

import Utils from '../../../../dot/js/Utils.js';
import Vector2 from '../../../../dot/js/Vector2.js';
import CoordinateSnapModes from '../../common/model/CoordinateSnapModes.js';
import VectorSet from '../../common/model/VectorSet.js';
import VectorAdditionConstants from '../../common/VectorAdditionConstants.js';
import vectorAddition from '../../vectorAddition.js';
import EquationsSumVector from './EquationsSumVector.js';
import EquationsVector from './EquationsVector.js';
// Describes the initial vectors for Cartesian snap mode. See https://github.com/phetsims/vector-addition/issues/227
const CARTESIAN_VECTOR_DESCRIPTIONS = [
// a
{
  vectorComponents: new Vector2(0, 5),
  vectorTail: new Vector2(5, 5),
  baseVectorTail: new Vector2(35, 15)
},
// b
{
  vectorComponents: new Vector2(5, 5),
  vectorTail: new Vector2(15, 5),
  baseVectorTail: new Vector2(35, 5)
}];

// Describes the initial vectors for polar snap mode. See https://github.com/phetsims/vector-addition/issues/227
const POLAR_VECTOR_DESCRIPTIONS = [
// d
{
  vectorComponents: Vector2.createPolar(5, 0),
  vectorTail: new Vector2(5, 5),
  baseVectorTail: new Vector2(35, 15)
},
// e
{
  vectorComponents: Vector2.createPolar(8, Utils.toRadians(45)),
  vectorTail: new Vector2(15, 5),
  baseVectorTail: new Vector2(35, 5)
}];
export default class EquationsVectorSet extends VectorSet {
  // We need to know about EquationsVector instances, a specialization of Vector.
  // We can use a regular array (instead of ObservableArray) because the set of vectors is static in this screen.

  /**
   * @param graph
   * @param componentStyleProperty
   * @param sumVisibleProperty
   * @param vectorColorPalette - color palette for vectors in this set
   * @param coordinateSnapMode - each vector set can only represent one snap mode
   */
  constructor(graph, componentStyleProperty, sumVisibleProperty, vectorColorPalette, coordinateSnapMode) {
    const options = {
      // EquationsVectorSet will initialize its own sum vector, because the sum vector in this screen is different.
      // It's not truly a sum, and its computation depends on which equation type is selected (see EquationTypes).
      initializeSum: false,
      // offsets for sum component vectors in PROJECTION style
      sumProjectionXOffset: 0.5,
      sumProjectionYOffset: 0.5
    };
    super(graph, componentStyleProperty, sumVisibleProperty, vectorColorPalette, options);
    this.symbols = coordinateSnapMode === CoordinateSnapModes.CARTESIAN ? VectorAdditionConstants.VECTOR_SYMBOLS_GROUP_1 : VectorAdditionConstants.VECTOR_SYMBOLS_GROUP_2;

    //----------------------------------------------------------------------------------------------------
    // Create the vectors, one less than symbols. For example, if symbols were [ 'a', 'b', 'c' ],
    // 'a' and 'c' would be vector symbols and 'c' would be the sum vector.

    const vectorDescriptions = coordinateSnapMode === CoordinateSnapModes.CARTESIAN ? CARTESIAN_VECTOR_DESCRIPTIONS : POLAR_VECTOR_DESCRIPTIONS;
    assert && assert(vectorDescriptions.length === this.symbols.length - 1);
    this.equationsVectors = [];
    for (let i = 0; i < vectorDescriptions.length; i++) {
      const vectorDescription = vectorDescriptions[i];

      // verify that all fields in the description are present
      assert && assert(vectorDescription.vectorTail, 'missing vectorTail');
      assert && assert(vectorDescription.vectorComponents, 'missing vectorComponents');
      assert && assert(vectorDescription.baseVectorTail, 'missing baseVectorTail');
      const vector = new EquationsVector(vectorDescription.vectorTail, vectorDescription.vectorComponents, vectorDescription.baseVectorTail, graph, this, this.symbols[i]);
      this.vectors.push(vector);
      this.equationsVectors.push(vector);
    }

    // Create the sum vector
    assert && assert(this.symbols.length > 0);
    this._sumVector = new EquationsSumVector(graph, this, graph.equationTypeProperty, _.last(this.symbols));
    this._sumVector.setProjectionOffsets(options.sumProjectionXOffset, options.sumProjectionYOffset);
  }
  reset() {
    // We are not calling super.reset because the default behavior is to dispose of all vectors in this.vectors.
    // In the Equations screen, vectors are created automatically at startup, and there is no way to created them
    // via the UI.  So we want to keep them around, but reset them.
    // See https://github.com/phetsims/vector-addition/issues/143
    this.vectors.forEach(vector => {
      vector.reset();
    });

    // ... but we still need to reset the sum vector.
    this._sumVector && this._sumVector.reset();
  }
}
vectorAddition.register('EquationsVectorSet', EquationsVectorSet);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJVdGlscyIsIlZlY3RvcjIiLCJDb29yZGluYXRlU25hcE1vZGVzIiwiVmVjdG9yU2V0IiwiVmVjdG9yQWRkaXRpb25Db25zdGFudHMiLCJ2ZWN0b3JBZGRpdGlvbiIsIkVxdWF0aW9uc1N1bVZlY3RvciIsIkVxdWF0aW9uc1ZlY3RvciIsIkNBUlRFU0lBTl9WRUNUT1JfREVTQ1JJUFRJT05TIiwidmVjdG9yQ29tcG9uZW50cyIsInZlY3RvclRhaWwiLCJiYXNlVmVjdG9yVGFpbCIsIlBPTEFSX1ZFQ1RPUl9ERVNDUklQVElPTlMiLCJjcmVhdGVQb2xhciIsInRvUmFkaWFucyIsIkVxdWF0aW9uc1ZlY3RvclNldCIsImNvbnN0cnVjdG9yIiwiZ3JhcGgiLCJjb21wb25lbnRTdHlsZVByb3BlcnR5Iiwic3VtVmlzaWJsZVByb3BlcnR5IiwidmVjdG9yQ29sb3JQYWxldHRlIiwiY29vcmRpbmF0ZVNuYXBNb2RlIiwib3B0aW9ucyIsImluaXRpYWxpemVTdW0iLCJzdW1Qcm9qZWN0aW9uWE9mZnNldCIsInN1bVByb2plY3Rpb25ZT2Zmc2V0Iiwic3ltYm9scyIsIkNBUlRFU0lBTiIsIlZFQ1RPUl9TWU1CT0xTX0dST1VQXzEiLCJWRUNUT1JfU1lNQk9MU19HUk9VUF8yIiwidmVjdG9yRGVzY3JpcHRpb25zIiwiYXNzZXJ0IiwibGVuZ3RoIiwiZXF1YXRpb25zVmVjdG9ycyIsImkiLCJ2ZWN0b3JEZXNjcmlwdGlvbiIsInZlY3RvciIsInZlY3RvcnMiLCJwdXNoIiwiX3N1bVZlY3RvciIsImVxdWF0aW9uVHlwZVByb3BlcnR5IiwiXyIsImxhc3QiLCJzZXRQcm9qZWN0aW9uT2Zmc2V0cyIsInJlc2V0IiwiZm9yRWFjaCIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiRXF1YXRpb25zVmVjdG9yU2V0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE5LTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIEVxdWF0aW9uc1ZlY3RvclNldCBpcyBhIHNwZWNpYWxpemF0aW9uIG9mIFZlY3RvclNldCBmb3IgdGhlICdFcXVhdGlvbnMnIHNjcmVlbi4gIEl0IGFkZHM6XHJcbiAqXHJcbiAqICAtIGEgcHJlZGVmaW5lZCBzZXQgb2YgdmVjdG9yczsgdmVjdG9ycyBjYW5ub3QgYmUgYWRkZWQgb3IgcmVtb3ZlZFxyXG4gKiAgLSBhbiBFcXVhdGlvbnNTdW1WZWN0b3JcclxuICpcclxuICogQGF1dGhvciBCcmFuZG9uIExpXHJcbiAqL1xyXG5cclxuaW1wb3J0IFV0aWxzIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9VdGlscy5qcyc7XHJcbmltcG9ydCBWZWN0b3IyIGZyb20gJy4uLy4uLy4uLy4uL2RvdC9qcy9WZWN0b3IyLmpzJztcclxuaW1wb3J0IENvb3JkaW5hdGVTbmFwTW9kZXMgZnJvbSAnLi4vLi4vY29tbW9uL21vZGVsL0Nvb3JkaW5hdGVTbmFwTW9kZXMuanMnO1xyXG5pbXBvcnQgVmVjdG9yU2V0IGZyb20gJy4uLy4uL2NvbW1vbi9tb2RlbC9WZWN0b3JTZXQuanMnO1xyXG5pbXBvcnQgVmVjdG9yQWRkaXRpb25Db25zdGFudHMgZnJvbSAnLi4vLi4vY29tbW9uL1ZlY3RvckFkZGl0aW9uQ29uc3RhbnRzLmpzJztcclxuaW1wb3J0IHZlY3RvckFkZGl0aW9uIGZyb20gJy4uLy4uL3ZlY3RvckFkZGl0aW9uLmpzJztcclxuaW1wb3J0IEVxdWF0aW9uc1N1bVZlY3RvciBmcm9tICcuL0VxdWF0aW9uc1N1bVZlY3Rvci5qcyc7XHJcbmltcG9ydCBFcXVhdGlvbnNWZWN0b3IgZnJvbSAnLi9FcXVhdGlvbnNWZWN0b3IuanMnO1xyXG5pbXBvcnQgRXF1YXRpb25zR3JhcGggZnJvbSAnLi9FcXVhdGlvbnNHcmFwaC5qcyc7XHJcbmltcG9ydCBDb21wb25lbnRWZWN0b3JTdHlsZXMgZnJvbSAnLi4vLi4vY29tbW9uL21vZGVsL0NvbXBvbmVudFZlY3RvclN0eWxlcy5qcyc7XHJcbmltcG9ydCBFbnVtZXJhdGlvblByb3BlcnR5IGZyb20gJy4uLy4uLy4uLy4uL2F4b24vanMvRW51bWVyYXRpb25Qcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL1Byb3BlcnR5LmpzJztcclxuaW1wb3J0IFZlY3RvckNvbG9yUGFsZXR0ZSBmcm9tICcuLi8uLi9jb21tb24vbW9kZWwvVmVjdG9yQ29sb3JQYWxldHRlLmpzJztcclxuXHJcbi8vIERlc2NyaWJlcyB0aGUgaW5pdGlhbCB2ZWN0b3JzIGZvciBDYXJ0ZXNpYW4gc25hcCBtb2RlLiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL3ZlY3Rvci1hZGRpdGlvbi9pc3N1ZXMvMjI3XHJcbmNvbnN0IENBUlRFU0lBTl9WRUNUT1JfREVTQ1JJUFRJT05TID0gW1xyXG5cclxuICAvLyBhXHJcbiAge1xyXG4gICAgdmVjdG9yQ29tcG9uZW50czogbmV3IFZlY3RvcjIoIDAsIDUgKSxcclxuICAgIHZlY3RvclRhaWw6IG5ldyBWZWN0b3IyKCA1LCA1ICksXHJcbiAgICBiYXNlVmVjdG9yVGFpbDogbmV3IFZlY3RvcjIoIDM1LCAxNSApXHJcbiAgfSxcclxuXHJcbiAgLy8gYlxyXG4gIHtcclxuICAgIHZlY3RvckNvbXBvbmVudHM6IG5ldyBWZWN0b3IyKCA1LCA1ICksXHJcbiAgICB2ZWN0b3JUYWlsOiBuZXcgVmVjdG9yMiggMTUsIDUgKSxcclxuICAgIGJhc2VWZWN0b3JUYWlsOiBuZXcgVmVjdG9yMiggMzUsIDUgKVxyXG4gIH1cclxuXTtcclxuXHJcbi8vIERlc2NyaWJlcyB0aGUgaW5pdGlhbCB2ZWN0b3JzIGZvciBwb2xhciBzbmFwIG1vZGUuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMvdmVjdG9yLWFkZGl0aW9uL2lzc3Vlcy8yMjdcclxuY29uc3QgUE9MQVJfVkVDVE9SX0RFU0NSSVBUSU9OUyA9IFtcclxuXHJcbiAgLy8gZFxyXG4gIHtcclxuICAgIHZlY3RvckNvbXBvbmVudHM6IFZlY3RvcjIuY3JlYXRlUG9sYXIoIDUsIDAgKSxcclxuICAgIHZlY3RvclRhaWw6IG5ldyBWZWN0b3IyKCA1LCA1ICksXHJcbiAgICBiYXNlVmVjdG9yVGFpbDogbmV3IFZlY3RvcjIoIDM1LCAxNSApXHJcbiAgfSxcclxuXHJcbiAgLy8gZVxyXG4gIHtcclxuICAgIHZlY3RvckNvbXBvbmVudHM6IFZlY3RvcjIuY3JlYXRlUG9sYXIoIDgsIFV0aWxzLnRvUmFkaWFucyggNDUgKSApLFxyXG4gICAgdmVjdG9yVGFpbDogbmV3IFZlY3RvcjIoIDE1LCA1ICksXHJcbiAgICBiYXNlVmVjdG9yVGFpbDogbmV3IFZlY3RvcjIoIDM1LCA1IClcclxuICB9XHJcbl07XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBFcXVhdGlvbnNWZWN0b3JTZXQgZXh0ZW5kcyBWZWN0b3JTZXQge1xyXG5cclxuICBwdWJsaWMgcmVhZG9ubHkgc3ltYm9sczogc3RyaW5nW107XHJcblxyXG4gIC8vIFdlIG5lZWQgdG8ga25vdyBhYm91dCBFcXVhdGlvbnNWZWN0b3IgaW5zdGFuY2VzLCBhIHNwZWNpYWxpemF0aW9uIG9mIFZlY3Rvci5cclxuICAvLyBXZSBjYW4gdXNlIGEgcmVndWxhciBhcnJheSAoaW5zdGVhZCBvZiBPYnNlcnZhYmxlQXJyYXkpIGJlY2F1c2UgdGhlIHNldCBvZiB2ZWN0b3JzIGlzIHN0YXRpYyBpbiB0aGlzIHNjcmVlbi5cclxuICBwdWJsaWMgcmVhZG9ubHkgZXF1YXRpb25zVmVjdG9yczogRXF1YXRpb25zVmVjdG9yW107XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSBncmFwaFxyXG4gICAqIEBwYXJhbSBjb21wb25lbnRTdHlsZVByb3BlcnR5XHJcbiAgICogQHBhcmFtIHN1bVZpc2libGVQcm9wZXJ0eVxyXG4gICAqIEBwYXJhbSB2ZWN0b3JDb2xvclBhbGV0dGUgLSBjb2xvciBwYWxldHRlIGZvciB2ZWN0b3JzIGluIHRoaXMgc2V0XHJcbiAgICogQHBhcmFtIGNvb3JkaW5hdGVTbmFwTW9kZSAtIGVhY2ggdmVjdG9yIHNldCBjYW4gb25seSByZXByZXNlbnQgb25lIHNuYXAgbW9kZVxyXG4gICAqL1xyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggZ3JhcGg6IEVxdWF0aW9uc0dyYXBoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50U3R5bGVQcm9wZXJ0eTogRW51bWVyYXRpb25Qcm9wZXJ0eTxDb21wb25lbnRWZWN0b3JTdHlsZXM+LFxyXG4gICAgICAgICAgICAgICAgICAgICAgc3VtVmlzaWJsZVByb3BlcnR5OiBQcm9wZXJ0eTxib29sZWFuPixcclxuICAgICAgICAgICAgICAgICAgICAgIHZlY3RvckNvbG9yUGFsZXR0ZTogVmVjdG9yQ29sb3JQYWxldHRlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgY29vcmRpbmF0ZVNuYXBNb2RlOiBDb29yZGluYXRlU25hcE1vZGVzICkge1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSB7XHJcblxyXG4gICAgICAvLyBFcXVhdGlvbnNWZWN0b3JTZXQgd2lsbCBpbml0aWFsaXplIGl0cyBvd24gc3VtIHZlY3RvciwgYmVjYXVzZSB0aGUgc3VtIHZlY3RvciBpbiB0aGlzIHNjcmVlbiBpcyBkaWZmZXJlbnQuXHJcbiAgICAgIC8vIEl0J3Mgbm90IHRydWx5IGEgc3VtLCBhbmQgaXRzIGNvbXB1dGF0aW9uIGRlcGVuZHMgb24gd2hpY2ggZXF1YXRpb24gdHlwZSBpcyBzZWxlY3RlZCAoc2VlIEVxdWF0aW9uVHlwZXMpLlxyXG4gICAgICBpbml0aWFsaXplU3VtOiBmYWxzZSxcclxuXHJcbiAgICAgIC8vIG9mZnNldHMgZm9yIHN1bSBjb21wb25lbnQgdmVjdG9ycyBpbiBQUk9KRUNUSU9OIHN0eWxlXHJcbiAgICAgIHN1bVByb2plY3Rpb25YT2Zmc2V0OiAwLjUsXHJcbiAgICAgIHN1bVByb2plY3Rpb25ZT2Zmc2V0OiAwLjVcclxuICAgIH07XHJcblxyXG4gICAgc3VwZXIoIGdyYXBoLCBjb21wb25lbnRTdHlsZVByb3BlcnR5LCBzdW1WaXNpYmxlUHJvcGVydHksIHZlY3RvckNvbG9yUGFsZXR0ZSwgb3B0aW9ucyApO1xyXG5cclxuICAgIHRoaXMuc3ltYm9scyA9ICggY29vcmRpbmF0ZVNuYXBNb2RlID09PSBDb29yZGluYXRlU25hcE1vZGVzLkNBUlRFU0lBTiApID9cclxuICAgICAgICAgICAgICAgICAgIFZlY3RvckFkZGl0aW9uQ29uc3RhbnRzLlZFQ1RPUl9TWU1CT0xTX0dST1VQXzEgOlxyXG4gICAgICAgICAgICAgICAgICAgVmVjdG9yQWRkaXRpb25Db25zdGFudHMuVkVDVE9SX1NZTUJPTFNfR1JPVVBfMjtcclxuXHJcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIENyZWF0ZSB0aGUgdmVjdG9ycywgb25lIGxlc3MgdGhhbiBzeW1ib2xzLiBGb3IgZXhhbXBsZSwgaWYgc3ltYm9scyB3ZXJlIFsgJ2EnLCAnYicsICdjJyBdLFxyXG4gICAgLy8gJ2EnIGFuZCAnYycgd291bGQgYmUgdmVjdG9yIHN5bWJvbHMgYW5kICdjJyB3b3VsZCBiZSB0aGUgc3VtIHZlY3Rvci5cclxuXHJcbiAgICBjb25zdCB2ZWN0b3JEZXNjcmlwdGlvbnMgPSAoIGNvb3JkaW5hdGVTbmFwTW9kZSA9PT0gQ29vcmRpbmF0ZVNuYXBNb2Rlcy5DQVJURVNJQU4gKSA/XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDQVJURVNJQU5fVkVDVE9SX0RFU0NSSVBUSU9OUyA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQT0xBUl9WRUNUT1JfREVTQ1JJUFRJT05TO1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggdmVjdG9yRGVzY3JpcHRpb25zLmxlbmd0aCA9PT0gdGhpcy5zeW1ib2xzLmxlbmd0aCAtIDEgKTtcclxuXHJcbiAgICB0aGlzLmVxdWF0aW9uc1ZlY3RvcnMgPSBbXTtcclxuICAgIGZvciAoIGxldCBpID0gMDsgaSA8IHZlY3RvckRlc2NyaXB0aW9ucy5sZW5ndGg7IGkrKyApIHtcclxuXHJcbiAgICAgIGNvbnN0IHZlY3RvckRlc2NyaXB0aW9uID0gdmVjdG9yRGVzY3JpcHRpb25zWyBpIF07XHJcblxyXG4gICAgICAvLyB2ZXJpZnkgdGhhdCBhbGwgZmllbGRzIGluIHRoZSBkZXNjcmlwdGlvbiBhcmUgcHJlc2VudFxyXG4gICAgICBhc3NlcnQgJiYgYXNzZXJ0KCB2ZWN0b3JEZXNjcmlwdGlvbi52ZWN0b3JUYWlsLCAnbWlzc2luZyB2ZWN0b3JUYWlsJyApO1xyXG4gICAgICBhc3NlcnQgJiYgYXNzZXJ0KCB2ZWN0b3JEZXNjcmlwdGlvbi52ZWN0b3JDb21wb25lbnRzLCAnbWlzc2luZyB2ZWN0b3JDb21wb25lbnRzJyApO1xyXG4gICAgICBhc3NlcnQgJiYgYXNzZXJ0KCB2ZWN0b3JEZXNjcmlwdGlvbi5iYXNlVmVjdG9yVGFpbCwgJ21pc3NpbmcgYmFzZVZlY3RvclRhaWwnICk7XHJcblxyXG4gICAgICBjb25zdCB2ZWN0b3IgPSBuZXcgRXF1YXRpb25zVmVjdG9yKFxyXG4gICAgICAgIHZlY3RvckRlc2NyaXB0aW9uLnZlY3RvclRhaWwsXHJcbiAgICAgICAgdmVjdG9yRGVzY3JpcHRpb24udmVjdG9yQ29tcG9uZW50cyxcclxuICAgICAgICB2ZWN0b3JEZXNjcmlwdGlvbi5iYXNlVmVjdG9yVGFpbCxcclxuICAgICAgICBncmFwaCxcclxuICAgICAgICB0aGlzLFxyXG4gICAgICAgIHRoaXMuc3ltYm9sc1sgaSBdICk7XHJcblxyXG4gICAgICB0aGlzLnZlY3RvcnMucHVzaCggdmVjdG9yICk7XHJcbiAgICAgIHRoaXMuZXF1YXRpb25zVmVjdG9ycy5wdXNoKCB2ZWN0b3IgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDcmVhdGUgdGhlIHN1bSB2ZWN0b3JcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIHRoaXMuc3ltYm9scy5sZW5ndGggPiAwICk7XHJcbiAgICB0aGlzLl9zdW1WZWN0b3IgPSBuZXcgRXF1YXRpb25zU3VtVmVjdG9yKCBncmFwaCwgdGhpcywgZ3JhcGguZXF1YXRpb25UeXBlUHJvcGVydHksIF8ubGFzdCggdGhpcy5zeW1ib2xzICkhICk7XHJcbiAgICB0aGlzLl9zdW1WZWN0b3Iuc2V0UHJvamVjdGlvbk9mZnNldHMoIG9wdGlvbnMuc3VtUHJvamVjdGlvblhPZmZzZXQsIG9wdGlvbnMuc3VtUHJvamVjdGlvbllPZmZzZXQgKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBvdmVycmlkZSByZXNldCgpOiB2b2lkIHtcclxuXHJcbiAgICAvLyBXZSBhcmUgbm90IGNhbGxpbmcgc3VwZXIucmVzZXQgYmVjYXVzZSB0aGUgZGVmYXVsdCBiZWhhdmlvciBpcyB0byBkaXNwb3NlIG9mIGFsbCB2ZWN0b3JzIGluIHRoaXMudmVjdG9ycy5cclxuICAgIC8vIEluIHRoZSBFcXVhdGlvbnMgc2NyZWVuLCB2ZWN0b3JzIGFyZSBjcmVhdGVkIGF1dG9tYXRpY2FsbHkgYXQgc3RhcnR1cCwgYW5kIHRoZXJlIGlzIG5vIHdheSB0byBjcmVhdGVkIHRoZW1cclxuICAgIC8vIHZpYSB0aGUgVUkuICBTbyB3ZSB3YW50IHRvIGtlZXAgdGhlbSBhcm91bmQsIGJ1dCByZXNldCB0aGVtLlxyXG4gICAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy92ZWN0b3ItYWRkaXRpb24vaXNzdWVzLzE0M1xyXG4gICAgdGhpcy52ZWN0b3JzLmZvckVhY2goIHZlY3RvciA9PiB7IHZlY3Rvci5yZXNldCgpOyB9ICk7XHJcblxyXG4gICAgLy8gLi4uIGJ1dCB3ZSBzdGlsbCBuZWVkIHRvIHJlc2V0IHRoZSBzdW0gdmVjdG9yLlxyXG4gICAgdGhpcy5fc3VtVmVjdG9yICYmIHRoaXMuX3N1bVZlY3Rvci5yZXNldCgpO1xyXG4gIH1cclxufVxyXG5cclxudmVjdG9yQWRkaXRpb24ucmVnaXN0ZXIoICdFcXVhdGlvbnNWZWN0b3JTZXQn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