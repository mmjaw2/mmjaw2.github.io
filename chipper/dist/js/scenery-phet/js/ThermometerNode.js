// Copyright 2014-2024, University of Colorado Boulder

/**
 * Thermometer node, see https://github.com/phetsims/scenery-phet/issues/43
 *
 * @author Aaron Davis
 * @author Sam Reid (PhET Interactive Simulations)
 * @author Chris Malley (PixelZoom, Inc.)
 */

import DerivedProperty from '../../axon/js/DerivedProperty.js';
import LinearFunction from '../../dot/js/LinearFunction.js';
import Range from '../../dot/js/Range.js';
import Utils from '../../dot/js/Utils.js';
import { Shape } from '../../kite/js/imports.js';
import InstanceRegistry from '../../phet-core/js/documentation/InstanceRegistry.js';
import optionize from '../../phet-core/js/optionize.js';
import { LinearGradient, Node, Path, Rectangle } from '../../scenery/js/imports.js';
import NullableIO from '../../tandem/js/types/NullableIO.js';
import NumberIO from '../../tandem/js/types/NumberIO.js';
import sceneryPhet from './sceneryPhet.js';
import ShadedSphereNode from './ShadedSphereNode.js';
const FLUID_OVERLAP = 1; // overlap of fluid in tube and bulb, to hide seam

// center of the bulb is at (0,0), let the client code move to the correct position
const BULB_CENTER_X = 0;
const BULB_CENTER_Y = 0;
export default class ThermometerNode extends Node {
  /**
   * @param temperatureProperty - null means there is no temperature to measure, treated as minTemperature
   * @param minTemperature
   * @param maxTemperature
   * @param [providedOptions?]
   */
  constructor(temperatureProperty, minTemperature, maxTemperature, providedOptions) {
    const options = optionize()({
      bulbDiameter: 50,
      tubeWidth: 30,
      tubeHeight: 100,
      lineWidth: 4,
      outlineStroke: 'black',
      tickSpacing: 15,
      tickSpacingTemperature: null,
      majorTickLength: 15,
      minorTickLength: 7.5,
      glassThickness: 4,
      zeroLevel: 'bulbCenter',
      backgroundFill: null,
      // all the default colors are shades of red
      fluidMainColor: '#850e0e',
      fluidHighlightColor: '#ff7575',
      fluidRightSideColor: '#c41515'
    }, providedOptions);
    super();
    const thermometerRange = new Range(minTemperature, maxTemperature);

    // Create a shaded sphere to act as the bulb fluid
    const bulbFluidDiameter = options.bulbDiameter - options.glassThickness - options.lineWidth / 2;
    const bulbFluidNode = new ShadedSphereNode(bulbFluidDiameter, {
      centerX: BULB_CENTER_X,
      centerY: BULB_CENTER_Y,
      mainColor: options.fluidMainColor,
      highlightColor: options.fluidHighlightColor,
      highlightXOffset: -0.2,
      highlightYOffset: 0.2,
      rotation: Math.PI / 2
    });

    // Angles for the outline of the bulb
    const bulbStartAngle = -Math.acos(options.tubeWidth / options.bulbDiameter);
    const bulbEndAngle = Math.PI - bulbStartAngle;

    // Create the outline for the thermometer, starting with the bulb
    const tubeTopRadius = options.tubeWidth / 2;
    const straightTubeHeight = options.tubeHeight - tubeTopRadius;
    const straightTubeTop = BULB_CENTER_Y - options.bulbDiameter / 2 - straightTubeHeight;
    const straightTubeLeft = BULB_CENTER_X - options.tubeWidth / 2;
    const outlineShape = new Shape().arc(BULB_CENTER_X, BULB_CENTER_Y, options.bulbDiameter / 2, bulbStartAngle, bulbEndAngle) // bulb at bottom
    .arc(BULB_CENTER_X, straightTubeTop, tubeTopRadius, Math.PI, 0) // rounded top of tube
    .close();
    const outlineNode = new Path(outlineShape, {
      stroke: options.outlineStroke,
      lineWidth: options.lineWidth
    });
    assert && assert(outlineNode.height === options.tubeHeight + options.bulbDiameter + options.lineWidth); // see scenery-phet#136

    const tubeFluidWidth = options.tubeWidth - options.glassThickness - options.lineWidth / 2;
    const tubeFluidRadius = tubeFluidWidth / 2;
    const clipBulbRadius = (options.bulbDiameter - options.glassThickness - options.lineWidth / 2) / 2;
    const clipStartAngle = -Math.acos(tubeFluidRadius / clipBulbRadius);
    const clipEndAngle = Math.PI - clipStartAngle;
    const tubeFluidBottom = bulbFluidDiameter / 2 * Math.sin(clipEndAngle);
    const tubeFluidLeft = -tubeFluidRadius;

    // Clip area for the fluid in the tube, round at the top
    const fluidClipArea = new Shape().moveTo(tubeFluidLeft, tubeFluidBottom + FLUID_OVERLAP).arc(BULB_CENTER_X, straightTubeTop, tubeFluidRadius, Math.PI, 0) // round top
    .lineTo(-tubeFluidLeft, tubeFluidBottom + FLUID_OVERLAP).close();

    // Clip the top of the bulb so it's flat where it connects to the tube
    const bulbFluidClipArea = Shape.rectangle(tubeFluidBottom, BULB_CENTER_Y - options.bulbDiameter / 2, options.bulbDiameter, options.bulbDiameter);
    bulbFluidNode.setClipArea(bulbFluidClipArea);

    // Gradient for fluid in tube
    const tubeFluidGradient = new LinearGradient(tubeFluidLeft, 0, tubeFluidLeft + tubeFluidWidth, 0).addColorStop(0, options.fluidMainColor).addColorStop(0.4, options.fluidHighlightColor).addColorStop(0.5, options.fluidHighlightColor).addColorStop(1, options.fluidMainColor);

    // Fluid in the tube (correct size set later)
    const tubeFluidNode = new Rectangle(0, 0, tubeFluidWidth, 0, {
      fill: tubeFluidGradient,
      clipArea: fluidClipArea
    });

    // override tick spacing options when using tickSpacingTemperature
    let offset = options.tickSpacing; // distance between position of minTemp and first tick
    let minorOffset = 0; // bool (as number) indicating where first minor tick is placed
    if (options.tickSpacingTemperature !== null) {
      const scaleTempY = (options.tubeHeight + options.lineWidth) / (maxTemperature - minTemperature);
      const offsetTemp = options.tickSpacingTemperature - minTemperature % options.tickSpacingTemperature;
      offset = offsetTemp * scaleTempY;
      minorOffset = (minTemperature + offsetTemp) % (options.tickSpacingTemperature * 2) % 2;
      options.tickSpacing = options.tickSpacingTemperature * scaleTempY;
    }

    // tick marks, from bottom up, alternating major and minor ticks
    for (let i = 0; i * options.tickSpacing + offset <= options.tubeHeight - tubeTopRadius / 3; i++) {
      outlineShape.moveTo(straightTubeLeft, tubeFluidBottom - i * options.tickSpacing - offset);
      outlineShape.horizontalLineTo(straightTubeLeft + (i % 2 === minorOffset ? options.minorTickLength : options.majorTickLength));
    }

    // Background inside the tube
    if (options.backgroundFill) {
      this.addChild(new Path(outlineShape, {
        fill: options.backgroundFill
      }));
    }

    // Add other nodes after optional background
    this.addChild(tubeFluidNode);
    this.addChild(bulbFluidNode);
    this.addChild(outlineNode);

    // Temperature determines the height of the fluid in the tube
    const maxFluidHeight = new Path(fluidClipArea).height;
    let minFluidHeight;
    if (options.zeroLevel === 'bulbCenter') {
      minFluidHeight = 0;
    } else if (options.zeroLevel === 'bulbTop') {
      minFluidHeight = -tubeFluidBottom;
    } else {
      throw new Error(`Invalid zeroLevel: ${options.zeroLevel}`);
    }
    this.temperatureLinearFunction = new LinearFunction(minTemperature, maxTemperature, minFluidHeight, maxFluidHeight + minFluidHeight);
    const temperaturePropertyObserver = temperature => {
      const fluidHeight = this.temperatureToYPos(temperature);
      tubeFluidNode.visible = fluidHeight > 0;
      tubeFluidNode.setRect(tubeFluidLeft, tubeFluidBottom - fluidHeight + minFluidHeight, tubeFluidWidth, fluidHeight + FLUID_OVERLAP);
    };
    temperatureProperty.link(temperaturePropertyObserver);
    const percentProperty = new DerivedProperty([temperatureProperty], temp => {
      return temp === null ? 0 : thermometerRange.getNormalizedValue(Utils.clamp(temp, thermometerRange.min, thermometerRange.max)) * 100;
    }, {
      tandem: options.tandem?.createTandem('percentProperty'),
      phetioDocumentation: 'the percentage of the thermometer that is filled by the current temperature. If temperature is null, then percent will be 0',
      phetioValueType: NullableIO(NumberIO)
    });
    this.mutate(options);
    this.disposeThermometerNode = () => {
      if (temperatureProperty.hasListener(temperaturePropertyObserver)) {
        temperatureProperty.unlink(temperaturePropertyObserver);
      }
      percentProperty.dispose();
    };

    // support for binder documentation, stripped out in builds and only runs when ?binder is specified
    assert && phet?.chipper?.queryParameters?.binder && InstanceRegistry.registerDataURL('scenery-phet', 'ThermometerNode', this);
  }
  dispose() {
    this.disposeThermometerNode();
    super.dispose();
  }

  /**
   * Get y position at temperature to allow accurate tick placement
   * @param temperature - temperature at which to find y position, null is treated as the provided minTemperature
   */
  temperatureToYPos(temperature) {
    // treat null as zero - this is a "legacy requirement", needed by the States of Matter sims
    const compensatedTemperature = temperature === null ? 0 : temperature;
    return this.temperatureLinearFunction.evaluate(compensatedTemperature);
  }

  /**
   * Get temperature at y position to allow temperature thumb mapping
   * @param y - y position on thermometer node
   */
  yPosToTemperature(y) {
    return this.temperatureLinearFunction.inverse(y);
  }
}
sceneryPhet.register('ThermometerNode', ThermometerNode);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEZXJpdmVkUHJvcGVydHkiLCJMaW5lYXJGdW5jdGlvbiIsIlJhbmdlIiwiVXRpbHMiLCJTaGFwZSIsIkluc3RhbmNlUmVnaXN0cnkiLCJvcHRpb25pemUiLCJMaW5lYXJHcmFkaWVudCIsIk5vZGUiLCJQYXRoIiwiUmVjdGFuZ2xlIiwiTnVsbGFibGVJTyIsIk51bWJlcklPIiwic2NlbmVyeVBoZXQiLCJTaGFkZWRTcGhlcmVOb2RlIiwiRkxVSURfT1ZFUkxBUCIsIkJVTEJfQ0VOVEVSX1giLCJCVUxCX0NFTlRFUl9ZIiwiVGhlcm1vbWV0ZXJOb2RlIiwiY29uc3RydWN0b3IiLCJ0ZW1wZXJhdHVyZVByb3BlcnR5IiwibWluVGVtcGVyYXR1cmUiLCJtYXhUZW1wZXJhdHVyZSIsInByb3ZpZGVkT3B0aW9ucyIsIm9wdGlvbnMiLCJidWxiRGlhbWV0ZXIiLCJ0dWJlV2lkdGgiLCJ0dWJlSGVpZ2h0IiwibGluZVdpZHRoIiwib3V0bGluZVN0cm9rZSIsInRpY2tTcGFjaW5nIiwidGlja1NwYWNpbmdUZW1wZXJhdHVyZSIsIm1ham9yVGlja0xlbmd0aCIsIm1pbm9yVGlja0xlbmd0aCIsImdsYXNzVGhpY2tuZXNzIiwiemVyb0xldmVsIiwiYmFja2dyb3VuZEZpbGwiLCJmbHVpZE1haW5Db2xvciIsImZsdWlkSGlnaGxpZ2h0Q29sb3IiLCJmbHVpZFJpZ2h0U2lkZUNvbG9yIiwidGhlcm1vbWV0ZXJSYW5nZSIsImJ1bGJGbHVpZERpYW1ldGVyIiwiYnVsYkZsdWlkTm9kZSIsImNlbnRlclgiLCJjZW50ZXJZIiwibWFpbkNvbG9yIiwiaGlnaGxpZ2h0Q29sb3IiLCJoaWdobGlnaHRYT2Zmc2V0IiwiaGlnaGxpZ2h0WU9mZnNldCIsInJvdGF0aW9uIiwiTWF0aCIsIlBJIiwiYnVsYlN0YXJ0QW5nbGUiLCJhY29zIiwiYnVsYkVuZEFuZ2xlIiwidHViZVRvcFJhZGl1cyIsInN0cmFpZ2h0VHViZUhlaWdodCIsInN0cmFpZ2h0VHViZVRvcCIsInN0cmFpZ2h0VHViZUxlZnQiLCJvdXRsaW5lU2hhcGUiLCJhcmMiLCJjbG9zZSIsIm91dGxpbmVOb2RlIiwic3Ryb2tlIiwiYXNzZXJ0IiwiaGVpZ2h0IiwidHViZUZsdWlkV2lkdGgiLCJ0dWJlRmx1aWRSYWRpdXMiLCJjbGlwQnVsYlJhZGl1cyIsImNsaXBTdGFydEFuZ2xlIiwiY2xpcEVuZEFuZ2xlIiwidHViZUZsdWlkQm90dG9tIiwic2luIiwidHViZUZsdWlkTGVmdCIsImZsdWlkQ2xpcEFyZWEiLCJtb3ZlVG8iLCJsaW5lVG8iLCJidWxiRmx1aWRDbGlwQXJlYSIsInJlY3RhbmdsZSIsInNldENsaXBBcmVhIiwidHViZUZsdWlkR3JhZGllbnQiLCJhZGRDb2xvclN0b3AiLCJ0dWJlRmx1aWROb2RlIiwiZmlsbCIsImNsaXBBcmVhIiwib2Zmc2V0IiwibWlub3JPZmZzZXQiLCJzY2FsZVRlbXBZIiwib2Zmc2V0VGVtcCIsImkiLCJob3Jpem9udGFsTGluZVRvIiwiYWRkQ2hpbGQiLCJtYXhGbHVpZEhlaWdodCIsIm1pbkZsdWlkSGVpZ2h0IiwiRXJyb3IiLCJ0ZW1wZXJhdHVyZUxpbmVhckZ1bmN0aW9uIiwidGVtcGVyYXR1cmVQcm9wZXJ0eU9ic2VydmVyIiwidGVtcGVyYXR1cmUiLCJmbHVpZEhlaWdodCIsInRlbXBlcmF0dXJlVG9ZUG9zIiwidmlzaWJsZSIsInNldFJlY3QiLCJsaW5rIiwicGVyY2VudFByb3BlcnR5IiwidGVtcCIsImdldE5vcm1hbGl6ZWRWYWx1ZSIsImNsYW1wIiwibWluIiwibWF4IiwidGFuZGVtIiwiY3JlYXRlVGFuZGVtIiwicGhldGlvRG9jdW1lbnRhdGlvbiIsInBoZXRpb1ZhbHVlVHlwZSIsIm11dGF0ZSIsImRpc3Bvc2VUaGVybW9tZXRlck5vZGUiLCJoYXNMaXN0ZW5lciIsInVubGluayIsImRpc3Bvc2UiLCJwaGV0IiwiY2hpcHBlciIsInF1ZXJ5UGFyYW1ldGVycyIsImJpbmRlciIsInJlZ2lzdGVyRGF0YVVSTCIsImNvbXBlbnNhdGVkVGVtcGVyYXR1cmUiLCJldmFsdWF0ZSIsInlQb3NUb1RlbXBlcmF0dXJlIiwieSIsImludmVyc2UiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIlRoZXJtb21ldGVyTm9kZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxNC0yMDI0LCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBUaGVybW9tZXRlciBub2RlLCBzZWUgaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL3NjZW5lcnktcGhldC9pc3N1ZXMvNDNcclxuICpcclxuICogQGF1dGhvciBBYXJvbiBEYXZpc1xyXG4gKiBAYXV0aG9yIFNhbSBSZWlkIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKiBAYXV0aG9yIENocmlzIE1hbGxleSAoUGl4ZWxab29tLCBJbmMuKVxyXG4gKi9cclxuXHJcbmltcG9ydCBEZXJpdmVkUHJvcGVydHkgZnJvbSAnLi4vLi4vYXhvbi9qcy9EZXJpdmVkUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgVFJlYWRPbmx5UHJvcGVydHkgZnJvbSAnLi4vLi4vYXhvbi9qcy9UUmVhZE9ubHlQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBMaW5lYXJGdW5jdGlvbiBmcm9tICcuLi8uLi9kb3QvanMvTGluZWFyRnVuY3Rpb24uanMnO1xyXG5pbXBvcnQgUmFuZ2UgZnJvbSAnLi4vLi4vZG90L2pzL1JhbmdlLmpzJztcclxuaW1wb3J0IFV0aWxzIGZyb20gJy4uLy4uL2RvdC9qcy9VdGlscy5qcyc7XHJcbmltcG9ydCB7IFNoYXBlIH0gZnJvbSAnLi4vLi4va2l0ZS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IEluc3RhbmNlUmVnaXN0cnkgZnJvbSAnLi4vLi4vcGhldC1jb3JlL2pzL2RvY3VtZW50YXRpb24vSW5zdGFuY2VSZWdpc3RyeS5qcyc7XHJcbmltcG9ydCBvcHRpb25pemUgZnJvbSAnLi4vLi4vcGhldC1jb3JlL2pzL29wdGlvbml6ZS5qcyc7XHJcbmltcG9ydCB7IExpbmVhckdyYWRpZW50LCBOb2RlLCBOb2RlT3B0aW9ucywgUGF0aCwgUmVjdGFuZ2xlLCBUQ29sb3IgfSBmcm9tICcuLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgTnVsbGFibGVJTyBmcm9tICcuLi8uLi90YW5kZW0vanMvdHlwZXMvTnVsbGFibGVJTy5qcyc7XHJcbmltcG9ydCBOdW1iZXJJTyBmcm9tICcuLi8uLi90YW5kZW0vanMvdHlwZXMvTnVtYmVySU8uanMnO1xyXG5pbXBvcnQgc2NlbmVyeVBoZXQgZnJvbSAnLi9zY2VuZXJ5UGhldC5qcyc7XHJcbmltcG9ydCBTaGFkZWRTcGhlcmVOb2RlIGZyb20gJy4vU2hhZGVkU3BoZXJlTm9kZS5qcyc7XHJcblxyXG5jb25zdCBGTFVJRF9PVkVSTEFQID0gMTsgLy8gb3ZlcmxhcCBvZiBmbHVpZCBpbiB0dWJlIGFuZCBidWxiLCB0byBoaWRlIHNlYW1cclxuXHJcbi8vIGNlbnRlciBvZiB0aGUgYnVsYiBpcyBhdCAoMCwwKSwgbGV0IHRoZSBjbGllbnQgY29kZSBtb3ZlIHRvIHRoZSBjb3JyZWN0IHBvc2l0aW9uXHJcbmNvbnN0IEJVTEJfQ0VOVEVSX1ggPSAwO1xyXG5jb25zdCBCVUxCX0NFTlRFUl9ZID0gMDtcclxuXHJcbnR5cGUgWmVyb0xldmVsID0gJ2J1bGJDZW50ZXInIHwgJ2J1bGJUb3AnO1xyXG5cclxudHlwZSBTZWxmT3B0aW9ucyA9IHtcclxuICBidWxiRGlhbWV0ZXI/OiBudW1iZXI7XHJcbiAgdHViZVdpZHRoPzogbnVtYmVyO1xyXG4gIHR1YmVIZWlnaHQ/OiBudW1iZXI7XHJcbiAgbGluZVdpZHRoPzogbnVtYmVyO1xyXG4gIG91dGxpbmVTdHJva2U/OiBUQ29sb3I7XHJcbiAgdGlja1NwYWNpbmc/OiBudW1iZXI7XHJcblxyXG4gIC8vIG92ZXJyaWRlcyB0aWNrU3BhY2luZyB0byBzcGFjZSB0aWNrcyBieSB1bml0cyBvZiB0ZW1wZXJhdHVyZVxyXG4gIHRpY2tTcGFjaW5nVGVtcGVyYXR1cmU/OiBudW1iZXIgfCBudWxsO1xyXG4gIG1ham9yVGlja0xlbmd0aD86IG51bWJlcjtcclxuICBtaW5vclRpY2tMZW5ndGg/OiBudW1iZXI7XHJcblxyXG4gIC8vIHNwYWNlIGJldHdlZW4gdGhlIHRoZXJtb21ldGVyIG91dGxpbmUgYW5kIHRoZSBmbHVpZCBpbnNpZGUgaXRcclxuICBnbGFzc1RoaWNrbmVzcz86IG51bWJlcjtcclxuXHJcbiAgLy8gZGVmaW5lcyB3aGVyZSBsZXZlbCBpcyBhdCB0ZW1wZXJhdHVyZSB6ZXJvIC0gJ2J1bGJDZW50ZXInIG9yICdidWxiVG9wJ1xyXG4gIHplcm9MZXZlbD86IFplcm9MZXZlbDtcclxuXHJcbiAgLy8gbGVhdmUgYXMgbnVsbCB0byBoYXZlIGEgdHJhbnNwYXJlbnQgYmFja2dyb3VuZC4gSWYgYSBjb2xvciBpcyBnaXZlbiwgdGhlbiBhbiBleHRyYSBSZWN0YW5nbGUgaXMgY3JlYXRlZCBmb3IgdGhlIGJhY2tncm91bmRcclxuICBiYWNrZ3JvdW5kRmlsbD86IFRDb2xvcjtcclxuXHJcbiAgLy8gdGhlIG1haW4gY29sb3Igb2YgdGhlIGJ1bGIgZmx1aWQsIGFuZCB0aGUgbGVmdCBzaWRlIG9mIHRoZSB0dWJlIGdyYWRpZW50XHJcbiAgZmx1aWRNYWluQ29sb3I/OiBUQ29sb3I7XHJcblxyXG4gIC8vIHRoZSBoaWdobGlnaHQgY29sb3Igb2YgdGhlIGJ1bGIgZmx1aWQgYW5kIHRoZSBtaWRkbGUgb2YgdGhlIHR1YmUgZ3JhZGllbnRcclxuICBmbHVpZEhpZ2hsaWdodENvbG9yPzogVENvbG9yO1xyXG5cclxuICAvLyB0aGUgcmlnaHQgc2lkZSBvZiB0aGUgdHViZSBncmFkaWVudCwgbm90IHVzZWQgY3VycmVudGx5XHJcbiAgZmx1aWRSaWdodFNpZGVDb2xvcj86IFRDb2xvcjtcclxufTtcclxuXHJcbmV4cG9ydCB0eXBlIFRoZXJtb21ldGVyTm9kZU9wdGlvbnMgPSBTZWxmT3B0aW9ucyAmIE5vZGVPcHRpb25zO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVGhlcm1vbWV0ZXJOb2RlIGV4dGVuZHMgTm9kZSB7XHJcbiAgcHJpdmF0ZSByZWFkb25seSB0ZW1wZXJhdHVyZUxpbmVhckZ1bmN0aW9uOiBMaW5lYXJGdW5jdGlvbjtcclxuICBwcml2YXRlIHJlYWRvbmx5IGRpc3Bvc2VUaGVybW9tZXRlck5vZGU6ICgpID0+IHZvaWQ7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB0ZW1wZXJhdHVyZVByb3BlcnR5IC0gbnVsbCBtZWFucyB0aGVyZSBpcyBubyB0ZW1wZXJhdHVyZSB0byBtZWFzdXJlLCB0cmVhdGVkIGFzIG1pblRlbXBlcmF0dXJlXHJcbiAgICogQHBhcmFtIG1pblRlbXBlcmF0dXJlXHJcbiAgICogQHBhcmFtIG1heFRlbXBlcmF0dXJlXHJcbiAgICogQHBhcmFtIFtwcm92aWRlZE9wdGlvbnM/XVxyXG4gICAqL1xyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggdGVtcGVyYXR1cmVQcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8bnVtYmVyIHwgbnVsbD4sIG1pblRlbXBlcmF0dXJlOiBudW1iZXIsIG1heFRlbXBlcmF0dXJlOiBudW1iZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICBwcm92aWRlZE9wdGlvbnM/OiBUaGVybW9tZXRlck5vZGVPcHRpb25zICkge1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSBvcHRpb25pemU8VGhlcm1vbWV0ZXJOb2RlT3B0aW9ucywgU2VsZk9wdGlvbnMsIE5vZGVPcHRpb25zPigpKCB7XHJcbiAgICAgIGJ1bGJEaWFtZXRlcjogNTAsXHJcbiAgICAgIHR1YmVXaWR0aDogMzAsXHJcbiAgICAgIHR1YmVIZWlnaHQ6IDEwMCxcclxuICAgICAgbGluZVdpZHRoOiA0LFxyXG4gICAgICBvdXRsaW5lU3Ryb2tlOiAnYmxhY2snLFxyXG4gICAgICB0aWNrU3BhY2luZzogMTUsXHJcbiAgICAgIHRpY2tTcGFjaW5nVGVtcGVyYXR1cmU6IG51bGwsXHJcbiAgICAgIG1ham9yVGlja0xlbmd0aDogMTUsXHJcbiAgICAgIG1pbm9yVGlja0xlbmd0aDogNy41LFxyXG4gICAgICBnbGFzc1RoaWNrbmVzczogNCxcclxuICAgICAgemVyb0xldmVsOiAnYnVsYkNlbnRlcicsXHJcbiAgICAgIGJhY2tncm91bmRGaWxsOiBudWxsLFxyXG5cclxuICAgICAgLy8gYWxsIHRoZSBkZWZhdWx0IGNvbG9ycyBhcmUgc2hhZGVzIG9mIHJlZFxyXG4gICAgICBmbHVpZE1haW5Db2xvcjogJyM4NTBlMGUnLFxyXG4gICAgICBmbHVpZEhpZ2hsaWdodENvbG9yOiAnI2ZmNzU3NScsXHJcbiAgICAgIGZsdWlkUmlnaHRTaWRlQ29sb3I6ICcjYzQxNTE1J1xyXG4gICAgfSwgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgc3VwZXIoKTtcclxuXHJcbiAgICBjb25zdCB0aGVybW9tZXRlclJhbmdlID0gbmV3IFJhbmdlKCBtaW5UZW1wZXJhdHVyZSwgbWF4VGVtcGVyYXR1cmUgKTtcclxuXHJcbiAgICAvLyBDcmVhdGUgYSBzaGFkZWQgc3BoZXJlIHRvIGFjdCBhcyB0aGUgYnVsYiBmbHVpZFxyXG4gICAgY29uc3QgYnVsYkZsdWlkRGlhbWV0ZXIgPSBvcHRpb25zLmJ1bGJEaWFtZXRlciAtIG9wdGlvbnMuZ2xhc3NUaGlja25lc3MgLSBvcHRpb25zLmxpbmVXaWR0aCAvIDI7XHJcbiAgICBjb25zdCBidWxiRmx1aWROb2RlID0gbmV3IFNoYWRlZFNwaGVyZU5vZGUoIGJ1bGJGbHVpZERpYW1ldGVyLCB7XHJcbiAgICAgIGNlbnRlclg6IEJVTEJfQ0VOVEVSX1gsXHJcbiAgICAgIGNlbnRlclk6IEJVTEJfQ0VOVEVSX1ksXHJcbiAgICAgIG1haW5Db2xvcjogb3B0aW9ucy5mbHVpZE1haW5Db2xvcixcclxuICAgICAgaGlnaGxpZ2h0Q29sb3I6IG9wdGlvbnMuZmx1aWRIaWdobGlnaHRDb2xvcixcclxuICAgICAgaGlnaGxpZ2h0WE9mZnNldDogLTAuMixcclxuICAgICAgaGlnaGxpZ2h0WU9mZnNldDogMC4yLFxyXG4gICAgICByb3RhdGlvbjogTWF0aC5QSSAvIDJcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBBbmdsZXMgZm9yIHRoZSBvdXRsaW5lIG9mIHRoZSBidWxiXHJcbiAgICBjb25zdCBidWxiU3RhcnRBbmdsZSA9IC1NYXRoLmFjb3MoIG9wdGlvbnMudHViZVdpZHRoIC8gb3B0aW9ucy5idWxiRGlhbWV0ZXIgKTtcclxuICAgIGNvbnN0IGJ1bGJFbmRBbmdsZSA9IE1hdGguUEkgLSBidWxiU3RhcnRBbmdsZTtcclxuXHJcbiAgICAvLyBDcmVhdGUgdGhlIG91dGxpbmUgZm9yIHRoZSB0aGVybW9tZXRlciwgc3RhcnRpbmcgd2l0aCB0aGUgYnVsYlxyXG4gICAgY29uc3QgdHViZVRvcFJhZGl1cyA9IG9wdGlvbnMudHViZVdpZHRoIC8gMjtcclxuICAgIGNvbnN0IHN0cmFpZ2h0VHViZUhlaWdodCA9IG9wdGlvbnMudHViZUhlaWdodCAtIHR1YmVUb3BSYWRpdXM7XHJcbiAgICBjb25zdCBzdHJhaWdodFR1YmVUb3AgPSBCVUxCX0NFTlRFUl9ZIC0gKCBvcHRpb25zLmJ1bGJEaWFtZXRlciAvIDIgKSAtIHN0cmFpZ2h0VHViZUhlaWdodDtcclxuICAgIGNvbnN0IHN0cmFpZ2h0VHViZUxlZnQgPSBCVUxCX0NFTlRFUl9YIC0gKCBvcHRpb25zLnR1YmVXaWR0aCAvIDIgKTtcclxuXHJcbiAgICBjb25zdCBvdXRsaW5lU2hhcGUgPSBuZXcgU2hhcGUoKVxyXG4gICAgICAuYXJjKCBCVUxCX0NFTlRFUl9YLCBCVUxCX0NFTlRFUl9ZLCBvcHRpb25zLmJ1bGJEaWFtZXRlciAvIDIsIGJ1bGJTdGFydEFuZ2xlLCBidWxiRW5kQW5nbGUgKSAvLyBidWxiIGF0IGJvdHRvbVxyXG4gICAgICAuYXJjKCBCVUxCX0NFTlRFUl9YLCBzdHJhaWdodFR1YmVUb3AsIHR1YmVUb3BSYWRpdXMsIE1hdGguUEksIDAgKSAvLyByb3VuZGVkIHRvcCBvZiB0dWJlXHJcbiAgICAgIC5jbG9zZSgpO1xyXG5cclxuICAgIGNvbnN0IG91dGxpbmVOb2RlID0gbmV3IFBhdGgoIG91dGxpbmVTaGFwZSwge1xyXG4gICAgICBzdHJva2U6IG9wdGlvbnMub3V0bGluZVN0cm9rZSxcclxuICAgICAgbGluZVdpZHRoOiBvcHRpb25zLmxpbmVXaWR0aFxyXG4gICAgfSApO1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggb3V0bGluZU5vZGUuaGVpZ2h0ID09PSBvcHRpb25zLnR1YmVIZWlnaHQgKyBvcHRpb25zLmJ1bGJEaWFtZXRlciArIG9wdGlvbnMubGluZVdpZHRoICk7IC8vIHNlZSBzY2VuZXJ5LXBoZXQjMTM2XHJcblxyXG4gICAgY29uc3QgdHViZUZsdWlkV2lkdGggPSBvcHRpb25zLnR1YmVXaWR0aCAtIG9wdGlvbnMuZ2xhc3NUaGlja25lc3MgLSBvcHRpb25zLmxpbmVXaWR0aCAvIDI7XHJcbiAgICBjb25zdCB0dWJlRmx1aWRSYWRpdXMgPSB0dWJlRmx1aWRXaWR0aCAvIDI7XHJcbiAgICBjb25zdCBjbGlwQnVsYlJhZGl1cyA9ICggb3B0aW9ucy5idWxiRGlhbWV0ZXIgLSBvcHRpb25zLmdsYXNzVGhpY2tuZXNzIC0gb3B0aW9ucy5saW5lV2lkdGggLyAyICkgLyAyO1xyXG4gICAgY29uc3QgY2xpcFN0YXJ0QW5nbGUgPSAtTWF0aC5hY29zKCB0dWJlRmx1aWRSYWRpdXMgLyBjbGlwQnVsYlJhZGl1cyApO1xyXG4gICAgY29uc3QgY2xpcEVuZEFuZ2xlID0gTWF0aC5QSSAtIGNsaXBTdGFydEFuZ2xlO1xyXG4gICAgY29uc3QgdHViZUZsdWlkQm90dG9tID0gKCBidWxiRmx1aWREaWFtZXRlciAvIDIgKSAqIE1hdGguc2luKCBjbGlwRW5kQW5nbGUgKTtcclxuICAgIGNvbnN0IHR1YmVGbHVpZExlZnQgPSAtdHViZUZsdWlkUmFkaXVzO1xyXG5cclxuICAgIC8vIENsaXAgYXJlYSBmb3IgdGhlIGZsdWlkIGluIHRoZSB0dWJlLCByb3VuZCBhdCB0aGUgdG9wXHJcbiAgICBjb25zdCBmbHVpZENsaXBBcmVhID0gbmV3IFNoYXBlKClcclxuICAgICAgLm1vdmVUbyggdHViZUZsdWlkTGVmdCwgdHViZUZsdWlkQm90dG9tICsgRkxVSURfT1ZFUkxBUCApXHJcbiAgICAgIC5hcmMoIEJVTEJfQ0VOVEVSX1gsIHN0cmFpZ2h0VHViZVRvcCwgdHViZUZsdWlkUmFkaXVzLCBNYXRoLlBJLCAwICkgLy8gcm91bmQgdG9wXHJcbiAgICAgIC5saW5lVG8oIC10dWJlRmx1aWRMZWZ0LCB0dWJlRmx1aWRCb3R0b20gKyBGTFVJRF9PVkVSTEFQIClcclxuICAgICAgLmNsb3NlKCk7XHJcblxyXG4gICAgLy8gQ2xpcCB0aGUgdG9wIG9mIHRoZSBidWxiIHNvIGl0J3MgZmxhdCB3aGVyZSBpdCBjb25uZWN0cyB0byB0aGUgdHViZVxyXG4gICAgY29uc3QgYnVsYkZsdWlkQ2xpcEFyZWEgPSBTaGFwZS5yZWN0YW5nbGUoXHJcbiAgICAgIHR1YmVGbHVpZEJvdHRvbSxcclxuICAgICAgQlVMQl9DRU5URVJfWSAtIG9wdGlvbnMuYnVsYkRpYW1ldGVyIC8gMixcclxuICAgICAgb3B0aW9ucy5idWxiRGlhbWV0ZXIsXHJcbiAgICAgIG9wdGlvbnMuYnVsYkRpYW1ldGVyXHJcbiAgICApO1xyXG4gICAgYnVsYkZsdWlkTm9kZS5zZXRDbGlwQXJlYSggYnVsYkZsdWlkQ2xpcEFyZWEgKTtcclxuXHJcbiAgICAvLyBHcmFkaWVudCBmb3IgZmx1aWQgaW4gdHViZVxyXG4gICAgY29uc3QgdHViZUZsdWlkR3JhZGllbnQgPSBuZXcgTGluZWFyR3JhZGllbnQoIHR1YmVGbHVpZExlZnQsIDAsIHR1YmVGbHVpZExlZnQgKyB0dWJlRmx1aWRXaWR0aCwgMCApXHJcbiAgICAgIC5hZGRDb2xvclN0b3AoIDAsIG9wdGlvbnMuZmx1aWRNYWluQ29sb3IgKVxyXG4gICAgICAuYWRkQ29sb3JTdG9wKCAwLjQsIG9wdGlvbnMuZmx1aWRIaWdobGlnaHRDb2xvciApXHJcbiAgICAgIC5hZGRDb2xvclN0b3AoIDAuNSwgb3B0aW9ucy5mbHVpZEhpZ2hsaWdodENvbG9yIClcclxuICAgICAgLmFkZENvbG9yU3RvcCggMSwgb3B0aW9ucy5mbHVpZE1haW5Db2xvciApO1xyXG5cclxuICAgIC8vIEZsdWlkIGluIHRoZSB0dWJlIChjb3JyZWN0IHNpemUgc2V0IGxhdGVyKVxyXG4gICAgY29uc3QgdHViZUZsdWlkTm9kZSA9IG5ldyBSZWN0YW5nbGUoIDAsIDAsIHR1YmVGbHVpZFdpZHRoLCAwLCB7XHJcbiAgICAgIGZpbGw6IHR1YmVGbHVpZEdyYWRpZW50LFxyXG4gICAgICBjbGlwQXJlYTogZmx1aWRDbGlwQXJlYVxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIG92ZXJyaWRlIHRpY2sgc3BhY2luZyBvcHRpb25zIHdoZW4gdXNpbmcgdGlja1NwYWNpbmdUZW1wZXJhdHVyZVxyXG4gICAgbGV0IG9mZnNldCA9IG9wdGlvbnMudGlja1NwYWNpbmc7IC8vIGRpc3RhbmNlIGJldHdlZW4gcG9zaXRpb24gb2YgbWluVGVtcCBhbmQgZmlyc3QgdGlja1xyXG4gICAgbGV0IG1pbm9yT2Zmc2V0ID0gMDsgLy8gYm9vbCAoYXMgbnVtYmVyKSBpbmRpY2F0aW5nIHdoZXJlIGZpcnN0IG1pbm9yIHRpY2sgaXMgcGxhY2VkXHJcbiAgICBpZiAoIG9wdGlvbnMudGlja1NwYWNpbmdUZW1wZXJhdHVyZSAhPT0gbnVsbCApIHtcclxuICAgICAgY29uc3Qgc2NhbGVUZW1wWSA9ICggb3B0aW9ucy50dWJlSGVpZ2h0ICsgb3B0aW9ucy5saW5lV2lkdGggKSAvICggbWF4VGVtcGVyYXR1cmUgLSBtaW5UZW1wZXJhdHVyZSApO1xyXG4gICAgICBjb25zdCBvZmZzZXRUZW1wID0gb3B0aW9ucy50aWNrU3BhY2luZ1RlbXBlcmF0dXJlIC0gKCBtaW5UZW1wZXJhdHVyZSAlIG9wdGlvbnMudGlja1NwYWNpbmdUZW1wZXJhdHVyZSApO1xyXG4gICAgICBvZmZzZXQgPSBvZmZzZXRUZW1wICogc2NhbGVUZW1wWTtcclxuICAgICAgbWlub3JPZmZzZXQgPSAoICggbWluVGVtcGVyYXR1cmUgKyBvZmZzZXRUZW1wICkgJSAoIG9wdGlvbnMudGlja1NwYWNpbmdUZW1wZXJhdHVyZSAqIDIgKSApICUgMjtcclxuICAgICAgb3B0aW9ucy50aWNrU3BhY2luZyA9IG9wdGlvbnMudGlja1NwYWNpbmdUZW1wZXJhdHVyZSAqIHNjYWxlVGVtcFk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gdGljayBtYXJrcywgZnJvbSBib3R0b20gdXAsIGFsdGVybmF0aW5nIG1ham9yIGFuZCBtaW5vciB0aWNrc1xyXG4gICAgZm9yICggbGV0IGkgPSAwOyBpICogb3B0aW9ucy50aWNrU3BhY2luZyArIG9mZnNldCA8PSBvcHRpb25zLnR1YmVIZWlnaHQgLSAoIHR1YmVUb3BSYWRpdXMgLyAzICk7IGkrKyApIHtcclxuICAgICAgb3V0bGluZVNoYXBlLm1vdmVUbyhcclxuICAgICAgICBzdHJhaWdodFR1YmVMZWZ0LFxyXG4gICAgICAgIHR1YmVGbHVpZEJvdHRvbSAtICggaSAqIG9wdGlvbnMudGlja1NwYWNpbmcgKSAtIG9mZnNldFxyXG4gICAgICApO1xyXG4gICAgICBvdXRsaW5lU2hhcGUuaG9yaXpvbnRhbExpbmVUbyhcclxuICAgICAgICBzdHJhaWdodFR1YmVMZWZ0ICsgKCAoIGkgJSAyID09PSBtaW5vck9mZnNldCApID8gb3B0aW9ucy5taW5vclRpY2tMZW5ndGggOiBvcHRpb25zLm1ham9yVGlja0xlbmd0aCApXHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQmFja2dyb3VuZCBpbnNpZGUgdGhlIHR1YmVcclxuICAgIGlmICggb3B0aW9ucy5iYWNrZ3JvdW5kRmlsbCApIHtcclxuICAgICAgdGhpcy5hZGRDaGlsZCggbmV3IFBhdGgoIG91dGxpbmVTaGFwZSwgeyBmaWxsOiBvcHRpb25zLmJhY2tncm91bmRGaWxsIH0gKSApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEFkZCBvdGhlciBub2RlcyBhZnRlciBvcHRpb25hbCBiYWNrZ3JvdW5kXHJcbiAgICB0aGlzLmFkZENoaWxkKCB0dWJlRmx1aWROb2RlICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBidWxiRmx1aWROb2RlICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBvdXRsaW5lTm9kZSApO1xyXG5cclxuICAgIC8vIFRlbXBlcmF0dXJlIGRldGVybWluZXMgdGhlIGhlaWdodCBvZiB0aGUgZmx1aWQgaW4gdGhlIHR1YmVcclxuICAgIGNvbnN0IG1heEZsdWlkSGVpZ2h0ID0gbmV3IFBhdGgoIGZsdWlkQ2xpcEFyZWEgKS5oZWlnaHQ7XHJcblxyXG4gICAgbGV0IG1pbkZsdWlkSGVpZ2h0OiBudW1iZXI7XHJcbiAgICBpZiAoIG9wdGlvbnMuemVyb0xldmVsID09PSAnYnVsYkNlbnRlcicgKSB7XHJcbiAgICAgIG1pbkZsdWlkSGVpZ2h0ID0gMDtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKCBvcHRpb25zLnplcm9MZXZlbCA9PT0gJ2J1bGJUb3AnICkge1xyXG4gICAgICBtaW5GbHVpZEhlaWdodCA9IC10dWJlRmx1aWRCb3R0b207XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCBgSW52YWxpZCB6ZXJvTGV2ZWw6ICR7b3B0aW9ucy56ZXJvTGV2ZWx9YCApO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMudGVtcGVyYXR1cmVMaW5lYXJGdW5jdGlvbiA9IG5ldyBMaW5lYXJGdW5jdGlvbihcclxuICAgICAgbWluVGVtcGVyYXR1cmUsXHJcbiAgICAgIG1heFRlbXBlcmF0dXJlLFxyXG4gICAgICBtaW5GbHVpZEhlaWdodCxcclxuICAgICAgbWF4Rmx1aWRIZWlnaHQgKyBtaW5GbHVpZEhlaWdodFxyXG4gICAgKTtcclxuXHJcbiAgICBjb25zdCB0ZW1wZXJhdHVyZVByb3BlcnR5T2JzZXJ2ZXIgPSAoIHRlbXBlcmF0dXJlOiBudW1iZXIgfCBudWxsICk6IHZvaWQgPT4ge1xyXG4gICAgICBjb25zdCBmbHVpZEhlaWdodCA9IHRoaXMudGVtcGVyYXR1cmVUb1lQb3MoIHRlbXBlcmF0dXJlICk7XHJcbiAgICAgIHR1YmVGbHVpZE5vZGUudmlzaWJsZSA9ICggZmx1aWRIZWlnaHQgPiAwICk7XHJcbiAgICAgIHR1YmVGbHVpZE5vZGUuc2V0UmVjdChcclxuICAgICAgICB0dWJlRmx1aWRMZWZ0LFxyXG4gICAgICAgIHR1YmVGbHVpZEJvdHRvbSAtIGZsdWlkSGVpZ2h0ICsgbWluRmx1aWRIZWlnaHQsXHJcbiAgICAgICAgdHViZUZsdWlkV2lkdGgsXHJcbiAgICAgICAgZmx1aWRIZWlnaHQgKyBGTFVJRF9PVkVSTEFQXHJcbiAgICAgICk7XHJcbiAgICB9O1xyXG5cclxuICAgIHRlbXBlcmF0dXJlUHJvcGVydHkubGluayggdGVtcGVyYXR1cmVQcm9wZXJ0eU9ic2VydmVyICk7XHJcblxyXG4gICAgY29uc3QgcGVyY2VudFByb3BlcnR5ID0gbmV3IERlcml2ZWRQcm9wZXJ0eSggWyB0ZW1wZXJhdHVyZVByb3BlcnR5IF0sIHRlbXAgPT4ge1xyXG4gICAgICByZXR1cm4gdGVtcCA9PT0gbnVsbCA/IDAgOlxyXG4gICAgICAgICAgICAgdGhlcm1vbWV0ZXJSYW5nZS5nZXROb3JtYWxpemVkVmFsdWUoIFV0aWxzLmNsYW1wKCB0ZW1wLCB0aGVybW9tZXRlclJhbmdlLm1pbiwgdGhlcm1vbWV0ZXJSYW5nZS5tYXggKSApICogMTAwO1xyXG4gICAgfSwge1xyXG4gICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtPy5jcmVhdGVUYW5kZW0oICdwZXJjZW50UHJvcGVydHknICksXHJcbiAgICAgIHBoZXRpb0RvY3VtZW50YXRpb246ICd0aGUgcGVyY2VudGFnZSBvZiB0aGUgdGhlcm1vbWV0ZXIgdGhhdCBpcyBmaWxsZWQgYnkgdGhlIGN1cnJlbnQgdGVtcGVyYXR1cmUuIElmIHRlbXBlcmF0dXJlIGlzIG51bGwsIHRoZW4gcGVyY2VudCB3aWxsIGJlIDAnLFxyXG4gICAgICBwaGV0aW9WYWx1ZVR5cGU6IE51bGxhYmxlSU8oIE51bWJlcklPIClcclxuICAgIH0gKTtcclxuXHJcbiAgICB0aGlzLm11dGF0ZSggb3B0aW9ucyApO1xyXG5cclxuICAgIHRoaXMuZGlzcG9zZVRoZXJtb21ldGVyTm9kZSA9ICgpID0+IHtcclxuICAgICAgaWYgKCB0ZW1wZXJhdHVyZVByb3BlcnR5Lmhhc0xpc3RlbmVyKCB0ZW1wZXJhdHVyZVByb3BlcnR5T2JzZXJ2ZXIgKSApIHtcclxuICAgICAgICB0ZW1wZXJhdHVyZVByb3BlcnR5LnVubGluayggdGVtcGVyYXR1cmVQcm9wZXJ0eU9ic2VydmVyICk7XHJcbiAgICAgIH1cclxuICAgICAgcGVyY2VudFByb3BlcnR5LmRpc3Bvc2UoKTtcclxuICAgIH07XHJcblxyXG4gICAgLy8gc3VwcG9ydCBmb3IgYmluZGVyIGRvY3VtZW50YXRpb24sIHN0cmlwcGVkIG91dCBpbiBidWlsZHMgYW5kIG9ubHkgcnVucyB3aGVuID9iaW5kZXIgaXMgc3BlY2lmaWVkXHJcbiAgICBhc3NlcnQgJiYgcGhldD8uY2hpcHBlcj8ucXVlcnlQYXJhbWV0ZXJzPy5iaW5kZXIgJiYgSW5zdGFuY2VSZWdpc3RyeS5yZWdpc3RlckRhdGFVUkwoICdzY2VuZXJ5LXBoZXQnLCAnVGhlcm1vbWV0ZXJOb2RlJywgdGhpcyApO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIG92ZXJyaWRlIGRpc3Bvc2UoKTogdm9pZCB7XHJcbiAgICB0aGlzLmRpc3Bvc2VUaGVybW9tZXRlck5vZGUoKTtcclxuICAgIHN1cGVyLmRpc3Bvc2UoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCB5IHBvc2l0aW9uIGF0IHRlbXBlcmF0dXJlIHRvIGFsbG93IGFjY3VyYXRlIHRpY2sgcGxhY2VtZW50XHJcbiAgICogQHBhcmFtIHRlbXBlcmF0dXJlIC0gdGVtcGVyYXR1cmUgYXQgd2hpY2ggdG8gZmluZCB5IHBvc2l0aW9uLCBudWxsIGlzIHRyZWF0ZWQgYXMgdGhlIHByb3ZpZGVkIG1pblRlbXBlcmF0dXJlXHJcbiAgICovXHJcbiAgcHVibGljIHRlbXBlcmF0dXJlVG9ZUG9zKCB0ZW1wZXJhdHVyZTogbnVtYmVyIHwgbnVsbCApOiBudW1iZXIge1xyXG5cclxuICAgIC8vIHRyZWF0IG51bGwgYXMgemVybyAtIHRoaXMgaXMgYSBcImxlZ2FjeSByZXF1aXJlbWVudFwiLCBuZWVkZWQgYnkgdGhlIFN0YXRlcyBvZiBNYXR0ZXIgc2ltc1xyXG4gICAgY29uc3QgY29tcGVuc2F0ZWRUZW1wZXJhdHVyZSA9IHRlbXBlcmF0dXJlID09PSBudWxsID8gMCA6IHRlbXBlcmF0dXJlO1xyXG5cclxuICAgIHJldHVybiB0aGlzLnRlbXBlcmF0dXJlTGluZWFyRnVuY3Rpb24uZXZhbHVhdGUoIGNvbXBlbnNhdGVkVGVtcGVyYXR1cmUgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCB0ZW1wZXJhdHVyZSBhdCB5IHBvc2l0aW9uIHRvIGFsbG93IHRlbXBlcmF0dXJlIHRodW1iIG1hcHBpbmdcclxuICAgKiBAcGFyYW0geSAtIHkgcG9zaXRpb24gb24gdGhlcm1vbWV0ZXIgbm9kZVxyXG4gICAqL1xyXG4gIHB1YmxpYyB5UG9zVG9UZW1wZXJhdHVyZSggeTogbnVtYmVyICk6IG51bWJlciB7XHJcbiAgICByZXR1cm4gdGhpcy50ZW1wZXJhdHVyZUxpbmVhckZ1bmN0aW9uLmludmVyc2UoIHkgKTtcclxuICB9XHJcbn1cclxuXHJcbnNjZW5lcnlQaGV0LnJlZ2lzdGVyKCAnVGhlcm1vbWV0ZXJOb2RlJywgVGhlcm1vbWV0ZXJOb2RlICk7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxlQUFlLE1BQU0sa0NBQWtDO0FBRTlELE9BQU9DLGNBQWMsTUFBTSxnQ0FBZ0M7QUFDM0QsT0FBT0MsS0FBSyxNQUFNLHVCQUF1QjtBQUN6QyxPQUFPQyxLQUFLLE1BQU0sdUJBQXVCO0FBQ3pDLFNBQVNDLEtBQUssUUFBUSwwQkFBMEI7QUFDaEQsT0FBT0MsZ0JBQWdCLE1BQU0sc0RBQXNEO0FBQ25GLE9BQU9DLFNBQVMsTUFBTSxpQ0FBaUM7QUFDdkQsU0FBU0MsY0FBYyxFQUFFQyxJQUFJLEVBQWVD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