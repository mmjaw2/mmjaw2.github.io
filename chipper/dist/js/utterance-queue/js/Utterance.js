// Copyright 2022-2024, University of Colorado Boulder

/**
 * An utterance to be handed off to the AlertQueue, which manages the order of accessibility alerts
 * read by a screen reader.
 *
 * An utterance to be provided to the AlertQueue. An utterance can be one of TAlertable.
 *
 * A single Utterance can be added to the utteranceQueue multiple times. This may be so that a
 * number of alerts associated with the utterance get read in order (see alert in options). Or it
 * may be that changes are being alerted rapidly from the same source. An Utterance is considered
 * "unstable" if it is being added rapidly to the utteranceQueue. By default, utterances are only
 * announced when they are "stable", and stop getting added to the queue. This will prevent
 * a large number of alerts from the same interaction from spamming the user. See related options alertStableDelay,
 * and alertMaximumDelay.
 *
 * @author Jesse Greenberg
 * @author Michael Kauzmann (PhET Interactive Simulations)
 */

import DerivedProperty from '../../axon/js/DerivedProperty.js';
import TinyProperty from '../../axon/js/TinyProperty.js';
import DynamicProperty from '../../axon/js/DynamicProperty.js';
import NumberProperty from '../../axon/js/NumberProperty.js';
import optionize from '../../phet-core/js/optionize.js';
import IOType from '../../tandem/js/types/IOType.js';
import StringIO from '../../tandem/js/types/StringIO.js';
import responseCollector from './responseCollector.js';
import ResponsePacket from './ResponsePacket.js';
import utteranceQueueNamespace from './utteranceQueueNamespace.js';
import NullableIO from '../../tandem/js/types/NullableIO.js';
import NumberIO from '../../tandem/js/types/NumberIO.js';
import OrIO from '../../tandem/js/types/OrIO.js';
import Property from '../../axon/js/Property.js';
import { isTReadOnlyProperty } from '../../axon/js/TReadOnlyProperty.js';
import Disposable from '../../axon/js/Disposable.js';

// constants
const DEFAULT_PRIORITY = 1;

// The names of Properties that can be accessed on Utterance that are AnnouncingControlProperties for specific Announcing
// features.

let globalIdCounter = 1;
class Utterance extends Disposable {
  // If the value of this Property is false, this Utterance will never be announced by an Announcer. See
  // documentation for canAnnounceImplementationProperty for implementation details and why we use a DynamicProperty.

  // If the value of this Property is false, this Utterance will never be announced by AriaLiveAnnouncer.

  // If the value of this Property is false, this Utterance will never be announced by SpeechSynthesisAnnouncer.

  // (utterance-queue-internal)

  // (utterance-queue-internal)

  // (utterance-queue-internal)

  // (utterance-queue-internal)

  // observable for the priority, can be set to change the priority of this Utterance
  // while it is still in the UtteranceQueue. See options documentation for behavior of priority.

  // the previous value of the resolved "alert". See getAlertText().

  constructor(providedOptions) {
    const options = optionize()({
      alert: null,
      predicate: function () {
        return true;
      },
      canAnnounceProperties: [],
      descriptionCanAnnounceProperties: [],
      voicingCanAnnounceProperties: [],
      alertStableDelay: 200,
      alertMaximumDelay: Number.MAX_VALUE,
      announcerOptions: {},
      priority: DEFAULT_PRIORITY
    }, providedOptions);
    super(options);
    this.id = globalIdCounter++;
    this._alert = options.alert;
    this.predicate = options.predicate;
    this.canAnnounceProperty = new AnnouncingControlProperty({
      dependentProperties: options.canAnnounceProperties
    });
    this.descriptionCanAnnounceProperty = new AnnouncingControlProperty({
      dependentProperties: options.descriptionCanAnnounceProperties
    });
    this.voicingCanAnnounceProperty = new AnnouncingControlProperty({
      dependentProperties: options.voicingCanAnnounceProperties
    });
    this.alertStableDelay = options.alertStableDelay;
    this.alertMaximumDelay = options.alertMaximumDelay;
    this.announcerOptions = options.announcerOptions;
    this.priorityProperty = new NumberProperty(options.priority);
    this.previousAlertText = null;
  }

  /**
   * @param alert
   * @param respectResponseCollectorProperties - if false, then do not listen to the value of responseCollector
   *                                              for creating the ResponsePacket conglomerate (just combine all available).
   */
  static getAlertStringFromResponsePacket(alert, respectResponseCollectorProperties) {
    const responsePacketOptions = alert.serialize();
    if (!respectResponseCollectorProperties) {
      responsePacketOptions.ignoreProperties = true;
    }
    return responseCollector.collectResponses(responsePacketOptions);
  }

  /**
   * Get the string to alert. This function has potential to run a function to generate the string. Use this with caution.
   * Most often UtteranceQueue should be the only spot calling this.
   * @param respectResponseCollectorProperties=false - if false, then do not listen to the value of responseCollector
   *                                              for creating the ResponsePacket conglomerate (just combine all that are supplied).
   */
  getAlertText(respectResponseCollectorProperties = false) {
    const alert = Utterance.alertableToText(this._alert, respectResponseCollectorProperties);
    this.previousAlertText = alert;
    return alert;
  }
  getAlert() {
    return this._alert;
  }
  get alert() {
    return this.getAlert();
  }
  set alert(alert) {
    this.setAlert(alert);
  }
  setAlert(alert) {
    this._alert = alert;
  }

  /**
   * Set the alertStableDelay time, see alertStableDelay option for more information.
   *
   * BEWARE! Why does the delay time need to be changed during the lifetime of an Utterance? It did for
   * https://github.com/phetsims/gravity-force-lab-basics/issues/146, but does it for you? Be sure there is good
   * reason changing this value.
   */
  setAlertStableDelay(delay) {
    this.alertStableDelay = delay;
  }
  toString() {
    return `Utterance_${this.id}#${this.getAlertText()}`;
  }
  toStateObject() {
    return {
      alert: NullableIO(OrIO([StringIO, NumberIO])).toStateObject(this.getAlertText())
    };
  }
  reset() {
    this.previousAlertText = null;
  }

  /**
   * Set the Properties controlling whether this Utterance can announce. All Properties must be
   * true for the alert content of this Utterance to be announced. These Properties are used in the implementation
   * of this.canAnnounceProperty. Setting new canAnnounceProperties has no impact on the listeners added to
   * this.canAnnounceProperty.
   */
  setCanAnnounceProperties(canAnnounceProperties) {
    this.canAnnounceProperty.setDependentProperties(canAnnounceProperties);
  }
  set canAnnounceProperties(canAnnounceProperties) {
    this.setCanAnnounceProperties(canAnnounceProperties);
  }
  get canAnnounceProperties() {
    return this.getCanAnnounceProperties();
  }

  /**
   * Get the Properties that control whether the alert content for this Utterance can be announced.
   * All must be true for the announcement to occur.
   */
  getCanAnnounceProperties() {
    return this.canAnnounceProperty.getDependentProperties();
  }

  /**
   * Set the Properties controlling whether this Utterance can announce to AriaLiveAnnouncer. All Properties must be
   * true for the alert content of this Utterance to be announced. These Properties are used in the implementation
   * of this.descriptionCanAnnounceProperty. Setting new descriptionCanAnnounceProperties has no impact on the
   * listeners added to this.descriptionCanAnnounceProperty. To announce to AriaLiveAnnouncer, this.canAnnounceProperty
   * must also be true
   */
  setDescriptionCanAnnounceProperties(descriptionCanAnnounceProperties) {
    this.descriptionCanAnnounceProperty.setDependentProperties(descriptionCanAnnounceProperties);
  }
  set descriptionCanAnnounceProperties(descriptionCanAnnounceProperties) {
    this.setDescriptionCanAnnounceProperties(descriptionCanAnnounceProperties);
  }
  get descriptionCanAnnounceProperties() {
    return this.getDescriptionCanAnnounceProperties();
  }

  /**
   * Get the Properties that control whether the alert content for this Utterance can be announced.
   * All must be true for the announcement to occur.
   */
  getDescriptionCanAnnounceProperties() {
    return this.descriptionCanAnnounceProperty.getDependentProperties();
  }

  /**
   * Set the Properties controlling whether this Utterance can announce to SpeechSynthesisAnnouncer. All Properties
   * must be true for the alert content of this Utterance to be announced. These Properties are used in the
   * implementation of this.voicingCanAnnounceProperty. Setting new voicingCanAnnounceProperties has no impact
   * on the listeners added to this.voicingCanAnnounceProperty. To announce to SpeechSynthesisAnnouncer,
   * this.canAnnounceProperty must also be true.
   */
  setVoicingCanAnnounceProperties(voicingCanAnnounceProperties) {
    this.voicingCanAnnounceProperty.setDependentProperties(voicingCanAnnounceProperties);
  }
  set voicingCanAnnounceProperties(voicingCanAnnounceProperties) {
    this.setVoicingCanAnnounceProperties(voicingCanAnnounceProperties);
  }
  get voicingCanAnnounceProperties() {
    return this.getVoicingCanAnnounceProperties();
  }

  /**
   * Get the Properties that control whether the alert content for this Utterance can be announced.
   * All must be true for the announcement to occur.
   */
  getVoicingCanAnnounceProperties() {
    return this.voicingCanAnnounceProperty.getDependentProperties();
  }

  /**
   * Make eligible for garbage collection.
   */
  dispose() {
    this.canAnnounceProperty.dispose();
    this.descriptionCanAnnounceProperty.dispose();
    this.voicingCanAnnounceProperty.dispose();
    this.priorityProperty.dispose();
    super.dispose();
  }

  /**
   * @param alertable
   * @param respectResponseCollectorProperties=false - if false, then do not listen to the value of responseCollector
   *                                              for creating the ResponsePacket conglomerate (just combine all that are supplied).
   */
  static alertableToText(alertable, respectResponseCollectorProperties = false) {
    let alert;
    if (typeof alertable === 'function') {
      alert = alertable();
    } else if (alertable instanceof ResponsePacket) {
      alert = Utterance.getAlertStringFromResponsePacket(alertable, respectResponseCollectorProperties);
    } else if (alertable instanceof Utterance) {
      return alertable.getAlertText(respectResponseCollectorProperties);
    } else if (isTReadOnlyProperty(alertable)) {
      alert = alertable.value;
    } else {
      // Nothing to process from the TAlertable, it is raw content
      alert = alertable;
    }
    return alert;
  }

  // Priority levels that can be used by Utterances providing the `announcerOptions.priority` option.
  static TOP_PRIORITY = 10;
  static HIGH_PRIORITY = 5;
  static MEDIUM_PRIORITY = 2;
  static DEFAULT_PRIORITY = DEFAULT_PRIORITY;
  static LOW_PRIORITY = 0;
  static UtteranceIO = new IOType('UtteranceIO', {
    valueType: Utterance,
    documentation: 'Announces text to a specific browser technology (like aria-live or web speech)',
    toStateObject: utterance => utterance.toStateObject(),
    stateSchema: {
      alert: NullableIO(OrIO([StringIO, NumberIO]))
    }
  });
}
class AnnouncingControlProperty extends DynamicProperty {
  // List of Properties that must all be true in order for the Utterance to be announced by the Announcer.

  // A Property for the DynamicProperty. The value of this Property is the DerivedProperty.and of all
  // canAnnounceProperties. The benefit of using a DynamicProperty is that dependency Properties of the
  // implementation can change (new DerivedProperty in setDependentProperties) but the listeners will remain
  // unaffected on the canAnnounceProperty.

  constructor(providedOptions) {
    const options = optionize()({
      dependentProperties: []
    }, providedOptions);
    const implementationProperty = new Property(new TinyProperty(false));
    super(implementationProperty);
    this._dependentProperties = [];
    this.implementationProperty = implementationProperty;
    this.setDependentProperties(options.dependentProperties);
  }

  /**
   * Set the Properties controlling this Property's value. All Properties must be true for this Property to be true.
   */
  setDependentProperties(dependentProperties) {
    if (this.implementationProperty.value) {
      this.implementationProperty.value.dispose();
    }

    // If no dependentProperties provided, use a dummy Property that will always allow this Utterance to announce.
    const dependencyProperties = dependentProperties.length === 0 ? [new TinyProperty(true)] : dependentProperties;
    this.implementationProperty.value = DerivedProperty.and(dependencyProperties);
    this._dependentProperties = dependentProperties;
  }
  set dependentProperties(dependentProperties) {
    this.setDependentProperties(dependentProperties);
  }
  get dependentProperties() {
    return this.getDependentProperties();
  }

  /**
   * Get the Properties that control whether the alert content for this Utterance can be announced.
   * All must be true for the announcement to occur.
   */
  getDependentProperties() {
    return this._dependentProperties.slice(0); // defensive copy
  }
  dispose() {
    this.implementationProperty.dispose();
    this._dependentProperties = [];
    super.dispose();
  }
}
utteranceQueueNamespace.register('Utterance', Utterance);
export default Utterance;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEZXJpdmVkUHJvcGVydHkiLCJUaW55UHJvcGVydHkiLCJEeW5hbWljUHJvcGVydHkiLCJOdW1iZXJQcm9wZXJ0eSIsIm9wdGlvbml6ZSIsIklPVHlwZSIsIlN0cmluZ0lPIiwicmVzcG9uc2VDb2xsZWN0b3IiLCJSZXNwb25zZVBhY2tldCIsInV0dGVyYW5jZVF1ZXVlTmFtZXNwYWNlIiwiTnVsbGFibGVJTyIsIk51bWJlcklPIiwiT3JJTyIsIlByb3BlcnR5IiwiaXNUUmVhZE9ubHlQcm9wZXJ0eSIsIkRpc3Bvc2FibGUiLCJERUZBVUxUX1BSSU9SSVRZIiwiZ2xvYmFsSWRDb3VudGVyIiwiVXR0ZXJhbmNlIiwiY29uc3RydWN0b3IiLCJwcm92aWRlZE9wdGlvbnMiLCJvcHRpb25zIiwiYWxlcnQiLCJwcmVkaWNhdGUiLCJjYW5Bbm5vdW5jZVByb3BlcnRpZXMiLCJkZXNjcmlwdGlvbkNhbkFubm91bmNlUHJvcGVydGllcyIsInZvaWNpbmdDYW5Bbm5vdW5jZVByb3BlcnRpZXMiLCJhbGVydFN0YWJsZURlbGF5IiwiYWxlcnRNYXhpbXVtRGVsYXkiLCJOdW1iZXIiLCJNQVhfVkFMVUUiLCJhbm5vdW5jZXJPcHRpb25zIiwicHJpb3JpdHkiLCJpZCIsIl9hbGVydCIsImNhbkFubm91bmNlUHJvcGVydHkiLCJBbm5vdW5jaW5nQ29udHJvbFByb3BlcnR5IiwiZGVwZW5kZW50UHJvcGVydGllcyIsImRlc2NyaXB0aW9uQ2FuQW5ub3VuY2VQcm9wZXJ0eSIsInZvaWNpbmdDYW5Bbm5vdW5jZVByb3BlcnR5IiwicHJpb3JpdHlQcm9wZXJ0eSIsInByZXZpb3VzQWxlcnRUZXh0IiwiZ2V0QWxlcnRTdHJpbmdGcm9tUmVzcG9uc2VQYWNrZXQiLCJyZXNwZWN0UmVzcG9uc2VDb2xsZWN0b3JQcm9wZXJ0aWVzIiwicmVzcG9uc2VQYWNrZXRPcHRpb25zIiwic2VyaWFsaXplIiwiaWdub3JlUHJvcGVydGllcyIsImNvbGxlY3RSZXNwb25zZXMiLCJnZXRBbGVydFRleHQiLCJhbGVydGFibGVUb1RleHQiLCJnZXRBbGVydCIsInNldEFsZXJ0Iiwic2V0QWxlcnRTdGFibGVEZWxheSIsImRlbGF5IiwidG9TdHJpbmciLCJ0b1N0YXRlT2JqZWN0IiwicmVzZXQiLCJzZXRDYW5Bbm5vdW5jZVByb3BlcnRpZXMiLCJzZXREZXBlbmRlbnRQcm9wZXJ0aWVzIiwiZ2V0Q2FuQW5ub3VuY2VQcm9wZXJ0aWVzIiwiZ2V0RGVwZW5kZW50UHJvcGVydGllcyIsInNldERlc2NyaXB0aW9uQ2FuQW5ub3VuY2VQcm9wZXJ0aWVzIiwiZ2V0RGVzY3JpcHRpb25DYW5Bbm5vdW5jZVByb3BlcnRpZXMiLCJzZXRWb2ljaW5nQ2FuQW5ub3VuY2VQcm9wZXJ0aWVzIiwiZ2V0Vm9pY2luZ0NhbkFubm91bmNlUHJvcGVydGllcyIsImRpc3Bvc2UiLCJhbGVydGFibGUiLCJ2YWx1ZSIsIlRPUF9QUklPUklUWSIsIkhJR0hfUFJJT1JJVFkiLCJNRURJVU1fUFJJT1JJVFkiLCJMT1dfUFJJT1JJVFkiLCJVdHRlcmFuY2VJTyIsInZhbHVlVHlwZSIsImRvY3VtZW50YXRpb24iLCJ1dHRlcmFuY2UiLCJzdGF0ZVNjaGVtYSIsImltcGxlbWVudGF0aW9uUHJvcGVydHkiLCJfZGVwZW5kZW50UHJvcGVydGllcyIsImRlcGVuZGVuY3lQcm9wZXJ0aWVzIiwibGVuZ3RoIiwiYW5kIiwic2xpY2UiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIlV0dGVyYW5jZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAyMi0yMDI0LCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBBbiB1dHRlcmFuY2UgdG8gYmUgaGFuZGVkIG9mZiB0byB0aGUgQWxlcnRRdWV1ZSwgd2hpY2ggbWFuYWdlcyB0aGUgb3JkZXIgb2YgYWNjZXNzaWJpbGl0eSBhbGVydHNcclxuICogcmVhZCBieSBhIHNjcmVlbiByZWFkZXIuXHJcbiAqXHJcbiAqIEFuIHV0dGVyYW5jZSB0byBiZSBwcm92aWRlZCB0byB0aGUgQWxlcnRRdWV1ZS4gQW4gdXR0ZXJhbmNlIGNhbiBiZSBvbmUgb2YgVEFsZXJ0YWJsZS5cclxuICpcclxuICogQSBzaW5nbGUgVXR0ZXJhbmNlIGNhbiBiZSBhZGRlZCB0byB0aGUgdXR0ZXJhbmNlUXVldWUgbXVsdGlwbGUgdGltZXMuIFRoaXMgbWF5IGJlIHNvIHRoYXQgYVxyXG4gKiBudW1iZXIgb2YgYWxlcnRzIGFzc29jaWF0ZWQgd2l0aCB0aGUgdXR0ZXJhbmNlIGdldCByZWFkIGluIG9yZGVyIChzZWUgYWxlcnQgaW4gb3B0aW9ucykuIE9yIGl0XHJcbiAqIG1heSBiZSB0aGF0IGNoYW5nZXMgYXJlIGJlaW5nIGFsZXJ0ZWQgcmFwaWRseSBmcm9tIHRoZSBzYW1lIHNvdXJjZS4gQW4gVXR0ZXJhbmNlIGlzIGNvbnNpZGVyZWRcclxuICogXCJ1bnN0YWJsZVwiIGlmIGl0IGlzIGJlaW5nIGFkZGVkIHJhcGlkbHkgdG8gdGhlIHV0dGVyYW5jZVF1ZXVlLiBCeSBkZWZhdWx0LCB1dHRlcmFuY2VzIGFyZSBvbmx5XHJcbiAqIGFubm91bmNlZCB3aGVuIHRoZXkgYXJlIFwic3RhYmxlXCIsIGFuZCBzdG9wIGdldHRpbmcgYWRkZWQgdG8gdGhlIHF1ZXVlLiBUaGlzIHdpbGwgcHJldmVudFxyXG4gKiBhIGxhcmdlIG51bWJlciBvZiBhbGVydHMgZnJvbSB0aGUgc2FtZSBpbnRlcmFjdGlvbiBmcm9tIHNwYW1taW5nIHRoZSB1c2VyLiBTZWUgcmVsYXRlZCBvcHRpb25zIGFsZXJ0U3RhYmxlRGVsYXksXHJcbiAqIGFuZCBhbGVydE1heGltdW1EZWxheS5cclxuICpcclxuICogQGF1dGhvciBKZXNzZSBHcmVlbmJlcmdcclxuICogQGF1dGhvciBNaWNoYWVsIEthdXptYW5uIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKi9cclxuXHJcbmltcG9ydCBEZXJpdmVkUHJvcGVydHkgZnJvbSAnLi4vLi4vYXhvbi9qcy9EZXJpdmVkUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgVGlueVByb3BlcnR5IGZyb20gJy4uLy4uL2F4b24vanMvVGlueVByb3BlcnR5LmpzJztcclxuaW1wb3J0IER5bmFtaWNQcm9wZXJ0eSwgeyBEeW5hbWljUHJvcGVydHlPcHRpb25zIH0gZnJvbSAnLi4vLi4vYXhvbi9qcy9EeW5hbWljUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgTnVtYmVyUHJvcGVydHkgZnJvbSAnLi4vLi4vYXhvbi9qcy9OdW1iZXJQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBvcHRpb25pemUgZnJvbSAnLi4vLi4vcGhldC1jb3JlL2pzL29wdGlvbml6ZS5qcyc7XHJcbmltcG9ydCBJT1R5cGUgZnJvbSAnLi4vLi4vdGFuZGVtL2pzL3R5cGVzL0lPVHlwZS5qcyc7XHJcbmltcG9ydCBTdHJpbmdJTyBmcm9tICcuLi8uLi90YW5kZW0vanMvdHlwZXMvU3RyaW5nSU8uanMnO1xyXG5pbXBvcnQgcmVzcG9uc2VDb2xsZWN0b3IgZnJvbSAnLi9yZXNwb25zZUNvbGxlY3Rvci5qcyc7XHJcbmltcG9ydCBSZXNwb25zZVBhY2tldCwgeyBSZXNvbHZlZFJlc3BvbnNlIH0gZnJvbSAnLi9SZXNwb25zZVBhY2tldC5qcyc7XHJcbmltcG9ydCB1dHRlcmFuY2VRdWV1ZU5hbWVzcGFjZSBmcm9tICcuL3V0dGVyYW5jZVF1ZXVlTmFtZXNwYWNlLmpzJztcclxuaW1wb3J0IFRQcm9wZXJ0eSBmcm9tICcuLi8uLi9heG9uL2pzL1RQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBOdWxsYWJsZUlPIGZyb20gJy4uLy4uL3RhbmRlbS9qcy90eXBlcy9OdWxsYWJsZUlPLmpzJztcclxuaW1wb3J0IE51bWJlcklPIGZyb20gJy4uLy4uL3RhbmRlbS9qcy90eXBlcy9OdW1iZXJJTy5qcyc7XHJcbmltcG9ydCBPcklPIGZyb20gJy4uLy4uL3RhbmRlbS9qcy90eXBlcy9PcklPLmpzJztcclxuaW1wb3J0IFByb3BlcnR5IGZyb20gJy4uLy4uL2F4b24vanMvUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgVFJlYWRPbmx5UHJvcGVydHksIHsgaXNUUmVhZE9ubHlQcm9wZXJ0eSB9IGZyb20gJy4uLy4uL2F4b24vanMvVFJlYWRPbmx5UHJvcGVydHkuanMnO1xyXG5pbXBvcnQgRGlzcG9zYWJsZSwgeyBEaXNwb3NhYmxlT3B0aW9ucyB9IGZyb20gJy4uLy4uL2F4b24vanMvRGlzcG9zYWJsZS5qcyc7XHJcblxyXG4vLyBjb25zdGFudHNcclxuY29uc3QgREVGQVVMVF9QUklPUklUWSA9IDE7XHJcblxyXG5leHBvcnQgdHlwZSBUQWxlcnRhYmxlID0gUmVzb2x2ZWRSZXNwb25zZSB8ICggKCkgPT4gc3RyaW5nICkgfCBUUmVhZE9ubHlQcm9wZXJ0eTxzdHJpbmc+IHwgUmVzcG9uc2VQYWNrZXQgfCBVdHRlcmFuY2U7XHJcblxyXG50eXBlIEFsZXJ0YWJsZU5vVXR0ZXJhbmNlID0gRXhjbHVkZTxUQWxlcnRhYmxlLCBVdHRlcmFuY2U+O1xyXG5cclxudHlwZSBTZXJpYWxpemVkVXR0ZXJhbmNlID0ge1xyXG4gIGFsZXJ0OiBSZXNvbHZlZFJlc3BvbnNlO1xyXG59O1xyXG5cclxuLy8gVGhlIG5hbWVzIG9mIFByb3BlcnRpZXMgdGhhdCBjYW4gYmUgYWNjZXNzZWQgb24gVXR0ZXJhbmNlIHRoYXQgYXJlIEFubm91bmNpbmdDb250cm9sUHJvcGVydGllcyBmb3Igc3BlY2lmaWMgQW5ub3VuY2luZ1xyXG4vLyBmZWF0dXJlcy5cclxuZXhwb3J0IHR5cGUgRmVhdHVyZVNwZWNpZmljQW5ub3VuY2luZ0NvbnRyb2xQcm9wZXJ0eSA9ICdkZXNjcmlwdGlvbkNhbkFubm91bmNlUHJvcGVydHknIHwgJ3ZvaWNpbmdDYW5Bbm5vdW5jZVByb3BlcnR5JztcclxuXHJcbnR5cGUgRmVhdHVyZVNwZWNpZmljQW5ub3VuY2luZ0NvbnRyb2xQcm9wZXJ0eVN1cHBvcnRlZCA9IHtcclxuICBbUHJvcGVydHkgaW4gRmVhdHVyZVNwZWNpZmljQW5ub3VuY2luZ0NvbnRyb2xQcm9wZXJ0eV06IEFubm91bmNpbmdDb250cm9sUHJvcGVydHlcclxufTtcclxuXHJcbmxldCBnbG9iYWxJZENvdW50ZXIgPSAxO1xyXG5cclxudHlwZSBTZWxmT3B0aW9ucyA9IHtcclxuXHJcbiAgLy8gVGhlIGNvbnRlbnQgb2YgdGhlIGFsZXJ0IHRoYXQgdGhpcyBVdHRlcmFuY2UgaXMgd3JhcHBpbmcuXHJcbiAgYWxlcnQ/OiBBbGVydGFibGVOb1V0dGVyYW5jZTtcclxuXHJcbiAgLy8gTGlzdCBvZiBQcm9wZXJ0aWVzIHRoYXQgbXVzdCBhbGwgYmUgdHJ1ZSBpbiBvcmRlciBmb3IgdGhlIFV0dGVyYW5jZSB0byBiZSBhbm5vdW5jZWQgYnkgdGhlIEFubm91bmNlci4gU2VlXHJcbiAgLy8gc2V0Q2FuQW5ub3VuY2VQcm9wZXJ0aWVzKCkgZm9yIG1vcmUgaW5mb3JtYXRpb24uXHJcbiAgY2FuQW5ub3VuY2VQcm9wZXJ0aWVzPzogVFJlYWRPbmx5UHJvcGVydHk8Ym9vbGVhbj5bXTtcclxuXHJcbiAgLy8gTGlzdCBvZiBQcm9wZXJ0aWVzIHRoYXQgbXVzdCBhbGwgYmUgdHJ1ZSBpbiBvcmRlciBmb3IgdGhlIFV0dGVyYW5jZSB0byBiZSBhbm5vdW5jZWQgdG8gdGhlIEludGVyYWN0aXZlIERlc2NyaXB0aW9uXHJcbiAgLy8gZmVhdHVyZSBvZiBQaEVUIFNpbXVsYXRpb25zLiBjYW5Bbm5vdW5jZVByb3BlcnRpZXMgYWxzbyBhcHBseSAoYW5kIHNvIG11c3QgYWxsIGJlIHRydWUpIHRvIGFubm91bmNlIHdpdGggdGhpc1xyXG4gIC8vIHNwZWNpZmljIGZlYXR1cmUuXHJcbiAgZGVzY3JpcHRpb25DYW5Bbm5vdW5jZVByb3BlcnRpZXM/OiBUUmVhZE9ubHlQcm9wZXJ0eTxib29sZWFuPltdO1xyXG5cclxuICAvLyBMaXN0IG9mIFByb3BlcnRpZXMgdGhhdCBtdXN0IGFsbCBiZSB0cnVlIGluIG9yZGVyIGZvciB0aGUgVXR0ZXJhbmNlIHRvIGJlIGFubm91bmNlZCB0byB0aGUgVm9pY2luZ1xyXG4gIC8vIGZlYXR1cmUgb2YgUGhFVCBTaW11bGF0aW9ucy4gY2FuQW5ub3VuY2VQcm9wZXJ0aWVzIGFsc28gYXBwbHkgKGFuZCBzbyBtdXN0IGFsbCBiZSB0cnVlKSB0byBhbm5vdW5jZSB3aXRoIHRoaXNcclxuICAvLyBzcGVjaWZpYyBmZWF0dXJlLlxyXG4gIHZvaWNpbmdDYW5Bbm5vdW5jZVByb3BlcnRpZXM/OiBUUmVhZE9ubHlQcm9wZXJ0eTxib29sZWFuPltdO1xyXG5cclxuICAvLyBpZiBwcmVkaWNhdGUgcmV0dXJucyBmYWxzZSwgdGhlIGFsZXJ0IGNvbnRlbnQgYXNzb2NpYXRlZFxyXG4gIC8vIHdpdGggdGhpcyB1dHRlcmFuY2Ugd2lsbCBub3QgYmUgYW5ub3VuY2VkIGJ5IHRoZSB1dHRlcmFuY2UtcXVldWUuIEFubm91bmNlcnMgYWxzbyBvcHRpb25hbGx5IGhhdmUgdGhlIGFiaWxpdHlcclxuICAvLyB0byByZXNwZWN0IHRoaXMgcHJlZGljYXRlIGJlZm9yZSB0aGV5IGZpbmFsbHkgYWxlcnQgdGhlIFV0dGVyYW5jZS4gVGhpcyBjYW4gYmUgaGVscGZ1bCBpZiB1dHRlcmFuY2VzIHNpdCBhbmRcclxuICAvLyB3YWl0IGluIHRoZSBhbm5vdW5jZXIgYmVmb3JlIGJlaW5nIGFsZXJ0ZWQuIElmIHRoZSBwcmVkaWNhdGUgZmFpbHMgdGhlcmUgaXMgbm8gcmV0cnkuIFRoZSB1dHRlcmFuY2Ugd2lsbCBiZVxyXG4gIC8vIHJlbW92ZWQgZnJvbSB0aGUgcXVldWUgd2l0aG91dCBhbm5vdW5jaW5nLlxyXG4gIHByZWRpY2F0ZT86ICgpID0+IGJvb2xlYW47XHJcblxyXG4gIC8vIGluIG1zLCBob3cgbG9uZyB0byB3YWl0IGJlZm9yZSB0aGUgdXR0ZXJhbmNlIGlzIGNvbnNpZGVyZWQgXCJzdGFibGVcIiBhbmQgc3RvcHMgYmVpbmdcclxuICAvLyBhZGRlZCB0byB0aGUgcXVldWUsIGF0IHdoaWNoIHBvaW50IGl0IHdpbGwgYmUgc3Bva2VuLiBEZWZhdWx0IHZhbHVlIGNob3NlbiBiZWNhdXNlXHJcbiAgLy8gaXQgc291bmRzIG5pY2UgaW4gbW9zdCB1c2FnZXMgb2YgVXR0ZXJhbmNlIHdpdGggYWxlcnRTdGFibGVEZWxheS4gSWYgeW91IHdhbnQgdG8gaGVhciB0aGUgdXR0ZXJhbmNlIGFzIGZhc3RcclxuICAvLyBhcyBwb3NzaWJsZSwgcmVkdWNlIHRoaXMgZGVsYXkgdG8gMC4gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9zY2VuZXJ5LXBoZXQvaXNzdWVzLzQ5MVxyXG4gIGFsZXJ0U3RhYmxlRGVsYXk/OiBudW1iZXI7XHJcblxyXG4gIC8vIGluIG1zLCB0aGUgbWF4aW11bSBhbW91bnQgb2YgdGltZSB0aGF0IHNob3VsZFxyXG4gIC8vIHBhc3MgYmVmb3JlIHRoaXMgYWxlcnQgc2hvdWxkIGJlIHNwb2tlbiwgZXZlbiBpZiB0aGUgdXR0ZXJhbmNlIGlzIHJhcGlkbHkgYWRkZWQgdG8gdGhlIHF1ZXVlXHJcbiAgLy8gYW5kIGlzIG5vdCBxdWl0ZSBcInN0YWJsZVwiXHJcbiAgYWxlcnRNYXhpbXVtRGVsYXk/OiBudW1iZXI7XHJcblxyXG4gIC8vIE9wdGlvbnMgc3BlY2lmaWMgdG8gdGhlIEFubm91bmNlciBvZiB0aGUgVXR0ZXJhbmNlLiBTZWUgc3VwcG9ydGVkIG9wdGlvbnMgaW4geW91ciBzcGVjaWZpYyBBbm5vdW5jZXInc1xyXG4gIC8vIGFubm91bmNlKCkgZnVuY3Rpb24gKGZvciBleGFtcGxlIEFyaWFMaXZlQW5ub3VuY2VyLmFubm91bmNlKCkpXHJcbiAgYW5ub3VuY2VyT3B0aW9ucz86IFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xyXG5cclxuICAvLyB7bnVtYmVyfSAtIFVzZWQgdG8gZGV0ZXJtaW5lIHdoaWNoIHV0dGVyYW5jZSBtaWdodCBpbnRlcnJ1cHQgYW5vdGhlciB1dHRlcmFuY2UuIFBsZWFzZSBvbmx5IHVzZSBwcmlvcml0eSBzdGF0aWNzXHJcbiAgLy8gb24gVXR0ZXJhbmNlIHdoZW4gc2V0dGluZyB0aGlzIHZhbHVlIGxpa2UgVXR0ZXJhbmNlLk1FRElVTV9QUklPUklUWS5cclxuICAvLyBBbnkgdXR0ZXJhbmNlICgxKSB3aXRoIGEgaGlnaGVyIHByaW9yaXR5IHRoYW4gYW5vdGhlciB1dHRlcmFuY2UgKDIpIHdpbGwgYmVoYXZlIGFzIHN1Y2g6XHJcbiAgLy8gLSAoMSkgd2lsbCBpbnRlcnJ1cHQgKDIpIHdoZW4gKDIpIGlzIGN1cnJlbnRseSBiZWluZyBzcG9rZW4sIGFuZCAoMSkgaXMgYW5ub3VuY2VkIGJ5IHRoZSB2b2ljaW5nTWFuYWdlci4gSW4gdGhpc1xyXG4gIC8vICAgICAgIGNhc2UsICgyKSBpcyBpbnRlcnJ1cHRlZCwgYW5kIG5ldmVyIGZpbmlzaGVkLlxyXG4gIC8vIC0gKDEpIHdpbGwgY29udGludWUgc3BlYWtpbmcgaWYgKDEpIHdhcyBzcGVha2luZywgYW5kICgyKSBpcyBhZGRlZCB0byB0aGUgVXR0ZXJhbmNlUXVldWUuIEluIHRoaXMgY2FzZSAoMilcclxuICAvLyAgICAgICB3aWxsIGJlIHNwb2tlbiB3aGVuICgxKSBpcyBkb25lLiBJbiB0aGlzIGNhc2UgKDIpIHdpbGwgcmVtYWluIGluIHRoZSBxdWV1ZSB3aGlsZSB3YWl0aW5nIGZvciAoMSkgdG8gZmluaXNoLlxyXG4gIHByaW9yaXR5PzogbnVtYmVyO1xyXG59O1xyXG5cclxuZXhwb3J0IHR5cGUgVXR0ZXJhbmNlT3B0aW9ucyA9IFNlbGZPcHRpb25zICYgRGlzcG9zYWJsZU9wdGlvbnM7XHJcblxyXG5jbGFzcyBVdHRlcmFuY2UgZXh0ZW5kcyBEaXNwb3NhYmxlIGltcGxlbWVudHMgRmVhdHVyZVNwZWNpZmljQW5ub3VuY2luZ0NvbnRyb2xQcm9wZXJ0eVN1cHBvcnRlZCB7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBpZDogbnVtYmVyO1xyXG4gIHByaXZhdGUgX2FsZXJ0OiBBbGVydGFibGVOb1V0dGVyYW5jZTtcclxuXHJcbiAgLy8gSWYgdGhlIHZhbHVlIG9mIHRoaXMgUHJvcGVydHkgaXMgZmFsc2UsIHRoaXMgVXR0ZXJhbmNlIHdpbGwgbmV2ZXIgYmUgYW5ub3VuY2VkIGJ5IGFuIEFubm91bmNlci4gU2VlXHJcbiAgLy8gZG9jdW1lbnRhdGlvbiBmb3IgY2FuQW5ub3VuY2VJbXBsZW1lbnRhdGlvblByb3BlcnR5IGZvciBpbXBsZW1lbnRhdGlvbiBkZXRhaWxzIGFuZCB3aHkgd2UgdXNlIGEgRHluYW1pY1Byb3BlcnR5LlxyXG4gIHB1YmxpYyByZWFkb25seSBjYW5Bbm5vdW5jZVByb3BlcnR5OiBBbm5vdW5jaW5nQ29udHJvbFByb3BlcnR5O1xyXG5cclxuICAvLyBJZiB0aGUgdmFsdWUgb2YgdGhpcyBQcm9wZXJ0eSBpcyBmYWxzZSwgdGhpcyBVdHRlcmFuY2Ugd2lsbCBuZXZlciBiZSBhbm5vdW5jZWQgYnkgQXJpYUxpdmVBbm5vdW5jZXIuXHJcbiAgcHVibGljIHJlYWRvbmx5IGRlc2NyaXB0aW9uQ2FuQW5ub3VuY2VQcm9wZXJ0eTogQW5ub3VuY2luZ0NvbnRyb2xQcm9wZXJ0eTtcclxuXHJcbiAgLy8gSWYgdGhlIHZhbHVlIG9mIHRoaXMgUHJvcGVydHkgaXMgZmFsc2UsIHRoaXMgVXR0ZXJhbmNlIHdpbGwgbmV2ZXIgYmUgYW5ub3VuY2VkIGJ5IFNwZWVjaFN5bnRoZXNpc0Fubm91bmNlci5cclxuICBwdWJsaWMgcmVhZG9ubHkgdm9pY2luZ0NhbkFubm91bmNlUHJvcGVydHk6IEFubm91bmNpbmdDb250cm9sUHJvcGVydHk7XHJcblxyXG4gIC8vICh1dHRlcmFuY2UtcXVldWUtaW50ZXJuYWwpXHJcbiAgcHVibGljIHJlYWRvbmx5IHByZWRpY2F0ZTogKCkgPT4gYm9vbGVhbjtcclxuXHJcbiAgLy8gKHV0dGVyYW5jZS1xdWV1ZS1pbnRlcm5hbClcclxuICBwdWJsaWMgYWxlcnRTdGFibGVEZWxheTogbnVtYmVyO1xyXG5cclxuICAvLyAodXR0ZXJhbmNlLXF1ZXVlLWludGVybmFsKVxyXG4gIHB1YmxpYyBhbGVydE1heGltdW1EZWxheTogbnVtYmVyO1xyXG5cclxuICAvLyAodXR0ZXJhbmNlLXF1ZXVlLWludGVybmFsKVxyXG4gIHB1YmxpYyBhbm5vdW5jZXJPcHRpb25zOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcclxuXHJcbiAgLy8gb2JzZXJ2YWJsZSBmb3IgdGhlIHByaW9yaXR5LCBjYW4gYmUgc2V0IHRvIGNoYW5nZSB0aGUgcHJpb3JpdHkgb2YgdGhpcyBVdHRlcmFuY2VcclxuICAvLyB3aGlsZSBpdCBpcyBzdGlsbCBpbiB0aGUgVXR0ZXJhbmNlUXVldWUuIFNlZSBvcHRpb25zIGRvY3VtZW50YXRpb24gZm9yIGJlaGF2aW9yIG9mIHByaW9yaXR5LlxyXG4gIHB1YmxpYyBwcmlvcml0eVByb3BlcnR5OiBUUHJvcGVydHk8bnVtYmVyPjtcclxuXHJcbiAgLy8gdGhlIHByZXZpb3VzIHZhbHVlIG9mIHRoZSByZXNvbHZlZCBcImFsZXJ0XCIuIFNlZSBnZXRBbGVydFRleHQoKS5cclxuICBwcml2YXRlIHByZXZpb3VzQWxlcnRUZXh0OiBSZXNvbHZlZFJlc3BvbnNlO1xyXG5cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIHByb3ZpZGVkT3B0aW9ucz86IFV0dGVyYW5jZU9wdGlvbnMgKSB7XHJcblxyXG4gICAgY29uc3Qgb3B0aW9ucyA9IG9wdGlvbml6ZTxVdHRlcmFuY2VPcHRpb25zLCBTZWxmT3B0aW9ucywgRGlzcG9zYWJsZU9wdGlvbnM+KCkoIHtcclxuICAgICAgYWxlcnQ6IG51bGwsXHJcbiAgICAgIHByZWRpY2F0ZTogZnVuY3Rpb24oKSB7IHJldHVybiB0cnVlOyB9LFxyXG4gICAgICBjYW5Bbm5vdW5jZVByb3BlcnRpZXM6IFtdLFxyXG4gICAgICBkZXNjcmlwdGlvbkNhbkFubm91bmNlUHJvcGVydGllczogW10sXHJcbiAgICAgIHZvaWNpbmdDYW5Bbm5vdW5jZVByb3BlcnRpZXM6IFtdLFxyXG4gICAgICBhbGVydFN0YWJsZURlbGF5OiAyMDAsXHJcbiAgICAgIGFsZXJ0TWF4aW11bURlbGF5OiBOdW1iZXIuTUFYX1ZBTFVFLFxyXG4gICAgICBhbm5vdW5jZXJPcHRpb25zOiB7fSxcclxuICAgICAgcHJpb3JpdHk6IERFRkFVTFRfUFJJT1JJVFlcclxuICAgIH0sIHByb3ZpZGVkT3B0aW9ucyApO1xyXG5cclxuICAgIHN1cGVyKCBvcHRpb25zICk7XHJcblxyXG4gICAgdGhpcy5pZCA9IGdsb2JhbElkQ291bnRlcisrO1xyXG5cclxuICAgIHRoaXMuX2FsZXJ0ID0gb3B0aW9ucy5hbGVydDtcclxuXHJcbiAgICB0aGlzLnByZWRpY2F0ZSA9IG9wdGlvbnMucHJlZGljYXRlO1xyXG5cclxuICAgIHRoaXMuY2FuQW5ub3VuY2VQcm9wZXJ0eSA9IG5ldyBBbm5vdW5jaW5nQ29udHJvbFByb3BlcnR5KCB7XHJcbiAgICAgIGRlcGVuZGVudFByb3BlcnRpZXM6IG9wdGlvbnMuY2FuQW5ub3VuY2VQcm9wZXJ0aWVzXHJcbiAgICB9ICk7XHJcbiAgICB0aGlzLmRlc2NyaXB0aW9uQ2FuQW5ub3VuY2VQcm9wZXJ0eSA9IG5ldyBBbm5vdW5jaW5nQ29udHJvbFByb3BlcnR5KCB7XHJcbiAgICAgIGRlcGVuZGVudFByb3BlcnRpZXM6IG9wdGlvbnMuZGVzY3JpcHRpb25DYW5Bbm5vdW5jZVByb3BlcnRpZXNcclxuICAgIH0gKTtcclxuICAgIHRoaXMudm9pY2luZ0NhbkFubm91bmNlUHJvcGVydHkgPSBuZXcgQW5ub3VuY2luZ0NvbnRyb2xQcm9wZXJ0eSgge1xyXG4gICAgICBkZXBlbmRlbnRQcm9wZXJ0aWVzOiBvcHRpb25zLnZvaWNpbmdDYW5Bbm5vdW5jZVByb3BlcnRpZXNcclxuXHJcbiAgICB9ICk7XHJcbiAgICB0aGlzLmFsZXJ0U3RhYmxlRGVsYXkgPSBvcHRpb25zLmFsZXJ0U3RhYmxlRGVsYXk7XHJcblxyXG4gICAgdGhpcy5hbGVydE1heGltdW1EZWxheSA9IG9wdGlvbnMuYWxlcnRNYXhpbXVtRGVsYXk7XHJcblxyXG4gICAgdGhpcy5hbm5vdW5jZXJPcHRpb25zID0gb3B0aW9ucy5hbm5vdW5jZXJPcHRpb25zO1xyXG5cclxuICAgIHRoaXMucHJpb3JpdHlQcm9wZXJ0eSA9IG5ldyBOdW1iZXJQcm9wZXJ0eSggb3B0aW9ucy5wcmlvcml0eSApO1xyXG5cclxuICAgIHRoaXMucHJldmlvdXNBbGVydFRleHQgPSBudWxsO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIGFsZXJ0XHJcbiAgICogQHBhcmFtIHJlc3BlY3RSZXNwb25zZUNvbGxlY3RvclByb3BlcnRpZXMgLSBpZiBmYWxzZSwgdGhlbiBkbyBub3QgbGlzdGVuIHRvIHRoZSB2YWx1ZSBvZiByZXNwb25zZUNvbGxlY3RvclxyXG4gICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBjcmVhdGluZyB0aGUgUmVzcG9uc2VQYWNrZXQgY29uZ2xvbWVyYXRlIChqdXN0IGNvbWJpbmUgYWxsIGF2YWlsYWJsZSkuXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBzdGF0aWMgZ2V0QWxlcnRTdHJpbmdGcm9tUmVzcG9uc2VQYWNrZXQoIGFsZXJ0OiBSZXNwb25zZVBhY2tldCwgcmVzcGVjdFJlc3BvbnNlQ29sbGVjdG9yUHJvcGVydGllczogYm9vbGVhbiApOiBzdHJpbmcge1xyXG5cclxuICAgIGNvbnN0IHJlc3BvbnNlUGFja2V0T3B0aW9ucyA9IGFsZXJ0LnNlcmlhbGl6ZSgpO1xyXG5cclxuICAgIGlmICggIXJlc3BlY3RSZXNwb25zZUNvbGxlY3RvclByb3BlcnRpZXMgKSB7XHJcbiAgICAgIHJlc3BvbnNlUGFja2V0T3B0aW9ucy5pZ25vcmVQcm9wZXJ0aWVzID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXNwb25zZUNvbGxlY3Rvci5jb2xsZWN0UmVzcG9uc2VzKCByZXNwb25zZVBhY2tldE9wdGlvbnMgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCB0aGUgc3RyaW5nIHRvIGFsZXJ0LiBUaGlzIGZ1bmN0aW9uIGhhcyBwb3RlbnRpYWwgdG8gcnVuIGEgZnVuY3Rpb24gdG8gZ2VuZXJhdGUgdGhlIHN0cmluZy4gVXNlIHRoaXMgd2l0aCBjYXV0aW9uLlxyXG4gICAqIE1vc3Qgb2Z0ZW4gVXR0ZXJhbmNlUXVldWUgc2hvdWxkIGJlIHRoZSBvbmx5IHNwb3QgY2FsbGluZyB0aGlzLlxyXG4gICAqIEBwYXJhbSByZXNwZWN0UmVzcG9uc2VDb2xsZWN0b3JQcm9wZXJ0aWVzPWZhbHNlIC0gaWYgZmFsc2UsIHRoZW4gZG8gbm90IGxpc3RlbiB0byB0aGUgdmFsdWUgb2YgcmVzcG9uc2VDb2xsZWN0b3JcclxuICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgY3JlYXRpbmcgdGhlIFJlc3BvbnNlUGFja2V0IGNvbmdsb21lcmF0ZSAoanVzdCBjb21iaW5lIGFsbCB0aGF0IGFyZSBzdXBwbGllZCkuXHJcbiAgICovXHJcbiAgcHVibGljIGdldEFsZXJ0VGV4dCggcmVzcGVjdFJlc3BvbnNlQ29sbGVjdG9yUHJvcGVydGllcyA9IGZhbHNlICk6IFJlc29sdmVkUmVzcG9uc2Uge1xyXG5cclxuICAgIGNvbnN0IGFsZXJ0ID0gVXR0ZXJhbmNlLmFsZXJ0YWJsZVRvVGV4dCggdGhpcy5fYWxlcnQsIHJlc3BlY3RSZXNwb25zZUNvbGxlY3RvclByb3BlcnRpZXMgKTtcclxuXHJcbiAgICB0aGlzLnByZXZpb3VzQWxlcnRUZXh0ID0gYWxlcnQ7XHJcbiAgICByZXR1cm4gYWxlcnQ7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0QWxlcnQoKTogQWxlcnRhYmxlTm9VdHRlcmFuY2Uge1xyXG4gICAgcmV0dXJuIHRoaXMuX2FsZXJ0O1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldCBhbGVydCgpOiBBbGVydGFibGVOb1V0dGVyYW5jZSB7cmV0dXJuIHRoaXMuZ2V0QWxlcnQoKTsgfVxyXG5cclxuICBwdWJsaWMgc2V0IGFsZXJ0KCBhbGVydDogQWxlcnRhYmxlTm9VdHRlcmFuY2UgKSB7IHRoaXMuc2V0QWxlcnQoIGFsZXJ0ICk7IH1cclxuXHJcbiAgcHVibGljIHNldEFsZXJ0KCBhbGVydDogQWxlcnRhYmxlTm9VdHRlcmFuY2UgKTogdm9pZCB7XHJcbiAgICB0aGlzLl9hbGVydCA9IGFsZXJ0O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU2V0IHRoZSBhbGVydFN0YWJsZURlbGF5IHRpbWUsIHNlZSBhbGVydFN0YWJsZURlbGF5IG9wdGlvbiBmb3IgbW9yZSBpbmZvcm1hdGlvbi5cclxuICAgKlxyXG4gICAqIEJFV0FSRSEgV2h5IGRvZXMgdGhlIGRlbGF5IHRpbWUgbmVlZCB0byBiZSBjaGFuZ2VkIGR1cmluZyB0aGUgbGlmZXRpbWUgb2YgYW4gVXR0ZXJhbmNlPyBJdCBkaWQgZm9yXHJcbiAgICogaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL2dyYXZpdHktZm9yY2UtbGFiLWJhc2ljcy9pc3N1ZXMvMTQ2LCBidXQgZG9lcyBpdCBmb3IgeW91PyBCZSBzdXJlIHRoZXJlIGlzIGdvb2RcclxuICAgKiByZWFzb24gY2hhbmdpbmcgdGhpcyB2YWx1ZS5cclxuICAgKi9cclxuICBwdWJsaWMgc2V0QWxlcnRTdGFibGVEZWxheSggZGVsYXk6IG51bWJlciApOiB2b2lkIHtcclxuICAgIHRoaXMuYWxlcnRTdGFibGVEZWxheSA9IGRlbGF5O1xyXG4gIH1cclxuXHJcbiAgcHVibGljIG92ZXJyaWRlIHRvU3RyaW5nKCk6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gYFV0dGVyYW5jZV8ke3RoaXMuaWR9IyR7dGhpcy5nZXRBbGVydFRleHQoKX1gO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHRvU3RhdGVPYmplY3QoKTogU2VyaWFsaXplZFV0dGVyYW5jZSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBhbGVydDogTnVsbGFibGVJTyggT3JJTyggWyBTdHJpbmdJTywgTnVtYmVySU8gXSApICkudG9TdGF0ZU9iamVjdCggdGhpcy5nZXRBbGVydFRleHQoKSApXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHJlc2V0KCk6IHZvaWQge1xyXG4gICAgdGhpcy5wcmV2aW91c0FsZXJ0VGV4dCA9IG51bGw7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTZXQgdGhlIFByb3BlcnRpZXMgY29udHJvbGxpbmcgd2hldGhlciB0aGlzIFV0dGVyYW5jZSBjYW4gYW5ub3VuY2UuIEFsbCBQcm9wZXJ0aWVzIG11c3QgYmVcclxuICAgKiB0cnVlIGZvciB0aGUgYWxlcnQgY29udGVudCBvZiB0aGlzIFV0dGVyYW5jZSB0byBiZSBhbm5vdW5jZWQuIFRoZXNlIFByb3BlcnRpZXMgYXJlIHVzZWQgaW4gdGhlIGltcGxlbWVudGF0aW9uXHJcbiAgICogb2YgdGhpcy5jYW5Bbm5vdW5jZVByb3BlcnR5LiBTZXR0aW5nIG5ldyBjYW5Bbm5vdW5jZVByb3BlcnRpZXMgaGFzIG5vIGltcGFjdCBvbiB0aGUgbGlzdGVuZXJzIGFkZGVkIHRvXHJcbiAgICogdGhpcy5jYW5Bbm5vdW5jZVByb3BlcnR5LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzZXRDYW5Bbm5vdW5jZVByb3BlcnRpZXMoIGNhbkFubm91bmNlUHJvcGVydGllczogVFJlYWRPbmx5UHJvcGVydHk8Ym9vbGVhbj5bXSApOiB2b2lkIHtcclxuICAgIHRoaXMuY2FuQW5ub3VuY2VQcm9wZXJ0eS5zZXREZXBlbmRlbnRQcm9wZXJ0aWVzKCBjYW5Bbm5vdW5jZVByb3BlcnRpZXMgKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzZXQgY2FuQW5ub3VuY2VQcm9wZXJ0aWVzKCBjYW5Bbm5vdW5jZVByb3BlcnRpZXM6IFRSZWFkT25seVByb3BlcnR5PGJvb2xlYW4+W10gKSB7XHJcbiAgICB0aGlzLnNldENhbkFubm91bmNlUHJvcGVydGllcyggY2FuQW5ub3VuY2VQcm9wZXJ0aWVzICk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0IGNhbkFubm91bmNlUHJvcGVydGllcygpOiBUUmVhZE9ubHlQcm9wZXJ0eTxib29sZWFuPltdIHsgcmV0dXJuIHRoaXMuZ2V0Q2FuQW5ub3VuY2VQcm9wZXJ0aWVzKCk7IH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IHRoZSBQcm9wZXJ0aWVzIHRoYXQgY29udHJvbCB3aGV0aGVyIHRoZSBhbGVydCBjb250ZW50IGZvciB0aGlzIFV0dGVyYW5jZSBjYW4gYmUgYW5ub3VuY2VkLlxyXG4gICAqIEFsbCBtdXN0IGJlIHRydWUgZm9yIHRoZSBhbm5vdW5jZW1lbnQgdG8gb2NjdXIuXHJcbiAgICovXHJcbiAgcHVibGljIGdldENhbkFubm91bmNlUHJvcGVydGllcygpOiBUUmVhZE9ubHlQcm9wZXJ0eTxib29sZWFuPltdIHtcclxuICAgIHJldHVybiB0aGlzLmNhbkFubm91bmNlUHJvcGVydHkuZ2V0RGVwZW5kZW50UHJvcGVydGllcygpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU2V0IHRoZSBQcm9wZXJ0aWVzIGNvbnRyb2xsaW5nIHdoZXRoZXIgdGhpcyBVdHRlcmFuY2UgY2FuIGFubm91bmNlIHRvIEFyaWFMaXZlQW5ub3VuY2VyLiBBbGwgUHJvcGVydGllcyBtdXN0IGJlXHJcbiAgICogdHJ1ZSBmb3IgdGhlIGFsZXJ0IGNvbnRlbnQgb2YgdGhpcyBVdHRlcmFuY2UgdG8gYmUgYW5ub3VuY2VkLiBUaGVzZSBQcm9wZXJ0aWVzIGFyZSB1c2VkIGluIHRoZSBpbXBsZW1lbnRhdGlvblxyXG4gICAqIG9mIHRoaXMuZGVzY3JpcHRpb25DYW5Bbm5vdW5jZVByb3BlcnR5LiBTZXR0aW5nIG5ldyBkZXNjcmlwdGlvbkNhbkFubm91bmNlUHJvcGVydGllcyBoYXMgbm8gaW1wYWN0IG9uIHRoZVxyXG4gICAqIGxpc3RlbmVycyBhZGRlZCB0byB0aGlzLmRlc2NyaXB0aW9uQ2FuQW5ub3VuY2VQcm9wZXJ0eS4gVG8gYW5ub3VuY2UgdG8gQXJpYUxpdmVBbm5vdW5jZXIsIHRoaXMuY2FuQW5ub3VuY2VQcm9wZXJ0eVxyXG4gICAqIG11c3QgYWxzbyBiZSB0cnVlXHJcbiAgICovXHJcbiAgcHVibGljIHNldERlc2NyaXB0aW9uQ2FuQW5ub3VuY2VQcm9wZXJ0aWVzKCBkZXNjcmlwdGlvbkNhbkFubm91bmNlUHJvcGVydGllczogVFJlYWRPbmx5UHJvcGVydHk8Ym9vbGVhbj5bXSApOiB2b2lkIHtcclxuICAgIHRoaXMuZGVzY3JpcHRpb25DYW5Bbm5vdW5jZVByb3BlcnR5LnNldERlcGVuZGVudFByb3BlcnRpZXMoIGRlc2NyaXB0aW9uQ2FuQW5ub3VuY2VQcm9wZXJ0aWVzICk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc2V0IGRlc2NyaXB0aW9uQ2FuQW5ub3VuY2VQcm9wZXJ0aWVzKCBkZXNjcmlwdGlvbkNhbkFubm91bmNlUHJvcGVydGllczogVFJlYWRPbmx5UHJvcGVydHk8Ym9vbGVhbj5bXSApIHtcclxuICAgIHRoaXMuc2V0RGVzY3JpcHRpb25DYW5Bbm5vdW5jZVByb3BlcnRpZXMoIGRlc2NyaXB0aW9uQ2FuQW5ub3VuY2VQcm9wZXJ0aWVzICk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0IGRlc2NyaXB0aW9uQ2FuQW5ub3VuY2VQcm9wZXJ0aWVzKCk6IFRSZWFkT25seVByb3BlcnR5PGJvb2xlYW4+W10geyByZXR1cm4gdGhpcy5nZXREZXNjcmlwdGlvbkNhbkFubm91bmNlUHJvcGVydGllcygpOyB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCB0aGUgUHJvcGVydGllcyB0aGF0IGNvbnRyb2wgd2hldGhlciB0aGUgYWxlcnQgY29udGVudCBmb3IgdGhpcyBVdHRlcmFuY2UgY2FuIGJlIGFubm91bmNlZC5cclxuICAgKiBBbGwgbXVzdCBiZSB0cnVlIGZvciB0aGUgYW5ub3VuY2VtZW50IHRvIG9jY3VyLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBnZXREZXNjcmlwdGlvbkNhbkFubm91bmNlUHJvcGVydGllcygpOiBUUmVhZE9ubHlQcm9wZXJ0eTxib29sZWFuPltdIHtcclxuICAgIHJldHVybiB0aGlzLmRlc2NyaXB0aW9uQ2FuQW5ub3VuY2VQcm9wZXJ0eS5nZXREZXBlbmRlbnRQcm9wZXJ0aWVzKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTZXQgdGhlIFByb3BlcnRpZXMgY29udHJvbGxpbmcgd2hldGhlciB0aGlzIFV0dGVyYW5jZSBjYW4gYW5ub3VuY2UgdG8gU3BlZWNoU3ludGhlc2lzQW5ub3VuY2VyLiBBbGwgUHJvcGVydGllc1xyXG4gICAqIG11c3QgYmUgdHJ1ZSBmb3IgdGhlIGFsZXJ0IGNvbnRlbnQgb2YgdGhpcyBVdHRlcmFuY2UgdG8gYmUgYW5ub3VuY2VkLiBUaGVzZSBQcm9wZXJ0aWVzIGFyZSB1c2VkIGluIHRoZVxyXG4gICAqIGltcGxlbWVudGF0aW9uIG9mIHRoaXMudm9pY2luZ0NhbkFubm91bmNlUHJvcGVydHkuIFNldHRpbmcgbmV3IHZvaWNpbmdDYW5Bbm5vdW5jZVByb3BlcnRpZXMgaGFzIG5vIGltcGFjdFxyXG4gICAqIG9uIHRoZSBsaXN0ZW5lcnMgYWRkZWQgdG8gdGhpcy52b2ljaW5nQ2FuQW5ub3VuY2VQcm9wZXJ0eS4gVG8gYW5ub3VuY2UgdG8gU3BlZWNoU3ludGhlc2lzQW5ub3VuY2VyLFxyXG4gICAqIHRoaXMuY2FuQW5ub3VuY2VQcm9wZXJ0eSBtdXN0IGFsc28gYmUgdHJ1ZS5cclxuICAgKi9cclxuICBwdWJsaWMgc2V0Vm9pY2luZ0NhbkFubm91bmNlUHJvcGVydGllcyggdm9pY2luZ0NhbkFubm91bmNlUHJvcGVydGllczogVFJlYWRPbmx5UHJvcGVydHk8Ym9vbGVhbj5bXSApOiB2b2lkIHtcclxuICAgIHRoaXMudm9pY2luZ0NhbkFubm91bmNlUHJvcGVydHkuc2V0RGVwZW5kZW50UHJvcGVydGllcyggdm9pY2luZ0NhbkFubm91bmNlUHJvcGVydGllcyApO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHNldCB2b2ljaW5nQ2FuQW5ub3VuY2VQcm9wZXJ0aWVzKCB2b2ljaW5nQ2FuQW5ub3VuY2VQcm9wZXJ0aWVzOiBUUmVhZE9ubHlQcm9wZXJ0eTxib29sZWFuPltdICkge1xyXG4gICAgdGhpcy5zZXRWb2ljaW5nQ2FuQW5ub3VuY2VQcm9wZXJ0aWVzKCB2b2ljaW5nQ2FuQW5ub3VuY2VQcm9wZXJ0aWVzICk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0IHZvaWNpbmdDYW5Bbm5vdW5jZVByb3BlcnRpZXMoKTogVFJlYWRPbmx5UHJvcGVydHk8Ym9vbGVhbj5bXSB7IHJldHVybiB0aGlzLmdldFZvaWNpbmdDYW5Bbm5vdW5jZVByb3BlcnRpZXMoKTsgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgdGhlIFByb3BlcnRpZXMgdGhhdCBjb250cm9sIHdoZXRoZXIgdGhlIGFsZXJ0IGNvbnRlbnQgZm9yIHRoaXMgVXR0ZXJhbmNlIGNhbiBiZSBhbm5vdW5jZWQuXHJcbiAgICogQWxsIG11c3QgYmUgdHJ1ZSBmb3IgdGhlIGFubm91bmNlbWVudCB0byBvY2N1ci5cclxuICAgKi9cclxuICBwdWJsaWMgZ2V0Vm9pY2luZ0NhbkFubm91bmNlUHJvcGVydGllcygpOiBUUmVhZE9ubHlQcm9wZXJ0eTxib29sZWFuPltdIHtcclxuICAgIHJldHVybiB0aGlzLnZvaWNpbmdDYW5Bbm5vdW5jZVByb3BlcnR5LmdldERlcGVuZGVudFByb3BlcnRpZXMoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIE1ha2UgZWxpZ2libGUgZm9yIGdhcmJhZ2UgY29sbGVjdGlvbi5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgZGlzcG9zZSgpOiB2b2lkIHtcclxuICAgIHRoaXMuY2FuQW5ub3VuY2VQcm9wZXJ0eS5kaXNwb3NlKCk7XHJcbiAgICB0aGlzLmRlc2NyaXB0aW9uQ2FuQW5ub3VuY2VQcm9wZXJ0eS5kaXNwb3NlKCk7XHJcbiAgICB0aGlzLnZvaWNpbmdDYW5Bbm5vdW5jZVByb3BlcnR5LmRpc3Bvc2UoKTtcclxuXHJcbiAgICB0aGlzLnByaW9yaXR5UHJvcGVydHkuZGlzcG9zZSgpO1xyXG5cclxuICAgIHN1cGVyLmRpc3Bvc2UoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSBhbGVydGFibGVcclxuICAgKiBAcGFyYW0gcmVzcGVjdFJlc3BvbnNlQ29sbGVjdG9yUHJvcGVydGllcz1mYWxzZSAtIGlmIGZhbHNlLCB0aGVuIGRvIG5vdCBsaXN0ZW4gdG8gdGhlIHZhbHVlIG9mIHJlc3BvbnNlQ29sbGVjdG9yXHJcbiAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGNyZWF0aW5nIHRoZSBSZXNwb25zZVBhY2tldCBjb25nbG9tZXJhdGUgKGp1c3QgY29tYmluZSBhbGwgdGhhdCBhcmUgc3VwcGxpZWQpLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgYWxlcnRhYmxlVG9UZXh0KCBhbGVydGFibGU6IFRBbGVydGFibGUsIHJlc3BlY3RSZXNwb25zZUNvbGxlY3RvclByb3BlcnRpZXMgPSBmYWxzZSApOiBSZXNvbHZlZFJlc3BvbnNlIHtcclxuICAgIGxldCBhbGVydDogUmVzb2x2ZWRSZXNwb25zZTtcclxuXHJcbiAgICBpZiAoIHR5cGVvZiBhbGVydGFibGUgPT09ICdmdW5jdGlvbicgKSB7XHJcbiAgICAgIGFsZXJ0ID0gYWxlcnRhYmxlKCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICggYWxlcnRhYmxlIGluc3RhbmNlb2YgUmVzcG9uc2VQYWNrZXQgKSB7XHJcbiAgICAgIGFsZXJ0ID0gVXR0ZXJhbmNlLmdldEFsZXJ0U3RyaW5nRnJvbVJlc3BvbnNlUGFja2V0KCBhbGVydGFibGUsIHJlc3BlY3RSZXNwb25zZUNvbGxlY3RvclByb3BlcnRpZXMgKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKCBhbGVydGFibGUgaW5zdGFuY2VvZiBVdHRlcmFuY2UgKSB7XHJcbiAgICAgIHJldHVybiBhbGVydGFibGUuZ2V0QWxlcnRUZXh0KCByZXNwZWN0UmVzcG9uc2VDb2xsZWN0b3JQcm9wZXJ0aWVzICk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICggaXNUUmVhZE9ubHlQcm9wZXJ0eSggYWxlcnRhYmxlICkgKSB7XHJcbiAgICAgIGFsZXJ0ID0gYWxlcnRhYmxlLnZhbHVlO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcblxyXG4gICAgICAvLyBOb3RoaW5nIHRvIHByb2Nlc3MgZnJvbSB0aGUgVEFsZXJ0YWJsZSwgaXQgaXMgcmF3IGNvbnRlbnRcclxuICAgICAgYWxlcnQgPSBhbGVydGFibGU7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYWxlcnQ7XHJcbiAgfVxyXG5cclxuICAvLyBQcmlvcml0eSBsZXZlbHMgdGhhdCBjYW4gYmUgdXNlZCBieSBVdHRlcmFuY2VzIHByb3ZpZGluZyB0aGUgYGFubm91bmNlck9wdGlvbnMucHJpb3JpdHlgIG9wdGlvbi5cclxuICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IFRPUF9QUklPUklUWSA9IDEwO1xyXG4gIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgSElHSF9QUklPUklUWSA9IDU7XHJcbiAgcHVibGljIHN0YXRpYyByZWFkb25seSBNRURJVU1fUFJJT1JJVFkgPSAyO1xyXG4gIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgREVGQVVMVF9QUklPUklUWSA9IERFRkFVTFRfUFJJT1JJVFk7XHJcbiAgcHVibGljIHN0YXRpYyByZWFkb25seSBMT1dfUFJJT1JJVFkgPSAwO1xyXG5cclxuICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IFV0dGVyYW5jZUlPID0gbmV3IElPVHlwZSggJ1V0dGVyYW5jZUlPJywge1xyXG4gICAgdmFsdWVUeXBlOiBVdHRlcmFuY2UsXHJcbiAgICBkb2N1bWVudGF0aW9uOiAnQW5ub3VuY2VzIHRleHQgdG8gYSBzcGVjaWZpYyBicm93c2VyIHRlY2hub2xvZ3kgKGxpa2UgYXJpYS1saXZlIG9yIHdlYiBzcGVlY2gpJyxcclxuICAgIHRvU3RhdGVPYmplY3Q6ICggdXR0ZXJhbmNlOiBVdHRlcmFuY2UgKSA9PiB1dHRlcmFuY2UudG9TdGF0ZU9iamVjdCgpLFxyXG4gICAgc3RhdGVTY2hlbWE6IHtcclxuICAgICAgYWxlcnQ6IE51bGxhYmxlSU8oIE9ySU8oIFsgU3RyaW5nSU8sIE51bWJlcklPIF0gKSApXHJcbiAgICB9XHJcbiAgfSApO1xyXG59XHJcblxyXG50eXBlIEFubm91bmNpbmdDb250cm9sUHJvcGVydHlTZWxmT3B0aW9ucyA9IHtcclxuICBkZXBlbmRlbnRQcm9wZXJ0aWVzPzogVFJlYWRPbmx5UHJvcGVydHk8Ym9vbGVhbj5bXTtcclxufTtcclxuXHJcbnR5cGUgQW5ub3VuY2luZ0NvbnRyb2xQcm9wZXJ0eVBhcmVudE9wdGlvbnMgPSBEeW5hbWljUHJvcGVydHlPcHRpb25zPGJvb2xlYW4sIGJvb2xlYW4sIFRSZWFkT25seVByb3BlcnR5PGJvb2xlYW4+PjtcclxudHlwZSBBbm5vdW5jaW5nQ29udHJvbFByb3BlcnR5T3B0aW9ucyA9IEFubm91bmNpbmdDb250cm9sUHJvcGVydHlTZWxmT3B0aW9ucyAmIEFubm91bmNpbmdDb250cm9sUHJvcGVydHlQYXJlbnRPcHRpb25zO1xyXG5cclxuY2xhc3MgQW5ub3VuY2luZ0NvbnRyb2xQcm9wZXJ0eSBleHRlbmRzIER5bmFtaWNQcm9wZXJ0eTxib29sZWFuLCBib29sZWFuLCBUUmVhZE9ubHlQcm9wZXJ0eTxib29sZWFuPj4ge1xyXG5cclxuICAvLyBMaXN0IG9mIFByb3BlcnRpZXMgdGhhdCBtdXN0IGFsbCBiZSB0cnVlIGluIG9yZGVyIGZvciB0aGUgVXR0ZXJhbmNlIHRvIGJlIGFubm91bmNlZCBieSB0aGUgQW5ub3VuY2VyLlxyXG4gIHByaXZhdGUgX2RlcGVuZGVudFByb3BlcnRpZXM6IFRSZWFkT25seVByb3BlcnR5PGJvb2xlYW4+W107XHJcblxyXG4gIC8vIEEgUHJvcGVydHkgZm9yIHRoZSBEeW5hbWljUHJvcGVydHkuIFRoZSB2YWx1ZSBvZiB0aGlzIFByb3BlcnR5IGlzIHRoZSBEZXJpdmVkUHJvcGVydHkuYW5kIG9mIGFsbFxyXG4gIC8vIGNhbkFubm91bmNlUHJvcGVydGllcy4gVGhlIGJlbmVmaXQgb2YgdXNpbmcgYSBEeW5hbWljUHJvcGVydHkgaXMgdGhhdCBkZXBlbmRlbmN5IFByb3BlcnRpZXMgb2YgdGhlXHJcbiAgLy8gaW1wbGVtZW50YXRpb24gY2FuIGNoYW5nZSAobmV3IERlcml2ZWRQcm9wZXJ0eSBpbiBzZXREZXBlbmRlbnRQcm9wZXJ0aWVzKSBidXQgdGhlIGxpc3RlbmVycyB3aWxsIHJlbWFpblxyXG4gIC8vIHVuYWZmZWN0ZWQgb24gdGhlIGNhbkFubm91bmNlUHJvcGVydHkuXHJcbiAgcHJpdmF0ZSByZWFkb25seSBpbXBsZW1lbnRhdGlvblByb3BlcnR5OiBQcm9wZXJ0eTxUUmVhZE9ubHlQcm9wZXJ0eTxib29sZWFuPj47XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggcHJvdmlkZWRPcHRpb25zPzogQW5ub3VuY2luZ0NvbnRyb2xQcm9wZXJ0eU9wdGlvbnMgKSB7XHJcblxyXG4gICAgY29uc3Qgb3B0aW9ucyA9IG9wdGlvbml6ZTxBbm5vdW5jaW5nQ29udHJvbFByb3BlcnR5T3B0aW9ucywgQW5ub3VuY2luZ0NvbnRyb2xQcm9wZXJ0eVNlbGZPcHRpb25zLCBBbm5vdW5jaW5nQ29udHJvbFByb3BlcnR5UGFyZW50T3B0aW9ucz4oKSgge1xyXG4gICAgICBkZXBlbmRlbnRQcm9wZXJ0aWVzOiBbXVxyXG4gICAgfSwgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgY29uc3QgaW1wbGVtZW50YXRpb25Qcm9wZXJ0eSA9IG5ldyBQcm9wZXJ0eTxUUmVhZE9ubHlQcm9wZXJ0eTxib29sZWFuPj4oIG5ldyBUaW55UHJvcGVydHkoIGZhbHNlICkgKTtcclxuXHJcbiAgICBzdXBlciggaW1wbGVtZW50YXRpb25Qcm9wZXJ0eSApO1xyXG5cclxuICAgIHRoaXMuX2RlcGVuZGVudFByb3BlcnRpZXMgPSBbXTtcclxuICAgIHRoaXMuaW1wbGVtZW50YXRpb25Qcm9wZXJ0eSA9IGltcGxlbWVudGF0aW9uUHJvcGVydHk7XHJcbiAgICB0aGlzLnNldERlcGVuZGVudFByb3BlcnRpZXMoIG9wdGlvbnMuZGVwZW5kZW50UHJvcGVydGllcyApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU2V0IHRoZSBQcm9wZXJ0aWVzIGNvbnRyb2xsaW5nIHRoaXMgUHJvcGVydHkncyB2YWx1ZS4gQWxsIFByb3BlcnRpZXMgbXVzdCBiZSB0cnVlIGZvciB0aGlzIFByb3BlcnR5IHRvIGJlIHRydWUuXHJcbiAgICovXHJcbiAgcHVibGljIHNldERlcGVuZGVudFByb3BlcnRpZXMoIGRlcGVuZGVudFByb3BlcnRpZXM6IFRSZWFkT25seVByb3BlcnR5PGJvb2xlYW4+W10gKTogdm9pZCB7XHJcbiAgICBpZiAoIHRoaXMuaW1wbGVtZW50YXRpb25Qcm9wZXJ0eS52YWx1ZSApIHtcclxuICAgICAgdGhpcy5pbXBsZW1lbnRhdGlvblByb3BlcnR5LnZhbHVlLmRpc3Bvc2UoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBJZiBubyBkZXBlbmRlbnRQcm9wZXJ0aWVzIHByb3ZpZGVkLCB1c2UgYSBkdW1teSBQcm9wZXJ0eSB0aGF0IHdpbGwgYWx3YXlzIGFsbG93IHRoaXMgVXR0ZXJhbmNlIHRvIGFubm91bmNlLlxyXG4gICAgY29uc3QgZGVwZW5kZW5jeVByb3BlcnRpZXMgPSBkZXBlbmRlbnRQcm9wZXJ0aWVzLmxlbmd0aCA9PT0gMCA/IFsgbmV3IFRpbnlQcm9wZXJ0eSggdHJ1ZSApIF0gOiBkZXBlbmRlbnRQcm9wZXJ0aWVzO1xyXG5cclxuICAgIHRoaXMuaW1wbGVtZW50YXRpb25Qcm9wZXJ0eS52YWx1ZSA9IERlcml2ZWRQcm9wZXJ0eS5hbmQoIGRlcGVuZGVuY3lQcm9wZXJ0aWVzICk7XHJcblxyXG4gICAgdGhpcy5fZGVwZW5kZW50UHJvcGVydGllcyA9IGRlcGVuZGVudFByb3BlcnRpZXM7XHJcbiAgfVxyXG5cclxuXHJcbiAgcHVibGljIHNldCBkZXBlbmRlbnRQcm9wZXJ0aWVzKCBkZXBlbmRlbnRQcm9wZXJ0aWVzOiBUUmVhZE9ubHlQcm9wZXJ0eTxib29sZWFuPltdICkgeyB0aGlzLnNldERlcGVuZGVudFByb3BlcnRpZXMoIGRlcGVuZGVudFByb3BlcnRpZXMgKTsgfVxyXG5cclxuICBwdWJsaWMgZ2V0IGRlcGVuZGVudFByb3BlcnRpZXMoKSB7IHJldHVybiB0aGlzLmdldERlcGVuZGVudFByb3BlcnRpZXMoKTsgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgdGhlIFByb3BlcnRpZXMgdGhhdCBjb250cm9sIHdoZXRoZXIgdGhlIGFsZXJ0IGNvbnRlbnQgZm9yIHRoaXMgVXR0ZXJhbmNlIGNhbiBiZSBhbm5vdW5jZWQuXHJcbiAgICogQWxsIG11c3QgYmUgdHJ1ZSBmb3IgdGhlIGFubm91bmNlbWVudCB0byBvY2N1ci5cclxuICAgKi9cclxuICBwdWJsaWMgZ2V0RGVwZW5kZW50UHJvcGVydGllcygpOiBUUmVhZE9ubHlQcm9wZXJ0eTxib29sZWFuPltdIHtcclxuICAgIHJldHVybiB0aGlzLl9kZXBlbmRlbnRQcm9wZXJ0aWVzLnNsaWNlKCAwICk7IC8vIGRlZmVuc2l2ZSBjb3B5XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgb3ZlcnJpZGUgZGlzcG9zZSgpOiB2b2lkIHtcclxuICAgIHRoaXMuaW1wbGVtZW50YXRpb25Qcm9wZXJ0eS5kaXNwb3NlKCk7XHJcbiAgICB0aGlzLl9kZXBlbmRlbnRQcm9wZXJ0aWVzID0gW107XHJcbiAgICBzdXBlci5kaXNwb3NlKCk7XHJcbiAgfVxyXG59XHJcblxyXG51dHRlcmFuY2VRdWV1ZU5hbWVzcGFjZS5yZWdpc3RlciggJ1V0dGVyYW5jZScsIFV0dGVyYW5jZSApO1xyXG5leHBvcnQgZGVmYXVsdCBVdHRlcmFuY2U7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLGVBQWUsTUFBTSxrQ0FBa0M7QUFDOUQsT0FBT0MsWUFBWSxNQUFNLCtCQUErQjtBQUN4RCxPQUFPQyxlQUFlLE1BQWtDLGtDQUFrQztBQUMxRixPQUFPQyxjQUFjLE1BQU0saUNBQWlDO0FBQzVELE9BQU9DLFNBQVMsTUFBTSxpQ0FBaUM7QUFDdkQsT0FBT0MsTUFBTSxNQUFNLGlDQUFpQztBQUNwRCxPQUFPQyxRQUFRLE1BQU0sbUNBQW1DO0FBQ3hELE9BQU9DLGlCQUFpQixNQUFNLHdCQUF3QjtBQUN0RCxPQUFPQyxjQUFjLE1BQTRCLHFCQUFxQjtBQUN0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