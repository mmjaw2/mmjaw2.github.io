// Copyright 2013-2024, University of Colorado Boulder

/**
 * A DerivedProperty is computed based on other Properties.  This implementation inherits from Property to (a) simplify
 * implementation and (b) ensure it remains consistent. Note that the setters should not be called directly, so the
 * setters (set, reset and es5 setter) throw an error if used directly.
 *
 * @author Sam Reid (PhET Interactive Simulations)
 */

import Tandem from '../../tandem/js/Tandem.js';
import IOType from '../../tandem/js/types/IOType.js';
import VoidIO from '../../tandem/js/types/VoidIO.js';
import axon from './axon.js';
import Property from './Property.js';
import propertyStateHandlerSingleton from './propertyStateHandlerSingleton.js';
import PropertyStatePhase from './PropertyStatePhase.js';
import optionize from '../../phet-core/js/optionize.js';
import ReadOnlyProperty, { derivationStack } from './ReadOnlyProperty.js';
import PhetioObject from '../../tandem/js/PhetioObject.js';
import IOTypeCache from '../../tandem/js/IOTypeCache.js';
const DERIVED_PROPERTY_IO_PREFIX = 'DerivedPropertyIO';
const strictAxonDependenciesGlobal = _.hasIn(window, 'phet.chipper.queryParameters') && phet.chipper.queryParameters.strictAxonDependencies;

/**
 * Compute the derived value given a derivation and an array of dependencies
 */
function getDerivedValue(strictAxonDependencies, derivation, dependencies) {
  assert && strictAxonDependenciesGlobal && strictAxonDependencies && derivationStack.push(dependencies);
  try {
    // @ts-expect-error
    return derivation(...dependencies.map(property => property.get()));
  } finally {
    assert && strictAxonDependenciesGlobal && strictAxonDependencies && derivationStack.pop();
  }
}

// Convenience type for a Derived property that has a known return type but unknown dependency types.

/**
 * T = type of the derived value
 * Parameters[] = types of the callback parameters, e.g. [ Vector2, number, boolean ]
 */
export default class DerivedProperty extends ReadOnlyProperty {
  /**
   * @param dependencies - Properties that this Property's value is derived from
   * @param derivation - function that derives this Property's value, expects args in the same order as dependencies
   * @param [providedOptions] - see Property
   */

  constructor(dependencies, derivation, providedOptions) {
    const options = optionize()({
      phetioReadOnly: true,
      // derived properties can be read but not set by PhET-iO
      phetioOuterType: DerivedProperty.DerivedPropertyIO,
      phetioLinkDependencies: true,
      strictAxonDependencies: true
    }, providedOptions);
    assert && assert(dependencies.every(_.identity), 'dependencies should all be truthy');
    assert && assert(dependencies.length === _.uniq(dependencies).length, 'duplicate dependencies');
    const initialValue = getDerivedValue(options.strictAxonDependencies, derivation, dependencies);

    // We must pass supertype tandem to parent class so addInstance is called only once in the subclassiest constructor.
    super(initialValue, options);
    if (Tandem.VALIDATION && this.isPhetioInstrumented()) {
      // The phetioType should be a concrete (instantiated) DerivedPropertyIO, hence we must check its outer type
      assert && assert(this.phetioType.typeName.startsWith('DerivedPropertyIO'), 'phetioType should be DerivedPropertyIO');
    }
    this.dependencies = dependencies;
    this.derivation = derivation;
    this.strictAxonDependencies = options.strictAxonDependencies;
    this.derivedPropertyListener = this.getDerivedPropertyListener.bind(this);
    dependencies.forEach(dependency => {
      dependency.lazyLink(this.derivedPropertyListener);
      if (Tandem.PHET_IO_ENABLED && this.isPhetioInstrumented() && dependency instanceof PhetioObject && dependency.isPhetioInstrumented()) {
        if (dependency instanceof ReadOnlyProperty) {
          // Dependencies should have taken their correct values before this DerivedProperty undefers, so it will be sure
          // to have the right value.
          // NOTE: Do not mark the beforePhase as NOTIFY, as this will potentially cause interdependence bugs when used
          // with Multilinks. See Projectile Motion's use of MeasuringTapeNode for an example.
          propertyStateHandlerSingleton.registerPhetioOrderDependency(dependency, PropertyStatePhase.UNDEFER, this, PropertyStatePhase.UNDEFER);
        }
        if (options.tandem && options.phetioLinkDependencies) {
          const dependenciesTandem = options.tandem.createTandem('dependencies');
          this.addLinkedElement(dependency, {
            tandem: dependenciesTandem.createTandemFromPhetioID(dependency.tandem.phetioID)
          });
        }
      }
    });
  }

  /**
   * Determines whether this DerivedProperty has a specific dependency.
   */
  hasDependency(dependency) {
    return this.definedDependencies.includes(dependency);
  }

  /**
   * Returns dependencies that are guaranteed to be defined internally.
   */
  get definedDependencies() {
    assert && assert(this.dependencies !== null, 'Dependencies should be defined, has this Property been disposed?');
    return this.dependencies;
  }

  // for bind
  getDerivedPropertyListener() {
    // Don't try to recompute if we are disposed, see https://github.com/phetsims/axon/issues/432
    if (this.isDisposed) {
      return;
    }

    // Just mark that there is a deferred value, then calculate the derivation below when setDeferred() is called.
    // This is in part supported by the PhET-iO state engine because it can account for intermediate states, such
    // that this Property won't notify until after it is undeferred and has taken its final value.
    if (this.isDeferred) {
      this.hasDeferredValue = true;
    } else {
      super.set(getDerivedValue(this.strictAxonDependencies, this.derivation, this.definedDependencies));
    }
  }

  /**
   * Allows forcing a recomputation (as a possible workaround to listener order). This works well if you have a
   * non-Property event that should trigger a value change for this Property.
   *
   * For example:
   * myEmitter.addListener( () => myDerivedProperty.recomputeDerivation() );
   * myObservableArray.addItemAddedListener( () => myDerivedProperty.recomputeDerivation() );
   */
  recomputeDerivation() {
    this.getDerivedPropertyListener();
  }
  dispose() {
    const dependencies = this.definedDependencies;

    // Unlink from dependent Properties
    for (let i = 0; i < dependencies.length; i++) {
      const dependency = dependencies[i];
      if (dependency.hasListener(this.derivedPropertyListener)) {
        dependency.unlink(this.derivedPropertyListener);
      }
    }
    this.dependencies = null;
    super.dispose();
  }

  /**
   * Support deferred DerivedProperty by only calculating the derivation once when it is time to undefer it and fire
   * notifications. This way we don't have intermediate derivation calls during PhET-iO state setting.
   */
  setDeferred(isDeferred) {
    if (this.isDeferred && !isDeferred) {
      this.deferredValue = getDerivedValue(this.strictAxonDependencies, this.derivation, this.definedDependencies);
    }
    return super.setDeferred(isDeferred);
  }

  /**
   * Creates a derived boolean Property whose value is true iff firstProperty's value is equal to secondProperty's
   * value.
   */
  static valueEquals(firstProperty, secondProperty, options) {
    return new DerivedProperty([firstProperty, secondProperty], (u, v) => u === v, options);
  }
  static valueEqualsConstant(firstProperty, value, options) {
    return new DerivedProperty([firstProperty], u => u === value, options);
  }

  /**
   * Creates a derived boolean Property whose value is true iff every input Property value is true.
   */
  static and(properties, options) {
    assert && assert(properties.length > 0, 'must provide a dependency');
    return DerivedProperty.deriveAny(properties, () => _.reduce(properties, andFunction, true), options);
  }

  /**
   * Creates a derived boolean Property whose value is true iff any input Property value is true.
   */
  static or(properties, options) {
    assert && assert(properties.length > 0, 'must provide a dependency');
    return DerivedProperty.deriveAny(properties, () => _.reduce(properties, orFunction, false), options);
  }

  /**
   * Creates a derived number Property whose value is the result of multiplying all (number) dependencies together.
   */
  static multiply(properties, options) {
    assert && assert(properties.length > 0, 'must provide a dependency');
    return DerivedProperty.deriveAny(properties, () => _.reduce(properties, multiplyFunction, 1), options);
  }

  /**
   * Creates a derived number Property whose value is the result of adding all (number) dependencies together.
   */
  static add(properties, options) {
    assert && assert(properties.length > 0, 'must provide a dependency');
    return DerivedProperty.deriveAny(properties, () => _.reduce(properties, addFunction, 0), options);
  }

  /**
   * Creates a derived boolean Property whose value is the inverse of the provided property.
   */
  static not(propertyToInvert, options) {
    return new DerivedProperty([propertyToInvert], x => !x, options);
  }

  /**
   * Create a DerivedProperty from any number of dependencies.  This is parallel to Multilink.multilinkAny
   */
  static deriveAny(dependencies, derivation, providedOptions) {
    return new DerivedProperty(
    // @ts-expect-error we have to provide a mapping between an arbitrary length array and our max overload of 15 types.
    dependencies, derivation, providedOptions);
  }
}
const andFunction = (value, property) => {
  return value && property.value;
};
const orFunction = (value, property) => {
  assert && assert(typeof property.value === 'boolean', 'boolean value required');
  return value || property.value;
};
const multiplyFunction = (value, property) => {
  assert && assert(typeof property.value === 'number', 'number value required');
  return value * property.value;
};
const addFunction = (value, property) => {
  assert && assert(typeof property.value === 'number', 'number value required');
  return value + property.value;
};

// Cache each parameterized DerivedPropertyIO so that it is only created once.
const cache = new IOTypeCache();

/**
 * Parametric IOType constructor.  Given a parameter type, this function returns an appropriate DerivedProperty
 * IOType. Unlike PropertyIO, DerivedPropertyIO cannot be set by PhET-iO clients.
 * This caching implementation should be kept in sync with the other parametric IOType caching implementations.
 */
DerivedProperty.DerivedPropertyIO = parameterType => {
  assert && assert(parameterType, 'DerivedPropertyIO needs parameterType');
  if (!cache.has(parameterType)) {
    cache.set(parameterType, new IOType(`${DERIVED_PROPERTY_IO_PREFIX}<${parameterType.typeName}>`, {
      valueType: DerivedProperty,
      parameterTypes: [parameterType],
      supertype: Property.PropertyIO(parameterType),
      documentation: 'Like PropertyIO, but not settable.  Instead it is derived from other DerivedPropertyIO or PropertyIO ' + 'instances',
      // Override the parent implementation as a no-op.  DerivedProperty values appear in the state, but should not be set
      // back into a running simulation. See https://github.com/phetsims/phet-io/issues/1292
      applyState: _.noop,
      methods: {
        setValue: {
          returnType: VoidIO,
          parameterTypes: [parameterType],
          // @ts-expect-error
          implementation: DerivedProperty.prototype.set,
          documentation: 'Errors out when you try to set a derived property.',
          invocableForReadOnlyElements: false
        }
      }
    }));
  }
  return cache.get(parameterType);
};

// Convenience classes for subclassing DerivedProperty
export class DerivedProperty1 extends DerivedProperty {}
export class DerivedProperty2 extends DerivedProperty {}
export class DerivedProperty3 extends DerivedProperty {}
export class DerivedProperty4 extends DerivedProperty {}
export class DerivedProperty5 extends DerivedProperty {}
axon.register('DerivedProperty', DerivedProperty);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJUYW5kZW0iLCJJT1R5cGUiLCJWb2lkSU8iLCJheG9uIiwiUHJvcGVydHkiLCJwcm9wZXJ0eVN0YXRlSGFuZGxlclNpbmdsZXRvbiIsIlByb3BlcnR5U3RhdGVQaGFzZSIsIm9wdGlvbml6ZSIsIlJlYWRPbmx5UHJvcGVydHkiLCJkZXJpdmF0aW9uU3RhY2siLCJQaGV0aW9PYmplY3QiLCJJT1R5cGVDYWNoZSIsIkRFUklWRURfUFJPUEVSVFlfSU9fUFJFRklYIiwic3RyaWN0QXhvbkRlcGVuZGVuY2llc0dsb2JhbCIsIl8iLCJoYXNJbiIsIndpbmRvdyIsInBoZXQiLCJjaGlwcGVyIiwicXVlcnlQYXJhbWV0ZXJzIiwic3RyaWN0QXhvbkRlcGVuZGVuY2llcyIsImdldERlcml2ZWRWYWx1ZSIsImRlcml2YXRpb24iLCJkZXBlbmRlbmNpZXMiLCJhc3NlcnQiLCJwdXNoIiwibWFwIiwicHJvcGVydHkiLCJnZXQiLCJwb3AiLCJEZXJpdmVkUHJvcGVydHkiLCJjb25zdHJ1Y3RvciIsInByb3ZpZGVkT3B0aW9ucyIsIm9wdGlvbnMiLCJwaGV0aW9SZWFkT25seSIsInBoZXRpb091dGVyVHlwZSIsIkRlcml2ZWRQcm9wZXJ0eUlPIiwicGhldGlvTGlua0RlcGVuZGVuY2llcyIsImV2ZXJ5IiwiaWRlbnRpdHkiLCJsZW5ndGgiLCJ1bmlxIiwiaW5pdGlhbFZhbHVlIiwiVkFMSURBVElPTiIsImlzUGhldGlvSW5zdHJ1bWVudGVkIiwicGhldGlvVHlwZSIsInR5cGVOYW1lIiwic3RhcnRzV2l0aCIsImRlcml2ZWRQcm9wZXJ0eUxpc3RlbmVyIiwiZ2V0RGVyaXZlZFByb3BlcnR5TGlzdGVuZXIiLCJiaW5kIiwiZm9yRWFjaCIsImRlcGVuZGVuY3kiLCJsYXp5TGluayIsIlBIRVRfSU9fRU5BQkxFRCIsInJlZ2lzdGVyUGhldGlvT3JkZXJEZXBlbmRlbmN5IiwiVU5ERUZFUiIsInRhbmRlbSIsImRlcGVuZGVuY2llc1RhbmRlbSIsImNyZWF0ZVRhbmRlbSIsImFkZExpbmtlZEVsZW1lbnQiLCJjcmVhdGVUYW5kZW1Gcm9tUGhldGlvSUQiLCJwaGV0aW9JRCIsImhhc0RlcGVuZGVuY3kiLCJkZWZpbmVkRGVwZW5kZW5jaWVzIiwiaW5jbHVkZXMiLCJpc0Rpc3Bvc2VkIiwiaXNEZWZlcnJlZCIsImhhc0RlZmVycmVkVmFsdWUiLCJzZXQiLCJyZWNvbXB1dGVEZXJpdmF0aW9uIiwiZGlzcG9zZSIsImkiLCJoYXNMaXN0ZW5lciIsInVubGluayIsInNldERlZmVycmVkIiwiZGVmZXJyZWRWYWx1ZSIsInZhbHVlRXF1YWxzIiwiZmlyc3RQcm9wZXJ0eSIsInNlY29uZFByb3BlcnR5IiwidSIsInYiLCJ2YWx1ZUVxdWFsc0NvbnN0YW50IiwidmFsdWUiLCJhbmQiLCJwcm9wZXJ0aWVzIiwiZGVyaXZlQW55IiwicmVkdWNlIiwiYW5kRnVuY3Rpb24iLCJvciIsIm9yRnVuY3Rpb24iLCJtdWx0aXBseSIsIm11bHRpcGx5RnVuY3Rpb24iLCJhZGQiLCJhZGRGdW5jdGlvbiIsIm5vdCIsInByb3BlcnR5VG9JbnZlcnQiLCJ4IiwiY2FjaGUiLCJwYXJhbWV0ZXJUeXBlIiwiaGFzIiwidmFsdWVUeXBlIiwicGFyYW1ldGVyVHlwZXMiLCJzdXBlcnR5cGUiLCJQcm9wZXJ0eUlPIiwiZG9jdW1lbnRhdGlvbiIsImFwcGx5U3RhdGUiLCJub29wIiwibWV0aG9kcyIsInNldFZhbHVlIiwicmV0dXJuVHlwZSIsImltcGxlbWVudGF0aW9uIiwicHJvdG90eXBlIiwiaW52b2NhYmxlRm9yUmVhZE9ubHlFbGVtZW50cyIsIkRlcml2ZWRQcm9wZXJ0eTEiLCJEZXJpdmVkUHJvcGVydHkyIiwiRGVyaXZlZFByb3BlcnR5MyIsIkRlcml2ZWRQcm9wZXJ0eTQiLCJEZXJpdmVkUHJvcGVydHk1IiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJEZXJpdmVkUHJvcGVydHkudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTMtMjAyNCwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogQSBEZXJpdmVkUHJvcGVydHkgaXMgY29tcHV0ZWQgYmFzZWQgb24gb3RoZXIgUHJvcGVydGllcy4gIFRoaXMgaW1wbGVtZW50YXRpb24gaW5oZXJpdHMgZnJvbSBQcm9wZXJ0eSB0byAoYSkgc2ltcGxpZnlcclxuICogaW1wbGVtZW50YXRpb24gYW5kIChiKSBlbnN1cmUgaXQgcmVtYWlucyBjb25zaXN0ZW50LiBOb3RlIHRoYXQgdGhlIHNldHRlcnMgc2hvdWxkIG5vdCBiZSBjYWxsZWQgZGlyZWN0bHksIHNvIHRoZVxyXG4gKiBzZXR0ZXJzIChzZXQsIHJlc2V0IGFuZCBlczUgc2V0dGVyKSB0aHJvdyBhbiBlcnJvciBpZiB1c2VkIGRpcmVjdGx5LlxyXG4gKlxyXG4gKiBAYXV0aG9yIFNhbSBSZWlkIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKi9cclxuXHJcbmltcG9ydCBUYW5kZW0gZnJvbSAnLi4vLi4vdGFuZGVtL2pzL1RhbmRlbS5qcyc7XHJcbmltcG9ydCBJT1R5cGUgZnJvbSAnLi4vLi4vdGFuZGVtL2pzL3R5cGVzL0lPVHlwZS5qcyc7XHJcbmltcG9ydCBWb2lkSU8gZnJvbSAnLi4vLi4vdGFuZGVtL2pzL3R5cGVzL1ZvaWRJTy5qcyc7XHJcbmltcG9ydCBheG9uIGZyb20gJy4vYXhvbi5qcyc7XHJcbmltcG9ydCBQcm9wZXJ0eSwgeyBQcm9wZXJ0eU9wdGlvbnMgfSBmcm9tICcuL1Byb3BlcnR5LmpzJztcclxuaW1wb3J0IHByb3BlcnR5U3RhdGVIYW5kbGVyU2luZ2xldG9uIGZyb20gJy4vcHJvcGVydHlTdGF0ZUhhbmRsZXJTaW5nbGV0b24uanMnO1xyXG5pbXBvcnQgUHJvcGVydHlTdGF0ZVBoYXNlIGZyb20gJy4vUHJvcGVydHlTdGF0ZVBoYXNlLmpzJztcclxuaW1wb3J0IFRSZWFkT25seVByb3BlcnR5IGZyb20gJy4vVFJlYWRPbmx5UHJvcGVydHkuanMnO1xyXG5pbXBvcnQgSW50ZW50aW9uYWxBbnkgZnJvbSAnLi4vLi4vcGhldC1jb3JlL2pzL3R5cGVzL0ludGVudGlvbmFsQW55LmpzJztcclxuaW1wb3J0IG9wdGlvbml6ZSBmcm9tICcuLi8uLi9waGV0LWNvcmUvanMvb3B0aW9uaXplLmpzJztcclxuaW1wb3J0IHsgRGVwZW5kZW5jaWVzLCBSUDEsIFJQMTAsIFJQMTEsIFJQMTIsIFJQMTMsIFJQMTQsIFJQMTUsIFJQMiwgUlAzLCBSUDQsIFJQNSwgUlA2LCBSUDcsIFJQOCwgUlA5IH0gZnJvbSAnLi9NdWx0aWxpbmsuanMnO1xyXG5pbXBvcnQgUmVhZE9ubHlQcm9wZXJ0eSwgeyBkZXJpdmF0aW9uU3RhY2sgfSBmcm9tICcuL1JlYWRPbmx5UHJvcGVydHkuanMnO1xyXG5pbXBvcnQgUGhldGlvT2JqZWN0IGZyb20gJy4uLy4uL3RhbmRlbS9qcy9QaGV0aW9PYmplY3QuanMnO1xyXG5pbXBvcnQgSU9UeXBlQ2FjaGUgZnJvbSAnLi4vLi4vdGFuZGVtL2pzL0lPVHlwZUNhY2hlLmpzJztcclxuXHJcbmNvbnN0IERFUklWRURfUFJPUEVSVFlfSU9fUFJFRklYID0gJ0Rlcml2ZWRQcm9wZXJ0eUlPJztcclxuXHJcbnR5cGUgU2VsZk9wdGlvbnMgPSB7XHJcblxyXG4gIC8vIFdoZW4gdHJ1ZSwgaWYgdGhpcyBEZXJpdmVkUHJvcGVydHkgaXMgUGhFVC1pTyBpbnN0cnVtZW50LCBhZGQgYSBMaW5rZWRFbGVtZW50IGZvciBlYWNoIFBoRVQtaU8gaW5zdHJ1bWVudGVkIGRlcGVuZGVuY3kuXHJcbiAgcGhldGlvTGlua0RlcGVuZGVuY2llcz86IGJvb2xlYW47XHJcblxyXG4gIC8vIFR5cGljYWxseSwgYSBEZXJpdmVkUHJvcGVydHkgc2hvdWxkIG9ubHkgZ2V0IHZhbHVlcyBmb3IgaXRzIGltbWVkaWF0ZSBkZXBlbmRlbmNpZXMsIG90aGVyd2lzZSBpdCBjb3VsZCBlbmQgdXAgaW4gYVxyXG4gIC8vIHNpdHVhdGlvbiB3aGVyZSBzb21lIHZhbHVlIGNlbnRyYWwgdG8gdGhlIGRlcml2YXRpb24gaGFzIGNoYW5nZWQsIGJ1dCB0aGUgZGVyaXZlZCBwcm9wZXJ0eSBkb2Vzbid0IHVwZGF0ZSBiZWNhdXNlXHJcbiAgLy8gaXQgaXNuJ3QgbGlzdGVuaW5nLiBUaGVzZSBjaGVja3MgY2FuIGJlIGVuYWJsZWQgdmlhIGEgcGFja2FnZS5qc29uIGZsYWcgc2ltRmVhdHVyZXMuc3RyaWN0QXhvbkRlcGVuZGVuY2llcyBvclxyXG4gIC8vIHRoZSBxdWVyeSBwYXJhbWV0ZXIgP3N0cmljdEF4b25EZXBlbmRlbmNpZXM9dHJ1ZS4gVGhlIHF1ZXJ5IHBhcmFtZXRlciB0YWtlcyBwcmVjZWRlbmNlLlxyXG4gIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMvYXhvbi9pc3N1ZXMvNDQxXHJcbiAgc3RyaWN0QXhvbkRlcGVuZGVuY2llcz86IGJvb2xlYW47XHJcbn07XHJcblxyXG5leHBvcnQgdHlwZSBEZXJpdmVkUHJvcGVydHlPcHRpb25zPFQ+ID0gU2VsZk9wdGlvbnMgJiBQcm9wZXJ0eU9wdGlvbnM8VD47XHJcblxyXG5jb25zdCBzdHJpY3RBeG9uRGVwZW5kZW5jaWVzR2xvYmFsID0gXy5oYXNJbiggd2luZG93LCAncGhldC5jaGlwcGVyLnF1ZXJ5UGFyYW1ldGVycycgKSAmJiBwaGV0LmNoaXBwZXIucXVlcnlQYXJhbWV0ZXJzLnN0cmljdEF4b25EZXBlbmRlbmNpZXM7XHJcblxyXG4vKipcclxuICogQ29tcHV0ZSB0aGUgZGVyaXZlZCB2YWx1ZSBnaXZlbiBhIGRlcml2YXRpb24gYW5kIGFuIGFycmF5IG9mIGRlcGVuZGVuY2llc1xyXG4gKi9cclxuZnVuY3Rpb24gZ2V0RGVyaXZlZFZhbHVlPFQsIFQxLCBUMiwgVDMsIFQ0LCBUNSwgVDYsIFQ3LCBUOCwgVDksIFQxMCwgVDExLCBUMTIsIFQxMywgVDE0LCBUMTU+KCBzdHJpY3RBeG9uRGVwZW5kZW5jaWVzOiBib29sZWFuLCBkZXJpdmF0aW9uOiAoIC4uLnBhcmFtczogWyBUMSwgVDIsIFQzLCBUNCwgVDUsIFQ2LCBUNywgVDgsIFQ5LCBUMTAsIFQxMSwgVDEyLCBUMTMsIFQxNCwgVDE1IF0gKSA9PiBULCBkZXBlbmRlbmNpZXM6IERlcGVuZGVuY2llczxUMSwgVDIsIFQzLCBUNCwgVDUsIFQ2LCBUNywgVDgsIFQ5LCBUMTAsIFQxMSwgVDEyLCBUMTMsIFQxNCwgVDE1PiApOiBUIHtcclxuXHJcbiAgYXNzZXJ0ICYmIHN0cmljdEF4b25EZXBlbmRlbmNpZXNHbG9iYWwgJiYgc3RyaWN0QXhvbkRlcGVuZGVuY2llcyAmJiBkZXJpdmF0aW9uU3RhY2sucHVzaCggZGVwZW5kZW5jaWVzICk7XHJcblxyXG4gIHRyeSB7XHJcblxyXG4gICAgLy8gQHRzLWV4cGVjdC1lcnJvclxyXG4gICAgcmV0dXJuIGRlcml2YXRpb24oIC4uLmRlcGVuZGVuY2llcy5tYXAoIHByb3BlcnR5ID0+IHByb3BlcnR5LmdldCgpICkgKTtcclxuICB9XHJcbiAgZmluYWxseSB7XHJcbiAgICBhc3NlcnQgJiYgc3RyaWN0QXhvbkRlcGVuZGVuY2llc0dsb2JhbCAmJiBzdHJpY3RBeG9uRGVwZW5kZW5jaWVzICYmIGRlcml2YXRpb25TdGFjay5wb3AoKTtcclxuICB9XHJcbn1cclxuXHJcbi8vIENvbnZlbmllbmNlIHR5cGUgZm9yIGEgRGVyaXZlZCBwcm9wZXJ0eSB0aGF0IGhhcyBhIGtub3duIHJldHVybiB0eXBlIGJ1dCB1bmtub3duIGRlcGVuZGVuY3kgdHlwZXMuXHJcbmV4cG9ydCB0eXBlIFVua25vd25EZXJpdmVkUHJvcGVydHk8VD4gPSBEZXJpdmVkUHJvcGVydHk8VCwgdW5rbm93biwgdW5rbm93biwgdW5rbm93biwgdW5rbm93biwgdW5rbm93biwgdW5rbm93biwgdW5rbm93biwgdW5rbm93biwgdW5rbm93biwgdW5rbm93biwgdW5rbm93biwgdW5rbm93biwgdW5rbm93biwgdW5rbm93biwgdW5rbm93bj47XHJcblxyXG4vKipcclxuICogVCA9IHR5cGUgb2YgdGhlIGRlcml2ZWQgdmFsdWVcclxuICogUGFyYW1ldGVyc1tdID0gdHlwZXMgb2YgdGhlIGNhbGxiYWNrIHBhcmFtZXRlcnMsIGUuZy4gWyBWZWN0b3IyLCBudW1iZXIsIGJvb2xlYW4gXVxyXG4gKi9cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRGVyaXZlZFByb3BlcnR5PFQsIFQxLCBUMiwgVDMsIFQ0LCBUNSwgVDYsIFQ3LCBUOCwgVDksIFQxMCwgVDExLCBUMTIsIFQxMywgVDE0LCBUMTU+IGV4dGVuZHMgUmVhZE9ubHlQcm9wZXJ0eTxUPiBpbXBsZW1lbnRzIFRSZWFkT25seVByb3BlcnR5PFQ+IHtcclxuICBwcml2YXRlIGRlcGVuZGVuY2llczogRGVwZW5kZW5jaWVzPFQxLCBUMiwgVDMsIFQ0LCBUNSwgVDYsIFQ3LCBUOCwgVDksIFQxMCwgVDExLCBUMTIsIFQxMywgVDE0LCBUMTU+IHwgbnVsbDtcclxuICBwcml2YXRlIHJlYWRvbmx5IGRlcml2YXRpb246ICggLi4ucGFyYW1zOiBbIFQxLCBUMiwgVDMsIFQ0LCBUNSwgVDYsIFQ3LCBUOCwgVDksIFQxMCwgVDExLCBUMTIsIFQxMywgVDE0LCBUMTUgXSApID0+IFQ7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBkZXJpdmVkUHJvcGVydHlMaXN0ZW5lcjogKCkgPT4gdm9pZDtcclxuICBwcml2YXRlIHJlYWRvbmx5IHN0cmljdEF4b25EZXBlbmRlbmNpZXM6IGJvb2xlYW47XHJcblxyXG4gIHB1YmxpYyBzdGF0aWMgRGVyaXZlZFByb3BlcnR5SU86ICggcGFyYW1ldGVyVHlwZTogSU9UeXBlICkgPT4gSU9UeXBlO1xyXG5cclxuICAvKipcclxuICAgKiBAcGFyYW0gZGVwZW5kZW5jaWVzIC0gUHJvcGVydGllcyB0aGF0IHRoaXMgUHJvcGVydHkncyB2YWx1ZSBpcyBkZXJpdmVkIGZyb21cclxuICAgKiBAcGFyYW0gZGVyaXZhdGlvbiAtIGZ1bmN0aW9uIHRoYXQgZGVyaXZlcyB0aGlzIFByb3BlcnR5J3MgdmFsdWUsIGV4cGVjdHMgYXJncyBpbiB0aGUgc2FtZSBvcmRlciBhcyBkZXBlbmRlbmNpZXNcclxuICAgKiBAcGFyYW0gW3Byb3ZpZGVkT3B0aW9uc10gLSBzZWUgUHJvcGVydHlcclxuICAgKi9cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIGRlcGVuZGVuY2llczogUlAxPFQxPiwgZGVyaXZhdGlvbjogKCAuLi5wYXJhbXM6IFsgVDEgXSApID0+IFQsIHByb3ZpZGVkT3B0aW9ucz86IERlcml2ZWRQcm9wZXJ0eU9wdGlvbnM8VD4gKSA7XHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBkZXBlbmRlbmNpZXM6IFJQMjxUMSwgVDI+LCBkZXJpdmF0aW9uOiAoIC4uLnBhcmFtczogWyBUMSwgVDIgXSApID0+IFQsIHByb3ZpZGVkT3B0aW9ucz86IERlcml2ZWRQcm9wZXJ0eU9wdGlvbnM8VD4gKSA7XHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBkZXBlbmRlbmNpZXM6IFJQMzxUMSwgVDIsIFQzPiwgZGVyaXZhdGlvbjogKCAuLi5wYXJhbXM6IFsgVDEsIFQyLCBUMyBdICkgPT4gVCwgcHJvdmlkZWRPcHRpb25zPzogRGVyaXZlZFByb3BlcnR5T3B0aW9uczxUPiApIDtcclxuICBwdWJsaWMgY29uc3RydWN0b3IoIGRlcGVuZGVuY2llczogUlA0PFQxLCBUMiwgVDMsIFQ0PiwgZGVyaXZhdGlvbjogKCAuLi5wYXJhbXM6IFsgVDEsIFQyLCBUMywgVDQgXSApID0+IFQsIHByb3ZpZGVkT3B0aW9ucz86IERlcml2ZWRQcm9wZXJ0eU9wdGlvbnM8VD4gKSA7XHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBkZXBlbmRlbmNpZXM6IFJQNTxUMSwgVDIsIFQzLCBUNCwgVDU+LCBkZXJpdmF0aW9uOiAoIC4uLnBhcmFtczogWyBUMSwgVDIsIFQzLCBUNCwgVDUgXSApID0+IFQsIHByb3ZpZGVkT3B0aW9ucz86IERlcml2ZWRQcm9wZXJ0eU9wdGlvbnM8VD4gKSA7XHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBkZXBlbmRlbmNpZXM6IFJQNjxUMSwgVDIsIFQzLCBUNCwgVDUsIFQ2PiwgZGVyaXZhdGlvbjogKCAuLi5wYXJhbXM6IFsgVDEsIFQyLCBUMywgVDQsIFQ1LCBUNiBdICkgPT4gVCwgcHJvdmlkZWRPcHRpb25zPzogRGVyaXZlZFByb3BlcnR5T3B0aW9uczxUPiApIDtcclxuICBwdWJsaWMgY29uc3RydWN0b3IoIGRlcGVuZGVuY2llczogUlA3PFQxLCBUMiwgVDMsIFQ0LCBUNSwgVDYsIFQ3PiwgZGVyaXZhdGlvbjogKCAuLi5wYXJhbXM6IFsgVDEsIFQyLCBUMywgVDQsIFQ1LCBUNiwgVDcgXSApID0+IFQsIHByb3ZpZGVkT3B0aW9ucz86IERlcml2ZWRQcm9wZXJ0eU9wdGlvbnM8VD4gKSA7XHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBkZXBlbmRlbmNpZXM6IFJQODxUMSwgVDIsIFQzLCBUNCwgVDUsIFQ2LCBUNywgVDg+LCBkZXJpdmF0aW9uOiAoIC4uLnBhcmFtczogWyBUMSwgVDIsIFQzLCBUNCwgVDUsIFQ2LCBUNywgVDggXSApID0+IFQsIHByb3ZpZGVkT3B0aW9ucz86IERlcml2ZWRQcm9wZXJ0eU9wdGlvbnM8VD4gKSA7XHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBkZXBlbmRlbmNpZXM6IFJQOTxUMSwgVDIsIFQzLCBUNCwgVDUsIFQ2LCBUNywgVDgsIFQ5PiwgZGVyaXZhdGlvbjogKCAuLi5wYXJhbXM6IFsgVDEsIFQyLCBUMywgVDQsIFQ1LCBUNiwgVDcsIFQ4LCBUOSBdICkgPT4gVCwgcHJvdmlkZWRPcHRpb25zPzogRGVyaXZlZFByb3BlcnR5T3B0aW9uczxUPiApIDtcclxuICBwdWJsaWMgY29uc3RydWN0b3IoIGRlcGVuZGVuY2llczogUlAxMDxUMSwgVDIsIFQzLCBUNCwgVDUsIFQ2LCBUNywgVDgsIFQ5LCBUMTA+LCBkZXJpdmF0aW9uOiAoIC4uLnBhcmFtczogWyBUMSwgVDIsIFQzLCBUNCwgVDUsIFQ2LCBUNywgVDgsIFQ5LCBUMTAgXSApID0+IFQsIHByb3ZpZGVkT3B0aW9ucz86IERlcml2ZWRQcm9wZXJ0eU9wdGlvbnM8VD4gKSA7XHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBkZXBlbmRlbmNpZXM6IFJQMTE8VDEsIFQyLCBUMywgVDQsIFQ1LCBUNiwgVDcsIFQ4LCBUOSwgVDEwLCBUMTE+LCBkZXJpdmF0aW9uOiAoIC4uLnBhcmFtczogWyBUMSwgVDIsIFQzLCBUNCwgVDUsIFQ2LCBUNywgVDgsIFQ5LCBUMTAsIFQxMSBdICkgPT4gVCwgcHJvdmlkZWRPcHRpb25zPzogRGVyaXZlZFByb3BlcnR5T3B0aW9uczxUPiApIDtcclxuICBwdWJsaWMgY29uc3RydWN0b3IoIGRlcGVuZGVuY2llczogUlAxMjxUMSwgVDIsIFQzLCBUNCwgVDUsIFQ2LCBUNywgVDgsIFQ5LCBUMTAsIFQxMSwgVDEyPiwgZGVyaXZhdGlvbjogKCAuLi5wYXJhbXM6IFsgVDEsIFQyLCBUMywgVDQsIFQ1LCBUNiwgVDcsIFQ4LCBUOSwgVDEwLCBUMTEsIFQxMiBdICkgPT4gVCwgcHJvdmlkZWRPcHRpb25zPzogRGVyaXZlZFByb3BlcnR5T3B0aW9uczxUPiApIDtcclxuICBwdWJsaWMgY29uc3RydWN0b3IoIGRlcGVuZGVuY2llczogUlAxMzxUMSwgVDIsIFQzLCBUNCwgVDUsIFQ2LCBUNywgVDgsIFQ5LCBUMTAsIFQxMSwgVDEyLCBUMTM+LCBkZXJpdmF0aW9uOiAoIC4uLnBhcmFtczogWyBUMSwgVDIsIFQzLCBUNCwgVDUsIFQ2LCBUNywgVDgsIFQ5LCBUMTAsIFQxMSwgVDEyLCBUMTMgXSApID0+IFQsIHByb3ZpZGVkT3B0aW9ucz86IERlcml2ZWRQcm9wZXJ0eU9wdGlvbnM8VD4gKSA7XHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBkZXBlbmRlbmNpZXM6IFJQMTQ8VDEsIFQyLCBUMywgVDQsIFQ1LCBUNiwgVDcsIFQ4LCBUOSwgVDEwLCBUMTEsIFQxMiwgVDEzLCBUMTQ+LCBkZXJpdmF0aW9uOiAoIC4uLnBhcmFtczogWyBUMSwgVDIsIFQzLCBUNCwgVDUsIFQ2LCBUNywgVDgsIFQ5LCBUMTAsIFQxMSwgVDEyLCBUMTMsIFQxNCBdICkgPT4gVCwgcHJvdmlkZWRPcHRpb25zPzogRGVyaXZlZFByb3BlcnR5T3B0aW9uczxUPiApIDtcclxuICBwdWJsaWMgY29uc3RydWN0b3IoIGRlcGVuZGVuY2llczogUlAxNTxUMSwgVDIsIFQzLCBUNCwgVDUsIFQ2LCBUNywgVDgsIFQ5LCBUMTAsIFQxMSwgVDEyLCBUMTMsIFQxNCwgVDE1PiwgZGVyaXZhdGlvbjogKCAuLi5wYXJhbXM6IFsgVDEsIFQyLCBUMywgVDQsIFQ1LCBUNiwgVDcsIFQ4LCBUOSwgVDEwLCBUMTEsIFQxMiwgVDEzLCBUMTQsIFQxNSBdICkgPT4gVCwgcHJvdmlkZWRPcHRpb25zPzogRGVyaXZlZFByb3BlcnR5T3B0aW9uczxUPiApIDtcclxuICBwdWJsaWMgY29uc3RydWN0b3IoIGRlcGVuZGVuY2llczogRGVwZW5kZW5jaWVzPFQxLCBUMiwgVDMsIFQ0LCBUNSwgVDYsIFQ3LCBUOCwgVDksIFQxMCwgVDExLCBUMTIsIFQxMywgVDE0LCBUMTU+LCBkZXJpdmF0aW9uOiAoIC4uLnBhcmFtczogWyBUMSwgVDIsIFQzLCBUNCwgVDUsIFQ2LCBUNywgVDgsIFQ5LCBUMTAsIFQxMSwgVDEyLCBUMTMsIFQxNCwgVDE1IF0gKSA9PiBULCBwcm92aWRlZE9wdGlvbnM/OiBEZXJpdmVkUHJvcGVydHlPcHRpb25zPFQ+ICk7XHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBkZXBlbmRlbmNpZXM6IERlcGVuZGVuY2llczxUMSwgVDIsIFQzLCBUNCwgVDUsIFQ2LCBUNywgVDgsIFQ5LCBUMTAsIFQxMSwgVDEyLCBUMTMsIFQxNCwgVDE1PiwgZGVyaXZhdGlvbjogKCAuLi5wYXJhbXM6IFsgVDEsIFQyLCBUMywgVDQsIFQ1LCBUNiwgVDcsIFQ4LCBUOSwgVDEwLCBUMTEsIFQxMiwgVDEzLCBUMTQsIFQxNSBdICkgPT4gVCwgcHJvdmlkZWRPcHRpb25zPzogRGVyaXZlZFByb3BlcnR5T3B0aW9uczxUPiApIHtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0gb3B0aW9uaXplPERlcml2ZWRQcm9wZXJ0eU9wdGlvbnM8VD4sIFNlbGZPcHRpb25zLCBQcm9wZXJ0eU9wdGlvbnM8VD4+KCkoIHtcclxuICAgICAgcGhldGlvUmVhZE9ubHk6IHRydWUsIC8vIGRlcml2ZWQgcHJvcGVydGllcyBjYW4gYmUgcmVhZCBidXQgbm90IHNldCBieSBQaEVULWlPXHJcbiAgICAgIHBoZXRpb091dGVyVHlwZTogRGVyaXZlZFByb3BlcnR5LkRlcml2ZWRQcm9wZXJ0eUlPLFxyXG4gICAgICBwaGV0aW9MaW5rRGVwZW5kZW5jaWVzOiB0cnVlLFxyXG4gICAgICBzdHJpY3RBeG9uRGVwZW5kZW5jaWVzOiB0cnVlXHJcbiAgICB9LCBwcm92aWRlZE9wdGlvbnMgKTtcclxuXHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBkZXBlbmRlbmNpZXMuZXZlcnkoIF8uaWRlbnRpdHkgKSwgJ2RlcGVuZGVuY2llcyBzaG91bGQgYWxsIGJlIHRydXRoeScgKTtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIGRlcGVuZGVuY2llcy5sZW5ndGggPT09IF8udW5pcSggZGVwZW5kZW5jaWVzICkubGVuZ3RoLCAnZHVwbGljYXRlIGRlcGVuZGVuY2llcycgKTtcclxuXHJcbiAgICBjb25zdCBpbml0aWFsVmFsdWUgPSBnZXREZXJpdmVkVmFsdWUoIG9wdGlvbnMuc3RyaWN0QXhvbkRlcGVuZGVuY2llcywgZGVyaXZhdGlvbiwgZGVwZW5kZW5jaWVzICk7XHJcblxyXG4gICAgLy8gV2UgbXVzdCBwYXNzIHN1cGVydHlwZSB0YW5kZW0gdG8gcGFyZW50IGNsYXNzIHNvIGFkZEluc3RhbmNlIGlzIGNhbGxlZCBvbmx5IG9uY2UgaW4gdGhlIHN1YmNsYXNzaWVzdCBjb25zdHJ1Y3Rvci5cclxuICAgIHN1cGVyKCBpbml0aWFsVmFsdWUsIG9wdGlvbnMgKTtcclxuXHJcbiAgICBpZiAoIFRhbmRlbS5WQUxJREFUSU9OICYmIHRoaXMuaXNQaGV0aW9JbnN0cnVtZW50ZWQoKSApIHtcclxuXHJcbiAgICAgIC8vIFRoZSBwaGV0aW9UeXBlIHNob3VsZCBiZSBhIGNvbmNyZXRlIChpbnN0YW50aWF0ZWQpIERlcml2ZWRQcm9wZXJ0eUlPLCBoZW5jZSB3ZSBtdXN0IGNoZWNrIGl0cyBvdXRlciB0eXBlXHJcbiAgICAgIGFzc2VydCAmJiBhc3NlcnQoIHRoaXMucGhldGlvVHlwZS50eXBlTmFtZS5zdGFydHNXaXRoKCAnRGVyaXZlZFByb3BlcnR5SU8nICksICdwaGV0aW9UeXBlIHNob3VsZCBiZSBEZXJpdmVkUHJvcGVydHlJTycgKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmRlcGVuZGVuY2llcyA9IGRlcGVuZGVuY2llcztcclxuICAgIHRoaXMuZGVyaXZhdGlvbiA9IGRlcml2YXRpb247XHJcbiAgICB0aGlzLnN0cmljdEF4b25EZXBlbmRlbmNpZXMgPSBvcHRpb25zLnN0cmljdEF4b25EZXBlbmRlbmNpZXM7XHJcbiAgICB0aGlzLmRlcml2ZWRQcm9wZXJ0eUxpc3RlbmVyID0gdGhpcy5nZXREZXJpdmVkUHJvcGVydHlMaXN0ZW5lci5iaW5kKCB0aGlzICk7XHJcblxyXG4gICAgZGVwZW5kZW5jaWVzLmZvckVhY2goIGRlcGVuZGVuY3kgPT4ge1xyXG5cclxuICAgICAgZGVwZW5kZW5jeS5sYXp5TGluayggdGhpcy5kZXJpdmVkUHJvcGVydHlMaXN0ZW5lciApO1xyXG5cclxuICAgICAgaWYgKCBUYW5kZW0uUEhFVF9JT19FTkFCTEVEICYmIHRoaXMuaXNQaGV0aW9JbnN0cnVtZW50ZWQoKSAmJiBkZXBlbmRlbmN5IGluc3RhbmNlb2YgUGhldGlvT2JqZWN0ICYmIGRlcGVuZGVuY3kuaXNQaGV0aW9JbnN0cnVtZW50ZWQoKSApIHtcclxuICAgICAgICBpZiAoIGRlcGVuZGVuY3kgaW5zdGFuY2VvZiBSZWFkT25seVByb3BlcnR5ICkge1xyXG5cclxuICAgICAgICAgIC8vIERlcGVuZGVuY2llcyBzaG91bGQgaGF2ZSB0YWtlbiB0aGVpciBjb3JyZWN0IHZhbHVlcyBiZWZvcmUgdGhpcyBEZXJpdmVkUHJvcGVydHkgdW5kZWZlcnMsIHNvIGl0IHdpbGwgYmUgc3VyZVxyXG4gICAgICAgICAgLy8gdG8gaGF2ZSB0aGUgcmlnaHQgdmFsdWUuXHJcbiAgICAgICAgICAvLyBOT1RFOiBEbyBub3QgbWFyayB0aGUgYmVmb3JlUGhhc2UgYXMgTk9USUZZLCBhcyB0aGlzIHdpbGwgcG90ZW50aWFsbHkgY2F1c2UgaW50ZXJkZXBlbmRlbmNlIGJ1Z3Mgd2hlbiB1c2VkXHJcbiAgICAgICAgICAvLyB3aXRoIE11bHRpbGlua3MuIFNlZSBQcm9qZWN0aWxlIE1vdGlvbidzIHVzZSBvZiBNZWFzdXJpbmdUYXBlTm9kZSBmb3IgYW4gZXhhbXBsZS5cclxuICAgICAgICAgIHByb3BlcnR5U3RhdGVIYW5kbGVyU2luZ2xldG9uLnJlZ2lzdGVyUGhldGlvT3JkZXJEZXBlbmRlbmN5KCBkZXBlbmRlbmN5LCBQcm9wZXJ0eVN0YXRlUGhhc2UuVU5ERUZFUiwgdGhpcywgUHJvcGVydHlTdGF0ZVBoYXNlLlVOREVGRVIgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICggb3B0aW9ucy50YW5kZW0gJiYgb3B0aW9ucy5waGV0aW9MaW5rRGVwZW5kZW5jaWVzICkge1xyXG4gICAgICAgICAgY29uc3QgZGVwZW5kZW5jaWVzVGFuZGVtID0gb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnZGVwZW5kZW5jaWVzJyApO1xyXG4gICAgICAgICAgdGhpcy5hZGRMaW5rZWRFbGVtZW50KCBkZXBlbmRlbmN5LCB7XHJcbiAgICAgICAgICAgIHRhbmRlbTogZGVwZW5kZW5jaWVzVGFuZGVtLmNyZWF0ZVRhbmRlbUZyb21QaGV0aW9JRCggZGVwZW5kZW5jeS50YW5kZW0ucGhldGlvSUQgKVxyXG4gICAgICAgICAgfSApO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRGV0ZXJtaW5lcyB3aGV0aGVyIHRoaXMgRGVyaXZlZFByb3BlcnR5IGhhcyBhIHNwZWNpZmljIGRlcGVuZGVuY3kuXHJcbiAgICovXHJcbiAgcHVibGljIGhhc0RlcGVuZGVuY3koIGRlcGVuZGVuY3k6IFRSZWFkT25seVByb3BlcnR5PEludGVudGlvbmFsQW55PiApOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0aGlzLmRlZmluZWREZXBlbmRlbmNpZXMuaW5jbHVkZXMoIGRlcGVuZGVuY3kgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHVybnMgZGVwZW5kZW5jaWVzIHRoYXQgYXJlIGd1YXJhbnRlZWQgdG8gYmUgZGVmaW5lZCBpbnRlcm5hbGx5LlxyXG4gICAqL1xyXG4gIHByaXZhdGUgZ2V0IGRlZmluZWREZXBlbmRlbmNpZXMoKTogRGVwZW5kZW5jaWVzPFQxLCBUMiwgVDMsIFQ0LCBUNSwgVDYsIFQ3LCBUOCwgVDksIFQxMCwgVDExLCBUMTIsIFQxMywgVDE0LCBUMTU+IHtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIHRoaXMuZGVwZW5kZW5jaWVzICE9PSBudWxsLCAnRGVwZW5kZW5jaWVzIHNob3VsZCBiZSBkZWZpbmVkLCBoYXMgdGhpcyBQcm9wZXJ0eSBiZWVuIGRpc3Bvc2VkPycgKTtcclxuICAgIHJldHVybiB0aGlzLmRlcGVuZGVuY2llcyE7XHJcbiAgfVxyXG5cclxuICAvLyBmb3IgYmluZFxyXG4gIHByaXZhdGUgZ2V0RGVyaXZlZFByb3BlcnR5TGlzdGVuZXIoKTogdm9pZCB7XHJcbiAgICAvLyBEb24ndCB0cnkgdG8gcmVjb21wdXRlIGlmIHdlIGFyZSBkaXNwb3NlZCwgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9heG9uL2lzc3Vlcy80MzJcclxuICAgIGlmICggdGhpcy5pc0Rpc3Bvc2VkICkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgLy8gSnVzdCBtYXJrIHRoYXQgdGhlcmUgaXMgYSBkZWZlcnJlZCB2YWx1ZSwgdGhlbiBjYWxjdWxhdGUgdGhlIGRlcml2YXRpb24gYmVsb3cgd2hlbiBzZXREZWZlcnJlZCgpIGlzIGNhbGxlZC5cclxuICAgIC8vIFRoaXMgaXMgaW4gcGFydCBzdXBwb3J0ZWQgYnkgdGhlIFBoRVQtaU8gc3RhdGUgZW5naW5lIGJlY2F1c2UgaXQgY2FuIGFjY291bnQgZm9yIGludGVybWVkaWF0ZSBzdGF0ZXMsIHN1Y2hcclxuICAgIC8vIHRoYXQgdGhpcyBQcm9wZXJ0eSB3b24ndCBub3RpZnkgdW50aWwgYWZ0ZXIgaXQgaXMgdW5kZWZlcnJlZCBhbmQgaGFzIHRha2VuIGl0cyBmaW5hbCB2YWx1ZS5cclxuICAgIGlmICggdGhpcy5pc0RlZmVycmVkICkge1xyXG4gICAgICB0aGlzLmhhc0RlZmVycmVkVmFsdWUgPSB0cnVlO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIHN1cGVyLnNldCggZ2V0RGVyaXZlZFZhbHVlKCB0aGlzLnN0cmljdEF4b25EZXBlbmRlbmNpZXMsIHRoaXMuZGVyaXZhdGlvbiwgdGhpcy5kZWZpbmVkRGVwZW5kZW5jaWVzICkgKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEFsbG93cyBmb3JjaW5nIGEgcmVjb21wdXRhdGlvbiAoYXMgYSBwb3NzaWJsZSB3b3JrYXJvdW5kIHRvIGxpc3RlbmVyIG9yZGVyKS4gVGhpcyB3b3JrcyB3ZWxsIGlmIHlvdSBoYXZlIGFcclxuICAgKiBub24tUHJvcGVydHkgZXZlbnQgdGhhdCBzaG91bGQgdHJpZ2dlciBhIHZhbHVlIGNoYW5nZSBmb3IgdGhpcyBQcm9wZXJ0eS5cclxuICAgKlxyXG4gICAqIEZvciBleGFtcGxlOlxyXG4gICAqIG15RW1pdHRlci5hZGRMaXN0ZW5lciggKCkgPT4gbXlEZXJpdmVkUHJvcGVydHkucmVjb21wdXRlRGVyaXZhdGlvbigpICk7XHJcbiAgICogbXlPYnNlcnZhYmxlQXJyYXkuYWRkSXRlbUFkZGVkTGlzdGVuZXIoICgpID0+IG15RGVyaXZlZFByb3BlcnR5LnJlY29tcHV0ZURlcml2YXRpb24oKSApO1xyXG4gICAqL1xyXG4gIHB1YmxpYyByZWNvbXB1dGVEZXJpdmF0aW9uKCk6IHZvaWQge1xyXG4gICAgdGhpcy5nZXREZXJpdmVkUHJvcGVydHlMaXN0ZW5lcigpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIG92ZXJyaWRlIGRpc3Bvc2UoKTogdm9pZCB7XHJcblxyXG4gICAgY29uc3QgZGVwZW5kZW5jaWVzID0gdGhpcy5kZWZpbmVkRGVwZW5kZW5jaWVzO1xyXG5cclxuICAgIC8vIFVubGluayBmcm9tIGRlcGVuZGVudCBQcm9wZXJ0aWVzXHJcbiAgICBmb3IgKCBsZXQgaSA9IDA7IGkgPCBkZXBlbmRlbmNpZXMubGVuZ3RoOyBpKysgKSB7XHJcbiAgICAgIGNvbnN0IGRlcGVuZGVuY3kgPSBkZXBlbmRlbmNpZXNbIGkgXTtcclxuICAgICAgaWYgKCBkZXBlbmRlbmN5Lmhhc0xpc3RlbmVyKCB0aGlzLmRlcml2ZWRQcm9wZXJ0eUxpc3RlbmVyICkgKSB7XHJcbiAgICAgICAgZGVwZW5kZW5jeS51bmxpbmsoIHRoaXMuZGVyaXZlZFByb3BlcnR5TGlzdGVuZXIgKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgdGhpcy5kZXBlbmRlbmNpZXMgPSBudWxsO1xyXG5cclxuICAgIHN1cGVyLmRpc3Bvc2UoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFN1cHBvcnQgZGVmZXJyZWQgRGVyaXZlZFByb3BlcnR5IGJ5IG9ubHkgY2FsY3VsYXRpbmcgdGhlIGRlcml2YXRpb24gb25jZSB3aGVuIGl0IGlzIHRpbWUgdG8gdW5kZWZlciBpdCBhbmQgZmlyZVxyXG4gICAqIG5vdGlmaWNhdGlvbnMuIFRoaXMgd2F5IHdlIGRvbid0IGhhdmUgaW50ZXJtZWRpYXRlIGRlcml2YXRpb24gY2FsbHMgZHVyaW5nIFBoRVQtaU8gc3RhdGUgc2V0dGluZy5cclxuICAgKi9cclxuICBwdWJsaWMgb3ZlcnJpZGUgc2V0RGVmZXJyZWQoIGlzRGVmZXJyZWQ6IGJvb2xlYW4gKTogKCAoKSA9PiB2b2lkICkgfCBudWxsIHtcclxuICAgIGlmICggdGhpcy5pc0RlZmVycmVkICYmICFpc0RlZmVycmVkICkge1xyXG4gICAgICB0aGlzLmRlZmVycmVkVmFsdWUgPSBnZXREZXJpdmVkVmFsdWUoIHRoaXMuc3RyaWN0QXhvbkRlcGVuZGVuY2llcywgdGhpcy5kZXJpdmF0aW9uLCB0aGlzLmRlZmluZWREZXBlbmRlbmNpZXMgKTtcclxuICAgIH1cclxuICAgIHJldHVybiBzdXBlci5zZXREZWZlcnJlZCggaXNEZWZlcnJlZCApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ3JlYXRlcyBhIGRlcml2ZWQgYm9vbGVhbiBQcm9wZXJ0eSB3aG9zZSB2YWx1ZSBpcyB0cnVlIGlmZiBmaXJzdFByb3BlcnR5J3MgdmFsdWUgaXMgZXF1YWwgdG8gc2Vjb25kUHJvcGVydHknc1xyXG4gICAqIHZhbHVlLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgdmFsdWVFcXVhbHMoIGZpcnN0UHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PHVua25vd24+LCBzZWNvbmRQcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8dW5rbm93bj4sIG9wdGlvbnM/OiBEZXJpdmVkUHJvcGVydHlPcHRpb25zPGJvb2xlYW4+ICk6IFRSZWFkT25seVByb3BlcnR5PGJvb2xlYW4+IHtcclxuICAgIHJldHVybiBuZXcgRGVyaXZlZFByb3BlcnR5KCBbIGZpcnN0UHJvcGVydHksIHNlY29uZFByb3BlcnR5IF0sICggdTogdW5rbm93biwgdjogdW5rbm93biApID0+IHUgPT09IHYsIG9wdGlvbnMgKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzdGF0aWMgdmFsdWVFcXVhbHNDb25zdGFudCggZmlyc3RQcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8dW5rbm93bj4sIHZhbHVlOiB1bmtub3duLCBvcHRpb25zPzogRGVyaXZlZFByb3BlcnR5T3B0aW9uczxib29sZWFuPiApOiBUUmVhZE9ubHlQcm9wZXJ0eTxib29sZWFuPiB7XHJcbiAgICByZXR1cm4gbmV3IERlcml2ZWRQcm9wZXJ0eSggWyBmaXJzdFByb3BlcnR5IF0sICggdTogdW5rbm93biApID0+IHUgPT09IHZhbHVlLCBvcHRpb25zICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDcmVhdGVzIGEgZGVyaXZlZCBib29sZWFuIFByb3BlcnR5IHdob3NlIHZhbHVlIGlzIHRydWUgaWZmIGV2ZXJ5IGlucHV0IFByb3BlcnR5IHZhbHVlIGlzIHRydWUuXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBhbmQoIHByb3BlcnRpZXM6IFRSZWFkT25seVByb3BlcnR5PGJvb2xlYW4+W10sIG9wdGlvbnM/OiBQcm9wZXJ0eU9wdGlvbnM8Ym9vbGVhbj4gKTogVW5rbm93bkRlcml2ZWRQcm9wZXJ0eTxib29sZWFuPiB7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBwcm9wZXJ0aWVzLmxlbmd0aCA+IDAsICdtdXN0IHByb3ZpZGUgYSBkZXBlbmRlbmN5JyApO1xyXG5cclxuICAgIHJldHVybiBEZXJpdmVkUHJvcGVydHkuZGVyaXZlQW55KCBwcm9wZXJ0aWVzLCAoKSA9PiBfLnJlZHVjZSggcHJvcGVydGllcywgYW5kRnVuY3Rpb24sIHRydWUgKSwgb3B0aW9ucyApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ3JlYXRlcyBhIGRlcml2ZWQgYm9vbGVhbiBQcm9wZXJ0eSB3aG9zZSB2YWx1ZSBpcyB0cnVlIGlmZiBhbnkgaW5wdXQgUHJvcGVydHkgdmFsdWUgaXMgdHJ1ZS5cclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIG9yKCBwcm9wZXJ0aWVzOiBUUmVhZE9ubHlQcm9wZXJ0eTxib29sZWFuPltdLCBvcHRpb25zPzogUHJvcGVydHlPcHRpb25zPGJvb2xlYW4+ICk6IFVua25vd25EZXJpdmVkUHJvcGVydHk8Ym9vbGVhbj4ge1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggcHJvcGVydGllcy5sZW5ndGggPiAwLCAnbXVzdCBwcm92aWRlIGEgZGVwZW5kZW5jeScgKTtcclxuXHJcbiAgICByZXR1cm4gRGVyaXZlZFByb3BlcnR5LmRlcml2ZUFueSggcHJvcGVydGllcywgKCkgPT4gXy5yZWR1Y2UoIHByb3BlcnRpZXMsIG9yRnVuY3Rpb24sIGZhbHNlICksIG9wdGlvbnMgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENyZWF0ZXMgYSBkZXJpdmVkIG51bWJlciBQcm9wZXJ0eSB3aG9zZSB2YWx1ZSBpcyB0aGUgcmVzdWx0IG9mIG11bHRpcGx5aW5nIGFsbCAobnVtYmVyKSBkZXBlbmRlbmNpZXMgdG9nZXRoZXIuXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBtdWx0aXBseSggcHJvcGVydGllczogVFJlYWRPbmx5UHJvcGVydHk8bnVtYmVyPltdLCBvcHRpb25zPzogUHJvcGVydHlPcHRpb25zPG51bWJlcj4gKTogVW5rbm93bkRlcml2ZWRQcm9wZXJ0eTxudW1iZXI+IHtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIHByb3BlcnRpZXMubGVuZ3RoID4gMCwgJ211c3QgcHJvdmlkZSBhIGRlcGVuZGVuY3knICk7XHJcblxyXG4gICAgcmV0dXJuIERlcml2ZWRQcm9wZXJ0eS5kZXJpdmVBbnkoIHByb3BlcnRpZXMsICgpID0+IF8ucmVkdWNlKCBwcm9wZXJ0aWVzLCBtdWx0aXBseUZ1bmN0aW9uLCAxICksIG9wdGlvbnMgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENyZWF0ZXMgYSBkZXJpdmVkIG51bWJlciBQcm9wZXJ0eSB3aG9zZSB2YWx1ZSBpcyB0aGUgcmVzdWx0IG9mIGFkZGluZyBhbGwgKG51bWJlcikgZGVwZW5kZW5jaWVzIHRvZ2V0aGVyLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgYWRkKCBwcm9wZXJ0aWVzOiBUUmVhZE9ubHlQcm9wZXJ0eTxudW1iZXI+W10sIG9wdGlvbnM/OiBQcm9wZXJ0eU9wdGlvbnM8bnVtYmVyPiApOiBVbmtub3duRGVyaXZlZFByb3BlcnR5PG51bWJlcj4ge1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggcHJvcGVydGllcy5sZW5ndGggPiAwLCAnbXVzdCBwcm92aWRlIGEgZGVwZW5kZW5jeScgKTtcclxuXHJcbiAgICByZXR1cm4gRGVyaXZlZFByb3BlcnR5LmRlcml2ZUFueSggcHJvcGVydGllcywgKCkgPT4gXy5yZWR1Y2UoIHByb3BlcnRpZXMsIGFkZEZ1bmN0aW9uLCAwICksIG9wdGlvbnMgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENyZWF0ZXMgYSBkZXJpdmVkIGJvb2xlYW4gUHJvcGVydHkgd2hvc2UgdmFsdWUgaXMgdGhlIGludmVyc2Ugb2YgdGhlIHByb3ZpZGVkIHByb3BlcnR5LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgbm90KCBwcm9wZXJ0eVRvSW52ZXJ0OiBUUmVhZE9ubHlQcm9wZXJ0eTxib29sZWFuPiwgb3B0aW9ucz86IERlcml2ZWRQcm9wZXJ0eU9wdGlvbnM8Ym9vbGVhbj4gKTogRGVyaXZlZFByb3BlcnR5PGJvb2xlYW4sIGJvb2xlYW4sIHVua25vd24sIHVua25vd24sIHVua25vd24sIHVua25vd24sIHVua25vd24sIHVua25vd24sIHVua25vd24sIHVua25vd24sIHVua25vd24sIHVua25vd24sIHVua25vd24sIHVua25vd24sIHVua25vd24sIHVua25vd24+IHtcclxuICAgIHJldHVybiBuZXcgRGVyaXZlZFByb3BlcnR5KCBbIHByb3BlcnR5VG9JbnZlcnQgXSwgKCB4OiBib29sZWFuICkgPT4gIXgsIG9wdGlvbnMgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENyZWF0ZSBhIERlcml2ZWRQcm9wZXJ0eSBmcm9tIGFueSBudW1iZXIgb2YgZGVwZW5kZW5jaWVzLiAgVGhpcyBpcyBwYXJhbGxlbCB0byBNdWx0aWxpbmsubXVsdGlsaW5rQW55XHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBkZXJpdmVBbnk8VD4oIGRlcGVuZGVuY2llczogQXJyYXk8VFJlYWRPbmx5UHJvcGVydHk8dW5rbm93bj4+LCBkZXJpdmF0aW9uOiAoKSA9PiBULCBwcm92aWRlZE9wdGlvbnM/OiBEZXJpdmVkUHJvcGVydHlPcHRpb25zPFQ+ICk6IFVua25vd25EZXJpdmVkUHJvcGVydHk8VD4ge1xyXG4gICAgcmV0dXJuIG5ldyBEZXJpdmVkUHJvcGVydHkoXHJcbiAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3Igd2UgaGF2ZSB0byBwcm92aWRlIGEgbWFwcGluZyBiZXR3ZWVuIGFuIGFyYml0cmFyeSBsZW5ndGggYXJyYXkgYW5kIG91ciBtYXggb3ZlcmxvYWQgb2YgMTUgdHlwZXMuXHJcbiAgICAgIGRlcGVuZGVuY2llcyxcclxuXHJcbiAgICAgIGRlcml2YXRpb24sIHByb3ZpZGVkT3B0aW9ucyApO1xyXG4gIH1cclxufVxyXG5cclxuY29uc3QgYW5kRnVuY3Rpb24gPSAoIHZhbHVlOiBib29sZWFuLCBwcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8Ym9vbGVhbj4gKTogYm9vbGVhbiA9PiB7XHJcbiAgcmV0dXJuIHZhbHVlICYmIHByb3BlcnR5LnZhbHVlO1xyXG59O1xyXG5cclxuY29uc3Qgb3JGdW5jdGlvbiA9ICggdmFsdWU6IGJvb2xlYW4sIHByb3BlcnR5OiBUUmVhZE9ubHlQcm9wZXJ0eTxib29sZWFuPiApOiBib29sZWFuID0+IHtcclxuICBhc3NlcnQgJiYgYXNzZXJ0KCB0eXBlb2YgcHJvcGVydHkudmFsdWUgPT09ICdib29sZWFuJywgJ2Jvb2xlYW4gdmFsdWUgcmVxdWlyZWQnICk7XHJcbiAgcmV0dXJuIHZhbHVlIHx8IHByb3BlcnR5LnZhbHVlO1xyXG59O1xyXG5cclxuY29uc3QgbXVsdGlwbHlGdW5jdGlvbiA9ICggdmFsdWU6IG51bWJlciwgcHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PG51bWJlcj4gKTogbnVtYmVyID0+IHtcclxuICBhc3NlcnQgJiYgYXNzZXJ0KCB0eXBlb2YgcHJvcGVydHkudmFsdWUgPT09ICdudW1iZXInLCAnbnVtYmVyIHZhbHVlIHJlcXVpcmVkJyApO1xyXG4gIHJldHVybiB2YWx1ZSAqIHByb3BlcnR5LnZhbHVlO1xyXG59O1xyXG5cclxuY29uc3QgYWRkRnVuY3Rpb24gPSAoIHZhbHVlOiBudW1iZXIsIHByb3BlcnR5OiBUUmVhZE9ubHlQcm9wZXJ0eTxudW1iZXI+ICk6IG51bWJlciA9PiB7XHJcbiAgYXNzZXJ0ICYmIGFzc2VydCggdHlwZW9mIHByb3BlcnR5LnZhbHVlID09PSAnbnVtYmVyJywgJ251bWJlciB2YWx1ZSByZXF1aXJlZCcgKTtcclxuICByZXR1cm4gdmFsdWUgKyBwcm9wZXJ0eS52YWx1ZTtcclxufTtcclxuXHJcbi8vIENhY2hlIGVhY2ggcGFyYW1ldGVyaXplZCBEZXJpdmVkUHJvcGVydHlJTyBzbyB0aGF0IGl0IGlzIG9ubHkgY3JlYXRlZCBvbmNlLlxyXG5jb25zdCBjYWNoZSA9IG5ldyBJT1R5cGVDYWNoZSgpO1xyXG5cclxuLyoqXHJcbiAqIFBhcmFtZXRyaWMgSU9UeXBlIGNvbnN0cnVjdG9yLiAgR2l2ZW4gYSBwYXJhbWV0ZXIgdHlwZSwgdGhpcyBmdW5jdGlvbiByZXR1cm5zIGFuIGFwcHJvcHJpYXRlIERlcml2ZWRQcm9wZXJ0eVxyXG4gKiBJT1R5cGUuIFVubGlrZSBQcm9wZXJ0eUlPLCBEZXJpdmVkUHJvcGVydHlJTyBjYW5ub3QgYmUgc2V0IGJ5IFBoRVQtaU8gY2xpZW50cy5cclxuICogVGhpcyBjYWNoaW5nIGltcGxlbWVudGF0aW9uIHNob3VsZCBiZSBrZXB0IGluIHN5bmMgd2l0aCB0aGUgb3RoZXIgcGFyYW1ldHJpYyBJT1R5cGUgY2FjaGluZyBpbXBsZW1lbnRhdGlvbnMuXHJcbiAqL1xyXG5EZXJpdmVkUHJvcGVydHkuRGVyaXZlZFByb3BlcnR5SU8gPSBwYXJhbWV0ZXJUeXBlID0+IHtcclxuICBhc3NlcnQgJiYgYXNzZXJ0KCBwYXJhbWV0ZXJUeXBlLCAnRGVyaXZlZFByb3BlcnR5SU8gbmVlZHMgcGFyYW1ldGVyVHlwZScgKTtcclxuXHJcbiAgaWYgKCAhY2FjaGUuaGFzKCBwYXJhbWV0ZXJUeXBlICkgKSB7XHJcbiAgICBjYWNoZS5zZXQoIHBhcmFtZXRlclR5cGUsIG5ldyBJT1R5cGUoIGAke0RFUklWRURfUFJPUEVSVFlfSU9fUFJFRklYfTwke3BhcmFtZXRlclR5cGUudHlwZU5hbWV9PmAsIHtcclxuICAgICAgdmFsdWVUeXBlOiBEZXJpdmVkUHJvcGVydHksXHJcbiAgICAgIHBhcmFtZXRlclR5cGVzOiBbIHBhcmFtZXRlclR5cGUgXSxcclxuICAgICAgc3VwZXJ0eXBlOiBQcm9wZXJ0eS5Qcm9wZXJ0eUlPKCBwYXJhbWV0ZXJUeXBlICksXHJcbiAgICAgIGRvY3VtZW50YXRpb246ICdMaWtlIFByb3BlcnR5SU8sIGJ1dCBub3Qgc2V0dGFibGUuICBJbnN0ZWFkIGl0IGlzIGRlcml2ZWQgZnJvbSBvdGhlciBEZXJpdmVkUHJvcGVydHlJTyBvciBQcm9wZXJ0eUlPICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAnaW5zdGFuY2VzJyxcclxuXHJcbiAgICAgIC8vIE92ZXJyaWRlIHRoZSBwYXJlbnQgaW1wbGVtZW50YXRpb24gYXMgYSBuby1vcC4gIERlcml2ZWRQcm9wZXJ0eSB2YWx1ZXMgYXBwZWFyIGluIHRoZSBzdGF0ZSwgYnV0IHNob3VsZCBub3QgYmUgc2V0XHJcbiAgICAgIC8vIGJhY2sgaW50byBhIHJ1bm5pbmcgc2ltdWxhdGlvbi4gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9waGV0LWlvL2lzc3Vlcy8xMjkyXHJcbiAgICAgIGFwcGx5U3RhdGU6IF8ubm9vcCxcclxuICAgICAgbWV0aG9kczoge1xyXG4gICAgICAgIHNldFZhbHVlOiB7XHJcbiAgICAgICAgICByZXR1cm5UeXBlOiBWb2lkSU8sXHJcbiAgICAgICAgICBwYXJhbWV0ZXJUeXBlczogWyBwYXJhbWV0ZXJUeXBlIF0sXHJcblxyXG4gICAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvclxyXG4gICAgICAgICAgaW1wbGVtZW50YXRpb246IERlcml2ZWRQcm9wZXJ0eS5wcm90b3R5cGUuc2V0LFxyXG4gICAgICAgICAgZG9jdW1lbnRhdGlvbjogJ0Vycm9ycyBvdXQgd2hlbiB5b3UgdHJ5IHRvIHNldCBhIGRlcml2ZWQgcHJvcGVydHkuJyxcclxuICAgICAgICAgIGludm9jYWJsZUZvclJlYWRPbmx5RWxlbWVudHM6IGZhbHNlXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9ICkgKTtcclxuICB9XHJcblxyXG4gIHJldHVybiBjYWNoZS5nZXQoIHBhcmFtZXRlclR5cGUgKSE7XHJcbn07XHJcblxyXG5cclxuLy8gQ29udmVuaWVuY2UgY2xhc3NlcyBmb3Igc3ViY2xhc3NpbmcgRGVyaXZlZFByb3BlcnR5XHJcbmV4cG9ydCBjbGFzcyBEZXJpdmVkUHJvcGVydHkxPFQsIFQxPiBleHRlbmRzIERlcml2ZWRQcm9wZXJ0eTxULCBUMSwgbmV2ZXIsIG5ldmVyLCBuZXZlciwgbmV2ZXIsIG5ldmVyLCBuZXZlciwgbmV2ZXIsIG5ldmVyLCBuZXZlciwgbmV2ZXIsIG5ldmVyLCBuZXZlciwgbmV2ZXIsIG5ldmVyPiB7fVxyXG5cclxuZXhwb3J0IGNsYXNzIERlcml2ZWRQcm9wZXJ0eTI8VCwgVDEsIFQyPiBleHRlbmRzIERlcml2ZWRQcm9wZXJ0eTxULCBUMSwgVDIsIG5ldmVyLCBuZXZlciwgbmV2ZXIsIG5ldmVyLCBuZXZlciwgbmV2ZXIsIG5ldmVyLCBuZXZlciwgbmV2ZXIsIG5ldmVyLCBuZXZlciwgbmV2ZXIsIG5ldmVyPiB7fVxyXG5cclxuZXhwb3J0IGNsYXNzIERlcml2ZWRQcm9wZXJ0eTM8VCwgVDEsIFQyLCBUMz4gZXh0ZW5kcyBEZXJpdmVkUHJvcGVydHk8VCwgVDEsIFQyLCBUMywgbmV2ZXIsIG5ldmVyLCBuZXZlciwgbmV2ZXIsIG5ldmVyLCBuZXZlciwgbmV2ZXIsIG5ldmVyLCBuZXZlciwgbmV2ZXIsIG5ldmVyLCBuZXZlcj4ge31cclxuXHJcbmV4cG9ydCBjbGFzcyBEZXJpdmVkUHJvcGVydHk0PFQsIFQxLCBUMiwgVDMsIFQ0PiBleHRlbmRzIERlcml2ZWRQcm9wZXJ0eTxULCBUMSwgVDIsIFQzLCBUNCwgbmV2ZXIsIG5ldmVyLCBuZXZlciwgbmV2ZXIsIG5ldmVyLCBuZXZlciwgbmV2ZXIsIG5ldmVyLCBuZXZlciwgbmV2ZXIsIG5ldmVyPiB7fVxyXG5cclxuZXhwb3J0IGNsYXNzIERlcml2ZWRQcm9wZXJ0eTU8VCwgVDEsIFQyLCBUMywgVDQsIFQ1PiBleHRlbmRzIERlcml2ZWRQcm9wZXJ0eTxULCBUMSwgVDIsIFQzLCBUNCwgVDUsIG5ldmVyLCBuZXZlciwgbmV2ZXIsIG5ldmVyLCBuZXZlciwgbmV2ZXIsIG5ldmVyLCBuZXZlciwgbmV2ZXIsIG5ldmVyPiB7fVxyXG5cclxuYXhvbi5yZWdpc3RlciggJ0Rlcml2ZWRQcm9wZXJ0eScsIERlcml2ZWRQcm9wZXJ0eSApOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsTUFBTSxNQUFNLDJCQUEyQjtBQUM5QyxPQUFPQyxNQUFNLE1BQU0saUNBQWlDO0FBQ3BELE9BQU9DLE1BQU0sTUFBTSxpQ0FBaUM7QUFDcEQsT0FBT0MsSUFBSSxNQUFNLFdBQVc7QUFDNUIsT0FBT0MsUUFBUSxNQUEyQixlQUFlO0FBQ3pELE9BQU9DLDZCQUE2QixNQUFNLG9DQUFvQztBQUM5RSxPQUFPQyxrQkFBa0IsTUFBTSx5QkFBeUI7QUFHeEQsT0FBT0MsU0FBUyxNQUFNLGlDQUFpQztBQUV2RCxPQUFPQyxnQkFBZ0IsSUFBSUMsZUFBZSxRQUFRLHVCQUF1QjtBQUN6RSxPQUFPQyxZQUFZLE1BQU0saUNBQWlDO0FBQzFELE9BQU9DLFdBQVcsTUFBTSxnQ0FBZ0M7QUFFeEQsTUFBTUMsMEJBQTBCLEdBQUcsbUJBQW1CO0FBaUJ0RCxNQUFNQyw0QkFBNEIsR0FBR0MsQ0FBQyxDQUFDQyxLQUFLLENBQUVDLE1BQU0sRUFBRSw4QkFBK0IsQ0FBQyxJQUFJQyxJQUFJLENBQUNDLE9BQU8sQ0FBQ0MsZUFBZSxDQUFDQyxzQkFBc0I7O0FBRTdJO0FBQ0E7QUFDQTtBQUNBLFNBQVNDLGVBQWVBLENBQXVFRCxzQkFBK0IsRUFBRUUsVUFBb0csRUFBRUMsWUFBNEYsRUFBTTtFQUV0VUMsTUFBTSxJQUFJWCw0QkFBNEIsSUFBSU8sc0JBQXNCLElBQUlYLGVBQWUsQ0FBQ2dCLElBQUksQ0FBRUYsWUFBYSxDQUFDO0VBRXhHLElBQUk7SUFFRjtJQUNB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