// Copyright 2017-2024, University of Colorado Boulder

/**
 * Handles creation of an SVG stop element, and handles keeping it updated based on property/color changes.
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

import Pool from '../../../phet-core/js/Pool.js';
import { Color, scenery, svgns } from '../imports.js';
import { isTReadOnlyProperty } from '../../../axon/js/TReadOnlyProperty.js';
const scratchColor = new Color('transparent');
class SVGGradientStop {
  // persistent

  // transient

  // As a workaround for Property deferment issues, we'll keep track of the last Color that we added a listener to, so
  // that we can clean up things Property EVEN when we don't get correct Property change notifications. TODO: remove in https://github.com/phetsims/scenery/issues/1624

  constructor(svgGradient, ratio, color) {
    this.lastColor = null;
    this.initialize(svgGradient, ratio, color);
  }
  isActiveSVGGradientStop() {
    return !!this.svgGradient;
  }
  initialize(svgGradient, ratio, color) {
    sceneryLog && sceneryLog.Paints && sceneryLog.Paints(`[SVGGradientStop] initialize: ${svgGradient.gradient.id} : ${ratio}`);
    sceneryLog && sceneryLog.Paints && sceneryLog.push();
    this.svgGradient = svgGradient;
    this.color = color;
    this.ratio = ratio;
    this.svgElement = this.svgElement || document.createElementNS(svgns, 'stop');
    this.svgElement.setAttribute('offset', '' + ratio);
    this.dirty = true; // true here so our update() actually properly initializes

    this.update();
    this.propertyListener = this.propertyListener || this.onPropertyChange.bind(this);
    this.colorListener = this.colorListener || this.markDirty.bind(this);
    if (isTReadOnlyProperty(color)) {
      sceneryLog && sceneryLog.Paints && sceneryLog.Paints(`[SVGGradientStop] adding Property listener: ${this.svgGradient.gradient.id} : ${this.ratio}`);
      color.lazyLink(this.propertyListener);
      if (color.value instanceof Color) {
        sceneryLog && sceneryLog.Paints && sceneryLog.Paints(`[SVGGradientStop] adding Color listener: ${this.svgGradient.gradient.id} : ${this.ratio}`);
        color.value.changeEmitter.addListener(this.colorListener);
        this.lastColor = color.value;
      }
    } else if (color instanceof Color) {
      sceneryLog && sceneryLog.Paints && sceneryLog.Paints(`[SVGGradientStop] adding Color listener: ${this.svgGradient.gradient.id} : ${this.ratio}`);
      color.changeEmitter.addListener(this.colorListener);
    }
    sceneryLog && sceneryLog.Paints && sceneryLog.pop();
    return this;
  }

  /**
   * Called when our color is a Property and it changes.
   */
  onPropertyChange(newValue, oldValue) {
    assert && assert(this.isActiveSVGGradientStop());
    const activeSelf = this;
    if (this.lastColor !== null) {
      sceneryLog && sceneryLog.Paints && sceneryLog.Paints(`[SVGGradientStop] removing Color listener: ${activeSelf.svgGradient.gradient.id} : ${this.ratio}`);
      this.lastColor.changeEmitter.removeListener(this.colorListener);
      this.lastColor = null;
    }
    if (newValue instanceof Color) {
      sceneryLog && sceneryLog.Paints && sceneryLog.Paints(`[SVGGradientStop] adding Color listener: ${activeSelf.svgGradient.gradient.id} : ${this.ratio}`);
      newValue.changeEmitter.addListener(this.colorListener);
      this.lastColor = newValue;
    }
    this.markDirty();
  }

  /**
   * Should be called when the color stop's value may have changed.
   */
  markDirty() {
    assert && assert(this.isActiveSVGGradientStop());
    this.dirty = true;
    this.svgGradient.markDirty();
  }

  /**
   * Updates the color stop to whatever the current color should be.
   */
  update() {
    if (!this.dirty) {
      return;
    }
    this.dirty = false;
    assert && assert(this.isActiveSVGGradientStop());
    const activeSelf = this;
    sceneryLog && sceneryLog.Paints && sceneryLog.Paints(`[SVGGradientStop] update: ${activeSelf.svgGradient.gradient.id} : ${this.ratio}`);
    sceneryLog && sceneryLog.Paints && sceneryLog.push();

    // {Color|string|Property.<Color|string|null>|null}
    let color = this.color;

    // to {Color|string|null}
    if (isTReadOnlyProperty(color)) {
      color = color.value;
    }

    // to {Color|string}
    if (color === null) {
      color = 'transparent';
    }

    // to {Color}, in our scratchColor
    if (typeof color === 'string') {
      scratchColor.setCSS(color);
    } else {
      scratchColor.set(color);
    }

    // Since SVG doesn't support parsing scientific notation (e.g. 7e5), we need to output fixed decimal-point strings.
    // Since this needs to be done quickly, and we don't particularly care about slight rounding differences (it's
    // being used for display purposes only, and is never shown to the user), we use the built-in JS toFixed instead of
    // Dot's version of toFixed. See https://github.com/phetsims/kite/issues/50
    const stopOpacityRule = `stop-opacity: ${scratchColor.a.toFixed(20)};`; // eslint-disable-line bad-sim-text

    // For GC, mutate the color so it is just RGB and output that CSS also
    scratchColor.alpha = 1;
    const stopColorRule = `stop-color: ${scratchColor.toCSS()};`;
    this.svgElement.setAttribute('style', `${stopColorRule} ${stopOpacityRule}`);
    sceneryLog && sceneryLog.Paints && sceneryLog.pop();
  }

  /**
   * Disposes, so that it can be reused from the pool.
   */
  dispose() {
    assert && assert(this.isActiveSVGGradientStop());
    const activeSelf = this;
    sceneryLog && sceneryLog.Paints && sceneryLog.Paints(`[SVGGradientStop] dispose: ${activeSelf.svgGradient.gradient.id} : ${this.ratio}`);
    sceneryLog && sceneryLog.Paints && sceneryLog.push();
    const color = this.color;
    if (this.lastColor) {
      sceneryLog && sceneryLog.Paints && sceneryLog.Paints(`[SVGGradientStop] removing Color listener: ${activeSelf.svgGradient.gradient.id} : ${this.ratio}`);
      this.lastColor.changeEmitter.removeListener(this.colorListener);
      this.lastColor = null;
    }
    if (isTReadOnlyProperty(color)) {
      sceneryLog && sceneryLog.Paints && sceneryLog.Paints(`[SVGGradientStop] removing Property listener: ${activeSelf.svgGradient.gradient.id} : ${this.ratio}`);
      if (color.hasListener(this.propertyListener)) {
        color.unlink(this.propertyListener);
      }
    } else if (color instanceof Color) {
      sceneryLog && sceneryLog.Paints && sceneryLog.Paints(`[SVGGradientStop] removing Color listener: ${activeSelf.svgGradient.gradient.id} : ${this.ratio}`);
      color.changeEmitter.removeListener(this.colorListener);
    }
    this.color = null; // clear the reference
    this.svgGradient = null; // clear the reference

    this.freeToPool();
    sceneryLog && sceneryLog.Paints && sceneryLog.pop();
  }
  freeToPool() {
    SVGGradientStop.pool.freeToPool(this);
  }
  static pool = new Pool(SVGGradientStop);
}
scenery.register('SVGGradientStop', SVGGradientStop);
export default SVGGradientStop;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQb29sIiwiQ29sb3IiLCJzY2VuZXJ5Iiwic3ZnbnMiLCJpc1RSZWFkT25seVByb3BlcnR5Iiwic2NyYXRjaENvbG9yIiwiU1ZHR3JhZGllbnRTdG9wIiwiY29uc3RydWN0b3IiLCJzdmdHcmFkaWVudCIsInJhdGlvIiwiY29sb3IiLCJsYXN0Q29sb3IiLCJpbml0aWFsaXplIiwiaXNBY3RpdmVTVkdHcmFkaWVudFN0b3AiLCJzY2VuZXJ5TG9nIiwiUGFpbnRzIiwiZ3JhZGllbnQiLCJpZCIsInB1c2giLCJzdmdFbGVtZW50IiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50TlMiLCJzZXRBdHRyaWJ1dGUiLCJkaXJ0eSIsInVwZGF0ZSIsInByb3BlcnR5TGlzdGVuZXIiLCJvblByb3BlcnR5Q2hhbmdlIiwiYmluZCIsImNvbG9yTGlzdGVuZXIiLCJtYXJrRGlydHkiLCJsYXp5TGluayIsInZhbHVlIiwiY2hhbmdlRW1pdHRlciIsImFkZExpc3RlbmVyIiwicG9wIiwibmV3VmFsdWUiLCJvbGRWYWx1ZSIsImFzc2VydCIsImFjdGl2ZVNlbGYiLCJyZW1vdmVMaXN0ZW5lciIsInNldENTUyIsInNldCIsInN0b3BPcGFjaXR5UnVsZSIsImEiLCJ0b0ZpeGVkIiwiYWxwaGEiLCJzdG9wQ29sb3JSdWxlIiwidG9DU1MiLCJkaXNwb3NlIiwiaGFzTGlzdGVuZXIiLCJ1bmxpbmsiLCJmcmVlVG9Qb29sIiwicG9vbCIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiU1ZHR3JhZGllbnRTdG9wLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE3LTIwMjQsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIEhhbmRsZXMgY3JlYXRpb24gb2YgYW4gU1ZHIHN0b3AgZWxlbWVudCwgYW5kIGhhbmRsZXMga2VlcGluZyBpdCB1cGRhdGVkIGJhc2VkIG9uIHByb3BlcnR5L2NvbG9yIGNoYW5nZXMuXHJcbiAqXHJcbiAqIEBhdXRob3IgSm9uYXRoYW4gT2xzb24gPGpvbmF0aGFuLm9sc29uQGNvbG9yYWRvLmVkdT5cclxuICovXHJcblxyXG5pbXBvcnQgUG9vbCwgeyBUUG9vbGFibGUgfSBmcm9tICcuLi8uLi8uLi9waGV0LWNvcmUvanMvUG9vbC5qcyc7XHJcbmltcG9ydCBXaXRob3V0TnVsbCBmcm9tICcuLi8uLi8uLi9waGV0LWNvcmUvanMvdHlwZXMvV2l0aG91dE51bGwuanMnO1xyXG5pbXBvcnQgeyBBY3RpdmVTVkdHcmFkaWVudCwgQ29sb3IsIHNjZW5lcnksIHN2Z25zLCBUQ29sb3IgfSBmcm9tICcuLi9pbXBvcnRzLmpzJztcclxuaW1wb3J0IHsgaXNUUmVhZE9ubHlQcm9wZXJ0eSB9IGZyb20gJy4uLy4uLy4uL2F4b24vanMvVFJlYWRPbmx5UHJvcGVydHkuanMnO1xyXG5cclxuY29uc3Qgc2NyYXRjaENvbG9yID0gbmV3IENvbG9yKCAndHJhbnNwYXJlbnQnICk7XHJcblxyXG5leHBvcnQgdHlwZSBBY3RpdmVTVkdHcmFkaWVudFN0b3AgPSBXaXRob3V0TnVsbDxTVkdHcmFkaWVudFN0b3AsICdzdmdHcmFkaWVudCc+O1xyXG5cclxuY2xhc3MgU1ZHR3JhZGllbnRTdG9wIGltcGxlbWVudHMgVFBvb2xhYmxlIHtcclxuXHJcbiAgLy8gcGVyc2lzdGVudFxyXG4gIHB1YmxpYyBzdmdFbGVtZW50ITogU1ZHU3RvcEVsZW1lbnQ7XHJcblxyXG4gIC8vIHRyYW5zaWVudFxyXG4gIHB1YmxpYyBzdmdHcmFkaWVudCE6IEFjdGl2ZVNWR0dyYWRpZW50IHwgbnVsbDtcclxuICBwdWJsaWMgY29sb3IhOiBUQ29sb3I7XHJcblxyXG4gIHB1YmxpYyByYXRpbyE6IG51bWJlcjtcclxuICBwcml2YXRlIGRpcnR5ITogYm9vbGVhbjtcclxuICBwcml2YXRlIHByb3BlcnR5TGlzdGVuZXIhOiAoKSA9PiB2b2lkO1xyXG4gIHByaXZhdGUgY29sb3JMaXN0ZW5lciE6ICgpID0+IHZvaWQ7XHJcblxyXG4gIC8vIEFzIGEgd29ya2Fyb3VuZCBmb3IgUHJvcGVydHkgZGVmZXJtZW50IGlzc3Vlcywgd2UnbGwga2VlcCB0cmFjayBvZiB0aGUgbGFzdCBDb2xvciB0aGF0IHdlIGFkZGVkIGEgbGlzdGVuZXIgdG8sIHNvXHJcbiAgLy8gdGhhdCB3ZSBjYW4gY2xlYW4gdXAgdGhpbmdzIFByb3BlcnR5IEVWRU4gd2hlbiB3ZSBkb24ndCBnZXQgY29ycmVjdCBQcm9wZXJ0eSBjaGFuZ2Ugbm90aWZpY2F0aW9ucy4gVE9ETzogcmVtb3ZlIGluIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9zY2VuZXJ5L2lzc3Vlcy8xNjI0XHJcbiAgcHJpdmF0ZSBsYXN0Q29sb3IhOiBDb2xvciB8IG51bGw7XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3Rvciggc3ZnR3JhZGllbnQ6IEFjdGl2ZVNWR0dyYWRpZW50LCByYXRpbzogbnVtYmVyLCBjb2xvcjogVENvbG9yICkge1xyXG4gICAgdGhpcy5sYXN0Q29sb3IgPSBudWxsO1xyXG5cclxuICAgIHRoaXMuaW5pdGlhbGl6ZSggc3ZnR3JhZGllbnQsIHJhdGlvLCBjb2xvciApO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGlzQWN0aXZlU1ZHR3JhZGllbnRTdG9wKCk6IHRoaXMgaXMgQWN0aXZlU1ZHR3JhZGllbnRTdG9wIHsgcmV0dXJuICEhdGhpcy5zdmdHcmFkaWVudDsgfVxyXG5cclxuICBwdWJsaWMgaW5pdGlhbGl6ZSggc3ZnR3JhZGllbnQ6IEFjdGl2ZVNWR0dyYWRpZW50LCByYXRpbzogbnVtYmVyLCBjb2xvcjogVENvbG9yICk6IHRoaXMge1xyXG4gICAgc2NlbmVyeUxvZyAmJiBzY2VuZXJ5TG9nLlBhaW50cyAmJiBzY2VuZXJ5TG9nLlBhaW50cyggYFtTVkdHcmFkaWVudFN0b3BdIGluaXRpYWxpemU6ICR7c3ZnR3JhZGllbnQuZ3JhZGllbnQuaWR9IDogJHtyYXRpb31gICk7XHJcbiAgICBzY2VuZXJ5TG9nICYmIHNjZW5lcnlMb2cuUGFpbnRzICYmIHNjZW5lcnlMb2cucHVzaCgpO1xyXG5cclxuICAgIHRoaXMuc3ZnR3JhZGllbnQgPSBzdmdHcmFkaWVudDtcclxuICAgIHRoaXMuY29sb3IgPSBjb2xvcjtcclxuICAgIHRoaXMucmF0aW8gPSByYXRpbztcclxuXHJcbiAgICB0aGlzLnN2Z0VsZW1lbnQgPSB0aGlzLnN2Z0VsZW1lbnQgfHwgZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCBzdmducywgJ3N0b3AnICk7XHJcblxyXG4gICAgdGhpcy5zdmdFbGVtZW50LnNldEF0dHJpYnV0ZSggJ29mZnNldCcsICcnICsgcmF0aW8gKTtcclxuXHJcbiAgICB0aGlzLmRpcnR5ID0gdHJ1ZTsgLy8gdHJ1ZSBoZXJlIHNvIG91ciB1cGRhdGUoKSBhY3R1YWxseSBwcm9wZXJseSBpbml0aWFsaXplc1xyXG5cclxuICAgIHRoaXMudXBkYXRlKCk7XHJcblxyXG4gICAgdGhpcy5wcm9wZXJ0eUxpc3RlbmVyID0gdGhpcy5wcm9wZXJ0eUxpc3RlbmVyIHx8IHRoaXMub25Qcm9wZXJ0eUNoYW5nZS5iaW5kKCB0aGlzICk7XHJcbiAgICB0aGlzLmNvbG9yTGlzdGVuZXIgPSB0aGlzLmNvbG9yTGlzdGVuZXIgfHwgdGhpcy5tYXJrRGlydHkuYmluZCggdGhpcyApO1xyXG5cclxuICAgIGlmICggaXNUUmVhZE9ubHlQcm9wZXJ0eSggY29sb3IgKSApIHtcclxuICAgICAgc2NlbmVyeUxvZyAmJiBzY2VuZXJ5TG9nLlBhaW50cyAmJiBzY2VuZXJ5TG9nLlBhaW50cyggYFtTVkdHcmFkaWVudFN0b3BdIGFkZGluZyBQcm9wZXJ0eSBsaXN0ZW5lcjogJHt0aGlzLnN2Z0dyYWRpZW50LmdyYWRpZW50LmlkfSA6ICR7dGhpcy5yYXRpb31gICk7XHJcbiAgICAgIGNvbG9yLmxhenlMaW5rKCB0aGlzLnByb3BlcnR5TGlzdGVuZXIgKTtcclxuICAgICAgaWYgKCBjb2xvci52YWx1ZSBpbnN0YW5jZW9mIENvbG9yICkge1xyXG4gICAgICAgIHNjZW5lcnlMb2cgJiYgc2NlbmVyeUxvZy5QYWludHMgJiYgc2NlbmVyeUxvZy5QYWludHMoIGBbU1ZHR3JhZGllbnRTdG9wXSBhZGRpbmcgQ29sb3IgbGlzdGVuZXI6ICR7dGhpcy5zdmdHcmFkaWVudC5ncmFkaWVudC5pZH0gOiAke3RoaXMucmF0aW99YCApO1xyXG4gICAgICAgIGNvbG9yLnZhbHVlLmNoYW5nZUVtaXR0ZXIuYWRkTGlzdGVuZXIoIHRoaXMuY29sb3JMaXN0ZW5lciApO1xyXG4gICAgICAgIHRoaXMubGFzdENvbG9yID0gY29sb3IudmFsdWU7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2UgaWYgKCBjb2xvciBpbnN0YW5jZW9mIENvbG9yICkge1xyXG4gICAgICBzY2VuZXJ5TG9nICYmIHNjZW5lcnlMb2cuUGFpbnRzICYmIHNjZW5lcnlMb2cuUGFpbnRzKCBgW1NWR0dyYWRpZW50U3RvcF0gYWRkaW5nIENvbG9yIGxpc3RlbmVyOiAke3RoaXMuc3ZnR3JhZGllbnQuZ3JhZGllbnQuaWR9IDogJHt0aGlzLnJhdGlvfWAgKTtcclxuICAgICAgY29sb3IuY2hhbmdlRW1pdHRlci5hZGRMaXN0ZW5lciggdGhpcy5jb2xvckxpc3RlbmVyICk7XHJcbiAgICB9XHJcblxyXG4gICAgc2NlbmVyeUxvZyAmJiBzY2VuZXJ5TG9nLlBhaW50cyAmJiBzY2VuZXJ5TG9nLnBvcCgpO1xyXG5cclxuICAgIHJldHVybiB0aGlzO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2FsbGVkIHdoZW4gb3VyIGNvbG9yIGlzIGEgUHJvcGVydHkgYW5kIGl0IGNoYW5nZXMuXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBvblByb3BlcnR5Q2hhbmdlKCBuZXdWYWx1ZTogQ29sb3IgfCBzdHJpbmcgfCBudWxsLCBvbGRWYWx1ZTogQ29sb3IgfCBzdHJpbmcgfCBudWxsICk6IHZvaWQge1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggdGhpcy5pc0FjdGl2ZVNWR0dyYWRpZW50U3RvcCgpICk7XHJcbiAgICBjb25zdCBhY3RpdmVTZWxmID0gdGhpcyBhcyBBY3RpdmVTVkdHcmFkaWVudFN0b3A7XHJcblxyXG4gICAgaWYgKCB0aGlzLmxhc3RDb2xvciAhPT0gbnVsbCApIHtcclxuICAgICAgc2NlbmVyeUxvZyAmJiBzY2VuZXJ5TG9nLlBhaW50cyAmJiBzY2VuZXJ5TG9nLlBhaW50cyggYFtTVkdHcmFkaWVudFN0b3BdIHJlbW92aW5nIENvbG9yIGxpc3RlbmVyOiAke2FjdGl2ZVNlbGYuc3ZnR3JhZGllbnQuZ3JhZGllbnQuaWR9IDogJHt0aGlzLnJhdGlvfWAgKTtcclxuICAgICAgdGhpcy5sYXN0Q29sb3IuY2hhbmdlRW1pdHRlci5yZW1vdmVMaXN0ZW5lciggdGhpcy5jb2xvckxpc3RlbmVyICk7XHJcbiAgICAgIHRoaXMubGFzdENvbG9yID0gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIG5ld1ZhbHVlIGluc3RhbmNlb2YgQ29sb3IgKSB7XHJcbiAgICAgIHNjZW5lcnlMb2cgJiYgc2NlbmVyeUxvZy5QYWludHMgJiYgc2NlbmVyeUxvZy5QYWludHMoIGBbU1ZHR3JhZGllbnRTdG9wXSBhZGRpbmcgQ29sb3IgbGlzdGVuZXI6ICR7YWN0aXZlU2VsZi5zdmdHcmFkaWVudC5ncmFkaWVudC5pZH0gOiAke3RoaXMucmF0aW99YCApO1xyXG4gICAgICBuZXdWYWx1ZS5jaGFuZ2VFbWl0dGVyLmFkZExpc3RlbmVyKCB0aGlzLmNvbG9yTGlzdGVuZXIgKTtcclxuICAgICAgdGhpcy5sYXN0Q29sb3IgPSBuZXdWYWx1ZTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLm1hcmtEaXJ0eSgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU2hvdWxkIGJlIGNhbGxlZCB3aGVuIHRoZSBjb2xvciBzdG9wJ3MgdmFsdWUgbWF5IGhhdmUgY2hhbmdlZC5cclxuICAgKi9cclxuICBwcml2YXRlIG1hcmtEaXJ0eSgpOiB2b2lkIHtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIHRoaXMuaXNBY3RpdmVTVkdHcmFkaWVudFN0b3AoKSApO1xyXG5cclxuICAgIHRoaXMuZGlydHkgPSB0cnVlO1xyXG4gICAgKCB0aGlzIGFzIEFjdGl2ZVNWR0dyYWRpZW50U3RvcCApLnN2Z0dyYWRpZW50Lm1hcmtEaXJ0eSgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVXBkYXRlcyB0aGUgY29sb3Igc3RvcCB0byB3aGF0ZXZlciB0aGUgY3VycmVudCBjb2xvciBzaG91bGQgYmUuXHJcbiAgICovXHJcbiAgcHVibGljIHVwZGF0ZSgpOiB2b2lkIHtcclxuICAgIGlmICggIXRoaXMuZGlydHkgKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHRoaXMuZGlydHkgPSBmYWxzZTtcclxuXHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCB0aGlzLmlzQWN0aXZlU1ZHR3JhZGllbnRTdG9wKCkgKTtcclxuICAgIGNvbnN0IGFjdGl2ZVNlbGYgPSB0aGlzIGFzIEFjdGl2ZVNWR0dyYWRpZW50U3RvcDtcclxuXHJcbiAgICBzY2VuZXJ5TG9nICYmIHNjZW5lcnlMb2cuUGFpbnRzICYmIHNjZW5lcnlMb2cuUGFpbnRzKCBgW1NWR0dyYWRpZW50U3RvcF0gdXBkYXRlOiAke2FjdGl2ZVNlbGYuc3ZnR3JhZGllbnQuZ3JhZGllbnQuaWR9IDogJHt0aGlzLnJhdGlvfWAgKTtcclxuICAgIHNjZW5lcnlMb2cgJiYgc2NlbmVyeUxvZy5QYWludHMgJiYgc2NlbmVyeUxvZy5wdXNoKCk7XHJcblxyXG4gICAgLy8ge0NvbG9yfHN0cmluZ3xQcm9wZXJ0eS48Q29sb3J8c3RyaW5nfG51bGw+fG51bGx9XHJcbiAgICBsZXQgY29sb3IgPSB0aGlzLmNvbG9yO1xyXG5cclxuICAgIC8vIHRvIHtDb2xvcnxzdHJpbmd8bnVsbH1cclxuICAgIGlmICggaXNUUmVhZE9ubHlQcm9wZXJ0eSggY29sb3IgKSApIHtcclxuICAgICAgY29sb3IgPSBjb2xvci52YWx1ZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyB0byB7Q29sb3J8c3RyaW5nfVxyXG4gICAgaWYgKCBjb2xvciA9PT0gbnVsbCApIHtcclxuICAgICAgY29sb3IgPSAndHJhbnNwYXJlbnQnO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHRvIHtDb2xvcn0sIGluIG91ciBzY3JhdGNoQ29sb3JcclxuICAgIGlmICggdHlwZW9mIGNvbG9yID09PSAnc3RyaW5nJyApIHtcclxuICAgICAgc2NyYXRjaENvbG9yLnNldENTUyggY29sb3IgKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICBzY3JhdGNoQ29sb3Iuc2V0KCBjb2xvciApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFNpbmNlIFNWRyBkb2Vzbid0IHN1cHBvcnQgcGFyc2luZyBzY2llbnRpZmljIG5vdGF0aW9uIChlLmcuIDdlNSksIHdlIG5lZWQgdG8gb3V0cHV0IGZpeGVkIGRlY2ltYWwtcG9pbnQgc3RyaW5ncy5cclxuICAgIC8vIFNpbmNlIHRoaXMgbmVlZHMgdG8gYmUgZG9uZSBxdWlja2x5LCBhbmQgd2UgZG9uJ3QgcGFydGljdWxhcmx5IGNhcmUgYWJvdXQgc2xpZ2h0IHJvdW5kaW5nIGRpZmZlcmVuY2VzIChpdCdzXHJcbiAgICAvLyBiZWluZyB1c2VkIGZvciBkaXNwbGF5IHB1cnBvc2VzIG9ubHksIGFuZCBpcyBuZXZlciBzaG93biB0byB0aGUgdXNlciksIHdlIHVzZSB0aGUgYnVpbHQtaW4gSlMgdG9GaXhlZCBpbnN0ZWFkIG9mXHJcbiAgICAvLyBEb3QncyB2ZXJzaW9uIG9mIHRvRml4ZWQuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMva2l0ZS9pc3N1ZXMvNTBcclxuICAgIGNvbnN0IHN0b3BPcGFjaXR5UnVsZSA9IGBzdG9wLW9wYWNpdHk6ICR7c2NyYXRjaENvbG9yLmEudG9GaXhlZCggMjAgKX07YDsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBiYWQtc2ltLXRleHRcclxuXHJcbiAgICAvLyBGb3IgR0MsIG11dGF0ZSB0aGUgY29sb3Igc28gaXQgaXMganVzdCBSR0IgYW5kIG91dHB1dCB0aGF0IENTUyBhbHNvXHJcbiAgICBzY3JhdGNoQ29sb3IuYWxwaGEgPSAxO1xyXG4gICAgY29uc3Qgc3RvcENvbG9yUnVsZSA9IGBzdG9wLWNvbG9yOiAke3NjcmF0Y2hDb2xvci50b0NTUygpfTtgO1xyXG5cclxuICAgIHRoaXMuc3ZnRWxlbWVudC5zZXRBdHRyaWJ1dGUoICdzdHlsZScsIGAke3N0b3BDb2xvclJ1bGV9ICR7c3RvcE9wYWNpdHlSdWxlfWAgKTtcclxuXHJcbiAgICBzY2VuZXJ5TG9nICYmIHNjZW5lcnlMb2cuUGFpbnRzICYmIHNjZW5lcnlMb2cucG9wKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBEaXNwb3Nlcywgc28gdGhhdCBpdCBjYW4gYmUgcmV1c2VkIGZyb20gdGhlIHBvb2wuXHJcbiAgICovXHJcbiAgcHVibGljIGRpc3Bvc2UoKTogdm9pZCB7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCB0aGlzLmlzQWN0aXZlU1ZHR3JhZGllbnRTdG9wKCkgKTtcclxuICAgIGNvbnN0IGFjdGl2ZVNlbGYgPSB0aGlzIGFzIEFjdGl2ZVNWR0dyYWRpZW50U3RvcDtcclxuXHJcbiAgICBzY2VuZXJ5TG9nICYmIHNjZW5lcnlMb2cuUGFpbnRzICYmIHNjZW5lcnlMb2cuUGFpbnRzKCBgW1NWR0dyYWRpZW50U3RvcF0gZGlzcG9zZTogJHthY3RpdmVTZWxmLnN2Z0dyYWRpZW50LmdyYWRpZW50LmlkfSA6ICR7dGhpcy5yYXRpb31gICk7XHJcbiAgICBzY2VuZXJ5TG9nICYmIHNjZW5lcnlMb2cuUGFpbnRzICYmIHNjZW5lcnlMb2cucHVzaCgpO1xyXG5cclxuICAgIGNvbnN0IGNvbG9yID0gdGhpcy5jb2xvcjtcclxuXHJcbiAgICBpZiAoIHRoaXMubGFzdENvbG9yICkge1xyXG4gICAgICBzY2VuZXJ5TG9nICYmIHNjZW5lcnlMb2cuUGFpbnRzICYmIHNjZW5lcnlMb2cuUGFpbnRzKCBgW1NWR0dyYWRpZW50U3RvcF0gcmVtb3ZpbmcgQ29sb3IgbGlzdGVuZXI6ICR7YWN0aXZlU2VsZi5zdmdHcmFkaWVudC5ncmFkaWVudC5pZH0gOiAke3RoaXMucmF0aW99YCApO1xyXG4gICAgICB0aGlzLmxhc3RDb2xvci5jaGFuZ2VFbWl0dGVyLnJlbW92ZUxpc3RlbmVyKCB0aGlzLmNvbG9yTGlzdGVuZXIgKTtcclxuICAgICAgdGhpcy5sYXN0Q29sb3IgPSBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICggaXNUUmVhZE9ubHlQcm9wZXJ0eSggY29sb3IgKSApIHtcclxuICAgICAgc2NlbmVyeUxvZyAmJiBzY2VuZXJ5TG9nLlBhaW50cyAmJiBzY2VuZXJ5TG9nLlBhaW50cyggYFtTVkdHcmFkaWVudFN0b3BdIHJlbW92aW5nIFByb3BlcnR5IGxpc3RlbmVyOiAke2FjdGl2ZVNlbGYuc3ZnR3JhZGllbnQuZ3JhZGllbnQuaWR9IDogJHt0aGlzLnJhdGlvfWAgKTtcclxuICAgICAgaWYgKCBjb2xvci5oYXNMaXN0ZW5lciggdGhpcy5wcm9wZXJ0eUxpc3RlbmVyICkgKSB7XHJcbiAgICAgICAgY29sb3IudW5saW5rKCB0aGlzLnByb3BlcnR5TGlzdGVuZXIgKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoIGNvbG9yIGluc3RhbmNlb2YgQ29sb3IgKSB7XHJcbiAgICAgIHNjZW5lcnlMb2cgJiYgc2NlbmVyeUxvZy5QYWludHMgJiYgc2NlbmVyeUxvZy5QYWludHMoIGBbU1ZHR3JhZGllbnRTdG9wXSByZW1vdmluZyBDb2xvciBsaXN0ZW5lcjogJHthY3RpdmVTZWxmLnN2Z0dyYWRpZW50LmdyYWRpZW50LmlkfSA6ICR7dGhpcy5yYXRpb31gICk7XHJcbiAgICAgIGNvbG9yLmNoYW5nZUVtaXR0ZXIucmVtb3ZlTGlzdGVuZXIoIHRoaXMuY29sb3JMaXN0ZW5lciApO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuY29sb3IgPSBudWxsOyAvLyBjbGVhciB0aGUgcmVmZXJlbmNlXHJcbiAgICB0aGlzLnN2Z0dyYWRpZW50ID0gbnVsbDsgLy8gY2xlYXIgdGhlIHJlZmVyZW5jZVxyXG5cclxuICAgIHRoaXMuZnJlZVRvUG9vbCgpO1xyXG5cclxuICAgIHNjZW5lcnlMb2cgJiYgc2NlbmVyeUxvZy5QYWludHMgJiYgc2NlbmVyeUxvZy5wb3AoKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBmcmVlVG9Qb29sKCk6IHZvaWQge1xyXG4gICAgU1ZHR3JhZGllbnRTdG9wLnBvb2wuZnJlZVRvUG9vbCggdGhpcyApO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHN0YXRpYyByZWFkb25seSBwb29sID0gbmV3IFBvb2woIFNWR0dyYWRpZW50U3RvcCApO1xyXG59XHJcblxyXG5zY2VuZXJ5LnJlZ2lzdGVyKCAnU1ZHR3JhZGllbnRTdG9wJywgU1ZHR3JhZGllbnRTdG9wICk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBTVkdHcmFkaWVudFN0b3A7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLElBQUksTUFBcUIsK0JBQStCO0FBRS9ELFNBQTRCQyxLQUFLLEVBQUVDLE9BQU8sRUFBRUMsS0FBSyxRQUFnQixlQUFlO0FBQ2hGLFNBQVNDLG1CQUFtQixRQUFRLHVDQUF1QztBQUUzRSxNQUFNQyxZQUFZLEdBQUcsSUFBSUosS0FBSyxDQUFFLGFBQWMsQ0FBQztBQUkvQyxNQUFNSyxlQUFlLENBQXNCO0VBRXpDOztFQUdBOztFQVNBO0VBQ0E7O0VBR09DLFdBQVdBLENBQUVDLFdBQThCLEVBQUVDLEtBQWEsRUFBRUMsS0FBYSxFQUFHO0lBQ2pGLElBQUksQ0FBQ0MsU0FBUyxHQUFHLElBQUk7SUFFckIsSUFBSSxDQUFDQyxVQUFVLENBQUVKLFdBQVcsRUFBRUMsS0FBSyxFQUFFQyxLQUFNLENBQUM7RUFDOUM7RUFFT0csdUJBQXVCQSxDQUFBLEVBQWtDO0lBQUUsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDTCxXQUFXO0VBQUU7RUFFdEZJLFVBQVVBLENBQUVKLFdBQThCLEVBQUVDLEtBQWEsRUFBRUMsS0FBYSxFQUFTO0lBQ3RGSSxVQUFVLElBQUlBLFVBQVUsQ0FBQ0MsTUFBTSxJ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