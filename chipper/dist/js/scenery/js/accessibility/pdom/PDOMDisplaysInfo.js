// Copyright 2018-2024, University of Colorado Boulder

/**
 * Per-node information required to track what PDOM Displays our Node is visible under. A PDOM display is a Display that
 * is marked true with the `accessibility` option, and thus creates and manages a ParallelDOM (see ParallelDOM and
 * general scenery accessibility doc for more details). Acts like a multimap
 * (duplicates allowed) to indicate how many times we appear in a pdom display.
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

import { Renderer, scenery } from '../../imports.js';
export default class PDOMDisplaysInfo {
  // (duplicates allowed) - There is one copy of each pdom
  // Display for each trail (from its root node to this node) that is fully visible (assuming this subtree has
  // pdom content).
  // Thus, the value of this is:
  // - If this node is invisible OR the subtree has no pdomContent/pdomOrder: []
  // - Otherwise, it is the concatenation of our parents' pdomDisplays (AND any pdom displays rooted
  //   at this node).
  // This value is synchronously updated, and supports pdomInstances by letting them know when certain
  // nodes are visible on the display.

  /**
   * Tracks pdom display information for our given node.
   * (scenery-internal)
   */
  constructor(node) {
    this.node = node;
    this.pdomDisplays = [];
  }

  /**
   * Called when the node is added as a child to this node AND the node's subtree contains pdom content. (scenery-internal)
   */
  onAddChild(node) {
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.PDOMDisplaysInfo(`onAddChild n#${node.id} (parent:n#${this.node.id})`);
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.push();
    if (node._pdomDisplaysInfo.canHavePDOMDisplays()) {
      node._pdomDisplaysInfo.addPDOMDisplays(this.pdomDisplays);
    }
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.pop();
  }

  /**
   * Called when the node is removed as a child from this node AND the node's subtree contains pdom content. (scenery-internal)
   */
  onRemoveChild(node) {
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.PDOMDisplaysInfo(`onRemoveChild n#${node.id} (parent:n#${this.node.id})`);
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.push();
    if (node._pdomDisplaysInfo.canHavePDOMDisplays()) {
      node._pdomDisplaysInfo.removePDOMDisplays(this.pdomDisplays);
    }
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.pop();
  }

  /**
   * Called when our summary bitmask changes (scenery-internal)
   */
  onSummaryChange(oldBitmask, newBitmask) {
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.PDOMDisplaysInfo(`onSummaryChange n#${this.node.id} wasPDOM:${!(Renderer.bitmaskNoPDOM & oldBitmask)}, isPDOM:${!(Renderer.bitmaskNoPDOM & newBitmask)}`);
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.push();

    // If we are invisible, our pdomDisplays would not have changed ([] => [])
    if (this.node.visible && this.node.pdomVisible) {
      const hadPDOM = !(Renderer.bitmaskNoPDOM & oldBitmask);
      const hasPDOM = !(Renderer.bitmaskNoPDOM & newBitmask);

      // If we changed to have pdom content, we need to recursively add pdom displays.
      if (hasPDOM && !hadPDOM) {
        this.addAllPDOMDisplays();
      }

      // If we changed to NOT have pdom content, we need to recursively remove pdom displays.
      if (!hasPDOM && hadPDOM) {
        this.removeAllPDOMDisplays();
      }
    }
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.pop();
  }

  /**
   * Called when our visibility changes. (scenery-internal)
   */
  onVisibilityChange(visible) {
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.PDOMDisplaysInfo(`onVisibilityChange n#${this.node.id} visible:${visible}`);
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.push();

    // If we don't have pdom (or pdomVisible), our pdomDisplays would not have changed ([] => [])
    if (this.node.pdomVisible && !this.node._rendererSummary.hasNoPDOM()) {
      if (visible) {
        this.addAllPDOMDisplays();
      } else {
        this.removeAllPDOMDisplays();
      }
    }
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.pop();
  }

  /**
   * Called when our pdomVisibility changes. (scenery-internal)
   */
  onPDOMVisibilityChange(visible) {
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.PDOMDisplaysInfo(`onPDOMVisibilityChange n#${this.node.id} pdomVisible:${visible}`);
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.push();

    // If we don't have pdom, our pdomDisplays would not have changed ([] => [])
    if (this.node.visible && !this.node._rendererSummary.hasNoPDOM()) {
      if (visible) {
        this.addAllPDOMDisplays();
      } else {
        this.removeAllPDOMDisplays();
      }
    }
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.pop();
  }

  /**
   * Called when we have a rooted display added to this node. (scenery-internal)
   */
  onAddedRootedDisplay(display) {
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.PDOMDisplaysInfo(`onAddedRootedDisplay n#${this.node.id}`);
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.push();
    if (display._accessible && this.canHavePDOMDisplays()) {
      this.addPDOMDisplays([display]);
    }
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.pop();
  }

  /**
   * Called when we have a rooted display removed from this node. (scenery-internal)
   */
  onRemovedRootedDisplay(display) {
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.PDOMDisplaysInfo(`onRemovedRootedDisplay n#${this.node.id}`);
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.push();
    if (display._accessible && this.canHavePDOMDisplays()) {
      this.removePDOMDisplays([display]);
    }
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.pop();
  }

  /**
   * Returns whether we can have pdomDisplays specified in our array. (scenery-internal)
   */
  canHavePDOMDisplays() {
    return this.node.visible && this.node.pdomVisible && !this.node._rendererSummary.hasNoPDOM();
  }

  /**
   * Adds all of our pdom displays to our array (and propagates).
   */
  addAllPDOMDisplays() {
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.PDOMDisplaysInfo(`addAllPDOMDisplays n#${this.node.id}`);
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.push();
    assert && assert(this.pdomDisplays.length === 0, 'Should be empty before adding everything');
    assert && assert(this.canHavePDOMDisplays(), 'Should happen when we can store pdomDisplays');
    let i;
    const displays = [];

    // Concatenation of our parents' pdomDisplays
    for (i = 0; i < this.node._parents.length; i++) {
      Array.prototype.push.apply(displays, this.node._parents[i]._pdomDisplaysInfo.pdomDisplays);
    }

    // AND any acessible displays rooted at this node
    for (i = 0; i < this.node._rootedDisplays.length; i++) {
      const display = this.node._rootedDisplays[i];
      if (display._accessible) {
        displays.push(display);
      }
    }
    this.addPDOMDisplays(displays);
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.pop();
  }

  /**
   * Removes all of our pdom displays from our array (and propagates).
   */
  removeAllPDOMDisplays() {
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.PDOMDisplaysInfo(`removeAllPDOMDisplays n#${this.node.id}`);
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.push();
    assert && assert(!this.canHavePDOMDisplays(), 'Should happen when we cannot store pdomDisplays');

    // TODO: is there a way to avoid a copy? https://github.com/phetsims/scenery/issues/1581
    this.removePDOMDisplays(this.pdomDisplays.slice());
    assert && assert(this.pdomDisplays.length === 0, 'Should be empty after removing everything');
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.pop();
  }

  /**
   * Adds a list of pdom displays to our internal list. See pdomDisplays documentation.
   */
  addPDOMDisplays(displays) {
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.PDOMDisplaysInfo(`addPDOMDisplays n#${this.node.id} numDisplays:${displays.length}`);
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.push();
    assert && assert(Array.isArray(displays));

    // Simplifies things if we can stop no-ops here.
    if (displays.length !== 0) {
      Array.prototype.push.apply(this.pdomDisplays, displays);

      // Propagate the change to our children
      for (let i = 0; i < this.node._children.length; i++) {
        const child = this.node._children[i];
        if (child._pdomDisplaysInfo.canHavePDOMDisplays()) {
          this.node._children[i]._pdomDisplaysInfo.addPDOMDisplays(displays);
        }
      }
      this.node.pdomDisplaysEmitter.emit();
    }
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.pop();
  }

  /**
   * Removes a list of pdom displays from our internal list. See pdomDisplays documentation.
   */
  removePDOMDisplays(displays) {
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.PDOMDisplaysInfo(`removePDOMDisplays n#${this.node.id} numDisplays:${displays.length}`);
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.push();
    assert && assert(Array.isArray(displays));
    assert && assert(this.pdomDisplays.length >= displays.length, 'there should be at least as many PDOMDisplays as Displays');

    // Simplifies things if we can stop no-ops here.
    if (displays.length !== 0) {
      let i;
      for (i = displays.length - 1; i >= 0; i--) {
        const index = this.pdomDisplays.lastIndexOf(displays[i]);
        assert && assert(index >= 0);
        this.pdomDisplays.splice(i, 1);
      }

      // Propagate the change to our children
      for (i = 0; i < this.node._children.length; i++) {
        const child = this.node._children[i];
        // NOTE: Since this gets called many times from the RendererSummary (which happens before the actual child
        // modification happens), we DO NOT want to traverse to the child node getting removed. Ideally a better
        // solution than this flag should be found.
        if (child._pdomDisplaysInfo.canHavePDOMDisplays() && !child._isGettingRemovedFromParent) {
          child._pdomDisplaysInfo.removePDOMDisplays(displays);
        }
      }
      this.node.pdomDisplaysEmitter.emit();
    }
    sceneryLog && sceneryLog.PDOMDisplaysInfo && sceneryLog.pop();
  }
}
scenery.register('PDOMDisplaysInfo', PDOMDisplaysInfo);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJSZW5kZXJlciIsInNjZW5lcnkiLCJQRE9NRGlzcGxheXNJbmZvIiwiY29uc3RydWN0b3IiLCJub2RlIiwicGRvbURpc3BsYXlzIiwib25BZGRDaGlsZCIsInNjZW5lcnlMb2ciLCJpZCIsInB1c2giLCJfcGRvbURpc3BsYXlzSW5mbyIsImNhbkhhdmVQRE9NRGlzcGxheXMiLCJhZGRQRE9NRGlzcGxheXMiLCJwb3AiLCJvblJlbW92ZUNoaWxkIiwicmVtb3ZlUERPTURpc3BsYXlzIiwib25TdW1tYXJ5Q2hhbmdlIiwib2xkQml0bWFzayIsIm5ld0JpdG1hc2siLCJiaXRtYXNrTm9QRE9NIiwidmlzaWJsZSIsInBkb21WaXNpYmxlIiwiaGFkUERPTSIsImhhc1BET00iLCJhZGRBbGxQRE9NRGlzcGxheXMiLCJyZW1vdmVBbGxQRE9NRGlzcGxheXMiLCJvblZpc2liaWxpdHlDaGFuZ2UiLCJfcmVuZGVyZXJTdW1tYXJ5IiwiaGFzTm9QRE9NIiwib25QRE9NVmlzaWJpbGl0eUNoYW5nZSIsIm9uQWRkZWRSb290ZWREaXNwbGF5IiwiZGlzcGxheSIsIl9hY2Nlc3NpYmxlIiwib25SZW1vdmVkUm9vdGVkRGlzcGxheSIsImFzc2VydCIsImxlbmd0aCIsImkiLCJkaXNwbGF5cyIsIl9wYXJlbnRzIiwiQXJyYXkiLCJwcm90b3R5cGUiLCJhcHBseSIsIl9yb290ZWREaXNwbGF5cyIsInNsaWNlIiwiaXNBcnJheSIsIl9jaGlsZHJlbiIsImNoaWxkIiwicGRvbURpc3BsYXlzRW1pdHRlciIsImVtaXQiLCJpbmRleCIsImxhc3RJbmRleE9mIiwic3BsaWNlIiwiX2lzR2V0dGluZ1JlbW92ZWRGcm9tUGFyZW50IiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJQRE9NRGlzcGxheXNJbmZvLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE4LTIwMjQsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIFBlci1ub2RlIGluZm9ybWF0aW9uIHJlcXVpcmVkIHRvIHRyYWNrIHdoYXQgUERPTSBEaXNwbGF5cyBvdXIgTm9kZSBpcyB2aXNpYmxlIHVuZGVyLiBBIFBET00gZGlzcGxheSBpcyBhIERpc3BsYXkgdGhhdFxyXG4gKiBpcyBtYXJrZWQgdHJ1ZSB3aXRoIHRoZSBgYWNjZXNzaWJpbGl0eWAgb3B0aW9uLCBhbmQgdGh1cyBjcmVhdGVzIGFuZCBtYW5hZ2VzIGEgUGFyYWxsZWxET00gKHNlZSBQYXJhbGxlbERPTSBhbmRcclxuICogZ2VuZXJhbCBzY2VuZXJ5IGFjY2Vzc2liaWxpdHkgZG9jIGZvciBtb3JlIGRldGFpbHMpLiBBY3RzIGxpa2UgYSBtdWx0aW1hcFxyXG4gKiAoZHVwbGljYXRlcyBhbGxvd2VkKSB0byBpbmRpY2F0ZSBob3cgbWFueSB0aW1lcyB3ZSBhcHBlYXIgaW4gYSBwZG9tIGRpc3BsYXkuXHJcbiAqXHJcbiAqIEBhdXRob3IgSm9uYXRoYW4gT2xzb24gPGpvbmF0aGFuLm9sc29uQGNvbG9yYWRvLmVkdT5cclxuICovXHJcblxyXG5pbXBvcnQgeyBEaXNwbGF5LCBOb2RlLCBSZW5kZXJlciwgc2NlbmVyeSB9IGZyb20gJy4uLy4uL2ltcG9ydHMuanMnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUERPTURpc3BsYXlzSW5mbyB7XHJcblxyXG4gIHByaXZhdGUgcmVhZG9ubHkgbm9kZTogTm9kZTtcclxuXHJcbiAgLy8gKGR1cGxpY2F0ZXMgYWxsb3dlZCkgLSBUaGVyZSBpcyBvbmUgY29weSBvZiBlYWNoIHBkb21cclxuICAvLyBEaXNwbGF5IGZvciBlYWNoIHRyYWlsIChmcm9tIGl0cyByb290IG5vZGUgdG8gdGhpcyBub2RlKSB0aGF0IGlzIGZ1bGx5IHZpc2libGUgKGFzc3VtaW5nIHRoaXMgc3VidHJlZSBoYXNcclxuICAvLyBwZG9tIGNvbnRlbnQpLlxyXG4gIC8vIFRodXMsIHRoZSB2YWx1ZSBvZiB0aGlzIGlzOlxyXG4gIC8vIC0gSWYgdGhpcyBub2RlIGlzIGludmlzaWJsZSBPUiB0aGUgc3VidHJlZSBoYXMgbm8gcGRvbUNvbnRlbnQvcGRvbU9yZGVyOiBbXVxyXG4gIC8vIC0gT3RoZXJ3aXNlLCBpdCBpcyB0aGUgY29uY2F0ZW5hdGlvbiBvZiBvdXIgcGFyZW50cycgcGRvbURpc3BsYXlzIChBTkQgYW55IHBkb20gZGlzcGxheXMgcm9vdGVkXHJcbiAgLy8gICBhdCB0aGlzIG5vZGUpLlxyXG4gIC8vIFRoaXMgdmFsdWUgaXMgc3luY2hyb25vdXNseSB1cGRhdGVkLCBhbmQgc3VwcG9ydHMgcGRvbUluc3RhbmNlcyBieSBsZXR0aW5nIHRoZW0ga25vdyB3aGVuIGNlcnRhaW5cclxuICAvLyBub2RlcyBhcmUgdmlzaWJsZSBvbiB0aGUgZGlzcGxheS5cclxuICBwdWJsaWMgcmVhZG9ubHkgcGRvbURpc3BsYXlzOiBEaXNwbGF5W107XHJcblxyXG4gIC8qKlxyXG4gICAqIFRyYWNrcyBwZG9tIGRpc3BsYXkgaW5mb3JtYXRpb24gZm9yIG91ciBnaXZlbiBub2RlLlxyXG4gICAqIChzY2VuZXJ5LWludGVybmFsKVxyXG4gICAqL1xyXG4gIHB1YmxpYyBjb25zdHJ1Y3Rvciggbm9kZTogTm9kZSApIHtcclxuICAgIHRoaXMubm9kZSA9IG5vZGU7XHJcbiAgICB0aGlzLnBkb21EaXNwbGF5cyA9IFtdO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2FsbGVkIHdoZW4gdGhlIG5vZGUgaXMgYWRkZWQgYXMgYSBjaGlsZCB0byB0aGlzIG5vZGUgQU5EIHRoZSBub2RlJ3Mgc3VidHJlZSBjb250YWlucyBwZG9tIGNvbnRlbnQuIChzY2VuZXJ5LWludGVybmFsKVxyXG4gICAqL1xyXG4gIHB1YmxpYyBvbkFkZENoaWxkKCBub2RlOiBOb2RlICk6IHZvaWQge1xyXG4gICAgc2NlbmVyeUxvZyAmJiBzY2VuZXJ5TG9nLlBET01EaXNwbGF5c0luZm8gJiYgc2NlbmVyeUxvZy5QRE9NRGlzcGxheXNJbmZvKCBgb25BZGRDaGlsZCBuIyR7bm9kZS5pZH0gKHBhcmVudDpuIyR7dGhpcy5ub2RlLmlkfSlgICk7XHJcbiAgICBzY2VuZXJ5TG9nICYmIHNjZW5lcnlMb2cuUERPTURpc3BsYXlzSW5mbyAmJiBzY2VuZXJ5TG9nLnB1c2goKTtcclxuXHJcbiAgICBpZiAoIG5vZGUuX3Bkb21EaXNwbGF5c0luZm8uY2FuSGF2ZVBET01EaXNwbGF5cygpICkge1xyXG4gICAgICBub2RlLl9wZG9tRGlzcGxheXNJbmZvLmFkZFBET01EaXNwbGF5cyggdGhpcy5wZG9tRGlzcGxheXMgKTtcclxuICAgIH1cclxuXHJcbiAgICBzY2VuZXJ5TG9nICYmIHNjZW5lcnlMb2cuUERPTURpc3BsYXlzSW5mbyAmJiBzY2VuZXJ5TG9nLnBvcCgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2FsbGVkIHdoZW4gdGhlIG5vZGUgaXMgcmVtb3ZlZCBhcyBhIGNoaWxkIGZyb20gdGhpcyBub2RlIEFORCB0aGUgbm9kZSdzIHN1YnRyZWUgY29udGFpbnMgcGRvbSBjb250ZW50LiAoc2NlbmVyeS1pbnRlcm5hbClcclxuICAgKi9cclxuICBwdWJsaWMgb25SZW1vdmVDaGlsZCggbm9kZTogTm9kZSApOiB2b2lkIHtcclxuICAgIHNjZW5lcnlMb2cgJiYgc2NlbmVyeUxvZy5QRE9NRGlzcGxheXNJbmZvICYmIHNjZW5lcnlMb2cuUERPTURpc3BsYXlzSW5mbyggYG9uUmVtb3ZlQ2hpbGQgbiMke25vZGUuaWR9IChwYXJlbnQ6biMke3RoaXMubm9kZS5pZH0pYCApO1xyXG4gICAgc2NlbmVyeUxvZyAmJiBzY2VuZXJ5TG9nLlBET01EaXNwbGF5c0luZm8gJiYgc2NlbmVyeUxvZy5wdXNoKCk7XHJcblxyXG4gICAgaWYgKCBub2RlLl9wZG9tRGlzcGxheXNJbmZvLmNhbkhhdmVQRE9NRGlzcGxheXMoKSApIHtcclxuICAgICAgbm9kZS5fcGRvbURpc3BsYXlzSW5mby5yZW1vdmVQRE9NRGlzcGxheXMoIHRoaXMucGRvbURpc3BsYXlzICk7XHJcbiAgICB9XHJcblxyXG4gICAgc2NlbmVyeUxvZyAmJiBzY2VuZXJ5TG9nLlBET01EaXNwbGF5c0luZm8gJiYgc2NlbmVyeUxvZy5wb3AoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENhbGxlZCB3aGVuIG91ciBzdW1tYXJ5IGJpdG1hc2sgY2hhbmdlcyAoc2NlbmVyeS1pbnRlcm5hbClcclxuICAgKi9cclxuICBwdWJsaWMgb25TdW1tYXJ5Q2hhbmdlKCBvbGRCaXRtYXNrOiBudW1iZXIsIG5ld0JpdG1hc2s6IG51bWJlciApOiB2b2lkIHtcclxuICAgIHNjZW5lcnlMb2cgJiYgc2NlbmVyeUxvZy5QRE9NRGlzcGxheXNJbmZvICYmIHNjZW5lcnlMb2cuUERPTURpc3BsYXlzSW5mbyggYG9uU3VtbWFyeUNoYW5nZSBuIyR7dGhpcy5ub2RlLmlkfSB3YXNQRE9NOiR7ISggUmVuZGVyZXIuYml0bWFza05vUERPTSAmIG9sZEJpdG1hc2sgKX0sIGlzUERPTTokeyEoIFJlbmRlcmVyLmJpdG1hc2tOb1BET00gJiBuZXdCaXRtYXNrICl9YCApO1xyXG4gICAgc2NlbmVyeUxvZyAmJiBzY2VuZXJ5TG9nLlBET01EaXNwbGF5c0luZm8gJiYgc2NlbmVyeUxvZy5wdXNoKCk7XHJcblxyXG4gICAgLy8gSWYgd2UgYXJlIGludmlzaWJsZSwgb3VyIHBkb21EaXNwbGF5cyB3b3VsZCBub3QgaGF2ZSBjaGFuZ2VkIChbXSA9PiBbXSlcclxuICAgIGlmICggdGhpcy5ub2RlLnZpc2libGUgJiYgdGhpcy5ub2RlLnBkb21WaXNpYmxlICkge1xyXG4gICAgICBjb25zdCBoYWRQRE9NID0gISggUmVuZGVyZXIuYml0bWFza05vUERPTSAmIG9sZEJpdG1hc2sgKTtcclxuICAgICAgY29uc3QgaGFzUERPTSA9ICEoIFJlbmRlcmVyLmJpdG1hc2tOb1BET00gJiBuZXdCaXRtYXNrICk7XHJcblxyXG4gICAgICAvLyBJZiB3ZSBjaGFuZ2VkIHRvIGhhdmUgcGRvbSBjb250ZW50LCB3ZSBuZWVkIHRvIHJlY3Vyc2l2ZWx5IGFkZCBwZG9tIGRpc3BsYXlzLlxyXG4gICAgICBpZiAoIGhhc1BET00gJiYgIWhhZFBET00gKSB7XHJcbiAgICAgICAgdGhpcy5hZGRBbGxQRE9NRGlzcGxheXMoKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gSWYgd2UgY2hhbmdlZCB0byBOT1QgaGF2ZSBwZG9tIGNvbnRlbnQsIHdlIG5lZWQgdG8gcmVjdXJzaXZlbHkgcmVtb3ZlIHBkb20gZGlzcGxheXMuXHJcbiAgICAgIGlmICggIWhhc1BET00gJiYgaGFkUERPTSApIHtcclxuICAgICAgICB0aGlzLnJlbW92ZUFsbFBET01EaXNwbGF5cygpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc2NlbmVyeUxvZyAmJiBzY2VuZXJ5TG9nLlBET01EaXNwbGF5c0luZm8gJiYgc2NlbmVyeUxvZy5wb3AoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENhbGxlZCB3aGVuIG91ciB2aXNpYmlsaXR5IGNoYW5nZXMuIChzY2VuZXJ5LWludGVybmFsKVxyXG4gICAqL1xyXG4gIHB1YmxpYyBvblZpc2liaWxpdHlDaGFuZ2UoIHZpc2libGU6IGJvb2xlYW4gKTogdm9pZCB7XHJcbiAgICBzY2VuZXJ5TG9nICYmIHNjZW5lcnlMb2cuUERPTURpc3BsYXlzSW5mbyAmJiBzY2VuZXJ5TG9nLlBET01EaXNwbGF5c0luZm8oIGBvblZpc2liaWxpdHlDaGFuZ2UgbiMke3RoaXMubm9kZS5pZH0gdmlzaWJsZToke3Zpc2libGV9YCApO1xyXG4gICAgc2NlbmVyeUxvZyAmJiBzY2VuZXJ5TG9nLlBET01EaXNwbGF5c0luZm8gJiYgc2NlbmVyeUxvZy5wdXNoKCk7XHJcblxyXG4gICAgLy8gSWYgd2UgZG9uJ3QgaGF2ZSBwZG9tIChvciBwZG9tVmlzaWJsZSksIG91ciBwZG9tRGlzcGxheXMgd291bGQgbm90IGhhdmUgY2hhbmdlZCAoW10gPT4gW10pXHJcbiAgICBpZiAoIHRoaXMubm9kZS5wZG9tVmlzaWJsZSAmJiAhdGhpcy5ub2RlLl9yZW5kZXJlclN1bW1hcnkuaGFzTm9QRE9NKCkgKSB7XHJcbiAgICAgIGlmICggdmlzaWJsZSApIHtcclxuICAgICAgICB0aGlzLmFkZEFsbFBET01EaXNwbGF5cygpO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIHRoaXMucmVtb3ZlQWxsUERPTURpc3BsYXlzKCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzY2VuZXJ5TG9nICYmIHNjZW5lcnlMb2cuUERPTURpc3BsYXlzSW5mbyAmJiBzY2VuZXJ5TG9nLnBvcCgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2FsbGVkIHdoZW4gb3VyIHBkb21WaXNpYmlsaXR5IGNoYW5nZXMuIChzY2VuZXJ5LWludGVybmFsKVxyXG4gICAqL1xyXG4gIHB1YmxpYyBvblBET01WaXNpYmlsaXR5Q2hhbmdlKCB2aXNpYmxlOiBib29sZWFuICk6IHZvaWQge1xyXG4gICAgc2NlbmVyeUxvZyAmJiBzY2VuZXJ5TG9nLlBET01EaXNwbGF5c0luZm8gJiYgc2NlbmVyeUxvZy5QRE9NRGlzcGxheXNJbmZvKCBgb25QRE9NVmlzaWJpbGl0eUNoYW5nZSBuIyR7dGhpcy5ub2RlLmlkfSBwZG9tVmlzaWJsZToke3Zpc2libGV9YCApO1xyXG4gICAgc2NlbmVyeUxvZyAmJiBzY2VuZXJ5TG9nLlBET01EaXNwbGF5c0luZm8gJiYgc2NlbmVyeUxvZy5wdXNoKCk7XHJcblxyXG4gICAgLy8gSWYgd2UgZG9uJ3QgaGF2ZSBwZG9tLCBvdXIgcGRvbURpc3BsYXlzIHdvdWxkIG5vdCBoYXZlIGNoYW5nZWQgKFtdID0+IFtdKVxyXG4gICAgaWYgKCB0aGlzLm5vZGUudmlzaWJsZSAmJiAhdGhpcy5ub2RlLl9yZW5kZXJlclN1bW1hcnkuaGFzTm9QRE9NKCkgKSB7XHJcbiAgICAgIGlmICggdmlzaWJsZSApIHtcclxuICAgICAgICB0aGlzLmFkZEFsbFBET01EaXNwbGF5cygpO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIHRoaXMucmVtb3ZlQWxsUERPTURpc3BsYXlzKCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzY2VuZXJ5TG9nICYmIHNjZW5lcnlMb2cuUERPTURpc3BsYXlzSW5mbyAmJiBzY2VuZXJ5TG9nLnBvcCgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2FsbGVkIHdoZW4gd2UgaGF2ZSBhIHJvb3RlZCBkaXNwbGF5IGFkZGVkIHRvIHRoaXMgbm9kZS4gKHNjZW5lcnktaW50ZXJuYWwpXHJcbiAgICovXHJcbiAgcHVibGljIG9uQWRkZWRSb290ZWREaXNwbGF5KCBkaXNwbGF5OiBEaXNwbGF5ICk6IHZvaWQge1xyXG4gICAgc2NlbmVyeUxvZyAmJiBzY2VuZXJ5TG9nLlBET01EaXNwbGF5c0luZm8gJiYgc2NlbmVyeUxvZy5QRE9NRGlzcGxheXNJbmZvKCBgb25BZGRlZFJvb3RlZERpc3BsYXkgbiMke3RoaXMubm9kZS5pZH1gICk7XHJcbiAgICBzY2VuZXJ5TG9nICYmIHNjZW5lcnlMb2cuUERPTURpc3BsYXlzSW5mbyAmJiBzY2VuZXJ5TG9nLnB1c2goKTtcclxuXHJcbiAgICBpZiAoIGRpc3BsYXkuX2FjY2Vzc2libGUgJiYgdGhpcy5jYW5IYXZlUERPTURpc3BsYXlzKCkgKSB7XHJcbiAgICAgIHRoaXMuYWRkUERPTURpc3BsYXlzKCBbIGRpc3BsYXkgXSApO1xyXG4gICAgfVxyXG5cclxuICAgIHNjZW5lcnlMb2cgJiYgc2NlbmVyeUxvZy5QRE9NRGlzcGxheXNJbmZvICYmIHNjZW5lcnlMb2cucG9wKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDYWxsZWQgd2hlbiB3ZSBoYXZlIGEgcm9vdGVkIGRpc3BsYXkgcmVtb3ZlZCBmcm9tIHRoaXMgbm9kZS4gKHNjZW5lcnktaW50ZXJuYWwpXHJcbiAgICovXHJcbiAgcHVibGljIG9uUmVtb3ZlZFJvb3RlZERpc3BsYXkoIGRpc3BsYXk6IERpc3BsYXkgKTogdm9pZCB7XHJcbiAgICBzY2VuZXJ5TG9nICYmIHNjZW5lcnlMb2cuUERPTURpc3BsYXlzSW5mbyAmJiBzY2VuZXJ5TG9nLlBET01EaXNwbGF5c0luZm8oIGBvblJlbW92ZWRSb290ZWREaXNwbGF5IG4jJHt0aGlzLm5vZGUuaWR9YCApO1xyXG4gICAgc2NlbmVyeUxvZyAmJiBzY2VuZXJ5TG9nLlBET01EaXNwbGF5c0luZm8gJiYgc2NlbmVyeUxvZy5wdXNoKCk7XHJcblxyXG4gICAgaWYgKCBkaXNwbGF5Ll9hY2Nlc3NpYmxlICYmIHRoaXMuY2FuSGF2ZVBET01EaXNwbGF5cygpICkge1xyXG4gICAgICB0aGlzLnJlbW92ZVBET01EaXNwbGF5cyggWyBkaXNwbGF5IF0gKTtcclxuICAgIH1cclxuXHJcbiAgICBzY2VuZXJ5TG9nICYmIHNjZW5lcnlMb2cuUERPTURpc3BsYXlzSW5mbyAmJiBzY2VuZXJ5TG9nLnBvcCgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJucyB3aGV0aGVyIHdlIGNhbiBoYXZlIHBkb21EaXNwbGF5cyBzcGVjaWZpZWQgaW4gb3VyIGFycmF5LiAoc2NlbmVyeS1pbnRlcm5hbClcclxuICAgKi9cclxuICBwdWJsaWMgY2FuSGF2ZVBET01EaXNwbGF5cygpOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0aGlzLm5vZGUudmlzaWJsZSAmJiB0aGlzLm5vZGUucGRvbVZpc2libGUgJiYgIXRoaXMubm9kZS5fcmVuZGVyZXJTdW1tYXJ5Lmhhc05vUERPTSgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQWRkcyBhbGwgb2Ygb3VyIHBkb20gZGlzcGxheXMgdG8gb3VyIGFycmF5IChhbmQgcHJvcGFnYXRlcykuXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhZGRBbGxQRE9NRGlzcGxheXMoKTogdm9pZCB7XHJcbiAgICBzY2VuZXJ5TG9nICYmIHNjZW5lcnlMb2cuUERPTURpc3BsYXlzSW5mbyAmJiBzY2VuZXJ5TG9nLlBET01EaXNwbGF5c0luZm8oIGBhZGRBbGxQRE9NRGlzcGxheXMgbiMke3RoaXMubm9kZS5pZH1gICk7XHJcbiAgICBzY2VuZXJ5TG9nICYmIHNjZW5lcnlMb2cuUERPTURpc3BsYXlzSW5mbyAmJiBzY2VuZXJ5TG9nLnB1c2goKTtcclxuXHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCB0aGlzLnBkb21EaXNwbGF5cy5sZW5ndGggPT09IDAsICdTaG91bGQgYmUgZW1wdHkgYmVmb3JlIGFkZGluZyBldmVyeXRoaW5nJyApO1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggdGhpcy5jYW5IYXZlUERPTURpc3BsYXlzKCksICdTaG91bGQgaGFwcGVuIHdoZW4gd2UgY2FuIHN0b3JlIHBkb21EaXNwbGF5cycgKTtcclxuXHJcbiAgICBsZXQgaTtcclxuICAgIGNvbnN0IGRpc3BsYXlzOiBEaXNwbGF5W10gPSBbXTtcclxuXHJcbiAgICAvLyBDb25jYXRlbmF0aW9uIG9mIG91ciBwYXJlbnRzJyBwZG9tRGlzcGxheXNcclxuICAgIGZvciAoIGkgPSAwOyBpIDwgdGhpcy5ub2RlLl9wYXJlbnRzLmxlbmd0aDsgaSsrICkge1xyXG4gICAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseSggZGlzcGxheXMsIHRoaXMubm9kZS5fcGFyZW50c1sgaSBdLl9wZG9tRGlzcGxheXNJbmZvLnBkb21EaXNwbGF5cyApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEFORCBhbnkgYWNlc3NpYmxlIGRpc3BsYXlzIHJvb3RlZCBhdCB0aGlzIG5vZGVcclxuICAgIGZvciAoIGkgPSAwOyBpIDwgdGhpcy5ub2RlLl9yb290ZWREaXNwbGF5cy5sZW5ndGg7IGkrKyApIHtcclxuICAgICAgY29uc3QgZGlzcGxheSA9IHRoaXMubm9kZS5fcm9vdGVkRGlzcGxheXNbIGkgXTtcclxuICAgICAgaWYgKCBkaXNwbGF5Ll9hY2Nlc3NpYmxlICkge1xyXG4gICAgICAgIGRpc3BsYXlzLnB1c2goIGRpc3BsYXkgKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuYWRkUERPTURpc3BsYXlzKCBkaXNwbGF5cyApO1xyXG5cclxuICAgIHNjZW5lcnlMb2cgJiYgc2NlbmVyeUxvZy5QRE9NRGlzcGxheXNJbmZvICYmIHNjZW5lcnlMb2cucG9wKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZW1vdmVzIGFsbCBvZiBvdXIgcGRvbSBkaXNwbGF5cyBmcm9tIG91ciBhcnJheSAoYW5kIHByb3BhZ2F0ZXMpLlxyXG4gICAqL1xyXG4gIHByaXZhdGUgcmVtb3ZlQWxsUERPTURpc3BsYXlzKCk6IHZvaWQge1xyXG4gICAgc2NlbmVyeUxvZyAmJiBzY2VuZXJ5TG9nLlBET01EaXNwbGF5c0luZm8gJiYgc2NlbmVyeUxvZy5QRE9NRGlzcGxheXNJbmZvKCBgcmVtb3ZlQWxsUERPTURpc3BsYXlzIG4jJHt0aGlzLm5vZGUuaWR9YCApO1xyXG4gICAgc2NlbmVyeUxvZyAmJiBzY2VuZXJ5TG9nLlBET01EaXNwbGF5c0luZm8gJiYgc2NlbmVyeUxvZy5wdXNoKCk7XHJcblxyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggIXRoaXMuY2FuSGF2ZVBET01EaXNwbGF5cygpLCAnU2hvdWxkIGhhcHBlbiB3aGVuIHdlIGNhbm5vdCBzdG9yZSBwZG9tRGlzcGxheXMnICk7XHJcblxyXG4gICAgLy8gVE9ETzogaXMgdGhlcmUgYSB3YXkgdG8gYXZvaWQgYSBjb3B5PyBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMvc2NlbmVyeS9pc3N1ZXMvMTU4MVxyXG4gICAgdGhpcy5yZW1vdmVQRE9NRGlzcGxheXMoIHRoaXMucGRvbURpc3BsYXlzLnNsaWNlKCkgKTtcclxuXHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCB0aGlzLnBkb21EaXNwbGF5cy5sZW5ndGggPT09IDAsICdTaG91bGQgYmUgZW1wdHkgYWZ0ZXIgcmVtb3ZpbmcgZXZlcnl0aGluZycgKTtcclxuXHJcbiAgICBzY2VuZXJ5TG9nICYmIHNjZW5lcnlMb2cuUERPTURpc3BsYXlzSW5mbyAmJiBzY2VuZXJ5TG9nLnBvcCgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQWRkcyBhIGxpc3Qgb2YgcGRvbSBkaXNwbGF5cyB0byBvdXIgaW50ZXJuYWwgbGlzdC4gU2VlIHBkb21EaXNwbGF5cyBkb2N1bWVudGF0aW9uLlxyXG4gICAqL1xyXG4gIHByaXZhdGUgYWRkUERPTURpc3BsYXlzKCBkaXNwbGF5czogRGlzcGxheVtdICk6IHZvaWQge1xyXG4gICAgc2NlbmVyeUxvZyAmJiBzY2VuZXJ5TG9nLlBET01EaXNwbGF5c0luZm8gJiYgc2NlbmVyeUxvZy5QRE9NRGlzcGxheXNJbmZvKCBgYWRkUERPTURpc3BsYXlzIG4jJHt0aGlzLm5vZGUuaWR9IG51bURpc3BsYXlzOiR7ZGlzcGxheXMubGVuZ3RofWAgKTtcclxuICAgIHNjZW5lcnlMb2cgJiYgc2NlbmVyeUxvZy5QRE9NRGlzcGxheXNJbmZvICYmIHNjZW5lcnlMb2cucHVzaCgpO1xyXG5cclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIEFycmF5LmlzQXJyYXkoIGRpc3BsYXlzICkgKTtcclxuXHJcbiAgICAvLyBTaW1wbGlmaWVzIHRoaW5ncyBpZiB3ZSBjYW4gc3RvcCBuby1vcHMgaGVyZS5cclxuICAgIGlmICggZGlzcGxheXMubGVuZ3RoICE9PSAwICkge1xyXG4gICAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseSggdGhpcy5wZG9tRGlzcGxheXMsIGRpc3BsYXlzICk7XHJcblxyXG4gICAgICAvLyBQcm9wYWdhdGUgdGhlIGNoYW5nZSB0byBvdXIgY2hpbGRyZW5cclxuICAgICAgZm9yICggbGV0IGkgPSAwOyBpIDwgdGhpcy5ub2RlLl9jaGlsZHJlbi5sZW5ndGg7IGkrKyApIHtcclxuICAgICAgICBjb25zdCBjaGlsZCA9IHRoaXMubm9kZS5fY2hpbGRyZW5bIGkgXTtcclxuICAgICAgICBpZiAoIGNoaWxkLl9wZG9tRGlzcGxheXNJbmZvLmNhbkhhdmVQRE9NRGlzcGxheXMoKSApIHtcclxuICAgICAgICAgIHRoaXMubm9kZS5fY2hpbGRyZW5bIGkgXS5fcGRvbURpc3BsYXlzSW5mby5hZGRQRE9NRGlzcGxheXMoIGRpc3BsYXlzICk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICB0aGlzLm5vZGUucGRvbURpc3BsYXlzRW1pdHRlci5lbWl0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgc2NlbmVyeUxvZyAmJiBzY2VuZXJ5TG9nLlBET01EaXNwbGF5c0luZm8gJiYgc2NlbmVyeUxvZy5wb3AoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlbW92ZXMgYSBsaXN0IG9mIHBkb20gZGlzcGxheXMgZnJvbSBvdXIgaW50ZXJuYWwgbGlzdC4gU2VlIHBkb21EaXNwbGF5cyBkb2N1bWVudGF0aW9uLlxyXG4gICAqL1xyXG4gIHByaXZhdGUgcmVtb3ZlUERPTURpc3BsYXlzKCBkaXNwbGF5czogRGlzcGxheVtdICk6IHZvaWQge1xyXG4gICAgc2NlbmVyeUxvZyAmJiBzY2VuZXJ5TG9nLlBET01EaXNwbGF5c0luZm8gJiYgc2NlbmVyeUxvZy5QRE9NRGlzcGxheXNJbmZvKCBgcmVtb3ZlUERPTURpc3BsYXlzIG4jJHt0aGlzLm5vZGUuaWR9IG51bURpc3BsYXlzOiR7ZGlzcGxheXMubGVuZ3RofWAgKTtcclxuICAgIHNjZW5lcnlMb2cgJiYgc2NlbmVyeUxvZy5QRE9NRGlzcGxheXNJbmZvICYmIHNjZW5lcnlMb2cucHVzaCgpO1xyXG5cclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIEFycmF5LmlzQXJyYXkoIGRpc3BsYXlzICkgKTtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIHRoaXMucGRvbURpc3BsYXlzLmxlbmd0aCA+PSBkaXNwbGF5cy5sZW5ndGgsICd0aGVyZSBzaG91bGQgYmUgYXQgbGVhc3QgYXMgbWFueSBQRE9NRGlzcGxheXMgYXMgRGlzcGxheXMnICk7XHJcblxyXG4gICAgLy8gU2ltcGxpZmllcyB0aGluZ3MgaWYgd2UgY2FuIHN0b3Agbm8tb3BzIGhlcmUuXHJcbiAgICBpZiAoIGRpc3BsYXlzLmxlbmd0aCAhPT0gMCApIHtcclxuICAgICAgbGV0IGk7XHJcblxyXG4gICAgICBmb3IgKCBpID0gZGlzcGxheXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0gKSB7XHJcbiAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLnBkb21EaXNwbGF5cy5sYXN0SW5kZXhPZiggZGlzcGxheXNbIGkgXSApO1xyXG4gICAgICAgIGFzc2VydCAmJiBhc3NlcnQoIGluZGV4ID49IDAgKTtcclxuICAgICAgICB0aGlzLnBkb21EaXNwbGF5cy5zcGxpY2UoIGksIDEgKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gUHJvcGFnYXRlIHRoZSBjaGFuZ2UgdG8gb3VyIGNoaWxkcmVuXHJcbiAgICAgIGZvciAoIGkgPSAwOyBpIDwgdGhpcy5ub2RlLl9jaGlsZHJlbi5sZW5ndGg7IGkrKyApIHtcclxuICAgICAgICBjb25zdCBjaGlsZCA9IHRoaXMubm9kZS5fY2hpbGRyZW5bIGkgXTtcclxuICAgICAgICAvLyBOT1RFOiBTaW5jZSB0aGlzIGdldHMgY2FsbGVkIG1hbnkgdGltZXMgZnJvbSB0aGUgUmVuZGVyZXJTdW1tYXJ5ICh3aGljaCBoYXBwZW5zIGJlZm9yZSB0aGUgYWN0dWFsIGNoaWxkXHJcbiAgICAgICAgLy8gbW9kaWZpY2F0aW9uIGhhcHBlbnMpLCB3ZSBETyBOT1Qgd2FudCB0byB0cmF2ZXJzZSB0byB0aGUgY2hpbGQgbm9kZSBnZXR0aW5nIHJlbW92ZWQuIElkZWFsbHkgYSBiZXR0ZXJcclxuICAgICAgICAvLyBzb2x1dGlvbiB0aGFuIHRoaXMgZmxhZyBzaG91bGQgYmUgZm91bmQuXHJcbiAgICAgICAgaWYgKCBjaGlsZC5fcGRvbURpc3BsYXlzSW5mby5jYW5IYXZlUERPTURpc3BsYXlzKCkgJiYgIWNoaWxkLl9pc0dldHRpbmdSZW1vdmVkRnJvbVBhcmVudCApIHtcclxuICAgICAgICAgIGNoaWxkLl9wZG9tRGlzcGxheXNJbmZvLnJlbW92ZVBET01EaXNwbGF5cyggZGlzcGxheXMgKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHRoaXMubm9kZS5wZG9tRGlzcGxheXNFbWl0dGVyLmVtaXQoKTtcclxuICAgIH1cclxuXHJcbiAgICBzY2VuZXJ5TG9nICYmIHNjZW5lcnlMb2cuUERPTURpc3BsYXlzSW5mbyAmJiBzY2VuZXJ5TG9nLnBvcCgpO1xyXG4gIH1cclxufVxyXG5cclxuc2NlbmVyeS5yZWdpc3RlciggJ1BET01EaXNwbGF5c0luZm8nLCBQRE9NRGlzcGxheXNJbmZvICk7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLFNBQXdCQSxRQUFRLEVBQUVDLE9BQU8sUUFBUSxrQkFBa0I7QUFFbkUsZUFBZSxNQUFNQyxnQkFBZ0IsQ0FBQztFQUlwQztFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7O0VBR0E7QUFDRjtBQUNBO0FBQ0E7RUFDU0MsV0FBV0EsQ0FBRUMsSUFBVSxFQUFHO0lBQy9CLElBQUksQ0FBQ0EsSUFBSSxHQUFHQSxJQUFJO0lBQ2hCLElBQUksQ0FBQ0MsWUFBWSxHQUFHLEVBQUU7RUFDeEI7O0VBRUE7QUFDRjtBQUNBO0VBQ1NDLFVBQVVBLENBQUVGLElBQVUsRUFBUztJQUNwQ0csVUFBVSxJQUFJQSxVQUFVLENBQUNMLGdCQUFnQixJQUFJSyxVQUFVLENBQUNMLGdCQUFnQixDQUFHLGdCQUFlRSxJQUFJLENBQUNJLEVBQUcsY0FBYSxJQUFJLENBQUNKLElBQUksQ0FBQ0ksRUFBRyxHQUFHLENBQUM7SUFDaElELFVBQVUsSUFBSUEsVUFBVSxDQUFDTCxnQkFBZ0IsSUFBSUssVUFBVSxDQUFDRSxJQUFJLENBQUMsQ0FBQztJQUU5RCxJQUFLTCxJQUFJLENBQUNNLGlCQUFpQixDQUFDQyxtQkFBbUIsQ0FBQyxDQUFDLEVBQUc7TUFDbERQLElBQUksQ0FBQ00saUJBQWlCLENBQUNFLGVBQWUsQ0FBRSxJQUFJLENBQUNQLFlBQWEsQ0FBQztJQUM3RDtJQUVBRSxVQUFVLElBQUlBLFVBQVUsQ0FBQ0wsZ0JBQWdCLElBQUlLLFVBQVUsQ0FBQ00sR0FBRyxDQUFDLENBQUM7RUFDL0Q7O0VBRUE7QUFD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