// Copyright 2022-2024, University of Colorado Boulder

/**
 * Deserializes a generalized object
 * @deprecated
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

import Property from '../../../axon/js/Property.js';
import Bounds2 from '../../../dot/js/Bounds2.js';
import Matrix3 from '../../../dot/js/Matrix3.js';
import Vector2 from '../../../dot/js/Vector2.js';
import { Shape } from '../../../kite/js/imports.js';
import { Circle, Color, DOM, Image, Line, LinearGradient, Node, Path, Pattern, RadialGradient, Rectangle, scenery, Text } from '../imports.js';
import TinyProperty from '../../../axon/js/TinyProperty.js';
const sceneryDeserialize = value => {
  const nodeTypes = ['Node', 'Path', 'Circle', 'Line', 'Rectangle', 'Text', 'Image', 'CanvasNode', 'WebGLNode', 'DOM'];
  if (value.type === 'Vector2') {
    return new Vector2(value.x, value.y);
  }
  if (value.type === 'Matrix3') {
    return new Matrix3().rowMajor(value.m00, value.m01, value.m02, value.m10, value.m11, value.m12, value.m20, value.m21, value.m22);
  } else if (value.type === 'Bounds2') {
    return new Bounds2(value.minX, value.minY, value.maxX, value.maxY);
  } else if (value.type === 'Shape') {
    return new Shape(value.path);
  } else if (value.type === 'Array') {
    return value.value.map(sceneryDeserialize);
  } else if (value.type === 'Color') {
    return new Color(value.red, value.green, value.blue, value.alpha);
  } else if (value.type === 'Property') {
    return new Property(sceneryDeserialize(value.value));
  } else if (value.type === 'TinyProperty') {
    return new TinyProperty(sceneryDeserialize(value.value));
  } else if (value.type === 'Pattern' || value.type === 'LinearGradient' || value.type === 'RadialGradient') {
    let paint;
    if (value.type === 'Pattern') {
      const img = new window.Image();
      img.src = value.url;
      paint = new Pattern(img);
    }
    // Gradients
    else {
      const start = sceneryDeserialize(value.start);
      const end = sceneryDeserialize(value.end);
      if (value.type === 'LinearGradient') {
        paint = new LinearGradient(start.x, start.y, end.x, end.y);
      } else if (value.type === 'RadialGradient') {
        paint = new RadialGradient(start.x, start.y, value.startRadius, end.x, end.y, value.endRadius);
      }
      value.stops.forEach(stop => {
        paint.addColorStop(stop.ratio, sceneryDeserialize(stop.stop));
      });
    }
    if (value.transformMatrix) {
      paint.setTransformMatrix(sceneryDeserialize(value.transformMatrix));
    }
    return paint;
  } else if (_.includes(nodeTypes, value.type)) {
    let node;
    const setup = value.setup;
    if (value.type === 'Node') {
      node = new Node();
    } else if (value.type === 'Path') {
      node = new Path(sceneryDeserialize(setup.path));
    } else if (value.type === 'Circle') {
      node = new Circle({});
    } else if (value.type === 'Line') {
      node = new Line({});
    } else if (value.type === 'Rectangle') {
      node = new Rectangle({});
    } else if (value.type === 'Text') {
      node = new Text('');
    } else if (value.type === 'Image') {
      if (setup.imageType === 'image' || setup.imageType === 'canvas') {
        node = new Image(setup.src);
        if (setup.generateMipmaps) {
          node.mipmap = true;
        }
      } else if (setup.imageType === 'mipmapData') {
        const mipmapData = setup.mipmapData.map(level => {
          const result = {
            width: level.width,
            height: level.height,
            url: level.url
          };
          result.img = new window.Image();
          result.img.src = level.url;
          result.canvas = document.createElement('canvas');
          result.canvas.width = level.width;
          result.canvas.height = level.height;
          const context = result.canvas.getContext('2d');
          // delayed loading like in mipmap plugin
          result.updateCanvas = function () {
            if (result.img.complete && (typeof result.img.naturalWidth === 'undefined' || result.img.naturalWidth > 0)) {
              context.drawImage(result.img, 0, 0);
              delete result.updateCanvas;
            }
          };
          return result;
        });
        node = new Image(mipmapData);
      }
      node.initialWidth = setup.width;
      node.initialHeight = setup.height;
    } else if (value.type === 'CanvasNode' || value.type === 'WebGLNode') {
      // TODO: Record Canvas/WebGL calls? (conditionals would be harder!) https://github.com/phetsims/scenery/issues/1581
      node = new Node({
        children: [new Image(setup.url, {
          translation: sceneryDeserialize(setup.offset),
          scale: 1 / setup.scale
        })]
      });
    } else if (value.type === 'DOM') {
      const div = document.createElement('div');
      div.innerHTML = value.element;
      const element = div.childNodes[0];
      div.removeChild(element);
      if (value.dataURL) {
        const img = new window.Image();
        img.onload = () => {
          const context = element.getContext('2d');
          context.drawImage(img, 0, 0);
        };
        img.src = value.dataURL;
      }
      node = new DOM(element);
    }
    if (setup.clipArea) {
      node.clipArea = sceneryDeserialize(setup.clipArea);
    }
    if (setup.mouseArea) {
      node.mouseArea = sceneryDeserialize(setup.mouseArea);
    }
    if (setup.touchArea) {
      node.touchArea = sceneryDeserialize(setup.touchArea);
    }
    if (setup.matrix) {
      node.matrix = sceneryDeserialize(setup.matrix);
    }
    if (setup.localBounds) {
      node.localBounds = sceneryDeserialize(setup.localBounds);
    }

    // Paintable, if they exist
    if (setup.fill) {
      node.fill = sceneryDeserialize(setup.fill);
    }
    if (setup.stroke) {
      node.stroke = sceneryDeserialize(setup.stroke);
    }
    if (setup.lineDash) {
      node.lineDash = sceneryDeserialize(setup.lineDash);
    }
    node.mutate(value.options);
    node._serialization = value;
    return node;
  } else if (value.type === 'Subtree') {
    const nodeMap = {};
    const nodes = value.nodes.map(sceneryDeserialize);

    // Index them
    nodes.forEach(node => {
      nodeMap[node._serialization.id] = node;
    });

    // Connect children
    nodes.forEach(node => {
      node._serialization.setup.children.forEach(childId => {
        node.addChild(nodeMap[childId]);
      });
    });

    // The root should be the first one
    return nodeMap[value.rootNodeId];
  } else if (value.type === 'value') {
    return value.value;
  } else {
    return null;
  }
};
scenery.register('sceneryDeserialize', sceneryDeserialize);
export default sceneryDeserialize;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQcm9wZXJ0eSIsIkJvdW5kczIiLCJNYXRyaXgzIiwiVmVjdG9yMiIsIlNoYXBlIiwiQ2lyY2xlIiwiQ29sb3IiLCJET00iLCJJbWFnZSIsIkxpbmUiLCJMaW5lYXJHcmFkaWVudCIsIk5vZGUiLCJQYXRoIiwiUGF0dGVybiIsIlJhZGlhbEdyYWRpZW50IiwiUmVjdGFuZ2xlIiwic2NlbmVyeSIsIlRleHQiLCJUaW55UHJvcGVydHkiLCJzY2VuZXJ5RGVzZXJpYWxpemUiLCJ2YWx1ZSIsIm5vZGVUeXBlcyIsInR5cGUiLCJ4IiwieSIsInJvd01ham9yIiwibTAwIiwibTAxIiwibTAyIiwibTEwIiwibTExIiwibTEyIiwibTIwIiwibTIxIiwibTIyIiwibWluWCIsIm1pblkiLCJtYXhYIiwibWF4WSIsInBhdGgiLCJtYXAiLCJyZWQiLCJncmVlbiIsImJsdWUiLCJhbHBoYSIsInBhaW50IiwiaW1nIiwid2luZG93Iiwic3JjIiwidXJsIiwic3RhcnQiLCJlbmQiLCJzdGFydFJhZGl1cyIsImVuZFJhZGl1cyIsInN0b3BzIiwiZm9yRWFjaCIsInN0b3AiLCJhZGRDb2xvclN0b3AiLCJyYXRpbyIsInRyYW5zZm9ybU1hdHJpeCIsInNldFRyYW5zZm9ybU1hdHJpeCIsIl8iLCJpbmNsdWRlcyIsIm5vZGUiLCJzZXR1cCIsImltYWdlVHlwZSIsImdlbmVyYXRlTWlwbWFwcyIsIm1pcG1hcCIsIm1pcG1hcERhdGEiLCJsZXZlbCIsInJlc3VsdCIsIndpZHRoIiwiaGVpZ2h0IiwiY2FudmFzIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiY29udGV4dCIsImdldENvbnRleHQiLCJ1cGRhdGVDYW52YXMiLCJjb21wbGV0ZSIsIm5hdHVyYWxXaWR0aCIsImRyYXdJbWFnZSIsImluaXRpYWxXaWR0aCIsImluaXRpYWxIZWlnaHQiLCJjaGlsZHJlbiIsInRyYW5zbGF0aW9uIiwib2Zmc2V0Iiwic2NhbGUiLCJkaXYiLCJpbm5lckhUTUwiLCJlbGVtZW50IiwiY2hpbGROb2RlcyIsInJlbW92ZUNoaWxkIiwiZGF0YVVSTCIsIm9ubG9hZCIsImNsaXBBcmVhIiwibW91c2VBcmVhIiwidG91Y2hBcmVhIiwibWF0cml4IiwibG9jYWxCb3VuZHMiLCJmaWxsIiwic3Ryb2tlIiwibGluZURhc2giLCJtdXRhdGUiLCJvcHRpb25zIiwiX3NlcmlhbGl6YXRpb24iLCJub2RlTWFwIiwibm9kZXMiLCJpZCIsImNoaWxkSWQiLCJhZGRDaGlsZCIsInJvb3ROb2RlSWQiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbInNjZW5lcnlEZXNlcmlhbGl6ZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAyMi0yMDI0LCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBEZXNlcmlhbGl6ZXMgYSBnZW5lcmFsaXplZCBvYmplY3RcclxuICogQGRlcHJlY2F0ZWRcclxuICpcclxuICogQGF1dGhvciBKb25hdGhhbiBPbHNvbiA8am9uYXRoYW4ub2xzb25AY29sb3JhZG8uZWR1PlxyXG4gKi9cclxuXHJcbmltcG9ydCBQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi9heG9uL2pzL1Byb3BlcnR5LmpzJztcclxuaW1wb3J0IEJvdW5kczIgZnJvbSAnLi4vLi4vLi4vZG90L2pzL0JvdW5kczIuanMnO1xyXG5pbXBvcnQgTWF0cml4MyBmcm9tICcuLi8uLi8uLi9kb3QvanMvTWF0cml4My5qcyc7XHJcbmltcG9ydCBWZWN0b3IyIGZyb20gJy4uLy4uLy4uL2RvdC9qcy9WZWN0b3IyLmpzJztcclxuaW1wb3J0IHsgU2hhcGUgfSBmcm9tICcuLi8uLi8uLi9raXRlL2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgSW50ZW50aW9uYWxBbnkgZnJvbSAnLi4vLi4vLi4vcGhldC1jb3JlL2pzL3R5cGVzL0ludGVudGlvbmFsQW55LmpzJztcclxuaW1wb3J0IHsgQ2lyY2xlLCBDb2xvciwgRE9NLCBHcmFkaWVudCwgSW1hZ2UsIExpbmUsIExpbmVhckdyYWRpZW50LCBNaXBtYXAsIE5vZGUsIFBhaW50LCBQYXRoLCBQYXR0ZXJuLCBSYWRpYWxHcmFkaWVudCwgUmVjdGFuZ2xlLCBzY2VuZXJ5LCBUZXh0IH0gZnJvbSAnLi4vaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBUaW55UHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vYXhvbi9qcy9UaW55UHJvcGVydHkuanMnO1xyXG5cclxuY29uc3Qgc2NlbmVyeURlc2VyaWFsaXplID0gKCB2YWx1ZTogeyB0eXBlOiBzdHJpbmc7IFsga2V5OiBzdHJpbmcgXTogSW50ZW50aW9uYWxBbnkgfSApOiBJbnRlbnRpb25hbEFueSA9PiB7XHJcbiAgY29uc3Qgbm9kZVR5cGVzID0gW1xyXG4gICAgJ05vZGUnLCAnUGF0aCcsICdDaXJjbGUnLCAnTGluZScsICdSZWN0YW5nbGUnLCAnVGV4dCcsICdJbWFnZScsICdDYW52YXNOb2RlJywgJ1dlYkdMTm9kZScsICdET00nXHJcbiAgXTtcclxuXHJcbiAgaWYgKCB2YWx1ZS50eXBlID09PSAnVmVjdG9yMicgKSB7XHJcbiAgICByZXR1cm4gbmV3IFZlY3RvcjIoIHZhbHVlLngsIHZhbHVlLnkgKTtcclxuICB9XHJcbiAgaWYgKCB2YWx1ZS50eXBlID09PSAnTWF0cml4MycgKSB7XHJcbiAgICByZXR1cm4gbmV3IE1hdHJpeDMoKS5yb3dNYWpvcihcclxuICAgICAgdmFsdWUubTAwLCB2YWx1ZS5tMDEsIHZhbHVlLm0wMixcclxuICAgICAgdmFsdWUubTEwLCB2YWx1ZS5tMTEsIHZhbHVlLm0xMixcclxuICAgICAgdmFsdWUubTIwLCB2YWx1ZS5tMjEsIHZhbHVlLm0yMlxyXG4gICAgKTtcclxuICB9XHJcbiAgZWxzZSBpZiAoIHZhbHVlLnR5cGUgPT09ICdCb3VuZHMyJyApIHtcclxuICAgIHJldHVybiBuZXcgQm91bmRzMiggdmFsdWUubWluWCwgdmFsdWUubWluWSwgdmFsdWUubWF4WCwgdmFsdWUubWF4WSApO1xyXG4gIH1cclxuICBlbHNlIGlmICggdmFsdWUudHlwZSA9PT0gJ1NoYXBlJyApIHtcclxuICAgIHJldHVybiBuZXcgU2hhcGUoIHZhbHVlLnBhdGggKTtcclxuICB9XHJcbiAgZWxzZSBpZiAoIHZhbHVlLnR5cGUgPT09ICdBcnJheScgKSB7XHJcbiAgICByZXR1cm4gdmFsdWUudmFsdWUubWFwKCBzY2VuZXJ5RGVzZXJpYWxpemUgKTtcclxuICB9XHJcbiAgZWxzZSBpZiAoIHZhbHVlLnR5cGUgPT09ICdDb2xvcicgKSB7XHJcbiAgICByZXR1cm4gbmV3IENvbG9yKCB2YWx1ZS5yZWQsIHZhbHVlLmdyZWVuLCB2YWx1ZS5ibHVlLCB2YWx1ZS5hbHBoYSApO1xyXG4gIH1cclxuICBlbHNlIGlmICggdmFsdWUudHlwZSA9PT0gJ1Byb3BlcnR5JyApIHtcclxuICAgIHJldHVybiBuZXcgUHJvcGVydHkoIHNjZW5lcnlEZXNlcmlhbGl6ZSggdmFsdWUudmFsdWUgKSApO1xyXG4gIH1cclxuICBlbHNlIGlmICggdmFsdWUudHlwZSA9PT0gJ1RpbnlQcm9wZXJ0eScgKSB7XHJcbiAgICByZXR1cm4gbmV3IFRpbnlQcm9wZXJ0eSggc2NlbmVyeURlc2VyaWFsaXplKCB2YWx1ZS52YWx1ZSApICk7XHJcbiAgfVxyXG4gIGVsc2UgaWYgKCB2YWx1ZS50eXBlID09PSAnUGF0dGVybicgfHwgdmFsdWUudHlwZSA9PT0gJ0xpbmVhckdyYWRpZW50JyB8fCB2YWx1ZS50eXBlID09PSAnUmFkaWFsR3JhZGllbnQnICkge1xyXG4gICAgbGV0IHBhaW50ITogUGFpbnQ7XHJcblxyXG4gICAgaWYgKCB2YWx1ZS50eXBlID09PSAnUGF0dGVybicgKSB7XHJcbiAgICAgIGNvbnN0IGltZyA9IG5ldyB3aW5kb3cuSW1hZ2UoKTtcclxuICAgICAgaW1nLnNyYyA9IHZhbHVlLnVybDtcclxuICAgICAgcGFpbnQgPSBuZXcgUGF0dGVybiggaW1nICk7XHJcbiAgICB9XHJcbiAgICAvLyBHcmFkaWVudHNcclxuICAgIGVsc2Uge1xyXG4gICAgICBjb25zdCBzdGFydCA9IHNjZW5lcnlEZXNlcmlhbGl6ZSggdmFsdWUuc3RhcnQgKTtcclxuICAgICAgY29uc3QgZW5kID0gc2NlbmVyeURlc2VyaWFsaXplKCB2YWx1ZS5lbmQgKTtcclxuICAgICAgaWYgKCB2YWx1ZS50eXBlID09PSAnTGluZWFyR3JhZGllbnQnICkge1xyXG4gICAgICAgIHBhaW50ID0gbmV3IExpbmVhckdyYWRpZW50KCBzdGFydC54LCBzdGFydC55LCBlbmQueCwgZW5kLnkgKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIGlmICggdmFsdWUudHlwZSA9PT0gJ1JhZGlhbEdyYWRpZW50JyApIHtcclxuICAgICAgICBwYWludCA9IG5ldyBSYWRpYWxHcmFkaWVudCggc3RhcnQueCwgc3RhcnQueSwgdmFsdWUuc3RhcnRSYWRpdXMsIGVuZC54LCBlbmQueSwgdmFsdWUuZW5kUmFkaXVzICk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHZhbHVlLnN0b3BzLmZvckVhY2goICggc3RvcDogSW50ZW50aW9uYWxBbnkgKSA9PiB7XHJcbiAgICAgICAgKCBwYWludCBhcyBHcmFkaWVudCApLmFkZENvbG9yU3RvcCggc3RvcC5yYXRpbywgc2NlbmVyeURlc2VyaWFsaXplKCBzdG9wLnN0b3AgKSApO1xyXG4gICAgICB9ICk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCB2YWx1ZS50cmFuc2Zvcm1NYXRyaXggKSB7XHJcbiAgICAgIHBhaW50LnNldFRyYW5zZm9ybU1hdHJpeCggc2NlbmVyeURlc2VyaWFsaXplKCB2YWx1ZS50cmFuc2Zvcm1NYXRyaXggKSApO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBwYWludDtcclxuICB9XHJcbiAgZWxzZSBpZiAoIF8uaW5jbHVkZXMoIG5vZGVUeXBlcywgdmFsdWUudHlwZSApICkge1xyXG4gICAgbGV0IG5vZGU6IEludGVudGlvbmFsQW55O1xyXG5cclxuICAgIGNvbnN0IHNldHVwID0gdmFsdWUuc2V0dXA7XHJcblxyXG4gICAgaWYgKCB2YWx1ZS50eXBlID09PSAnTm9kZScgKSB7XHJcbiAgICAgIG5vZGUgPSBuZXcgTm9kZSgpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoIHZhbHVlLnR5cGUgPT09ICdQYXRoJyApIHtcclxuICAgICAgbm9kZSA9IG5ldyBQYXRoKCBzY2VuZXJ5RGVzZXJpYWxpemUoIHNldHVwLnBhdGggKSApO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoIHZhbHVlLnR5cGUgPT09ICdDaXJjbGUnICkge1xyXG4gICAgICBub2RlID0gbmV3IENpcmNsZSgge30gKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKCB2YWx1ZS50eXBlID09PSAnTGluZScgKSB7XHJcbiAgICAgIG5vZGUgPSBuZXcgTGluZSgge30gKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKCB2YWx1ZS50eXBlID09PSAnUmVjdGFuZ2xlJyApIHtcclxuICAgICAgbm9kZSA9IG5ldyBSZWN0YW5nbGUoIHt9ICk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICggdmFsdWUudHlwZSA9PT0gJ1RleHQnICkge1xyXG4gICAgICBub2RlID0gbmV3IFRleHQoICcnICk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICggdmFsdWUudHlwZSA9PT0gJ0ltYWdlJyApIHtcclxuICAgICAgaWYgKCBzZXR1cC5pbWFnZVR5cGUgPT09ICdpbWFnZScgfHwgc2V0dXAuaW1hZ2VUeXBlID09PSAnY2FudmFzJyApIHtcclxuICAgICAgICBub2RlID0gbmV3IEltYWdlKCBzZXR1cC5zcmMgKTtcclxuICAgICAgICBpZiAoIHNldHVwLmdlbmVyYXRlTWlwbWFwcyApIHtcclxuICAgICAgICAgIG5vZGUubWlwbWFwID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSBpZiAoIHNldHVwLmltYWdlVHlwZSA9PT0gJ21pcG1hcERhdGEnICkge1xyXG4gICAgICAgIGNvbnN0IG1pcG1hcERhdGEgPSBzZXR1cC5taXBtYXBEYXRhLm1hcCggKCBsZXZlbDogTWlwbWFwWzBdICkgPT4ge1xyXG4gICAgICAgICAgY29uc3QgcmVzdWx0OiBJbnRlbnRpb25hbEFueSA9IHtcclxuICAgICAgICAgICAgd2lkdGg6IGxldmVsLndpZHRoLFxyXG4gICAgICAgICAgICBoZWlnaHQ6IGxldmVsLmhlaWdodCxcclxuICAgICAgICAgICAgdXJsOiBsZXZlbC51cmxcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgICByZXN1bHQuaW1nID0gbmV3IHdpbmRvdy5JbWFnZSgpO1xyXG4gICAgICAgICAgcmVzdWx0LmltZy5zcmMgPSBsZXZlbC51cmw7XHJcbiAgICAgICAgICByZXN1bHQuY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2NhbnZhcycgKTtcclxuICAgICAgICAgIHJlc3VsdC5jYW52YXMud2lkdGggPSBsZXZlbC53aWR0aDtcclxuICAgICAgICAgIHJlc3VsdC5jYW52YXMuaGVpZ2h0ID0gbGV2ZWwuaGVpZ2h0O1xyXG4gICAgICAgICAgY29uc3QgY29udGV4dCA9IHJlc3VsdC5jYW52YXMuZ2V0Q29udGV4dCggJzJkJyApO1xyXG4gICAgICAgICAgLy8gZGVsYXllZCBsb2FkaW5nIGxpa2UgaW4gbWlwbWFwIHBsdWdpblxyXG4gICAgICAgICAgcmVzdWx0LnVwZGF0ZUNhbnZhcyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAoIHJlc3VsdC5pbWcuY29tcGxldGUgJiYgKCB0eXBlb2YgcmVzdWx0LmltZy5uYXR1cmFsV2lkdGggPT09ICd1bmRlZmluZWQnIHx8IHJlc3VsdC5pbWcubmF0dXJhbFdpZHRoID4gMCApICkge1xyXG4gICAgICAgICAgICAgIGNvbnRleHQuZHJhd0ltYWdlKCByZXN1bHQuaW1nLCAwLCAwICk7XHJcbiAgICAgICAgICAgICAgZGVsZXRlIHJlc3VsdC51cGRhdGVDYW52YXM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH07XHJcbiAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH0gKTtcclxuICAgICAgICBub2RlID0gbmV3IEltYWdlKCBtaXBtYXBEYXRhICk7XHJcbiAgICAgIH1cclxuICAgICAgKCBub2RlISApLmluaXRpYWxXaWR0aCA9IHNldHVwLndpZHRoO1xyXG4gICAgICAoIG5vZGUhICkuaW5pdGlhbEhlaWdodCA9IHNldHVwLmhlaWdodDtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKCB2YWx1ZS50eXBlID09PSAnQ2FudmFzTm9kZScgfHwgdmFsdWUudHlwZSA9PT0gJ1dlYkdMTm9kZScgKSB7XHJcbiAgICAgIC8vIFRPRE86IFJlY29yZCBDYW52YXMvV2ViR0wgY2FsbHM/IChjb25kaXRpb25hbHMgd291bGQgYmUgaGFyZGVyISkgaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL3NjZW5lcnkvaXNzdWVzLzE1ODFcclxuICAgICAgbm9kZSA9IG5ldyBOb2RlKCB7XHJcbiAgICAgICAgY2hpbGRyZW46IFtcclxuICAgICAgICAgIG5ldyBJbWFnZSggc2V0dXAudXJsLCB7XHJcbiAgICAgICAgICAgIHRyYW5zbGF0aW9uOiBzY2VuZXJ5RGVzZXJpYWxpemUoIHNldHVwLm9mZnNldCApLFxyXG4gICAgICAgICAgICBzY2FsZTogMSAvIHNldHVwLnNjYWxlXHJcbiAgICAgICAgICB9IClcclxuICAgICAgICBdXHJcbiAgICAgIH0gKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKCB2YWx1ZS50eXBlID09PSAnRE9NJyApIHtcclxuICAgICAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2RpdicgKTtcclxuICAgICAgZGl2LmlubmVySFRNTCA9IHZhbHVlLmVsZW1lbnQ7XHJcbiAgICAgIGNvbnN0IGVsZW1lbnQgPSBkaXYuY2hpbGROb2Rlc1sgMCBdO1xyXG4gICAgICBkaXYucmVtb3ZlQ2hpbGQoIGVsZW1lbnQgKTtcclxuXHJcbiAgICAgIGlmICggdmFsdWUuZGF0YVVSTCApIHtcclxuICAgICAgICBjb25zdCBpbWcgPSBuZXcgd2luZG93LkltYWdlKCk7XHJcbiAgICAgICAgaW1nLm9ubG9hZCA9ICgpID0+IHtcclxuICAgICAgICAgIGNvbnN0IGNvbnRleHQgPSAoIGVsZW1lbnQgYXMgSFRNTENhbnZhc0VsZW1lbnQgKS5nZXRDb250ZXh0KCAnMmQnICkhO1xyXG4gICAgICAgICAgY29udGV4dC5kcmF3SW1hZ2UoIGltZywgMCwgMCApO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgaW1nLnNyYyA9IHZhbHVlLmRhdGFVUkw7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIG5vZGUgPSBuZXcgRE9NKCBlbGVtZW50IGFzIEhUTUxFbGVtZW50ICk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCBzZXR1cC5jbGlwQXJlYSApIHtcclxuICAgICAgKCBub2RlISApLmNsaXBBcmVhID0gc2NlbmVyeURlc2VyaWFsaXplKCBzZXR1cC5jbGlwQXJlYSApO1xyXG4gICAgfVxyXG4gICAgaWYgKCBzZXR1cC5tb3VzZUFyZWEgKSB7XHJcbiAgICAgICggbm9kZSEgKS5tb3VzZUFyZWEgPSBzY2VuZXJ5RGVzZXJpYWxpemUoIHNldHVwLm1vdXNlQXJlYSApO1xyXG4gICAgfVxyXG4gICAgaWYgKCBzZXR1cC50b3VjaEFyZWEgKSB7XHJcbiAgICAgICggbm9kZSEgKS50b3VjaEFyZWEgPSBzY2VuZXJ5RGVzZXJpYWxpemUoIHNldHVwLnRvdWNoQXJlYSApO1xyXG4gICAgfVxyXG4gICAgaWYgKCBzZXR1cC5tYXRyaXggKSB7XHJcbiAgICAgICggbm9kZSEgKS5tYXRyaXggPSBzY2VuZXJ5RGVzZXJpYWxpemUoIHNldHVwLm1hdHJpeCApO1xyXG4gICAgfVxyXG4gICAgaWYgKCBzZXR1cC5sb2NhbEJvdW5kcyApIHtcclxuICAgICAgKCBub2RlISApLmxvY2FsQm91bmRzID0gc2NlbmVyeURlc2VyaWFsaXplKCBzZXR1cC5sb2NhbEJvdW5kcyApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFBhaW50YWJsZSwgaWYgdGhleSBleGlzdFxyXG4gICAgaWYgKCBzZXR1cC5maWxsICkge1xyXG4gICAgICAoIG5vZGUgYXMgUGF0aCB8IFRleHQgKS5maWxsID0gc2NlbmVyeURlc2VyaWFsaXplKCBzZXR1cC5maWxsICk7XHJcbiAgICB9XHJcbiAgICBpZiAoIHNldHVwLnN0cm9rZSApIHtcclxuICAgICAgKCBub2RlIGFzIFBhdGggfCBUZXh0ICkuc3Ryb2tlID0gc2NlbmVyeURlc2VyaWFsaXplKCBzZXR1cC5zdHJva2UgKTtcclxuICAgIH1cclxuICAgIGlmICggc2V0dXAubGluZURhc2ggKSB7XHJcbiAgICAgICggbm9kZSBhcyBQYXRoIHwgVGV4dCApLmxpbmVEYXNoID0gc2NlbmVyeURlc2VyaWFsaXplKCBzZXR1cC5saW5lRGFzaCApO1xyXG4gICAgfVxyXG5cclxuICAgICggbm9kZSEgKS5tdXRhdGUoIHZhbHVlLm9wdGlvbnMgKTtcclxuXHJcbiAgICAoIG5vZGUhICkuX3NlcmlhbGl6YXRpb24gPSB2YWx1ZTtcclxuXHJcbiAgICByZXR1cm4gbm9kZTtcclxuICB9XHJcbiAgZWxzZSBpZiAoIHZhbHVlLnR5cGUgPT09ICdTdWJ0cmVlJyApIHtcclxuICAgIGNvbnN0IG5vZGVNYXA6IFJlY29yZDxzdHJpbmcsIE5vZGU+ID0ge307XHJcbiAgICBjb25zdCBub2RlcyA9IHZhbHVlLm5vZGVzLm1hcCggc2NlbmVyeURlc2VyaWFsaXplICk7XHJcblxyXG4gICAgLy8gSW5kZXggdGhlbVxyXG4gICAgbm9kZXMuZm9yRWFjaCggKCBub2RlOiBOb2RlICkgPT4ge1xyXG4gICAgICBub2RlTWFwWyBub2RlLl9zZXJpYWxpemF0aW9uLmlkIF0gPSBub2RlO1xyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIENvbm5lY3QgY2hpbGRyZW5cclxuICAgIG5vZGVzLmZvckVhY2goICggbm9kZTogTm9kZSApID0+IHtcclxuICAgICAgbm9kZS5fc2VyaWFsaXphdGlvbi5zZXR1cC5jaGlsZHJlbi5mb3JFYWNoKCAoIGNoaWxkSWQ6IHN0cmluZyApID0+IHtcclxuICAgICAgICBub2RlLmFkZENoaWxkKCBub2RlTWFwWyBjaGlsZElkIF0gKTtcclxuICAgICAgfSApO1xyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIFRoZSByb290IHNob3VsZCBiZSB0aGUgZmlyc3Qgb25lXHJcbiAgICByZXR1cm4gbm9kZU1hcFsgdmFsdWUucm9vdE5vZGVJZCBdO1xyXG4gIH1cclxuICBlbHNlIGlmICggdmFsdWUudHlwZSA9PT0gJ3ZhbHVlJyApIHtcclxuICAgIHJldHVybiB2YWx1ZS52YWx1ZTtcclxuICB9XHJcbiAgZWxzZSB7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbn07XHJcblxyXG5zY2VuZXJ5LnJlZ2lzdGVyKCAnc2NlbmVyeURlc2VyaWFsaXplJywgc2NlbmVyeURlc2VyaWFsaXplICk7XHJcbmV4cG9ydCBkZWZhdWx0IHNjZW5lcnlEZXNlcmlhbGl6ZTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxRQUFRLE1BQU0sOEJBQThCO0FBQ25ELE9BQU9DLE9BQU8sTUFBTSw0QkFBNEI7QUFDaEQsT0FBT0MsT0FBTyxNQUFNLDRCQUE0QjtBQUNoRCxPQUFPQyxPQUFPLE1BQU0sNEJBQTRCO0FBQ2hELFNBQVNDLEtBQUssUUFBUSw2QkFBNkI7QUFFbkQsU0FBU0MsTUFBTSxFQUFFQyxLQUFLLEVBQUVDLEdBQUcsRUFBWUMsS0FBSyxFQUFFQyxJQUFJLEVBQUVDLGNBQWMsRUFBVUMsSUFBSSxFQUFTQyxJQUFJLEVBQUVDLE9BQU8sRUFBRUMsY0FBYyxFQUFFQyxTQUFTLEVBQUVDLE9BQU8sRUFBRUMsSUFBSSxRQUFRLGVBQWU7QUFDdkssT0FBT0MsWUFBWSxNQUFNLGtDQUFrQztBQUUzRCxNQUFNQyxrQkFBa0IsR0FBS0MsS0FBd0QsSUFBc0I7RUFDekcsTUFBTUMsU0FBUyxHQUFHLENBQ2hCLE1BQU0sRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRSxXQUFXLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBRSxZQUFZLEVBQUUsV0FBVyxFQUFF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