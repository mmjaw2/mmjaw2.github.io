// Copyright 2019-2024, University of Colorado Boulder

/**
 * Represents an image with a specific center "offset". Considered immutable (with an immutable image, the Canvas if
 * provided should not change).
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

import Matrix3 from '../../../dot/js/Matrix3.js';
import Vector2 from '../../../dot/js/Vector2.js';
import { Shape } from '../../../kite/js/imports.js';
import { Imageable, scenery } from '../imports.js';
import mutate from '../../../phet-core/js/mutate.js';
import optionize from '../../../phet-core/js/optionize.js';
import { isTReadOnlyProperty } from '../../../axon/js/TReadOnlyProperty.js';
let globalIdCounter = 1;
const scratchVector = new Vector2(0, 0);
export default class SpriteImage extends Imageable(Object) {
  // lazily-constructed

  /**
   * @param image
   * @param offset - A 2d offset from the upper-left of the image which is considered the "center".
   * @param [providedOptions]
   */
  constructor(image, offset, providedOptions) {
    assert && assert(image instanceof HTMLImageElement || image instanceof HTMLCanvasElement);
    const initImageableOptions = {
      hitTestPixels: false,
      pickable: true
    };
    if (isTReadOnlyProperty(image)) {
      initImageableOptions.imageProperty = image;
    } else {
      initImageableOptions.image = image;
    }
    const options = optionize()(initImageableOptions, providedOptions);
    super();
    this.id = globalIdCounter++;
    this.offset = offset;
    this.pickable = options.pickable;
    this.shape = null;
    this.imageData = null;

    // Initialize Imageable items (including the image itself)
    if (isTReadOnlyProperty(image)) {
      this.imageProperty = image;
    } else {
      this.image = image;
    }
    mutate(this, Object.keys(Imageable.DEFAULT_OPTIONS), options);
  }
  get width() {
    return this.imageWidth;
  }
  get height() {
    return this.imageHeight;
  }

  /**
   * Returns a Shape that represents the hit-testable area of this SpriteImage.
   */
  getShape() {
    if (!this.pickable) {
      return new Shape();
    }
    if (!this.shape) {
      if (this.hitTestPixels) {
        this.ensureImageData();
        if (this.imageData) {
          this.shape = Imageable.hitTestDataToShape(this.imageData, this.width, this.height);
        } else {
          // Empty, if we haven't been able to load image data (even if we have a width/height)
          return new Shape();
        }
      } else if (this.width && this.height) {
        this.shape = Shape.rect(0, 0, this.width, this.height);
      } else {
        // If we have no width/height
        return new Shape();
      }

      // Apply our offset
      this.shape = this.shape.transformed(Matrix3.translation(-this.offset.x, -this.offset.y));
    }
    return this.shape;
  }

  /**
   * Ensures we have a computed imageData (computes it lazily if necessary).
   */
  ensureImageData() {
    if (!this.imageData && this.width && this.height) {
      this.imageData = Imageable.getHitTestData(this.image, this.width, this.height);
    }
  }

  /**
   * Returns whether a given point is considered "inside" the SpriteImage.
   */
  containsPoint(point) {
    if (!this.pickable) {
      return false;
    }
    const width = this.width;
    const height = this.height;

    // If our image isn't really loaded yet, bail out
    if (!width && !height) {
      return false;
    }
    const position = scratchVector.set(point).add(this.offset);

    // Initial position check (are we within the rectangle)
    if (position.x < 0 || position.y < 0 || position.x > width || position.y > height) {
      return false;
    }
    if (!this.hitTestPixels) {
      return true;
    } else {
      // Lazy-load image data
      this.ensureImageData();

      // And test if it's available
      if (this.imageData) {
        return Imageable.testHitTestData(this.imageData, width, height, position);
      } else {
        return false;
      }
    }
  }
}
scenery.register('SpriteImage', SpriteImage);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJNYXRyaXgzIiwiVmVjdG9yMiIsIlNoYXBlIiwiSW1hZ2VhYmxlIiwic2NlbmVyeSIsIm11dGF0ZSIsIm9wdGlvbml6ZSIsImlzVFJlYWRPbmx5UHJvcGVydHkiLCJnbG9iYWxJZENvdW50ZXIiLCJzY3JhdGNoVmVjdG9yIiwiU3ByaXRlSW1hZ2UiLCJPYmplY3QiLCJjb25zdHJ1Y3RvciIsImltYWdlIiwib2Zmc2V0IiwicHJvdmlkZWRPcHRpb25zIiwiYXNzZXJ0IiwiSFRNTEltYWdlRWxlbWVudCIsIkhUTUxDYW52YXNFbGVtZW50IiwiaW5pdEltYWdlYWJsZU9wdGlvbnMiLCJoaXRUZXN0UGl4ZWxzIiwicGlja2FibGUiLCJpbWFnZVByb3BlcnR5Iiwib3B0aW9ucyIsImlkIiwic2hhcGUiLCJpbWFnZURhdGEiLCJrZXlzIiwiREVGQVVMVF9PUFRJT05TIiwid2lkdGgiLCJpbWFnZVdpZHRoIiwiaGVpZ2h0IiwiaW1hZ2VIZWlnaHQiLCJnZXRTaGFwZSIsImVuc3VyZUltYWdlRGF0YSIsImhpdFRlc3REYXRhVG9TaGFwZSIsInJlY3QiLCJ0cmFuc2Zvcm1lZCIsInRyYW5zbGF0aW9uIiwieCIsInkiLCJnZXRIaXRUZXN0RGF0YSIsImNvbnRhaW5zUG9pbnQiLCJwb2ludCIsInBvc2l0aW9uIiwic2V0IiwiYWRkIiwidGVzdEhpdFRlc3REYXRhIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJTcHJpdGVJbWFnZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxOS0yMDI0LCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBSZXByZXNlbnRzIGFuIGltYWdlIHdpdGggYSBzcGVjaWZpYyBjZW50ZXIgXCJvZmZzZXRcIi4gQ29uc2lkZXJlZCBpbW11dGFibGUgKHdpdGggYW4gaW1tdXRhYmxlIGltYWdlLCB0aGUgQ2FudmFzIGlmXHJcbiAqIHByb3ZpZGVkIHNob3VsZCBub3QgY2hhbmdlKS5cclxuICpcclxuICogQGF1dGhvciBKb25hdGhhbiBPbHNvbiA8am9uYXRoYW4ub2xzb25AY29sb3JhZG8uZWR1PlxyXG4gKi9cclxuXHJcbmltcG9ydCBNYXRyaXgzIGZyb20gJy4uLy4uLy4uL2RvdC9qcy9NYXRyaXgzLmpzJztcclxuaW1wb3J0IFZlY3RvcjIgZnJvbSAnLi4vLi4vLi4vZG90L2pzL1ZlY3RvcjIuanMnO1xyXG5pbXBvcnQgeyBTaGFwZSB9IGZyb20gJy4uLy4uLy4uL2tpdGUvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCB7IEltYWdlYWJsZSwgSW1hZ2VhYmxlSW1hZ2UsIEltYWdlYWJsZU9wdGlvbnMsIHNjZW5lcnkgfSBmcm9tICcuLi9pbXBvcnRzLmpzJztcclxuaW1wb3J0IG11dGF0ZSBmcm9tICcuLi8uLi8uLi9waGV0LWNvcmUvanMvbXV0YXRlLmpzJztcclxuaW1wb3J0IG9wdGlvbml6ZSBmcm9tICcuLi8uLi8uLi9waGV0LWNvcmUvanMvb3B0aW9uaXplLmpzJztcclxuaW1wb3J0IFRSZWFkT25seVByb3BlcnR5LCB7IGlzVFJlYWRPbmx5UHJvcGVydHkgfSBmcm9tICcuLi8uLi8uLi9heG9uL2pzL1RSZWFkT25seVByb3BlcnR5LmpzJztcclxuaW1wb3J0IFBpY2tSZXF1aXJlZCBmcm9tICcuLi8uLi8uLi9waGV0LWNvcmUvanMvdHlwZXMvUGlja1JlcXVpcmVkLmpzJztcclxuXHJcbmxldCBnbG9iYWxJZENvdW50ZXIgPSAxO1xyXG5jb25zdCBzY3JhdGNoVmVjdG9yID0gbmV3IFZlY3RvcjIoIDAsIDAgKTtcclxuXHJcbnR5cGUgU2VsZk9wdGlvbnMgPSB7XHJcbiAgaGl0VGVzdFBpeGVscz86IGJvb2xlYW47XHJcbiAgcGlja2FibGU/OiBib29sZWFuO1xyXG59O1xyXG5cclxuZXhwb3J0IHR5cGUgU3ByaXRlSW1hZ2VPcHRpb25zID0gU2VsZk9wdGlvbnMgJiBJbWFnZWFibGVPcHRpb25zO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU3ByaXRlSW1hZ2UgZXh0ZW5kcyBJbWFnZWFibGUoIE9iamVjdCApIHtcclxuXHJcbiAgcHVibGljIHJlYWRvbmx5IGlkOiBudW1iZXI7XHJcbiAgcHVibGljIHJlYWRvbmx5IG9mZnNldDogVmVjdG9yMjtcclxuICBwdWJsaWMgcmVhZG9ubHkgcGlja2FibGU6IGJvb2xlYW47XHJcbiAgcHJpdmF0ZSBzaGFwZTogU2hhcGUgfCBudWxsOyAvLyBsYXppbHktY29uc3RydWN0ZWRcclxuICBwcml2YXRlIGltYWdlRGF0YTogSW1hZ2VEYXRhIHwgbnVsbDtcclxuXHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIGltYWdlXHJcbiAgICogQHBhcmFtIG9mZnNldCAtIEEgMmQgb2Zmc2V0IGZyb20gdGhlIHVwcGVyLWxlZnQgb2YgdGhlIGltYWdlIHdoaWNoIGlzIGNvbnNpZGVyZWQgdGhlIFwiY2VudGVyXCIuXHJcbiAgICogQHBhcmFtIFtwcm92aWRlZE9wdGlvbnNdXHJcbiAgICovXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBpbWFnZTogSW1hZ2VhYmxlSW1hZ2UgfCBUUmVhZE9ubHlQcm9wZXJ0eTxJbWFnZWFibGVJbWFnZT4sIG9mZnNldDogVmVjdG9yMiwgcHJvdmlkZWRPcHRpb25zPzogU3ByaXRlSW1hZ2VPcHRpb25zICkge1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggaW1hZ2UgaW5zdGFuY2VvZiBIVE1MSW1hZ2VFbGVtZW50IHx8IGltYWdlIGluc3RhbmNlb2YgSFRNTENhbnZhc0VsZW1lbnQgKTtcclxuXHJcbiAgICBjb25zdCBpbml0SW1hZ2VhYmxlT3B0aW9ucyA9IHtcclxuICAgICAgaGl0VGVzdFBpeGVsczogZmFsc2UsXHJcbiAgICAgIHBpY2thYmxlOiB0cnVlXHJcbiAgICB9IGFzIFBpY2tSZXF1aXJlZDxTcHJpdGVJbWFnZU9wdGlvbnMsICdpbWFnZScgfCAnaW1hZ2VQcm9wZXJ0eScgfCAnaGl0VGVzdFBpeGVscycgfCAncGlja2FibGUnPjtcclxuICAgIGlmICggaXNUUmVhZE9ubHlQcm9wZXJ0eSggaW1hZ2UgKSApIHtcclxuICAgICAgaW5pdEltYWdlYWJsZU9wdGlvbnMuaW1hZ2VQcm9wZXJ0eSA9IGltYWdlO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIGluaXRJbWFnZWFibGVPcHRpb25zLmltYWdlID0gaW1hZ2U7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgb3B0aW9ucyA9IG9wdGlvbml6ZTxTcHJpdGVJbWFnZU9wdGlvbnMsIFNlbGZPcHRpb25zLCBJbWFnZWFibGVPcHRpb25zPigpKCBpbml0SW1hZ2VhYmxlT3B0aW9ucywgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgc3VwZXIoKTtcclxuXHJcbiAgICB0aGlzLmlkID0gZ2xvYmFsSWRDb3VudGVyKys7XHJcbiAgICB0aGlzLm9mZnNldCA9IG9mZnNldDtcclxuICAgIHRoaXMucGlja2FibGUgPSBvcHRpb25zLnBpY2thYmxlO1xyXG4gICAgdGhpcy5zaGFwZSA9IG51bGw7XHJcbiAgICB0aGlzLmltYWdlRGF0YSA9IG51bGw7XHJcblxyXG4gICAgLy8gSW5pdGlhbGl6ZSBJbWFnZWFibGUgaXRlbXMgKGluY2x1ZGluZyB0aGUgaW1hZ2UgaXRzZWxmKVxyXG4gICAgaWYgKCBpc1RSZWFkT25seVByb3BlcnR5KCBpbWFnZSApICkge1xyXG4gICAgICB0aGlzLmltYWdlUHJvcGVydHkgPSBpbWFnZTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICB0aGlzLmltYWdlID0gaW1hZ2U7XHJcbiAgICB9XHJcblxyXG4gICAgbXV0YXRlKCB0aGlzLCBPYmplY3Qua2V5cyggSW1hZ2VhYmxlLkRFRkFVTFRfT1BUSU9OUyApLCBvcHRpb25zICk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0IHdpZHRoKCk6IG51bWJlciB7XHJcbiAgICByZXR1cm4gdGhpcy5pbWFnZVdpZHRoO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldCBoZWlnaHQoKTogbnVtYmVyIHtcclxuICAgIHJldHVybiB0aGlzLmltYWdlSGVpZ2h0O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJucyBhIFNoYXBlIHRoYXQgcmVwcmVzZW50cyB0aGUgaGl0LXRlc3RhYmxlIGFyZWEgb2YgdGhpcyBTcHJpdGVJbWFnZS5cclxuICAgKi9cclxuICBwdWJsaWMgZ2V0U2hhcGUoKTogU2hhcGUge1xyXG4gICAgaWYgKCAhdGhpcy5waWNrYWJsZSApIHtcclxuICAgICAgcmV0dXJuIG5ldyBTaGFwZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICggIXRoaXMuc2hhcGUgKSB7XHJcbiAgICAgIGlmICggdGhpcy5oaXRUZXN0UGl4ZWxzICkge1xyXG4gICAgICAgIHRoaXMuZW5zdXJlSW1hZ2VEYXRhKCk7XHJcbiAgICAgICAgaWYgKCB0aGlzLmltYWdlRGF0YSApIHtcclxuICAgICAgICAgIHRoaXMuc2hhcGUgPSBJbWFnZWFibGUuaGl0VGVzdERhdGFUb1NoYXBlKCB0aGlzLmltYWdlRGF0YSwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAvLyBFbXB0eSwgaWYgd2UgaGF2ZW4ndCBiZWVuIGFibGUgdG8gbG9hZCBpbWFnZSBkYXRhIChldmVuIGlmIHdlIGhhdmUgYSB3aWR0aC9oZWlnaHQpXHJcbiAgICAgICAgICByZXR1cm4gbmV3IFNoYXBlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgaWYgKCB0aGlzLndpZHRoICYmIHRoaXMuaGVpZ2h0ICkge1xyXG4gICAgICAgIHRoaXMuc2hhcGUgPSBTaGFwZS5yZWN0KCAwLCAwLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCApO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIC8vIElmIHdlIGhhdmUgbm8gd2lkdGgvaGVpZ2h0XHJcbiAgICAgICAgcmV0dXJuIG5ldyBTaGFwZSgpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBBcHBseSBvdXIgb2Zmc2V0XHJcbiAgICAgIHRoaXMuc2hhcGUgPSB0aGlzLnNoYXBlLnRyYW5zZm9ybWVkKCBNYXRyaXgzLnRyYW5zbGF0aW9uKCAtdGhpcy5vZmZzZXQueCwgLXRoaXMub2Zmc2V0LnkgKSApO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB0aGlzLnNoYXBlO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRW5zdXJlcyB3ZSBoYXZlIGEgY29tcHV0ZWQgaW1hZ2VEYXRhIChjb21wdXRlcyBpdCBsYXppbHkgaWYgbmVjZXNzYXJ5KS5cclxuICAgKi9cclxuICBwcml2YXRlIGVuc3VyZUltYWdlRGF0YSgpOiB2b2lkIHtcclxuICAgIGlmICggIXRoaXMuaW1hZ2VEYXRhICYmIHRoaXMud2lkdGggJiYgdGhpcy5oZWlnaHQgKSB7XHJcbiAgICAgIHRoaXMuaW1hZ2VEYXRhID0gSW1hZ2VhYmxlLmdldEhpdFRlc3REYXRhKCB0aGlzLmltYWdlLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJucyB3aGV0aGVyIGEgZ2l2ZW4gcG9pbnQgaXMgY29uc2lkZXJlZCBcImluc2lkZVwiIHRoZSBTcHJpdGVJbWFnZS5cclxuICAgKi9cclxuICBwdWJsaWMgY29udGFpbnNQb2ludCggcG9pbnQ6IFZlY3RvcjIgKTogYm9vbGVhbiB7XHJcblxyXG4gICAgaWYgKCAhdGhpcy5waWNrYWJsZSApIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHdpZHRoID0gdGhpcy53aWR0aDtcclxuICAgIGNvbnN0IGhlaWdodCA9IHRoaXMuaGVpZ2h0O1xyXG5cclxuICAgIC8vIElmIG91ciBpbWFnZSBpc24ndCByZWFsbHkgbG9hZGVkIHlldCwgYmFpbCBvdXRcclxuICAgIGlmICggIXdpZHRoICYmICFoZWlnaHQgKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBwb3NpdGlvbiA9IHNjcmF0Y2hWZWN0b3Iuc2V0KCBwb2ludCApLmFkZCggdGhpcy5vZmZzZXQgKTtcclxuXHJcbiAgICAvLyBJbml0aWFsIHBvc2l0aW9uIGNoZWNrIChhcmUgd2Ugd2l0aGluIHRoZSByZWN0YW5nbGUpXHJcbiAgICBpZiAoIHBvc2l0aW9uLnggPCAwIHx8IHBvc2l0aW9uLnkgPCAwIHx8IHBvc2l0aW9uLnggPiB3aWR0aCB8fCBwb3NpdGlvbi55ID4gaGVpZ2h0ICkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCAhdGhpcy5oaXRUZXN0UGl4ZWxzICkge1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAvLyBMYXp5LWxvYWQgaW1hZ2UgZGF0YVxyXG4gICAgICB0aGlzLmVuc3VyZUltYWdlRGF0YSgpO1xyXG5cclxuICAgICAgLy8gQW5kIHRlc3QgaWYgaXQncyBhdmFpbGFibGVcclxuICAgICAgaWYgKCB0aGlzLmltYWdlRGF0YSApIHtcclxuICAgICAgICByZXR1cm4gSW1hZ2VhYmxlLnRlc3RIaXRUZXN0RGF0YSggdGhpcy5pbWFnZURhdGEsIHdpZHRoLCBoZWlnaHQsIHBvc2l0aW9uICk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5zY2VuZXJ5LnJlZ2lzdGVyKCAnU3ByaXRlSW1hZ2UnLCBTcHJpdGVJbWFnZSApOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLE9BQU8sTUFBTSw0QkFBNEI7QUFDaEQsT0FBT0MsT0FBTyxNQUFNLDRCQUE0QjtBQUNoRCxTQUFTQyxLQUFLLFFBQVEsNkJBQTZCO0FBQ25ELFNBQVNDLFNBQVMsRUFBb0NDLE9BQU8sUUFBUSxlQUFlO0FBQ3BGLE9BQU9DLE1BQU0sTUFB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