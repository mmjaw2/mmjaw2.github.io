// Copyright 2014-2024, University of Colorado Boulder

/**
 * RectangularRadioButtonGroup is a group of rectangular radio buttons, in either horizontal or vertical orientation.
 * See sun.ButtonsScreenView for example usage.
 *
 * @author Aaron Davis (PhET Interactive Simulations)
 * @author Chris Malley (PixelZoom, Inc.)
 */

import InstanceRegistry from '../../../phet-core/js/documentation/InstanceRegistry.js';
import { Color, FlowBox, HighlightFromNode, PDOMPeer, SceneryConstants } from '../../../scenery/js/imports.js';
import multiSelectionSoundPlayerFactory from '../../../tambo/js/multiSelectionSoundPlayerFactory.js';
import Tandem from '../../../tandem/js/Tandem.js';
import ColorConstants from '../ColorConstants.js';
import sun from '../sun.js';
import RectangularRadioButton from './RectangularRadioButton.js';
import optionize, { combineOptions } from '../../../phet-core/js/optionize.js';
import { getGroupItemNodes } from '../GroupItemOptions.js';
// pdom - Unique ID for each instance of RectangularRadioButtonGroup. Used to create the 'name' option that is passed
// to each RectangularRadioButton in the group. All buttons in the group must have the same 'name', and that name
// must be unique to the group. Otherwise, the browser will treat all inputs of type 'radio' in the document as being
// in a single group.
let instanceCount = 0;

// Prefix for instanceCount, because PhET sims have different types of "groups"
const CLASS_NAME = 'RectangularRadioButtonGroup';

// Describes one radio button

/**
 * Identifies a radio button and its layout manager. Pointer areas and focus highlight need to be set on
 * the button, but need to surround the layout manager containing both the button and its optional label.
 * This was formerly a class, converted to a type when PhET moved to TypeScript.
 * See https://github.com/phetsims/sun/issues/708
 */

// Where the optional label appears, relative to the radio button

export default class RectangularRadioButtonGroup extends FlowBox {
  constructor(property, items, providedOptions) {
    assert && assert(_.uniqBy(items, item => item.value).length === items.length, 'items must have unique values');
    assert && assert(_.find(items, item => item.value === property.value), 'one radio button must be associated with property.value');
    const options = optionize()({
      // SelfOptions
      soundPlayers: null,
      labelAlign: 'bottom',
      labelSpacing: 0,
      touchAreaXDilation: 0,
      touchAreaYDilation: 0,
      mouseAreaXDilation: 0,
      mouseAreaYDilation: 0,
      radioButtonOptions: {
        baseColor: ColorConstants.LIGHT_BLUE,
        cornerRadius: 4,
        xMargin: 5,
        yMargin: 5,
        xAlign: 'center',
        yAlign: 'center',
        buttonAppearanceStrategyOptions: {
          selectedStroke: 'black',
          selectedLineWidth: 1.5,
          selectedButtonOpacity: 1,
          deselectedStroke: new Color(50, 50, 50),
          deselectedLineWidth: 1,
          deselectedButtonOpacity: 0.6,
          overButtonOpacity: 0.8
        },
        contentAppearanceStrategy: RectangularRadioButton.ContentAppearanceStrategy,
        contentAppearanceStrategyOptions: {
          overContentOpacity: 0.8,
          selectedContentOpacity: 1,
          deselectedContentOpacity: 0.6
        }
      },
      // FlowBoxOptions
      spacing: 10,
      stretch: true,
      // have the buttons match size, see https://github.com/phetsims/sun/issues/851
      orientation: 'vertical',
      disabledOpacity: SceneryConstants.DISABLED_OPACITY,
      // phet-io
      tandem: Tandem.REQUIRED,
      tandemNameSuffix: 'ButtonGroup',
      visiblePropertyOptions: {
        phetioFeatured: true
      },
      phetioEnabledPropertyInstrumented: true,
      // opt into default PhET-iO instrumented enabledProperty
      phetioFeatured: true,
      // pdom
      tagName: 'ul',
      labelTagName: 'h3',
      ariaRole: 'radiogroup',
      groupFocusHighlight: true
    }, providedOptions);
    assert && assert(options.soundPlayers === null || options.soundPlayers.length === items.length, 'If soundPlayers is provided, there must be one per radio button.');
    instanceCount++;
    const radioButtonMap = new Map();
    const nodes = getGroupItemNodes(items, options.tandem);
    assert && assert(_.every(nodes, node => !node.hasPDOMContent), 'Accessibility is provided by RectangularRadioButton and RectangularRadioButtonGroupItem.labelContent. ' + 'Additional PDOM content in the provided Node could break accessibility.');

    // Calculate the maximum width and height of the content, so we can make all radio buttons the same size.
    const widestContentWidth = _.maxBy(nodes, node => node.width).width;
    const tallestContentHeight = _.maxBy(nodes, node => node.height).height;

    // Populated for each radio button in for loop
    const buttons = [];
    const buttonsWithLayoutNodes = [];
    const labelAppearanceStrategies = [];
    const xMargin = options.radioButtonOptions.xMargin;
    const yMargin = options.radioButtonOptions.yMargin;
    for (let i = 0; i < items.length; i++) {
      const item = items[i];
      const node = nodes[i];
      const radioButtonOptions = combineOptions({
        content: node,
        minWidth: widestContentWidth + 2 * xMargin,
        minHeight: tallestContentHeight + 2 * yMargin,
        soundPlayer: options.soundPlayers ? options.soundPlayers[i] : multiSelectionSoundPlayerFactory.getSelectionSoundPlayer(i),
        tandem: item.tandemName ? options.tandem.createTandem(item.tandemName) : options.tandem === Tandem.OPT_OUT ? Tandem.OPT_OUT : Tandem.REQUIRED,
        phetioDocumentation: item.phetioDocumentation || '',
        // NOTE: This does NOT support dynamic orientation changes. If you need that, change RectangularButton to support
        // dynamic options
        touchAreaXDilation: options.orientation === 'horizontal' ? options.spacing / 2 : options.touchAreaXDilation,
        touchAreaYDilation: options.orientation === 'vertical' ? options.spacing / 2 : options.touchAreaYDilation,
        mouseAreaXDilation: options.orientation === 'horizontal' ? options.spacing / 2 : options.mouseAreaXDilation,
        mouseAreaYDilation: options.orientation === 'vertical' ? options.spacing / 2 : options.mouseAreaYDilation
      }, options.radioButtonOptions, item.options);

      // Create the label and voicing response for the radio button.
      if (item.labelContent) {
        radioButtonOptions.labelContent = item.labelContent;
        radioButtonOptions.voicingNameResponse = item.labelContent;
      }

      // pdom create description for radio button
      // use if block to prevent empty 'p' tag being added when no option is present
      if (item.descriptionContent) {
        radioButtonOptions.descriptionContent = item.descriptionContent;
      }
      if (item.voicingContextResponse) {
        radioButtonOptions.voicingContextResponse = item.voicingContextResponse;
      }
      const radioButton = new RectangularRadioButton(property, item.value, radioButtonOptions);
      radioButtonMap.set(item.value, radioButton);

      // pdom - so the browser recognizes these buttons are in the same group. See instanceCount for more info.
      radioButton.setPDOMAttribute('name', CLASS_NAME + instanceCount);
      let button;
      if (item.label) {
        // If a label is provided, the button becomes a FlowBox that manages layout of the button and label.
        const label = item.label;
        const labelOrientation = options.labelAlign === 'bottom' || options.labelAlign === 'top' ? 'vertical' : 'horizontal';
        const labelChildren = options.labelAlign === 'left' || options.labelAlign === 'top' ? [label, radioButton] : [radioButton, label];
        button = new FlowBox({
          children: labelChildren,
          spacing: options.labelSpacing,
          orientation: labelOrientation
        });

        // Make sure the label pointer areas don't block the expanded button pointer areas.
        label.pickable = false;

        // Use the same content appearance strategy for the labels that is used for the button content.
        // By default, this reduces opacity of the labels for the deselected radio buttons.
        if (options.radioButtonOptions.contentAppearanceStrategy) {
          labelAppearanceStrategies.push(new options.radioButtonOptions.contentAppearanceStrategy(label, radioButton.interactionStateProperty, options.radioButtonOptions.contentAppearanceStrategyOptions));
        }
      } else {
        // The button has no label.
        button = radioButton;
      }
      buttons.push(button);

      // The highlight for the radio button should surround the layout Node if one is used.
      const focusHighlight = new HighlightFromNode(button);
      buttonsWithLayoutNodes.push({
        radioButton: radioButton,
        layoutNode: button,
        focusHighlight: focusHighlight
      });
      radioButton.focusHighlight = focusHighlight;
    }
    options.children = buttons;
    super(options);
    this.radioButtonMap = radioButtonMap;

    // pdom - This node's primary sibling is aria-labelledby its own label, so the label content is read whenever
    // a member of the group receives focus.
    this.addAriaLabelledbyAssociation({
      thisElementName: PDOMPeer.PRIMARY_SIBLING,
      otherNode: this,
      otherElementName: PDOMPeer.LABEL_SIBLING
    });

    // pan and zoom - Signify that key input is reserved, and we should not pan when user presses arrow keys.
    const intentListener = {
      keydown: event => event.pointer.reserveForKeyboardDrag()
    };
    this.addInputListener(intentListener);

    // must be done after this instance is instrumented
    this.addLinkedElement(property, {
      tandemName: 'property'
    });
    this.disposeRadioButtonGroup = () => {
      this.removeInputListener(intentListener);
      buttonsWithLayoutNodes.forEach(buttonWithLayoutNode => {
        buttonWithLayoutNode.focusHighlight.dispose();
        buttonWithLayoutNode.radioButton.dispose();

        // A layout Node was created for this button so it should be disposed.
        if (buttonWithLayoutNode.radioButton !== buttonWithLayoutNode.layoutNode) {
          buttonWithLayoutNode.layoutNode.dispose();
        }
      });
      labelAppearanceStrategies.forEach(strategy => strategy.dispose && strategy.dispose());
      nodes.forEach(node => node.dispose());
    };

    // pdom - register component for binder docs
    assert && phet?.chipper?.queryParameters?.binder && InstanceRegistry.registerDataURL('sun', 'RectangularRadioButtonGroup', this);
  }

  /**
   * Find the RectangularRadioButton corresponding to a value. Note that in the scene graph, the button may be nested
   * under other layers, so use caution for coordinate transformations.
   * @param value
   * @returns the corresponding button
   */
  getButtonForValue(value) {
    const result = this.radioButtonMap.get(value);
    assert && assert(result, 'No button found for value: ' + value);
    return result;
  }
  dispose() {
    this.radioButtonMap.clear();
    this.disposeRadioButtonGroup();
    super.dispose();
  }
}
sun.register('RectangularRadioButtonGroup', RectangularRadioButtonGroup);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJJbnN0YW5jZVJlZ2lzdHJ5IiwiQ29sb3IiLCJGbG93Qm94IiwiSGlnaGxpZ2h0RnJvbU5vZGUiLCJQRE9NUGVlciIsIlNjZW5lcnlDb25zdGFudHMiLCJtdWx0aVNlbGVjdGlvblNvdW5kUGxheWVyRmFjdG9yeSIsIlRhbmRlbSIsIkNvbG9yQ29uc3RhbnRzIiwic3VuIiwiUmVjdGFuZ3VsYXJSYWRpb0J1dHRvbiIsIm9wdGlvbml6ZSIsImNvbWJpbmVPcHRpb25zIiwiZ2V0R3JvdXBJdGVtTm9kZXMiLCJpbnN0YW5jZUNvdW50IiwiQ0xBU1NfTkFNRSIsIlJlY3Rhbmd1bGFyUmFkaW9CdXR0b25Hcm91cCIsImNvbnN0cnVjdG9yIiwicHJvcGVydHkiLCJpdGVtcyIsInByb3ZpZGVkT3B0aW9ucyIsImFzc2VydCIsIl8iLCJ1bmlxQnkiLCJpdGVtIiwidmFsdWUiLCJsZW5ndGgiLCJmaW5kIiwib3B0aW9ucyIsInNvdW5kUGxheWVycyIsImxhYmVsQWxpZ24iLCJsYWJlbFNwYWNpbmciLCJ0b3VjaEFyZWFYRGlsYXRpb24iLCJ0b3VjaEFyZWFZRGlsYXRpb24iLCJtb3VzZUFyZWFYRGlsYXRpb24iLCJtb3VzZUFyZWFZRGlsYXRpb24iLCJyYWRpb0J1dHRvbk9wdGlvbnMiLCJiYXNlQ29sb3IiLCJMSUdIVF9CTFVFIiwiY29ybmVyUmFkaXVzIiwieE1hcmdpbiIsInlNYXJnaW4iLCJ4QWxpZ24iLCJ5QWxpZ24iLCJidXR0b25BcHBlYXJhbmNlU3RyYXRlZ3lPcHRpb25zIiwic2VsZWN0ZWRTdHJva2UiLCJzZWxlY3RlZExpbmVXaWR0aCIsInNlbGVjdGVkQnV0dG9uT3BhY2l0eSIsImRlc2VsZWN0ZWRTdHJva2UiLCJkZXNlbGVjdGVkTGluZVdpZHRoIiwiZGVzZWxlY3RlZEJ1dHRvbk9wYWNpdHkiLCJvdmVyQnV0dG9uT3BhY2l0eSIsImNvbnRlbnRBcHBlYXJhbmNlU3RyYXRlZ3kiLCJDb250ZW50QXBwZWFyYW5jZVN0cmF0ZWd5IiwiY29udGVudEFwcGVhcmFuY2VTdHJhdGVneU9wdGlvbnMiLCJvdmVyQ29udGVudE9wYWNpdHkiLCJzZWxlY3RlZENvbnRlbnRPcGFjaXR5IiwiZGVzZWxlY3RlZENvbnRlbnRPcGFjaXR5Iiwic3BhY2luZyIsInN0cmV0Y2giLCJvcmllbnRhdGlvbiIsImRpc2FibGVkT3BhY2l0eSIsIkRJU0FCTEVEX09QQUNJVFkiLCJ0YW5kZW0iLCJSRVFVSVJFRCIsInRhbmRlbU5hbWVTdWZmaXgiLCJ2aXNpYmxlUHJvcGVydHlPcHRpb25zIiwicGhldGlvRmVhdHVyZWQiLCJwaGV0aW9FbmFibGVkUHJvcGVydHlJbnN0cnVtZW50ZWQiLCJ0YWdOYW1lIiwibGFiZWxUYWdOYW1lIiwiYXJpYVJvbGUiLCJncm91cEZvY3VzSGlnaGxpZ2h0IiwicmFkaW9CdXR0b25NYXAiLCJNYXAiLCJub2RlcyIsImV2ZXJ5Iiwibm9kZSIsImhhc1BET01Db250ZW50Iiwid2lkZXN0Q29udGVudFdpZHRoIiwibWF4QnkiLCJ3aWR0aCIsInRhbGxlc3RDb250ZW50SGVpZ2h0IiwiaGVpZ2h0IiwiYnV0dG9ucyIsImJ1dHRvbnNXaXRoTGF5b3V0Tm9kZXMiLCJsYWJlbEFwcGVhcmFuY2VTdHJhdGVnaWVzIiwiaSIsImNvbnRlbnQiLCJtaW5XaWR0aCIsIm1pbkhlaWdodCIsInNvdW5kUGxheWVyIiwiZ2V0U2VsZWN0aW9uU291bmRQbGF5ZXIiLCJ0YW5kZW1OYW1lIiwiY3JlYXRlVGFuZGVtIiwiT1BUX09VVCIsInBoZXRpb0RvY3VtZW50YXRpb24iLCJsYWJlbENvbnRlbnQiLCJ2b2ljaW5nTmFtZVJlc3BvbnNlIiwiZGVzY3JpcHRpb25Db250ZW50Iiwidm9pY2luZ0NvbnRleHRSZXNwb25zZSIsInJhZGlvQnV0dG9uIiwic2V0Iiwic2V0UERPTUF0dHJpYnV0ZSIsImJ1dHRvbiIsImxhYmVsIiwibGFiZWxPcmllbnRhdGlvbiIsImxhYmVsQ2hpbGRyZW4iLCJjaGlsZHJlbiIsInBpY2thYmxlIiwicHVzaCIsImludGVyYWN0aW9uU3RhdGVQcm9wZXJ0eSIsImZvY3VzSGlnaGxpZ2h0IiwibGF5b3V0Tm9kZSIsImFkZEFyaWFMYWJlbGxlZGJ5QXNzb2NpYXRpb24iLCJ0aGlzRWxlbWVudE5hbWUiLCJQUklNQVJZX1NJQkxJTkciLCJvdGhlck5vZGUiLCJvdGhlckVsZW1lbnROYW1lIiwiTEFCRUxfU0lCTElORyIsImludGVudExpc3RlbmVyIiwia2V5ZG93biIsImV2ZW50IiwicG9pbnRlciIsInJlc2VydmVGb3JLZXlib2FyZERyYWciLCJhZGRJbnB1dExpc3RlbmVyIiwiYWRkTGlua2VkRWxlbWVudCIsImRpc3Bvc2VSYWRpb0J1dHRvbkdyb3VwIiwicmVtb3ZlSW5wdXRMaXN0ZW5lciIsImZvckVhY2giLCJidXR0b25XaXRoTGF5b3V0Tm9kZSIsImRpc3Bvc2UiLCJzdHJhdGVneSIsInBoZXQiLCJjaGlwcGVyIiwicXVlcnlQYXJhbWV0ZXJzIiwiYmluZGVyIiwicmVnaXN0ZXJEYXRhVVJMIiwiZ2V0QnV0dG9uRm9yVmFsdWUiLCJyZXN1bHQiLCJnZXQiLCJjbGVhciIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiUmVjdGFuZ3VsYXJSYWRpb0J1dHRvbkdyb3VwLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE0LTIwMjQsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIFJlY3Rhbmd1bGFyUmFkaW9CdXR0b25Hcm91cCBpcyBhIGdyb3VwIG9mIHJlY3Rhbmd1bGFyIHJhZGlvIGJ1dHRvbnMsIGluIGVpdGhlciBob3Jpem9udGFsIG9yIHZlcnRpY2FsIG9yaWVudGF0aW9uLlxyXG4gKiBTZWUgc3VuLkJ1dHRvbnNTY3JlZW5WaWV3IGZvciBleGFtcGxlIHVzYWdlLlxyXG4gKlxyXG4gKiBAYXV0aG9yIEFhcm9uIERhdmlzIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKiBAYXV0aG9yIENocmlzIE1hbGxleSAoUGl4ZWxab29tLCBJbmMuKVxyXG4gKi9cclxuXHJcbmltcG9ydCBJbnN0YW5jZVJlZ2lzdHJ5IGZyb20gJy4uLy4uLy4uL3BoZXQtY29yZS9qcy9kb2N1bWVudGF0aW9uL0luc3RhbmNlUmVnaXN0cnkuanMnO1xyXG5pbXBvcnQgeyBDb2xvciwgRmxvd0JveCwgRmxvd0JveE9wdGlvbnMsIEhpZ2hsaWdodEZyb21Ob2RlLCBOb2RlLCBQRE9NUGVlciwgUERPTVZhbHVlVHlwZSwgU2NlbmVyeUNvbnN0YW50cywgVElucHV0TGlzdGVuZXIgfSBmcm9tICcuLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgbXVsdGlTZWxlY3Rpb25Tb3VuZFBsYXllckZhY3RvcnkgZnJvbSAnLi4vLi4vLi4vdGFtYm8vanMvbXVsdGlTZWxlY3Rpb25Tb3VuZFBsYXllckZhY3RvcnkuanMnO1xyXG5pbXBvcnQgVGFuZGVtIGZyb20gJy4uLy4uLy4uL3RhbmRlbS9qcy9UYW5kZW0uanMnO1xyXG5pbXBvcnQgQ29sb3JDb25zdGFudHMgZnJvbSAnLi4vQ29sb3JDb25zdGFudHMuanMnO1xyXG5pbXBvcnQgc3VuIGZyb20gJy4uL3N1bi5qcyc7XHJcbmltcG9ydCBSZWN0YW5ndWxhclJhZGlvQnV0dG9uLCB7IFJlY3Rhbmd1bGFyUmFkaW9CdXR0b25PcHRpb25zIH0gZnJvbSAnLi9SZWN0YW5ndWxhclJhZGlvQnV0dG9uLmpzJztcclxuaW1wb3J0IHsgVm9pY2luZ1Jlc3BvbnNlIH0gZnJvbSAnLi4vLi4vLi4vdXR0ZXJhbmNlLXF1ZXVlL2pzL1Jlc3BvbnNlUGFja2V0LmpzJztcclxuaW1wb3J0IFRTb3VuZFBsYXllciBmcm9tICcuLi8uLi8uLi90YW1iby9qcy9UU291bmRQbGF5ZXIuanMnO1xyXG5pbXBvcnQgVENvbnRlbnRBcHBlYXJhbmNlU3RyYXRlZ3kgZnJvbSAnLi9UQ29udGVudEFwcGVhcmFuY2VTdHJhdGVneS5qcyc7XHJcbmltcG9ydCBvcHRpb25pemUsIHsgY29tYmluZU9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi9waGV0LWNvcmUvanMvb3B0aW9uaXplLmpzJztcclxuaW1wb3J0IFN0cmljdE9taXQgZnJvbSAnLi4vLi4vLi4vcGhldC1jb3JlL2pzL3R5cGVzL1N0cmljdE9taXQuanMnO1xyXG5pbXBvcnQgR3JvdXBJdGVtT3B0aW9ucywgeyBnZXRHcm91cEl0ZW1Ob2RlcyB9IGZyb20gJy4uL0dyb3VwSXRlbU9wdGlvbnMuanMnO1xyXG5pbXBvcnQgUGhldGlvUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vYXhvbi9qcy9QaGV0aW9Qcm9wZXJ0eS5qcyc7XHJcblxyXG4vLyBwZG9tIC0gVW5pcXVlIElEIGZvciBlYWNoIGluc3RhbmNlIG9mIFJlY3Rhbmd1bGFyUmFkaW9CdXR0b25Hcm91cC4gVXNlZCB0byBjcmVhdGUgdGhlICduYW1lJyBvcHRpb24gdGhhdCBpcyBwYXNzZWRcclxuLy8gdG8gZWFjaCBSZWN0YW5ndWxhclJhZGlvQnV0dG9uIGluIHRoZSBncm91cC4gQWxsIGJ1dHRvbnMgaW4gdGhlIGdyb3VwIG11c3QgaGF2ZSB0aGUgc2FtZSAnbmFtZScsIGFuZCB0aGF0IG5hbWVcclxuLy8gbXVzdCBiZSB1bmlxdWUgdG8gdGhlIGdyb3VwLiBPdGhlcndpc2UsIHRoZSBicm93c2VyIHdpbGwgdHJlYXQgYWxsIGlucHV0cyBvZiB0eXBlICdyYWRpbycgaW4gdGhlIGRvY3VtZW50IGFzIGJlaW5nXHJcbi8vIGluIGEgc2luZ2xlIGdyb3VwLlxyXG5sZXQgaW5zdGFuY2VDb3VudCA9IDA7XHJcblxyXG4vLyBQcmVmaXggZm9yIGluc3RhbmNlQ291bnQsIGJlY2F1c2UgUGhFVCBzaW1zIGhhdmUgZGlmZmVyZW50IHR5cGVzIG9mIFwiZ3JvdXBzXCJcclxuY29uc3QgQ0xBU1NfTkFNRSA9ICdSZWN0YW5ndWxhclJhZGlvQnV0dG9uR3JvdXAnO1xyXG5cclxuLy8gRGVzY3JpYmVzIG9uZSByYWRpbyBidXR0b25cclxuZXhwb3J0IHR5cGUgUmVjdGFuZ3VsYXJSYWRpb0J1dHRvbkdyb3VwSXRlbTxUPiA9IHtcclxuICB2YWx1ZTogVDsgLy8gdmFsdWUgYXNzb2NpYXRlZCB3aXRoIHRoZSBidXR0b25cclxuICBsYWJlbD86IE5vZGU7IC8vIG9wdGlvbmFsIGxhYmVsIHRoYXQgYXBwZWFycyBvdXRzaWRlIHRoZSBidXR0b25cclxuICBwaGV0aW9Eb2N1bWVudGF0aW9uPzogc3RyaW5nOyAvLyBvcHRpb25hbCBkb2N1bWVudGF0aW9uIGZvciBQaEVULWlPXHJcbiAgbGFiZWxDb250ZW50PzogUERPTVZhbHVlVHlwZTsgLy8gb3B0aW9uYWwgbGFiZWwgZm9yIGExMXkgKGRlc2NyaXB0aW9uIGFuZCB2b2ljaW5nKVxyXG4gIHZvaWNpbmdDb250ZXh0UmVzcG9uc2U/OiBWb2ljaW5nUmVzcG9uc2U7XHJcbiAgZGVzY3JpcHRpb25Db250ZW50PzogUERPTVZhbHVlVHlwZTsgLy8gb3B0aW9uYWwgbGFiZWwgZm9yIGExMXlcclxuICBvcHRpb25zPzogU3RyaWN0T21pdDxSZWN0YW5ndWxhclJhZGlvQnV0dG9uT3B0aW9ucywgJ3RhbmRlbSc+OyAvLyBvcHRpb25zIHBhc3NlZCB0byBSZWN0YW5ndWxhclJhZGlvQnV0dG9uIGNvbnN0cnVjdG9yXHJcbn0gJiBHcm91cEl0ZW1PcHRpb25zO1xyXG5cclxuLyoqXHJcbiAqIElkZW50aWZpZXMgYSByYWRpbyBidXR0b24gYW5kIGl0cyBsYXlvdXQgbWFuYWdlci4gUG9pbnRlciBhcmVhcyBhbmQgZm9jdXMgaGlnaGxpZ2h0IG5lZWQgdG8gYmUgc2V0IG9uXHJcbiAqIHRoZSBidXR0b24sIGJ1dCBuZWVkIHRvIHN1cnJvdW5kIHRoZSBsYXlvdXQgbWFuYWdlciBjb250YWluaW5nIGJvdGggdGhlIGJ1dHRvbiBhbmQgaXRzIG9wdGlvbmFsIGxhYmVsLlxyXG4gKiBUaGlzIHdhcyBmb3JtZXJseSBhIGNsYXNzLCBjb252ZXJ0ZWQgdG8gYSB0eXBlIHdoZW4gUGhFVCBtb3ZlZCB0byBUeXBlU2NyaXB0LlxyXG4gKiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL3N1bi9pc3N1ZXMvNzA4XHJcbiAqL1xyXG50eXBlIEJ1dHRvbldpdGhMYXlvdXROb2RlPFQ+ID0ge1xyXG4gIHJhZGlvQnV0dG9uOiBSZWN0YW5ndWxhclJhZGlvQnV0dG9uPFQ+O1xyXG4gIHJlYWRvbmx5IGZvY3VzSGlnaGxpZ2h0OiBIaWdobGlnaHRGcm9tTm9kZTtcclxuICByZWFkb25seSBsYXlvdXROb2RlOiBOb2RlO1xyXG59O1xyXG5cclxuLy8gV2hlcmUgdGhlIG9wdGlvbmFsIGxhYmVsIGFwcGVhcnMsIHJlbGF0aXZlIHRvIHRoZSByYWRpbyBidXR0b25cclxuZXhwb3J0IHR5cGUgUmVjdGFuZ3VsYXJSYWRpb0J1dHRvbkxhYmVsQWxpZ24gPSAndG9wJyB8ICdib3R0b20nIHwgJ2xlZnQnIHwgJ3JpZ2h0JztcclxuXHJcbnR5cGUgU2VsZk9wdGlvbnMgPSB7XHJcblxyXG4gIC8vIFNvdW5kIGdlbmVyYXRpb24gZm9yIHRoZSByYWRpbyBidXR0b25zLlxyXG4gIC8vIG51bGwgbWVhbnMgdG8gdXNlIHRoZSBkZWZhdWx0cy4gT3RoZXJ3aXNlLCB0aGVyZSBtdXN0IGJlIG9uZSBmb3IgZWFjaCBidXR0b24uXHJcbiAgc291bmRQbGF5ZXJzPzogVFNvdW5kUGxheWVyW10gfCBudWxsO1xyXG5cclxuICAvLyBEZXRlcm1pbmVzIHdoZXJlIHRoZSBvcHRpb25hbCBsYWJlbCBhcHBlYXJzLCByZWxhdGl2ZSB0byB0aGUgYnV0dG9uXHJcbiAgbGFiZWxBbGlnbj86IFJlY3Rhbmd1bGFyUmFkaW9CdXR0b25MYWJlbEFsaWduO1xyXG5cclxuICAvLyBTcGFjaW5nIGJldHdlZW4gdGhlIG9wdGlvbmFsIGxhYmVsIGFuZCB0aGUgYnV0dG9uXHJcbiAgbGFiZWxTcGFjaW5nPzogbnVtYmVyO1xyXG5cclxuICAvLyBBcHBsaWVkIHRvIGVhY2ggYnV0dG9uLCBvciBlYWNoIGJ1dHRvbiArIG9wdGlvbmFsIGxhYmVsLlxyXG4gIC8vIFRoaXMgaXMgbm90IGhhbmRsZWQgdmlhIHJhZGlvQnV0dG9uT3B0aW9ucyBiZWNhdXNlIHdlIG1heSBoYXZlIGFuIG9wdGlvbmFsIGxhYmVsIGluIGFkZGl0aW9uIHRvIHRoZSBidXR0b24uXHJcbiAgdG91Y2hBcmVhWERpbGF0aW9uPzogbnVtYmVyO1xyXG4gIHRvdWNoQXJlYVlEaWxhdGlvbj86IG51bWJlcjtcclxuICBtb3VzZUFyZWFYRGlsYXRpb24/OiBudW1iZXI7XHJcbiAgbW91c2VBcmVhWURpbGF0aW9uPzogbnVtYmVyO1xyXG5cclxuICByYWRpb0J1dHRvbk9wdGlvbnM/OiBTdHJpY3RPbWl0PFJlY3Rhbmd1bGFyUmFkaW9CdXR0b25PcHRpb25zLFxyXG4gICAgJ3NvdW5kUGxheWVyJyB8ICAgICAgICAvLyB1c2UgU2VsZk9wdGlvbnMuc291bmRQbGF5ZXJzXHJcbiAgICAndG91Y2hBcmVhWERpbGF0aW9uJyB8IC8vIHVzZSBTZWxmT3B0aW9ucy50b3VjaEFyZWFYRGlsYXRpb25cclxuICAgICd0b3VjaEFyZWFZRGlsYXRpb24nIHwgLy8gdXNlIFNlbGZPcHRpb25zLnRvdWNoQXJlYVlEaWxhdGlvblxyXG4gICAgJ21vdXNlQXJlYVhEaWxhdGlvbicgfCAvLyB1c2UgU2VsZk9wdGlvbnMubW91c2VBcmVhWERpbGF0aW9uXHJcbiAgICAnbW91c2VBcmVhWURpbGF0aW9uJyAgIC8vIHVzZSBTZWxmT3B0aW9ucy5tb3VzZUFyZWFZRGlsYXRpb25cclxuICA+O1xyXG59O1xyXG5cclxuZXhwb3J0IHR5cGUgUmVjdGFuZ3VsYXJSYWRpb0J1dHRvbkdyb3VwT3B0aW9ucyA9IFNlbGZPcHRpb25zICYgU3RyaWN0T21pdDxGbG93Qm94T3B0aW9ucyxcclxuICAnY2hpbGRyZW4nIHwgJ3RhZ05hbWUnIHwgJ2FyaWFSb2xlJyB8ICdncm91cEZvY3VzSGlnaGxpZ2h0Jz47XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBSZWN0YW5ndWxhclJhZGlvQnV0dG9uR3JvdXA8VD4gZXh0ZW5kcyBGbG93Qm94IHtcclxuXHJcbiAgcHJpdmF0ZSByZWFkb25seSBkaXNwb3NlUmFkaW9CdXR0b25Hcm91cDogKCkgPT4gdm9pZDtcclxuICBwcml2YXRlIHJlYWRvbmx5IHJhZGlvQnV0dG9uTWFwOiBNYXA8VCwgUmVjdGFuZ3VsYXJSYWRpb0J1dHRvbjxUPj47XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggcHJvcGVydHk6IFBoZXRpb1Byb3BlcnR5PFQ+LCBpdGVtczogUmVjdGFuZ3VsYXJSYWRpb0J1dHRvbkdyb3VwSXRlbTxUPltdLCBwcm92aWRlZE9wdGlvbnM/OiBSZWN0YW5ndWxhclJhZGlvQnV0dG9uR3JvdXBPcHRpb25zICkge1xyXG5cclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIF8udW5pcUJ5KCBpdGVtcywgaXRlbSA9PiBpdGVtLnZhbHVlICkubGVuZ3RoID09PSBpdGVtcy5sZW5ndGgsXHJcbiAgICAgICdpdGVtcyBtdXN0IGhhdmUgdW5pcXVlIHZhbHVlcycgKTtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIF8uZmluZCggaXRlbXMsIGl0ZW0gPT4gKCBpdGVtLnZhbHVlID09PSBwcm9wZXJ0eS52YWx1ZSApICksXHJcbiAgICAgICdvbmUgcmFkaW8gYnV0dG9uIG11c3QgYmUgYXNzb2NpYXRlZCB3aXRoIHByb3BlcnR5LnZhbHVlJyApO1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSBvcHRpb25pemU8UmVjdGFuZ3VsYXJSYWRpb0J1dHRvbkdyb3VwT3B0aW9ucywgU2VsZk9wdGlvbnMsIEZsb3dCb3hPcHRpb25zPigpKCB7XHJcblxyXG4gICAgICAvLyBTZWxmT3B0aW9uc1xyXG4gICAgICBzb3VuZFBsYXllcnM6IG51bGwsXHJcbiAgICAgIGxhYmVsQWxpZ246ICdib3R0b20nLFxyXG4gICAgICBsYWJlbFNwYWNpbmc6IDAsXHJcbiAgICAgIHRvdWNoQXJlYVhEaWxhdGlvbjogMCxcclxuICAgICAgdG91Y2hBcmVhWURpbGF0aW9uOiAwLFxyXG4gICAgICBtb3VzZUFyZWFYRGlsYXRpb246IDAsXHJcbiAgICAgIG1vdXNlQXJlYVlEaWxhdGlvbjogMCxcclxuICAgICAgcmFkaW9CdXR0b25PcHRpb25zOiB7XHJcbiAgICAgICAgYmFzZUNvbG9yOiBDb2xvckNvbnN0YW50cy5MSUdIVF9CTFVFLFxyXG4gICAgICAgIGNvcm5lclJhZGl1czogNCxcclxuICAgICAgICB4TWFyZ2luOiA1LFxyXG4gICAgICAgIHlNYXJnaW46IDUsXHJcbiAgICAgICAgeEFsaWduOiAnY2VudGVyJyxcclxuICAgICAgICB5QWxpZ246ICdjZW50ZXInLFxyXG4gICAgICAgIGJ1dHRvbkFwcGVhcmFuY2VTdHJhdGVneU9wdGlvbnM6IHtcclxuICAgICAgICAgIHNlbGVjdGVkU3Ryb2tlOiAnYmxhY2snLFxyXG4gICAgICAgICAgc2VsZWN0ZWRMaW5lV2lkdGg6IDEuNSxcclxuICAgICAgICAgIHNlbGVjdGVkQnV0dG9uT3BhY2l0eTogMSxcclxuICAgICAgICAgIGRlc2VsZWN0ZWRTdHJva2U6IG5ldyBDb2xvciggNTAsIDUwLCA1MCApLFxyXG4gICAgICAgICAgZGVzZWxlY3RlZExpbmVXaWR0aDogMSxcclxuICAgICAgICAgIGRlc2VsZWN0ZWRCdXR0b25PcGFjaXR5OiAwLjYsXHJcbiAgICAgICAgICBvdmVyQnV0dG9uT3BhY2l0eTogMC44XHJcbiAgICAgICAgfSxcclxuICAgICAgICBjb250ZW50QXBwZWFyYW5jZVN0cmF0ZWd5OiBSZWN0YW5ndWxhclJhZGlvQnV0dG9uLkNvbnRlbnRBcHBlYXJhbmNlU3RyYXRlZ3ksXHJcbiAgICAgICAgY29udGVudEFwcGVhcmFuY2VTdHJhdGVneU9wdGlvbnM6IHtcclxuICAgICAgICAgIG92ZXJDb250ZW50T3BhY2l0eTogMC44LFxyXG4gICAgICAgICAgc2VsZWN0ZWRDb250ZW50T3BhY2l0eTogMSxcclxuICAgICAgICAgIGRlc2VsZWN0ZWRDb250ZW50T3BhY2l0eTogMC42XHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgLy8gRmxvd0JveE9wdGlvbnNcclxuICAgICAgc3BhY2luZzogMTAsXHJcbiAgICAgIHN0cmV0Y2g6IHRydWUsIC8vIGhhdmUgdGhlIGJ1dHRvbnMgbWF0Y2ggc2l6ZSwgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9zdW4vaXNzdWVzLzg1MVxyXG4gICAgICBvcmllbnRhdGlvbjogJ3ZlcnRpY2FsJyxcclxuICAgICAgZGlzYWJsZWRPcGFjaXR5OiBTY2VuZXJ5Q29uc3RhbnRzLkRJU0FCTEVEX09QQUNJVFksXHJcblxyXG4gICAgICAvLyBwaGV0LWlvXHJcbiAgICAgIHRhbmRlbTogVGFuZGVtLlJFUVVJUkVELFxyXG4gICAgICB0YW5kZW1OYW1lU3VmZml4OiAnQnV0dG9uR3JvdXAnLFxyXG4gICAgICB2aXNpYmxlUHJvcGVydHlPcHRpb25zOiB7IHBoZXRpb0ZlYXR1cmVkOiB0cnVlIH0sXHJcbiAgICAgIHBoZXRpb0VuYWJsZWRQcm9wZXJ0eUluc3RydW1lbnRlZDogdHJ1ZSwgLy8gb3B0IGludG8gZGVmYXVsdCBQaEVULWlPIGluc3RydW1lbnRlZCBlbmFibGVkUHJvcGVydHlcclxuICAgICAgcGhldGlvRmVhdHVyZWQ6IHRydWUsXHJcblxyXG4gICAgICAvLyBwZG9tXHJcbiAgICAgIHRhZ05hbWU6ICd1bCcsXHJcbiAgICAgIGxhYmVsVGFnTmFtZTogJ2gzJyxcclxuICAgICAgYXJpYVJvbGU6ICdyYWRpb2dyb3VwJyxcclxuICAgICAgZ3JvdXBGb2N1c0hpZ2hsaWdodDogdHJ1ZVxyXG4gICAgfSwgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggb3B0aW9ucy5zb3VuZFBsYXllcnMgPT09IG51bGwgfHwgb3B0aW9ucy5zb3VuZFBsYXllcnMubGVuZ3RoID09PSBpdGVtcy5sZW5ndGgsXHJcbiAgICAgICdJZiBzb3VuZFBsYXllcnMgaXMgcHJvdmlkZWQsIHRoZXJlIG11c3QgYmUgb25lIHBlciByYWRpbyBidXR0b24uJyApO1xyXG5cclxuICAgIGluc3RhbmNlQ291bnQrKztcclxuXHJcbiAgICBjb25zdCByYWRpb0J1dHRvbk1hcCA9IG5ldyBNYXA8VCwgUmVjdGFuZ3VsYXJSYWRpb0J1dHRvbjxUPj4oKTtcclxuXHJcbiAgICBjb25zdCBub2RlcyA9IGdldEdyb3VwSXRlbU5vZGVzKCBpdGVtcywgb3B0aW9ucy50YW5kZW0gKTtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIF8uZXZlcnkoIG5vZGVzLCBub2RlID0+ICFub2RlLmhhc1BET01Db250ZW50ICksXHJcbiAgICAgICdBY2Nlc3NpYmlsaXR5IGlzIHByb3ZpZGVkIGJ5IFJlY3Rhbmd1bGFyUmFkaW9CdXR0b24gYW5kIFJlY3Rhbmd1bGFyUmFkaW9CdXR0b25Hcm91cEl0ZW0ubGFiZWxDb250ZW50LiAnICtcclxuICAgICAgJ0FkZGl0aW9uYWwgUERPTSBjb250ZW50IGluIHRoZSBwcm92aWRlZCBOb2RlIGNvdWxkIGJyZWFrIGFjY2Vzc2liaWxpdHkuJyApO1xyXG5cclxuICAgIC8vIENhbGN1bGF0ZSB0aGUgbWF4aW11bSB3aWR0aCBhbmQgaGVpZ2h0IG9mIHRoZSBjb250ZW50LCBzbyB3ZSBjYW4gbWFrZSBhbGwgcmFkaW8gYnV0dG9ucyB0aGUgc2FtZSBzaXplLlxyXG4gICAgY29uc3Qgd2lkZXN0Q29udGVudFdpZHRoID0gXy5tYXhCeSggbm9kZXMsIG5vZGUgPT4gbm9kZS53aWR0aCApIS53aWR0aDtcclxuICAgIGNvbnN0IHRhbGxlc3RDb250ZW50SGVpZ2h0ID0gXy5tYXhCeSggbm9kZXMsIG5vZGUgPT4gbm9kZS5oZWlnaHQgKSEuaGVpZ2h0O1xyXG5cclxuICAgIC8vIFBvcHVsYXRlZCBmb3IgZWFjaCByYWRpbyBidXR0b24gaW4gZm9yIGxvb3BcclxuICAgIGNvbnN0IGJ1dHRvbnM6IEFycmF5PFJlY3Rhbmd1bGFyUmFkaW9CdXR0b248VD4gfCBGbG93Qm94PiA9IFtdO1xyXG4gICAgY29uc3QgYnV0dG9uc1dpdGhMYXlvdXROb2RlczogQnV0dG9uV2l0aExheW91dE5vZGU8VD5bXSA9IFtdO1xyXG4gICAgY29uc3QgbGFiZWxBcHBlYXJhbmNlU3RyYXRlZ2llczogSW5zdGFuY2VUeXBlPFRDb250ZW50QXBwZWFyYW5jZVN0cmF0ZWd5PltdID0gW107XHJcblxyXG4gICAgY29uc3QgeE1hcmdpbjogbnVtYmVyID0gb3B0aW9ucy5yYWRpb0J1dHRvbk9wdGlvbnMueE1hcmdpbiE7XHJcbiAgICBjb25zdCB5TWFyZ2luOiBudW1iZXIgPSBvcHRpb25zLnJhZGlvQnV0dG9uT3B0aW9ucy55TWFyZ2luITtcclxuXHJcbiAgICBmb3IgKCBsZXQgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKyApIHtcclxuICAgICAgY29uc3QgaXRlbSA9IGl0ZW1zWyBpIF07XHJcbiAgICAgIGNvbnN0IG5vZGUgPSBub2Rlc1sgaSBdO1xyXG5cclxuICAgICAgY29uc3QgcmFkaW9CdXR0b25PcHRpb25zID0gY29tYmluZU9wdGlvbnM8UmVjdGFuZ3VsYXJSYWRpb0J1dHRvbk9wdGlvbnM+KCB7XHJcbiAgICAgICAgY29udGVudDogbm9kZSxcclxuICAgICAgICBtaW5XaWR0aDogd2lkZXN0Q29udGVudFdpZHRoICsgMiAqIHhNYXJnaW4sXHJcbiAgICAgICAgbWluSGVpZ2h0OiB0YWxsZXN0Q29udGVudEhlaWdodCArIDIgKiB5TWFyZ2luLFxyXG4gICAgICAgIHNvdW5kUGxheWVyOiBvcHRpb25zLnNvdW5kUGxheWVycyA/IG9wdGlvbnMuc291bmRQbGF5ZXJzWyBpIF0gOlxyXG4gICAgICAgICAgICAgICAgICAgICBtdWx0aVNlbGVjdGlvblNvdW5kUGxheWVyRmFjdG9yeS5nZXRTZWxlY3Rpb25Tb3VuZFBsYXllciggaSApLFxyXG4gICAgICAgIHRhbmRlbTogaXRlbS50YW5kZW1OYW1lID8gb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCBpdGVtLnRhbmRlbU5hbWUgKSA6XHJcbiAgICAgICAgICAgICAgICBvcHRpb25zLnRhbmRlbSA9PT0gVGFuZGVtLk9QVF9PVVQgPyBUYW5kZW0uT1BUX09VVCA6XHJcbiAgICAgICAgICAgICAgICBUYW5kZW0uUkVRVUlSRUQsXHJcbiAgICAgICAgcGhldGlvRG9jdW1lbnRhdGlvbjogaXRlbS5waGV0aW9Eb2N1bWVudGF0aW9uIHx8ICcnLFxyXG4gICAgICAgIC8vIE5PVEU6IFRoaXMgZG9lcyBOT1Qgc3VwcG9ydCBkeW5hbWljIG9yaWVudGF0aW9uIGNoYW5nZXMuIElmIHlvdSBuZWVkIHRoYXQsIGNoYW5nZSBSZWN0YW5ndWxhckJ1dHRvbiB0byBzdXBwb3J0XHJcbiAgICAgICAgLy8gZHluYW1pYyBvcHRpb25zXHJcbiAgICAgICAgdG91Y2hBcmVhWERpbGF0aW9uOiBvcHRpb25zLm9yaWVudGF0aW9uID09PSAnaG9yaXpvbnRhbCcgPyBvcHRpb25zLnNwYWNpbmcgLyAyIDogb3B0aW9ucy50b3VjaEFyZWFYRGlsYXRpb24sXHJcbiAgICAgICAgdG91Y2hBcmVhWURpbGF0aW9uOiBvcHRpb25zLm9yaWVudGF0aW9uID09PSAndmVydGljYWwnID8gb3B0aW9ucy5zcGFjaW5nIC8gMiA6IG9wdGlvbnMudG91Y2hBcmVhWURpbGF0aW9uLFxyXG4gICAgICAgIG1vdXNlQXJlYVhEaWxhdGlvbjogb3B0aW9ucy5vcmllbnRhdGlvbiA9PT0gJ2hvcml6b250YWwnID8gb3B0aW9ucy5zcGFjaW5nIC8gMiA6IG9wdGlvbnMubW91c2VBcmVhWERpbGF0aW9uLFxyXG4gICAgICAgIG1vdXNlQXJlYVlEaWxhdGlvbjogb3B0aW9ucy5vcmllbnRhdGlvbiA9PT0gJ3ZlcnRpY2FsJyA/IG9wdGlvbnMuc3BhY2luZyAvIDIgOiBvcHRpb25zLm1vdXNlQXJlYVlEaWxhdGlvblxyXG4gICAgICB9LCBvcHRpb25zLnJhZGlvQnV0dG9uT3B0aW9ucywgaXRlbS5vcHRpb25zICk7XHJcblxyXG4gICAgICAvLyBDcmVhdGUgdGhlIGxhYmVsIGFuZCB2b2ljaW5nIHJlc3BvbnNlIGZvciB0aGUgcmFkaW8gYnV0dG9uLlxyXG4gICAgICBpZiAoIGl0ZW0ubGFiZWxDb250ZW50ICkge1xyXG4gICAgICAgIHJhZGlvQnV0dG9uT3B0aW9ucy5sYWJlbENvbnRlbnQgPSBpdGVtLmxhYmVsQ29udGVudDtcclxuICAgICAgICByYWRpb0J1dHRvbk9wdGlvbnMudm9pY2luZ05hbWVSZXNwb25zZSA9IGl0ZW0ubGFiZWxDb250ZW50O1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBwZG9tIGNyZWF0ZSBkZXNjcmlwdGlvbiBmb3IgcmFkaW8gYnV0dG9uXHJcbiAgICAgIC8vIHVzZSBpZiBibG9jayB0byBwcmV2ZW50IGVtcHR5ICdwJyB0YWcgYmVpbmcgYWRkZWQgd2hlbiBubyBvcHRpb24gaXMgcHJlc2VudFxyXG4gICAgICBpZiAoIGl0ZW0uZGVzY3JpcHRpb25Db250ZW50ICkge1xyXG4gICAgICAgIHJhZGlvQnV0dG9uT3B0aW9ucy5kZXNjcmlwdGlvbkNvbnRlbnQgPSBpdGVtLmRlc2NyaXB0aW9uQ29udGVudDtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKCBpdGVtLnZvaWNpbmdDb250ZXh0UmVzcG9uc2UgKSB7XHJcbiAgICAgICAgcmFkaW9CdXR0b25PcHRpb25zLnZvaWNpbmdDb250ZXh0UmVzcG9uc2UgPSBpdGVtLnZvaWNpbmdDb250ZXh0UmVzcG9uc2U7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IHJhZGlvQnV0dG9uID0gbmV3IFJlY3Rhbmd1bGFyUmFkaW9CdXR0b24oIHByb3BlcnR5LCBpdGVtLnZhbHVlLCByYWRpb0J1dHRvbk9wdGlvbnMgKTtcclxuXHJcbiAgICAgIHJhZGlvQnV0dG9uTWFwLnNldCggaXRlbS52YWx1ZSwgcmFkaW9CdXR0b24gKTtcclxuXHJcbiAgICAgIC8vIHBkb20gLSBzbyB0aGUgYnJvd3NlciByZWNvZ25pemVzIHRoZXNlIGJ1dHRvbnMgYXJlIGluIHRoZSBzYW1lIGdyb3VwLiBTZWUgaW5zdGFuY2VDb3VudCBmb3IgbW9yZSBpbmZvLlxyXG4gICAgICByYWRpb0J1dHRvbi5zZXRQRE9NQXR0cmlidXRlKCAnbmFtZScsIENMQVNTX05BTUUgKyBpbnN0YW5jZUNvdW50ICk7XHJcblxyXG4gICAgICBsZXQgYnV0dG9uO1xyXG4gICAgICBpZiAoIGl0ZW0ubGFiZWwgKSB7XHJcblxyXG4gICAgICAgIC8vIElmIGEgbGFiZWwgaXMgcHJvdmlkZWQsIHRoZSBidXR0b24gYmVjb21lcyBhIEZsb3dCb3ggdGhhdCBtYW5hZ2VzIGxheW91dCBvZiB0aGUgYnV0dG9uIGFuZCBsYWJlbC5cclxuICAgICAgICBjb25zdCBsYWJlbCA9IGl0ZW0ubGFiZWw7XHJcbiAgICAgICAgY29uc3QgbGFiZWxPcmllbnRhdGlvbiA9ICggb3B0aW9ucy5sYWJlbEFsaWduID09PSAnYm90dG9tJyB8fCBvcHRpb25zLmxhYmVsQWxpZ24gPT09ICd0b3AnICkgPyAndmVydGljYWwnIDogJ2hvcml6b250YWwnO1xyXG4gICAgICAgIGNvbnN0IGxhYmVsQ2hpbGRyZW4gPSAoIG9wdGlvbnMubGFiZWxBbGlnbiA9PT0gJ2xlZnQnIHx8IG9wdGlvbnMubGFiZWxBbGlnbiA9PT0gJ3RvcCcgKSA/IFsgbGFiZWwsIHJhZGlvQnV0dG9uIF0gOiBbIHJhZGlvQnV0dG9uLCBsYWJlbCBdO1xyXG4gICAgICAgIGJ1dHRvbiA9IG5ldyBGbG93Qm94KCB7XHJcbiAgICAgICAgICBjaGlsZHJlbjogbGFiZWxDaGlsZHJlbixcclxuICAgICAgICAgIHNwYWNpbmc6IG9wdGlvbnMubGFiZWxTcGFjaW5nLFxyXG4gICAgICAgICAgb3JpZW50YXRpb246IGxhYmVsT3JpZW50YXRpb25cclxuICAgICAgICB9ICk7XHJcblxyXG4gICAgICAgIC8vIE1ha2Ugc3VyZSB0aGUgbGFiZWwgcG9pbnRlciBhcmVhcyBkb24ndCBibG9jayB0aGUgZXhwYW5kZWQgYnV0dG9uIHBvaW50ZXIgYXJlYXMuXHJcbiAgICAgICAgbGFiZWwucGlja2FibGUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgLy8gVXNlIHRoZSBzYW1lIGNvbnRlbnQgYXBwZWFyYW5jZSBzdHJhdGVneSBmb3IgdGhlIGxhYmVscyB0aGF0IGlzIHVzZWQgZm9yIHRoZSBidXR0b24gY29udGVudC5cclxuICAgICAgICAvLyBCeSBkZWZhdWx0LCB0aGlzIHJlZHVjZXMgb3BhY2l0eSBvZiB0aGUgbGFiZWxzIGZvciB0aGUgZGVzZWxlY3RlZCByYWRpbyBidXR0b25zLlxyXG4gICAgICAgIGlmICggb3B0aW9ucy5yYWRpb0J1dHRvbk9wdGlvbnMuY29udGVudEFwcGVhcmFuY2VTdHJhdGVneSApIHtcclxuICAgICAgICAgIGxhYmVsQXBwZWFyYW5jZVN0cmF0ZWdpZXMucHVzaCggbmV3IG9wdGlvbnMucmFkaW9CdXR0b25PcHRpb25zLmNvbnRlbnRBcHBlYXJhbmNlU3RyYXRlZ3koXHJcbiAgICAgICAgICAgIGxhYmVsLFxyXG4gICAgICAgICAgICByYWRpb0J1dHRvbi5pbnRlcmFjdGlvblN0YXRlUHJvcGVydHksXHJcbiAgICAgICAgICAgIG9wdGlvbnMucmFkaW9CdXR0b25PcHRpb25zLmNvbnRlbnRBcHBlYXJhbmNlU3RyYXRlZ3lPcHRpb25zXHJcbiAgICAgICAgICApICk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG5cclxuICAgICAgICAvLyBUaGUgYnV0dG9uIGhhcyBubyBsYWJlbC5cclxuICAgICAgICBidXR0b24gPSByYWRpb0J1dHRvbjtcclxuICAgICAgfVxyXG4gICAgICBidXR0b25zLnB1c2goIGJ1dHRvbiApO1xyXG5cclxuICAgICAgLy8gVGhlIGhpZ2hsaWdodCBmb3IgdGhlIHJhZGlvIGJ1dHRvbiBzaG91bGQgc3Vycm91bmQgdGhlIGxheW91dCBOb2RlIGlmIG9uZSBpcyB1c2VkLlxyXG4gICAgICBjb25zdCBmb2N1c0hpZ2hsaWdodCA9IG5ldyBIaWdobGlnaHRGcm9tTm9kZSggYnV0dG9uICk7XHJcbiAgICAgIGJ1dHRvbnNXaXRoTGF5b3V0Tm9kZXMucHVzaCggeyByYWRpb0J1dHRvbjogcmFkaW9CdXR0b24sIGxheW91dE5vZGU6IGJ1dHRvbiwgZm9jdXNIaWdobGlnaHQ6IGZvY3VzSGlnaGxpZ2h0IH0gKTtcclxuICAgICAgcmFkaW9CdXR0b24uZm9jdXNIaWdobGlnaHQgPSBmb2N1c0hpZ2hsaWdodDtcclxuICAgIH1cclxuXHJcbiAgICBvcHRpb25zLmNoaWxkcmVuID0gYnV0dG9ucztcclxuXHJcbiAgICBzdXBlciggb3B0aW9ucyApO1xyXG5cclxuICAgIHRoaXMucmFkaW9CdXR0b25NYXAgPSByYWRpb0J1dHRvbk1hcDtcclxuXHJcbiAgICAvLyBwZG9tIC0gVGhpcyBub2RlJ3MgcHJpbWFyeSBzaWJsaW5nIGlzIGFyaWEtbGFiZWxsZWRieSBpdHMgb3duIGxhYmVsLCBzbyB0aGUgbGFiZWwgY29udGVudCBpcyByZWFkIHdoZW5ldmVyXHJcbiAgICAvLyBhIG1lbWJlciBvZiB0aGUgZ3JvdXAgcmVjZWl2ZXMgZm9jdXMuXHJcbiAgICB0aGlzLmFkZEFyaWFMYWJlbGxlZGJ5QXNzb2NpYXRpb24oIHtcclxuICAgICAgdGhpc0VsZW1lbnROYW1lOiBQRE9NUGVlci5QUklNQVJZX1NJQkxJTkcsXHJcbiAgICAgIG90aGVyTm9kZTogdGhpcyxcclxuICAgICAgb3RoZXJFbGVtZW50TmFtZTogUERPTVBlZXIuTEFCRUxfU0lCTElOR1xyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIHBhbiBhbmQgem9vbSAtIFNpZ25pZnkgdGhhdCBrZXkgaW5wdXQgaXMgcmVzZXJ2ZWQsIGFuZCB3ZSBzaG91bGQgbm90IHBhbiB3aGVuIHVzZXIgcHJlc3NlcyBhcnJvdyBrZXlzLlxyXG4gICAgY29uc3QgaW50ZW50TGlzdGVuZXI6IFRJbnB1dExpc3RlbmVyID0geyBrZXlkb3duOiBldmVudCA9PiBldmVudC5wb2ludGVyLnJlc2VydmVGb3JLZXlib2FyZERyYWcoKSB9O1xyXG4gICAgdGhpcy5hZGRJbnB1dExpc3RlbmVyKCBpbnRlbnRMaXN0ZW5lciApO1xyXG5cclxuICAgIC8vIG11c3QgYmUgZG9uZSBhZnRlciB0aGlzIGluc3RhbmNlIGlzIGluc3RydW1lbnRlZFxyXG4gICAgdGhpcy5hZGRMaW5rZWRFbGVtZW50KCBwcm9wZXJ0eSwge1xyXG4gICAgICB0YW5kZW1OYW1lOiAncHJvcGVydHknXHJcbiAgICB9ICk7XHJcblxyXG4gICAgdGhpcy5kaXNwb3NlUmFkaW9CdXR0b25Hcm91cCA9ICgpID0+IHtcclxuICAgICAgdGhpcy5yZW1vdmVJbnB1dExpc3RlbmVyKCBpbnRlbnRMaXN0ZW5lciApO1xyXG5cclxuICAgICAgYnV0dG9uc1dpdGhMYXlvdXROb2Rlcy5mb3JFYWNoKCBidXR0b25XaXRoTGF5b3V0Tm9kZSA9PiB7XHJcbiAgICAgICAgYnV0dG9uV2l0aExheW91dE5vZGUuZm9jdXNIaWdobGlnaHQuZGlzcG9zZSgpO1xyXG4gICAgICAgIGJ1dHRvbldpdGhMYXlvdXROb2RlLnJhZGlvQnV0dG9uLmRpc3Bvc2UoKTtcclxuXHJcbiAgICAgICAgLy8gQSBsYXlvdXQgTm9kZSB3YXMgY3JlYXRlZCBmb3IgdGhpcyBidXR0b24gc28gaXQgc2hvdWxkIGJlIGRpc3Bvc2VkLlxyXG4gICAgICAgIGlmICggYnV0dG9uV2l0aExheW91dE5vZGUucmFkaW9CdXR0b24gIT09IGJ1dHRvbldpdGhMYXlvdXROb2RlLmxheW91dE5vZGUgKSB7XHJcbiAgICAgICAgICBidXR0b25XaXRoTGF5b3V0Tm9kZS5sYXlvdXROb2RlLmRpc3Bvc2UoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gKTtcclxuXHJcbiAgICAgIGxhYmVsQXBwZWFyYW5jZVN0cmF0ZWdpZXMuZm9yRWFjaCggc3RyYXRlZ3kgPT4gKCBzdHJhdGVneS5kaXNwb3NlICYmIHN0cmF0ZWd5LmRpc3Bvc2UoKSApICk7XHJcbiAgICAgIG5vZGVzLmZvckVhY2goIG5vZGUgPT4gbm9kZS5kaXNwb3NlKCkgKTtcclxuICAgIH07XHJcblxyXG4gICAgLy8gcGRvbSAtIHJlZ2lzdGVyIGNvbXBvbmVudCBmb3IgYmluZGVyIGRvY3NcclxuICAgIGFzc2VydCAmJiBwaGV0Py5jaGlwcGVyPy5xdWVyeVBhcmFtZXRlcnM/LmJpbmRlciAmJiBJbnN0YW5jZVJlZ2lzdHJ5LnJlZ2lzdGVyRGF0YVVSTCggJ3N1bicsICdSZWN0YW5ndWxhclJhZGlvQnV0dG9uR3JvdXAnLCB0aGlzICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGaW5kIHRoZSBSZWN0YW5ndWxhclJhZGlvQnV0dG9uIGNvcnJlc3BvbmRpbmcgdG8gYSB2YWx1ZS4gTm90ZSB0aGF0IGluIHRoZSBzY2VuZSBncmFwaCwgdGhlIGJ1dHRvbiBtYXkgYmUgbmVzdGVkXHJcbiAgICogdW5kZXIgb3RoZXIgbGF5ZXJzLCBzbyB1c2UgY2F1dGlvbiBmb3IgY29vcmRpbmF0ZSB0cmFuc2Zvcm1hdGlvbnMuXHJcbiAgICogQHBhcmFtIHZhbHVlXHJcbiAgICogQHJldHVybnMgdGhlIGNvcnJlc3BvbmRpbmcgYnV0dG9uXHJcbiAgICovXHJcbiAgcHVibGljIGdldEJ1dHRvbkZvclZhbHVlKCB2YWx1ZTogVCApOiBSZWN0YW5ndWxhclJhZGlvQnV0dG9uPFQ+IHtcclxuICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMucmFkaW9CdXR0b25NYXAuZ2V0KCB2YWx1ZSApITtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIHJlc3VsdCwgJ05vIGJ1dHRvbiBmb3VuZCBmb3IgdmFsdWU6ICcgKyB2YWx1ZSApO1xyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBvdmVycmlkZSBkaXNwb3NlKCk6IHZvaWQge1xyXG4gICAgdGhpcy5yYWRpb0J1dHRvbk1hcC5jbGVhcigpO1xyXG4gICAgdGhpcy5kaXNwb3NlUmFkaW9CdXR0b25Hcm91cCgpO1xyXG4gICAgc3VwZXIuZGlzcG9zZSgpO1xyXG4gIH1cclxufVxyXG5cclxuc3VuLnJlZ2lzdGVyKCAnUmVjdGFuZ3VsYXJSYWRpb0J1dHRvbkdyb3VwJywgUmVjdGFuZ3VsYXJSYWRpb0J1dHRvbkdyb3VwICk7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxnQkFBZ0IsTUFBTSx5REFBeUQ7QUFDdEYsU0FBU0MsS0FBSyxFQUFFQyxPQUFPLEVBQWtCQyxp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