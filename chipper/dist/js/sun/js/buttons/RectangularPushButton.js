// Copyright 2014-2024, University of Colorado Boulder

/**
 * RectangularPushButton is a rectangular push button, used to initiate some action.
 *
 * @author John Blanco (PhET Interactive Simulations)
 */

import InstanceRegistry from '../../../phet-core/js/documentation/InstanceRegistry.js';
import optionize from '../../../phet-core/js/optionize.js';
import pushButtonSoundPlayer from '../../../tambo/js/shared-sound-players/pushButtonSoundPlayer.js';
import Tandem from '../../../tandem/js/Tandem.js';
import sun from '../sun.js';
import PushButtonInteractionStateProperty from './PushButtonInteractionStateProperty.js';
import PushButtonModel from './PushButtonModel.js';
import RectangularButton from './RectangularButton.js';

//TODO https://github.com/phetsims/sun/issues/749 Let's not create PushButtonModel with these options?

export default class RectangularPushButton extends RectangularButton {
  // RectangularButton has this.buttonModel, but we also need this.pushButtonModel, because it has additional methods

  constructor(providedOptions) {
    const options = optionize()({
      soundPlayer: pushButtonSoundPlayer,
      tandem: Tandem.REQUIRED
    }, providedOptions);

    // Save the listener and add it after creating the button model.  This is done so that
    // the same code path is always used for adding listener, thus guaranteeing a consistent code path if addListener is
    // overridden, see https://github.com/phetsims/sun/issues/284.
    const listener = options.listener;
    const superOptions = _.omit(options, ['listener']);

    // Note it shares a tandem with this, so the emitter will be instrumented as a child of the button
    //TODO https://github.com/phetsims/sun/issues/749 its surprising that we can pass superOptions with irrelevant fields to PushButtonModel without TS errors
    const pushButtonModel = new PushButtonModel(superOptions);
    super(pushButtonModel, new PushButtonInteractionStateProperty(pushButtonModel), superOptions);
    this.pushButtonModel = pushButtonModel;

    // add the listener that was potentially saved above
    listener && this.addListener(listener);

    // sound generation
    const playSound = () => {
      options.soundPlayer.play();
    };
    pushButtonModel.produceSoundEmitter.addListener(playSound);
    this.disposeRectangularPushButton = function () {
      pushButtonModel.produceSoundEmitter.removeListener(playSound);
      pushButtonModel.dispose(); //TODO this fails when assertions are enabled, see sun#212
    };

    // support for binder documentation, stripped out in builds and only runs when ?binder is specified
    assert && phet?.chipper?.queryParameters?.binder && InstanceRegistry.registerDataURL('sun', 'RectangularPushButton', this);
  }
  dispose() {
    // The order of operations here is important - the view needs to be disposed first so that it is unhooked from
    // the model before the model is disposed.  If the model is disposed first, the view ends up trying to change some
    // of its Property values when it is disposed.  See https://github.com/phetsims/axon/issues/242.
    super.dispose();
    this.disposeRectangularPushButton();
  }

  /**
   * Adds a listener that will be notified when the button fires.
   */
  addListener(listener) {
    this.pushButtonModel.addListener(listener);
  }

  /**
   * Removes a listener.
   */
  removeListener(listener) {
    this.pushButtonModel.removeListener(listener);
  }
}
sun.register('RectangularPushButton', RectangularPushButton);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJJbnN0YW5jZVJlZ2lzdHJ5Iiwib3B0aW9uaXplIiwicHVzaEJ1dHRvblNvdW5kUGxheWVyIiwiVGFuZGVtIiwic3VuIiwiUHVzaEJ1dHRvbkludGVyYWN0aW9uU3RhdGVQcm9wZXJ0eSIsIlB1c2hCdXR0b25Nb2RlbCIsIlJlY3Rhbmd1bGFyQnV0dG9uIiwiUmVjdGFuZ3VsYXJQdXNoQnV0dG9uIiwiY29uc3RydWN0b3IiLCJwcm92aWRlZE9wdGlvbnMiLCJvcHRpb25zIiwic291bmRQbGF5ZXIiLCJ0YW5kZW0iLCJSRVFVSVJFRCIsImxpc3RlbmVyIiwic3VwZXJPcHRpb25zIiwiXyIsIm9taXQiLCJwdXNoQnV0dG9uTW9kZWwiLCJhZGRMaXN0ZW5lciIsInBsYXlTb3VuZCIsInBsYXkiLCJwcm9kdWNlU291bmRFbWl0dGVyIiwiZGlzcG9zZVJlY3Rhbmd1bGFyUHVzaEJ1dHRvbiIsInJlbW92ZUxpc3RlbmVyIiwiZGlzcG9zZSIsImFzc2VydCIsInBoZXQiLCJjaGlwcGVyIiwicXVlcnlQYXJhbWV0ZXJzIiwiYmluZGVyIiwicmVnaXN0ZXJEYXRhVVJMIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJSZWN0YW5ndWxhclB1c2hCdXR0b24udHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTQtMjAyNCwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogUmVjdGFuZ3VsYXJQdXNoQnV0dG9uIGlzIGEgcmVjdGFuZ3VsYXIgcHVzaCBidXR0b24sIHVzZWQgdG8gaW5pdGlhdGUgc29tZSBhY3Rpb24uXHJcbiAqXHJcbiAqIEBhdXRob3IgSm9obiBCbGFuY28gKFBoRVQgSW50ZXJhY3RpdmUgU2ltdWxhdGlvbnMpXHJcbiAqL1xyXG5cclxuaW1wb3J0IEluc3RhbmNlUmVnaXN0cnkgZnJvbSAnLi4vLi4vLi4vcGhldC1jb3JlL2pzL2RvY3VtZW50YXRpb24vSW5zdGFuY2VSZWdpc3RyeS5qcyc7XHJcbmltcG9ydCBvcHRpb25pemUgZnJvbSAnLi4vLi4vLi4vcGhldC1jb3JlL2pzL29wdGlvbml6ZS5qcyc7XHJcbmltcG9ydCBwdXNoQnV0dG9uU291bmRQbGF5ZXIgZnJvbSAnLi4vLi4vLi4vdGFtYm8vanMvc2hhcmVkLXNvdW5kLXBsYXllcnMvcHVzaEJ1dHRvblNvdW5kUGxheWVyLmpzJztcclxuaW1wb3J0IFRTb3VuZFBsYXllciBmcm9tICcuLi8uLi8uLi90YW1iby9qcy9UU291bmRQbGF5ZXIuanMnO1xyXG5pbXBvcnQgVGFuZGVtIGZyb20gJy4uLy4uLy4uL3RhbmRlbS9qcy9UYW5kZW0uanMnO1xyXG5pbXBvcnQgc3VuIGZyb20gJy4uL3N1bi5qcyc7XHJcbmltcG9ydCBQdXNoQnV0dG9uSW50ZXJhY3Rpb25TdGF0ZVByb3BlcnR5IGZyb20gJy4vUHVzaEJ1dHRvbkludGVyYWN0aW9uU3RhdGVQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBQdXNoQnV0dG9uTW9kZWwsIHsgUHVzaEJ1dHRvbkxpc3RlbmVyLCBQdXNoQnV0dG9uTW9kZWxPcHRpb25zIH0gZnJvbSAnLi9QdXNoQnV0dG9uTW9kZWwuanMnO1xyXG5pbXBvcnQgUmVjdGFuZ3VsYXJCdXR0b24sIHsgUmVjdGFuZ3VsYXJCdXR0b25PcHRpb25zIH0gZnJvbSAnLi9SZWN0YW5ndWxhckJ1dHRvbi5qcyc7XHJcblxyXG50eXBlIFNlbGZPcHRpb25zID0ge1xyXG4gIHNvdW5kUGxheWVyPzogVFNvdW5kUGxheWVyO1xyXG59O1xyXG5cclxuLy9UT0RPIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9zdW4vaXNzdWVzLzc0OSBMZXQncyBub3QgY3JlYXRlIFB1c2hCdXR0b25Nb2RlbCB3aXRoIHRoZXNlIG9wdGlvbnM/XHJcbnR5cGUgU3VwZXJPcHRpb25zID0gUmVjdGFuZ3VsYXJCdXR0b25PcHRpb25zICYgUHVzaEJ1dHRvbk1vZGVsT3B0aW9ucztcclxuXHJcbmV4cG9ydCB0eXBlIFJlY3Rhbmd1bGFyUHVzaEJ1dHRvbk9wdGlvbnMgPSBTZWxmT3B0aW9ucyAmIFN1cGVyT3B0aW9ucztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJlY3Rhbmd1bGFyUHVzaEJ1dHRvbiBleHRlbmRzIFJlY3Rhbmd1bGFyQnV0dG9uIHtcclxuXHJcbiAgLy8gUmVjdGFuZ3VsYXJCdXR0b24gaGFzIHRoaXMuYnV0dG9uTW9kZWwsIGJ1dCB3ZSBhbHNvIG5lZWQgdGhpcy5wdXNoQnV0dG9uTW9kZWwsIGJlY2F1c2UgaXQgaGFzIGFkZGl0aW9uYWwgbWV0aG9kc1xyXG4gIHByb3RlY3RlZCByZWFkb25seSBwdXNoQnV0dG9uTW9kZWw6IFB1c2hCdXR0b25Nb2RlbDtcclxuXHJcbiAgcHJpdmF0ZSByZWFkb25seSBkaXNwb3NlUmVjdGFuZ3VsYXJQdXNoQnV0dG9uOiAoKSA9PiB2b2lkO1xyXG5cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIHByb3ZpZGVkT3B0aW9ucz86IFJlY3Rhbmd1bGFyUHVzaEJ1dHRvbk9wdGlvbnMgKSB7XHJcblxyXG4gICAgY29uc3Qgb3B0aW9ucyA9IG9wdGlvbml6ZTxSZWN0YW5ndWxhclB1c2hCdXR0b25PcHRpb25zLCBTZWxmT3B0aW9ucywgU3VwZXJPcHRpb25zPigpKCB7XHJcbiAgICAgIHNvdW5kUGxheWVyOiBwdXNoQnV0dG9uU291bmRQbGF5ZXIsXHJcbiAgICAgIHRhbmRlbTogVGFuZGVtLlJFUVVJUkVEXHJcbiAgICB9LCBwcm92aWRlZE9wdGlvbnMgKTtcclxuXHJcbiAgICAvLyBTYXZlIHRoZSBsaXN0ZW5lciBhbmQgYWRkIGl0IGFmdGVyIGNyZWF0aW5nIHRoZSBidXR0b24gbW9kZWwuICBUaGlzIGlzIGRvbmUgc28gdGhhdFxyXG4gICAgLy8gdGhlIHNhbWUgY29kZSBwYXRoIGlzIGFsd2F5cyB1c2VkIGZvciBhZGRpbmcgbGlzdGVuZXIsIHRodXMgZ3VhcmFudGVlaW5nIGEgY29uc2lzdGVudCBjb2RlIHBhdGggaWYgYWRkTGlzdGVuZXIgaXNcclxuICAgIC8vIG92ZXJyaWRkZW4sIHNlZSBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMvc3VuL2lzc3Vlcy8yODQuXHJcbiAgICBjb25zdCBsaXN0ZW5lciA9IG9wdGlvbnMubGlzdGVuZXI7XHJcbiAgICBjb25zdCBzdXBlck9wdGlvbnMgPSBfLm9taXQoIG9wdGlvbnMsIFsgJ2xpc3RlbmVyJyBdICk7XHJcblxyXG4gICAgLy8gTm90ZSBpdCBzaGFyZXMgYSB0YW5kZW0gd2l0aCB0aGlzLCBzbyB0aGUgZW1pdHRlciB3aWxsIGJlIGluc3RydW1lbnRlZCBhcyBhIGNoaWxkIG9mIHRoZSBidXR0b25cclxuICAgIC8vVE9ETyBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMvc3VuL2lzc3Vlcy83NDkgaXRzIHN1cnByaXNpbmcgdGhhdCB3ZSBjYW4gcGFzcyBzdXBlck9wdGlvbnMgd2l0aCBpcnJlbGV2YW50IGZpZWxkcyB0byBQdXNoQnV0dG9uTW9kZWwgd2l0aG91dCBUUyBlcnJvcnNcclxuICAgIGNvbnN0IHB1c2hCdXR0b25Nb2RlbCA9IG5ldyBQdXNoQnV0dG9uTW9kZWwoIHN1cGVyT3B0aW9ucyApO1xyXG5cclxuICAgIHN1cGVyKCBwdXNoQnV0dG9uTW9kZWwsIG5ldyBQdXNoQnV0dG9uSW50ZXJhY3Rpb25TdGF0ZVByb3BlcnR5KCBwdXNoQnV0dG9uTW9kZWwgKSwgc3VwZXJPcHRpb25zICk7XHJcblxyXG4gICAgdGhpcy5wdXNoQnV0dG9uTW9kZWwgPSBwdXNoQnV0dG9uTW9kZWw7XHJcblxyXG4gICAgLy8gYWRkIHRoZSBsaXN0ZW5lciB0aGF0IHdhcyBwb3RlbnRpYWxseSBzYXZlZCBhYm92ZVxyXG4gICAgbGlzdGVuZXIgJiYgdGhpcy5hZGRMaXN0ZW5lciggbGlzdGVuZXIgKTtcclxuXHJcbiAgICAvLyBzb3VuZCBnZW5lcmF0aW9uXHJcbiAgICBjb25zdCBwbGF5U291bmQgPSAoKSA9PiB7IG9wdGlvbnMuc291bmRQbGF5ZXIucGxheSgpOyB9O1xyXG4gICAgcHVzaEJ1dHRvbk1vZGVsLnByb2R1Y2VTb3VuZEVtaXR0ZXIuYWRkTGlzdGVuZXIoIHBsYXlTb3VuZCApO1xyXG5cclxuICAgIHRoaXMuZGlzcG9zZVJlY3Rhbmd1bGFyUHVzaEJ1dHRvbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICBwdXNoQnV0dG9uTW9kZWwucHJvZHVjZVNvdW5kRW1pdHRlci5yZW1vdmVMaXN0ZW5lciggcGxheVNvdW5kICk7XHJcbiAgICAgIHB1c2hCdXR0b25Nb2RlbC5kaXNwb3NlKCk7IC8vVE9ETyB0aGlzIGZhaWxzIHdoZW4gYXNzZXJ0aW9ucyBhcmUgZW5hYmxlZCwgc2VlIHN1biMyMTJcclxuICAgIH07XHJcblxyXG4gICAgLy8gc3VwcG9ydCBmb3IgYmluZGVyIGRvY3VtZW50YXRpb24sIHN0cmlwcGVkIG91dCBpbiBidWlsZHMgYW5kIG9ubHkgcnVucyB3aGVuID9iaW5kZXIgaXMgc3BlY2lmaWVkXHJcbiAgICBhc3NlcnQgJiYgcGhldD8uY2hpcHBlcj8ucXVlcnlQYXJhbWV0ZXJzPy5iaW5kZXIgJiYgSW5zdGFuY2VSZWdpc3RyeS5yZWdpc3RlckRhdGFVUkwoICdzdW4nLCAnUmVjdGFuZ3VsYXJQdXNoQnV0dG9uJywgdGhpcyApO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIG92ZXJyaWRlIGRpc3Bvc2UoKTogdm9pZCB7XHJcblxyXG4gICAgLy8gVGhlIG9yZGVyIG9mIG9wZXJhdGlvbnMgaGVyZSBpcyBpbXBvcnRhbnQgLSB0aGUgdmlldyBuZWVkcyB0byBiZSBkaXNwb3NlZCBmaXJzdCBzbyB0aGF0IGl0IGlzIHVuaG9va2VkIGZyb21cclxuICAgIC8vIHRoZSBtb2RlbCBiZWZvcmUgdGhlIG1vZGVsIGlzIGRpc3Bvc2VkLiAgSWYgdGhlIG1vZGVsIGlzIGRpc3Bvc2VkIGZpcnN0LCB0aGUgdmlldyBlbmRzIHVwIHRyeWluZyB0byBjaGFuZ2Ugc29tZVxyXG4gICAgLy8gb2YgaXRzIFByb3BlcnR5IHZhbHVlcyB3aGVuIGl0IGlzIGRpc3Bvc2VkLiAgU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9heG9uL2lzc3Vlcy8yNDIuXHJcbiAgICBzdXBlci5kaXNwb3NlKCk7XHJcbiAgICB0aGlzLmRpc3Bvc2VSZWN0YW5ndWxhclB1c2hCdXR0b24oKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEFkZHMgYSBsaXN0ZW5lciB0aGF0IHdpbGwgYmUgbm90aWZpZWQgd2hlbiB0aGUgYnV0dG9uIGZpcmVzLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBhZGRMaXN0ZW5lciggbGlzdGVuZXI6IFB1c2hCdXR0b25MaXN0ZW5lciApOiB2b2lkIHtcclxuICAgIHRoaXMucHVzaEJ1dHRvbk1vZGVsLmFkZExpc3RlbmVyKCBsaXN0ZW5lciApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVtb3ZlcyBhIGxpc3RlbmVyLlxyXG4gICAqL1xyXG4gIHB1YmxpYyByZW1vdmVMaXN0ZW5lciggbGlzdGVuZXI6IFB1c2hCdXR0b25MaXN0ZW5lciApOiB2b2lkIHtcclxuICAgIHRoaXMucHVzaEJ1dHRvbk1vZGVsLnJlbW92ZUxpc3RlbmVyKCBsaXN0ZW5lciApO1xyXG4gIH1cclxufVxyXG5cclxuc3VuLnJlZ2lzdGVyKCAnUmVjdGFuZ3VsYXJQdXNoQnV0dG9uJywgUmVjdGFuZ3VsYXJQdXNoQnV0dG9uICk7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLGdCQUFnQixNQUFNLHlEQUF5RDtBQUN0RixPQUFPQyxTQUFTLE1BQU0sb0NBQW9DO0FBQzFELE9BQU9DLHFCQUFxQixNQUFNLGlFQUFpRTtBQUVuRyxPQUFPQyxNQUFNLE1BQU0sOEJBQThCO0FBQ2pELE9BQU9DLEdBQUcsTUFBTSxXQUFXO0FBQzNCLE9BQU9DLGtDQUFrQyxNQUFNLHlDQUF5QztBQUN4RixPQUFPQyxlQUFlLE1BQXNELHNCQUFzQjtBQUNsRyxPQUFPQyxpQkFBaUIsTUFBb0Msd0JBQXdCOztBQU1wRjs7QUFLQSxlQUFlLE1BQU1DLHFCQUFxQixTQUFTRCxpQkFBaUIsQ0FBQztFQUVuRTs7RUFLT0UsV0FBV0EsQ0FBRUMsZUFBOEMsRUFBRztJQUVuRSxNQUFNQyxPQUFPLEdBQUdWLFNBQVMsQ0FBMEQsQ0FBQyxDQUFFO01BQ3BGVyxXQUFXLEVBQUVWLHFCQUFxQjtNQUNsQ1csTUFBTSxFQUFFVixNQUFNLENBQUNXO0lBQ2pCLENBQUMsRUFBRUosZUFBZ0IsQ0FBQzs7SUFFcEI7SUFDQTtJQUNBO0lBQ0EsTUFBTUssUUFBUSxHQUFHSixPQUFPLENBQUNJLFFBQVE7SUFDakMsTUFBTUMsWUFBWSxHQUFHQyxDQUFDLENBQUNDLElBQUksQ0FBRVAsT0FBTyxFQUFFLENBQUUsVUFBVSxDQUFHLENBQUM7O0lBRXREO0lBQ0E7SUFDQSxNQUFNUSxlQUFlLEdBQUcsSUFBSWIsZUFBZSxDQUFFVSxZQUFhLENBQUM7SUFFM0QsS0FBSyxDQUFFRyxlQUFlLEVBQUUsSUFBSWQsa0NBQWtDLENBQUVjLGVBQWdCLENBQUMsRUFBRUgsWUFBYSxDQUFDO0lBRWpHLElBQUksQ0FBQ0csZUFBZSxHQUFHQSxlQUFlOztJQUV0QztJQUNBSixRQUFRLElBQUksSUFBSSxDQUFDSyxXQUFXLENBQUVMLFFBQVMsQ0FBQzs7SUFFeEM7SUFDQSxNQUFNTSxTQUFTLEdBQUdBLENBQUEsS0FBTTtNQUFFVixPQUFPLENBQUNDLFdBQVcsQ0FBQ1UsSUFBSSxDQUFDLENBQUM7SUFBRSxDQUFDO0lBQ3ZESCxlQUFlLENBQUNJLG1CQUFtQixDQUFDSCxXQUFXLENBQUVDLFNBQVUsQ0FBQztJQUU1RCxJQUFJLENBQUNHLDRCQUE0QixHQUFHLFlBQVc7TUFDN0NMLGVBQWUsQ0FBQ0ksbUJBQW1CLENBQUNFLGNBQWMsQ0FBRUosU0FBVSxDQUFDO01BQy9ERixlQUFlLENBQUNPLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUM3QixDQUFDOztJQUVEO0lBQ0FDLE1BQU0sSUFBSUMsSUFBSSxFQUFFQyxPQUFPLEVBQUVDLGVBQWUsRUFBRUMsTUFBTSxJQUFJL0IsZ0JBQWdCLENBQUNnQyxlQUFlLENBQUUsS0FBSyxFQUFFLHVCQUF1QixFQUFFLElBQUssQ0FBQztFQUM5SDtFQUVnQk4sT0FBT0EsQ0FBQSxFQUFTO0lBRTlCO0lBQ0E7SUFDQTtJQUNBLEtBQUssQ0FBQ0EsT0FBTyxDQUFDLENBQUM7SUFDZixJQUFJLENBQUNGLDRCQUE0QixDQUFDLENBQUM7RUFDckM7O0VBRUE7QUFDRjtBQUNBO0VBQ1NKLFdBQVdBLENBQUVMLFFBQTRCLEVBQVM7SUFDdkQsSUFBSSxDQUFDSSxlQUFlLENBQUNDLFdBQVcsQ0FBRUwsUUFBUyxDQUFDO0VBQzlDOztFQUVBO0FBQ0Y7QUFDQTtFQUNTVSxjQUFjQSxDQUFFVixRQUE0QixFQUFTO0lBQzFELElBQUksQ0FBQ0ksZUFBZSxDQUFDTSxjQUFjLENBQUVWLFFBQVMsQ0FBQztFQUNqRDtBQUNGO0FBRUFYLEdBQUcsQ0FBQzZCLFFBQVEsQ0FBRSx1QkFBdUIsRUFBRXpCLHFCQUFzQixDQUFDIiwiaWdub3JlTGlzdCI6W119