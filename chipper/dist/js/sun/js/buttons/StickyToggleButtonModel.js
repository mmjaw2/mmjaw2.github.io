// Copyright 2014-2024, University of Colorado Boulder

/**
 * Model for a toggle button that sticks when pushed down and pops up when pushed a second time. Unlike other general
 * sun models, 'sticky' implies a specific type of user-interface component, a button that is either popped up or
 * pressed down.
 *
 * @author Sam Reid (PhET Interactive Simulations)
 * @author John Blanco (PhET Interactive Simulations)
 */

import BooleanProperty from '../../../axon/js/BooleanProperty.js';
import Emitter from '../../../axon/js/Emitter.js';
import optionize from '../../../phet-core/js/optionize.js';
import EventType from '../../../tandem/js/EventType.js';
import Tandem from '../../../tandem/js/Tandem.js';
import sun from '../sun.js';
import ButtonModel from './ButtonModel.js';
export default class StickyToggleButtonModel extends ButtonModel {
  /**
   * @param valueUp - value when the toggle is in the 'up' position
   * @param valueDown - value when the toggle is in the 'down' position
   * @param valueProperty - axon Property that can be either valueUp or valueDown.
   *   Would have preferred to call this `property` but it would clash with the Property function name.
   * @param providedOptions
   */
  constructor(valueUp, valueDown, valueProperty, providedOptions) {
    assert && assert(valueProperty.valueComparisonStrategy === 'reference', 'StickyToggleButtonModel depends on "===" equality for value comparison');
    const options = optionize()({
      tandem: Tandem.REQUIRED
    }, providedOptions);
    super(options);
    this.valueUp = valueUp;
    this.valueDown = valueDown;
    this.valueProperty = valueProperty;
    this.toggledEmitter = new Emitter({
      tandem: options.tandem.createTandem('toggledEmitter'),
      phetioDocumentation: 'Emits when the button is toggled',
      phetioEventType: EventType.USER
    });
    this.toggledEmitter.addListener(() => {
      assert && assert(this.valueProperty.value === this.valueUp || this.valueProperty.value === this.valueDown, `unrecognized value: ${this.valueProperty.value}`);
      this.valueProperty.value = this.valueProperty.value === this.valueUp ? this.valueDown : this.valueUp;
    });

    // When the user releases the toggle button, it should only fire an event if it is not during the same action in
    // which they pressed the button.  Track the state to see if they have already pushed the button.
    // Note: Does this need to be reset when the simulation does "reset all"?  I (Sam Reid) can't find any negative
    // consequences in the user interface of not resetting it, but maybe I missed something. Or maybe it would be safe
    // to reset it anyway.
    this.pressedWhileDownProperty = new BooleanProperty(false);

    // If the button is up and the user presses it, show it pressed and toggle the state right away.  When the button is
    // released, pop up the button (unless it was part of the same action that pressed the button down in the first
    // place).
    const downListener = down => {
      const overOrFocused = this.overProperty.get() || this.focusedProperty.get();
      if (this.enabledProperty.get() && overOrFocused && !this.interrupted) {
        if (down && valueProperty.value === valueUp) {
          this.toggle();
          this.pressedWhileDownProperty.set(false);
        }
        if (!down && valueProperty.value === valueDown) {
          if (this.pressedWhileDownProperty.get()) {
            this.toggle();
          } else {
            this.pressedWhileDownProperty.set(true);
          }
        }
      }

      // Handle the case where the pointer moved out then up over a toggle button, so it will respond to the next press
      if (!down && !overOrFocused) {
        this.pressedWhileDownProperty.set(true);
      }
    };
    this.downProperty.link(downListener);

    // if the valueProperty is set externally to user interaction, update the buttonModel
    // downProperty so the model stays in sync
    const valuePropertyListener = value => {
      this.downProperty.set(value === valueDown);
    };
    valueProperty.link(valuePropertyListener);

    // make the button ready to toggle when enabled
    const enabledPropertyOnListener = enabled => {
      if (enabled) {
        this.pressedWhileDownProperty.set(true);
      }
    };
    this.enabledProperty.link(enabledPropertyOnListener);
    this.disposeToggleButtonModel = () => {
      this.downProperty.unlink(downListener);
      this.enabledProperty.unlink(enabledPropertyOnListener);
      valueProperty.unlink(valuePropertyListener);
      this.toggledEmitter.dispose();
    };
  }
  dispose() {
    this.disposeToggleButtonModel();
    super.dispose();
  }
  toggle() {
    this.toggledEmitter.emit();
    this.produceSoundEmitter.emit();
  }
}
sun.register('StickyToggleButtonModel', StickyToggleButtonModel);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJCb29sZWFuUHJvcGVydHkiLCJFbWl0dGVyIiwib3B0aW9uaXplIiwiRXZlbnRUeXBlIiwiVGFuZGVtIiwic3VuIiwiQnV0dG9uTW9kZWwiLCJTdGlja3lUb2dnbGVCdXR0b25Nb2RlbCIsImNvbnN0cnVjdG9yIiwidmFsdWVVcCIsInZhbHVlRG93biIsInZhbHVlUHJvcGVydHkiLCJwcm92aWRlZE9wdGlvbnMiLCJhc3NlcnQiLCJ2YWx1ZUNvbXBhcmlzb25TdHJhdGVneSIsIm9wdGlvbnMiLCJ0YW5kZW0iLCJSRVFVSVJFRCIsInRvZ2dsZWRFbWl0dGVyIiwiY3JlYXRlVGFuZGVtIiwicGhldGlvRG9jdW1lbnRhdGlvbiIsInBoZXRpb0V2ZW50VHlwZSIsIlVTRVIiLCJhZGRMaXN0ZW5lciIsInZhbHVlIiwicHJlc3NlZFdoaWxlRG93blByb3BlcnR5IiwiZG93bkxpc3RlbmVyIiwiZG93biIsIm92ZXJPckZvY3VzZWQiLCJvdmVyUHJvcGVydHkiLCJnZXQiLCJmb2N1c2VkUHJvcGVydHkiLCJlbmFibGVkUHJvcGVydHkiLCJpbnRlcnJ1cHRlZCIsInRvZ2dsZSIsInNldCIsImRvd25Qcm9wZXJ0eSIsImxpbmsiLCJ2YWx1ZVByb3BlcnR5TGlzdGVuZXIiLCJlbmFibGVkUHJvcGVydHlPbkxpc3RlbmVyIiwiZW5hYmxlZCIsImRpc3Bvc2VUb2dnbGVCdXR0b25Nb2RlbCIsInVubGluayIsImRpc3Bvc2UiLCJlbWl0IiwicHJvZHVjZVNvdW5kRW1pdHRlciIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiU3RpY2t5VG9nZ2xlQnV0dG9uTW9kZWwudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTQtMjAyNCwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogTW9kZWwgZm9yIGEgdG9nZ2xlIGJ1dHRvbiB0aGF0IHN0aWNrcyB3aGVuIHB1c2hlZCBkb3duIGFuZCBwb3BzIHVwIHdoZW4gcHVzaGVkIGEgc2Vjb25kIHRpbWUuIFVubGlrZSBvdGhlciBnZW5lcmFsXHJcbiAqIHN1biBtb2RlbHMsICdzdGlja3knIGltcGxpZXMgYSBzcGVjaWZpYyB0eXBlIG9mIHVzZXItaW50ZXJmYWNlIGNvbXBvbmVudCwgYSBidXR0b24gdGhhdCBpcyBlaXRoZXIgcG9wcGVkIHVwIG9yXHJcbiAqIHByZXNzZWQgZG93bi5cclxuICpcclxuICogQGF1dGhvciBTYW0gUmVpZCAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICogQGF1dGhvciBKb2huIEJsYW5jbyAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcblxyXG5pbXBvcnQgQm9vbGVhblByb3BlcnR5IGZyb20gJy4uLy4uLy4uL2F4b24vanMvQm9vbGVhblByb3BlcnR5LmpzJztcclxuaW1wb3J0IEVtaXR0ZXIgZnJvbSAnLi4vLi4vLi4vYXhvbi9qcy9FbWl0dGVyLmpzJztcclxuaW1wb3J0IFRFbWl0dGVyIGZyb20gJy4uLy4uLy4uL2F4b24vanMvVEVtaXR0ZXIuanMnO1xyXG5pbXBvcnQgVFByb3BlcnR5IGZyb20gJy4uLy4uLy4uL2F4b24vanMvVFByb3BlcnR5LmpzJztcclxuaW1wb3J0IG9wdGlvbml6ZSwgeyBFbXB0eVNlbGZPcHRpb25zIH0gZnJvbSAnLi4vLi4vLi4vcGhldC1jb3JlL2pzL29wdGlvbml6ZS5qcyc7XHJcbmltcG9ydCBFdmVudFR5cGUgZnJvbSAnLi4vLi4vLi4vdGFuZGVtL2pzL0V2ZW50VHlwZS5qcyc7XHJcbmltcG9ydCBUYW5kZW0gZnJvbSAnLi4vLi4vLi4vdGFuZGVtL2pzL1RhbmRlbS5qcyc7XHJcbmltcG9ydCBzdW4gZnJvbSAnLi4vc3VuLmpzJztcclxuaW1wb3J0IEJ1dHRvbk1vZGVsLCB7IEJ1dHRvbk1vZGVsT3B0aW9ucyB9IGZyb20gJy4vQnV0dG9uTW9kZWwuanMnO1xyXG5cclxudHlwZSBTZWxmT3B0aW9ucyA9IEVtcHR5U2VsZk9wdGlvbnM7XHJcblxyXG5leHBvcnQgdHlwZSBTdGlja3lUb2dnbGVCdXR0b25Nb2RlbE9wdGlvbnMgPSBTZWxmT3B0aW9ucyAmIEJ1dHRvbk1vZGVsT3B0aW9ucztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFN0aWNreVRvZ2dsZUJ1dHRvbk1vZGVsPFQ+IGV4dGVuZHMgQnV0dG9uTW9kZWwge1xyXG5cclxuICBwdWJsaWMgcmVhZG9ubHkgdmFsdWVQcm9wZXJ0eTogVFByb3BlcnR5PFQ+O1xyXG4gIHB1YmxpYyByZWFkb25seSB2YWx1ZVVwOiBUO1xyXG4gIHB1YmxpYyByZWFkb25seSB2YWx1ZURvd246IFQ7XHJcblxyXG4gIHByaXZhdGUgcmVhZG9ubHkgdG9nZ2xlZEVtaXR0ZXI6IFRFbWl0dGVyO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgcHJlc3NlZFdoaWxlRG93blByb3BlcnR5OiBUUHJvcGVydHk8Ym9vbGVhbj47XHJcbiAgcHJpdmF0ZSByZWFkb25seSBkaXNwb3NlVG9nZ2xlQnV0dG9uTW9kZWw6ICgpID0+IHZvaWQ7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB2YWx1ZVVwIC0gdmFsdWUgd2hlbiB0aGUgdG9nZ2xlIGlzIGluIHRoZSAndXAnIHBvc2l0aW9uXHJcbiAgICogQHBhcmFtIHZhbHVlRG93biAtIHZhbHVlIHdoZW4gdGhlIHRvZ2dsZSBpcyBpbiB0aGUgJ2Rvd24nIHBvc2l0aW9uXHJcbiAgICogQHBhcmFtIHZhbHVlUHJvcGVydHkgLSBheG9uIFByb3BlcnR5IHRoYXQgY2FuIGJlIGVpdGhlciB2YWx1ZVVwIG9yIHZhbHVlRG93bi5cclxuICAgKiAgIFdvdWxkIGhhdmUgcHJlZmVycmVkIHRvIGNhbGwgdGhpcyBgcHJvcGVydHlgIGJ1dCBpdCB3b3VsZCBjbGFzaCB3aXRoIHRoZSBQcm9wZXJ0eSBmdW5jdGlvbiBuYW1lLlxyXG4gICAqIEBwYXJhbSBwcm92aWRlZE9wdGlvbnNcclxuICAgKi9cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIHZhbHVlVXA6IFQsIHZhbHVlRG93bjogVCwgdmFsdWVQcm9wZXJ0eTogVFByb3BlcnR5PFQ+LCBwcm92aWRlZE9wdGlvbnM/OiBTdGlja3lUb2dnbGVCdXR0b25Nb2RlbE9wdGlvbnMgKSB7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCB2YWx1ZVByb3BlcnR5LnZhbHVlQ29tcGFyaXNvblN0cmF0ZWd5ID09PSAncmVmZXJlbmNlJyxcclxuICAgICAgJ1N0aWNreVRvZ2dsZUJ1dHRvbk1vZGVsIGRlcGVuZHMgb24gXCI9PT1cIiBlcXVhbGl0eSBmb3IgdmFsdWUgY29tcGFyaXNvbicgKTtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0gb3B0aW9uaXplPFN0aWNreVRvZ2dsZUJ1dHRvbk1vZGVsT3B0aW9ucywgU2VsZk9wdGlvbnMsIEJ1dHRvbk1vZGVsT3B0aW9ucz4oKSgge1xyXG4gICAgICB0YW5kZW06IFRhbmRlbS5SRVFVSVJFRFxyXG4gICAgfSwgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgc3VwZXIoIG9wdGlvbnMgKTtcclxuXHJcbiAgICB0aGlzLnZhbHVlVXAgPSB2YWx1ZVVwO1xyXG4gICAgdGhpcy52YWx1ZURvd24gPSB2YWx1ZURvd247XHJcbiAgICB0aGlzLnZhbHVlUHJvcGVydHkgPSB2YWx1ZVByb3BlcnR5O1xyXG5cclxuICAgIHRoaXMudG9nZ2xlZEVtaXR0ZXIgPSBuZXcgRW1pdHRlcigge1xyXG4gICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ3RvZ2dsZWRFbWl0dGVyJyApLFxyXG4gICAgICBwaGV0aW9Eb2N1bWVudGF0aW9uOiAnRW1pdHMgd2hlbiB0aGUgYnV0dG9uIGlzIHRvZ2dsZWQnLFxyXG4gICAgICBwaGV0aW9FdmVudFR5cGU6IEV2ZW50VHlwZS5VU0VSXHJcbiAgICB9ICk7XHJcblxyXG4gICAgdGhpcy50b2dnbGVkRW1pdHRlci5hZGRMaXN0ZW5lciggKCkgPT4ge1xyXG4gICAgICBhc3NlcnQgJiYgYXNzZXJ0KCB0aGlzLnZhbHVlUHJvcGVydHkudmFsdWUgPT09IHRoaXMudmFsdWVVcCB8fCB0aGlzLnZhbHVlUHJvcGVydHkudmFsdWUgPT09IHRoaXMudmFsdWVEb3duLFxyXG4gICAgICAgIGB1bnJlY29nbml6ZWQgdmFsdWU6ICR7dGhpcy52YWx1ZVByb3BlcnR5LnZhbHVlfWAgKTtcclxuICAgICAgdGhpcy52YWx1ZVByb3BlcnR5LnZhbHVlID0gdGhpcy52YWx1ZVByb3BlcnR5LnZhbHVlID09PSB0aGlzLnZhbHVlVXAgPyB0aGlzLnZhbHVlRG93biA6IHRoaXMudmFsdWVVcDtcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBXaGVuIHRoZSB1c2VyIHJlbGVhc2VzIHRoZSB0b2dnbGUgYnV0dG9uLCBpdCBzaG91bGQgb25seSBmaXJlIGFuIGV2ZW50IGlmIGl0IGlzIG5vdCBkdXJpbmcgdGhlIHNhbWUgYWN0aW9uIGluXHJcbiAgICAvLyB3aGljaCB0aGV5IHByZXNzZWQgdGhlIGJ1dHRvbi4gIFRyYWNrIHRoZSBzdGF0ZSB0byBzZWUgaWYgdGhleSBoYXZlIGFscmVhZHkgcHVzaGVkIHRoZSBidXR0b24uXHJcbiAgICAvLyBOb3RlOiBEb2VzIHRoaXMgbmVlZCB0byBiZSByZXNldCB3aGVuIHRoZSBzaW11bGF0aW9uIGRvZXMgXCJyZXNldCBhbGxcIj8gIEkgKFNhbSBSZWlkKSBjYW4ndCBmaW5kIGFueSBuZWdhdGl2ZVxyXG4gICAgLy8gY29uc2VxdWVuY2VzIGluIHRoZSB1c2VyIGludGVyZmFjZSBvZiBub3QgcmVzZXR0aW5nIGl0LCBidXQgbWF5YmUgSSBtaXNzZWQgc29tZXRoaW5nLiBPciBtYXliZSBpdCB3b3VsZCBiZSBzYWZlXHJcbiAgICAvLyB0byByZXNldCBpdCBhbnl3YXkuXHJcbiAgICB0aGlzLnByZXNzZWRXaGlsZURvd25Qcm9wZXJ0eSA9IG5ldyBCb29sZWFuUHJvcGVydHkoIGZhbHNlICk7XHJcblxyXG4gICAgLy8gSWYgdGhlIGJ1dHRvbiBpcyB1cCBhbmQgdGhlIHVzZXIgcHJlc3NlcyBpdCwgc2hvdyBpdCBwcmVzc2VkIGFuZCB0b2dnbGUgdGhlIHN0YXRlIHJpZ2h0IGF3YXkuICBXaGVuIHRoZSBidXR0b24gaXNcclxuICAgIC8vIHJlbGVhc2VkLCBwb3AgdXAgdGhlIGJ1dHRvbiAodW5sZXNzIGl0IHdhcyBwYXJ0IG9mIHRoZSBzYW1lIGFjdGlvbiB0aGF0IHByZXNzZWQgdGhlIGJ1dHRvbiBkb3duIGluIHRoZSBmaXJzdFxyXG4gICAgLy8gcGxhY2UpLlxyXG4gICAgY29uc3QgZG93bkxpc3RlbmVyID0gKCBkb3duOiBib29sZWFuICkgPT4ge1xyXG4gICAgICBjb25zdCBvdmVyT3JGb2N1c2VkID0gdGhpcy5vdmVyUHJvcGVydHkuZ2V0KCkgfHwgdGhpcy5mb2N1c2VkUHJvcGVydHkuZ2V0KCk7XHJcbiAgICAgIGlmICggdGhpcy5lbmFibGVkUHJvcGVydHkuZ2V0KCkgJiYgb3Zlck9yRm9jdXNlZCAmJiAhdGhpcy5pbnRlcnJ1cHRlZCApIHtcclxuICAgICAgICBpZiAoIGRvd24gJiYgdmFsdWVQcm9wZXJ0eS52YWx1ZSA9PT0gdmFsdWVVcCApIHtcclxuICAgICAgICAgIHRoaXMudG9nZ2xlKCk7XHJcbiAgICAgICAgICB0aGlzLnByZXNzZWRXaGlsZURvd25Qcm9wZXJ0eS5zZXQoIGZhbHNlICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICggIWRvd24gJiYgdmFsdWVQcm9wZXJ0eS52YWx1ZSA9PT0gdmFsdWVEb3duICkge1xyXG4gICAgICAgICAgaWYgKCB0aGlzLnByZXNzZWRXaGlsZURvd25Qcm9wZXJ0eS5nZXQoKSApIHtcclxuICAgICAgICAgICAgdGhpcy50b2dnbGUoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnByZXNzZWRXaGlsZURvd25Qcm9wZXJ0eS5zZXQoIHRydWUgKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIEhhbmRsZSB0aGUgY2FzZSB3aGVyZSB0aGUgcG9pbnRlciBtb3ZlZCBvdXQgdGhlbiB1cCBvdmVyIGEgdG9nZ2xlIGJ1dHRvbiwgc28gaXQgd2lsbCByZXNwb25kIHRvIHRoZSBuZXh0IHByZXNzXHJcbiAgICAgIGlmICggIWRvd24gJiYgIW92ZXJPckZvY3VzZWQgKSB7XHJcbiAgICAgICAgdGhpcy5wcmVzc2VkV2hpbGVEb3duUHJvcGVydHkuc2V0KCB0cnVlICk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5kb3duUHJvcGVydHkubGluayggZG93bkxpc3RlbmVyICk7XHJcblxyXG4gICAgLy8gaWYgdGhlIHZhbHVlUHJvcGVydHkgaXMgc2V0IGV4dGVybmFsbHkgdG8gdXNlciBpbnRlcmFjdGlvbiwgdXBkYXRlIHRoZSBidXR0b25Nb2RlbFxyXG4gICAgLy8gZG93blByb3BlcnR5IHNvIHRoZSBtb2RlbCBzdGF5cyBpbiBzeW5jXHJcbiAgICBjb25zdCB2YWx1ZVByb3BlcnR5TGlzdGVuZXIgPSAoIHZhbHVlOiBUICkgPT4ge1xyXG4gICAgICB0aGlzLmRvd25Qcm9wZXJ0eS5zZXQoIHZhbHVlID09PSB2YWx1ZURvd24gKTtcclxuICAgIH07XHJcbiAgICB2YWx1ZVByb3BlcnR5LmxpbmsoIHZhbHVlUHJvcGVydHlMaXN0ZW5lciApO1xyXG5cclxuICAgIC8vIG1ha2UgdGhlIGJ1dHRvbiByZWFkeSB0byB0b2dnbGUgd2hlbiBlbmFibGVkXHJcbiAgICBjb25zdCBlbmFibGVkUHJvcGVydHlPbkxpc3RlbmVyID0gKCBlbmFibGVkOiBib29sZWFuICkgPT4ge1xyXG4gICAgICBpZiAoIGVuYWJsZWQgKSB7XHJcbiAgICAgICAgdGhpcy5wcmVzc2VkV2hpbGVEb3duUHJvcGVydHkuc2V0KCB0cnVlICk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgICB0aGlzLmVuYWJsZWRQcm9wZXJ0eS5saW5rKCBlbmFibGVkUHJvcGVydHlPbkxpc3RlbmVyICk7XHJcblxyXG4gICAgdGhpcy5kaXNwb3NlVG9nZ2xlQnV0dG9uTW9kZWwgPSAoKSA9PiB7XHJcbiAgICAgIHRoaXMuZG93blByb3BlcnR5LnVubGluayggZG93bkxpc3RlbmVyICk7XHJcbiAgICAgIHRoaXMuZW5hYmxlZFByb3BlcnR5LnVubGluayggZW5hYmxlZFByb3BlcnR5T25MaXN0ZW5lciApO1xyXG4gICAgICB2YWx1ZVByb3BlcnR5LnVubGluayggdmFsdWVQcm9wZXJ0eUxpc3RlbmVyICk7XHJcbiAgICAgIHRoaXMudG9nZ2xlZEVtaXR0ZXIuZGlzcG9zZSgpO1xyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBvdmVycmlkZSBkaXNwb3NlKCk6IHZvaWQge1xyXG4gICAgdGhpcy5kaXNwb3NlVG9nZ2xlQnV0dG9uTW9kZWwoKTtcclxuICAgIHN1cGVyLmRpc3Bvc2UoKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgdG9nZ2xlKCk6IHZvaWQge1xyXG4gICAgdGhpcy50b2dnbGVkRW1pdHRlci5lbWl0KCk7XHJcbiAgICB0aGlzLnByb2R1Y2VTb3VuZEVtaXR0ZXIuZW1pdCgpO1xyXG4gIH1cclxufVxyXG5cclxuc3VuLnJlZ2lzdGVyKCAnU3RpY2t5VG9nZ2xlQnV0dG9uTW9kZWwnLCBTdGlja3lUb2dnbGVCdXR0b25Nb2RlbCApOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxlQUFlLE1BQU0scUNBQXFDO0FBQ2pFLE9BQU9DLE9BQU8sTUFBTSw2QkFBNkI7QUFHakQsT0FBT0MsU0FBUyxNQUE0QixvQ0FBb0M7QUFDaEYsT0FBT0MsU0FBUyxNQUFNLGlDQUFpQztBQUN2RCxPQUFPQyxNQUFNLE1BQU0sOEJBQThCO0FBQ2pELE9BQU9DLEdBQUcsTUFBTSxXQUFXO0FBQzNCLE9BQU9DLFdBQVcsTUFBOEIsa0JBQWtCO0FBTWxFLGVBQWUsTUFBTUMsdUJBQXVCLFNBQVlELFdBQVcsQ0FBQztFQVVsRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtFQUNTRSxXQUFXQSxDQUFFQyxPQUFVLEVBQUVD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