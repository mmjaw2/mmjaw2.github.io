// Copyright 2014-2024, University of Colorado Boulder

/**
 * RoundButton is the base class for round buttons.
 *
 * @author John Blanco (PhET Interactive Simulations)
 * @author Sam Reid (PhET Interactive Simulations)
 */

import DerivedProperty from '../../../axon/js/DerivedProperty.js';
import { Shape } from '../../../kite/js/imports.js';
import optionize from '../../../phet-core/js/optionize.js';
import { Circle, Node, PaintColorProperty, RadialGradient } from '../../../scenery/js/imports.js';
import sun from '../sun.js';
import ButtonInteractionState from './ButtonInteractionState.js';
import ButtonNode from './ButtonNode.js';
// constants
const HIGHLIGHT_GRADIENT_LENGTH = 5; // In screen coords, which are roughly pixels.

export default class RoundButton extends ButtonNode {
  constructor(buttonModel, interactionStateProperty, providedOptions) {
    const options = optionize()({
      // SelfOptions
      radius: providedOptions && providedOptions.content ? null : 30,
      lineWidth: 0.5,
      // Only meaningful if stroke is non-null
      stroke: null,
      touchAreaDilation: 0,
      mouseAreaDilation: 0,
      touchAreaXShift: 0,
      touchAreaYShift: 0,
      mouseAreaXShift: 0,
      mouseAreaYShift: 0,
      aspectRatio: 1,
      // This will keep the minimum width and height the same, so our bounding box will be square

      // ButtonNodeOptions
      cursor: 'pointer',
      // If these are not the same, the larger one will be used to calculate the size of the button
      xMargin: 5,
      // Minimum margin in x direction, i.e. on left and right
      yMargin: 5,
      // Minimum margin in y direction, i.e. on top and bottom

      // Class that determines the button's appearance for the values of interactionStateProperty.
      // See RoundButton.ThreeDAppearanceStrategy for an example of the interface required.
      buttonAppearanceStrategy: RoundButton.ThreeDAppearanceStrategy
    }, providedOptions);
    if (!options.content) {
      assert && assert(typeof options.radius === 'number', `invalid radius: ${options.radius}`);
    }
    if (options.radius) {
      assert && assert(options.xMargin < options.radius, 'xMargin cannot be larger than radius');
      assert && assert(options.yMargin < options.radius, 'yMargin cannot be larger than radius');
      options.minUnstrokedWidth = options.radius * 2;
      options.minUnstrokedHeight = options.radius * 2;
    }

    // If no options were explicitly passed in for the button appearance strategy, pass through the general appearance
    // options.
    if (!options.buttonAppearanceStrategyOptions) {
      options.buttonAppearanceStrategyOptions = {
        stroke: options.stroke,
        lineWidth: options.lineWidth
      };
    }

    // Compute the radius of the button. radius will not be falsey if content is also falsey
    const buttonRadius = options.radius || Math.max(options.content.width + options.xMargin * 2, options.content.height + options.yMargin * 2) / 2;
    if (options.content && options.radius) {
      const previousContent = options.content;
      const minScale = Math.min((options.radius - options.xMargin) * 2 / previousContent.width, (options.radius - options.yMargin) * 2 / previousContent.height);
      options.content = new Node({
        children: [previousContent],
        scale: minScale
      });
    }

    // Create the circular part of the button.
    const buttonBackground = new Circle(buttonRadius);
    super(buttonModel, buttonBackground, interactionStateProperty, options);

    // Get the actual button radius after calling super, so that buttonAppearanceStrategy has applied the stroke.
    // This accounts for stroke + lineWidth, which is important when setting pointer areas and focus highlight.
    // See https://github.com/phetsims/sun/issues/660
    const buttonBackgroundRadius = buttonBackground.localBounds.width / 2;

    // Set pointer areas.
    this.touchArea = Shape.circle(options.touchAreaXShift, options.touchAreaYShift, buttonBackgroundRadius + options.touchAreaDilation);
    this.mouseArea = Shape.circle(options.mouseAreaXShift, options.mouseAreaYShift, buttonBackgroundRadius + options.mouseAreaDilation);

    // pdom - focus highlight is circular for round buttons, with a little bit of padding
    // between button shape and inner edge of highlight
    this.focusHighlight = Shape.circle(0, 0, buttonBackgroundRadius + 5);
  }
}

/**
 * ThreeDAppearanceStrategy is a value for RoundButton options.buttonAppearanceStrategy. It makes a round button
 * look 3D-ish by using gradients that create the appearance of highlighted and shaded edges. The gradients are
 * set up to make the light source appear to be in the upper left.
 */
export class ThreeDAppearanceStrategy {
  /**
   * @param buttonBackground - the Node for the button's background, sans content
   * @param interactionStateProperty
   * @param baseColorProperty
   * @param [providedOptions]
   */
  constructor(buttonBackground, interactionStateProperty, baseColorProperty, providedOptions) {
    // If stroke and lineWidth exist in the provided options, they become the default for all strokes and line widths.
    // If not, defaults are created.
    const defaultStroke = providedOptions && providedOptions.stroke ? providedOptions.stroke : new PaintColorProperty(baseColorProperty, {
      luminanceFactor: -0.4
    });
    const defaultLineWidth = providedOptions && providedOptions.lineWidth !== undefined ? providedOptions.lineWidth : 0.3;
    const options = optionize()({
      stroke: defaultStroke,
      lineWidth: defaultLineWidth,
      overStroke: defaultStroke,
      overLineWidth: defaultLineWidth,
      overButtonOpacity: 1,
      selectedStroke: defaultStroke,
      selectedLineWidth: defaultLineWidth,
      selectedButtonOpacity: 1,
      deselectedStroke: defaultStroke,
      deselectedLineWidth: defaultLineWidth,
      deselectedButtonOpacity: 1,
      overFill: baseColorProperty
    }, providedOptions);

    // Dynamic colors
    const baseBrighter8Property = new PaintColorProperty(baseColorProperty, {
      luminanceFactor: 0.8
    });
    const baseBrighter7Property = new PaintColorProperty(baseColorProperty, {
      luminanceFactor: 0.7
    });
    const baseBrighter3Property = new PaintColorProperty(baseColorProperty, {
      luminanceFactor: 0.3
    });
    const baseDarker1Property = new PaintColorProperty(baseColorProperty, {
      luminanceFactor: -0.1
    });
    const baseDarker2Property = new PaintColorProperty(baseColorProperty, {
      luminanceFactor: -0.2
    });
    const baseDarker4Property = new PaintColorProperty(baseColorProperty, {
      luminanceFactor: -0.4
    });
    const baseDarker5Property = new PaintColorProperty(baseColorProperty, {
      luminanceFactor: -0.5
    });
    const baseTransparentProperty = new DerivedProperty([baseColorProperty], color => color.withAlpha(0));

    // Set up variables needed to create the various gradient fills and otherwise modify the appearance
    const buttonRadius = buttonBackground.width / 2;
    const innerGradientRadius = buttonRadius - HIGHLIGHT_GRADIENT_LENGTH / 2;
    const outerGradientRadius = buttonRadius + HIGHLIGHT_GRADIENT_LENGTH / 2;
    const gradientOffset = HIGHLIGHT_GRADIENT_LENGTH / 2;
    const upFillHighlight = new RadialGradient(gradientOffset, gradientOffset, innerGradientRadius, gradientOffset, gradientOffset, outerGradientRadius).addColorStop(0, baseColorProperty).addColorStop(1, baseBrighter7Property);
    const upFillShadow = new RadialGradient(-gradientOffset, -gradientOffset, innerGradientRadius, -gradientOffset, -gradientOffset, outerGradientRadius).addColorStop(0, baseTransparentProperty).addColorStop(1, baseDarker5Property);
    const overFillHighlight = new RadialGradient(gradientOffset, gradientOffset, innerGradientRadius, gradientOffset, gradientOffset, outerGradientRadius).addColorStop(0, baseBrighter3Property).addColorStop(1, baseBrighter8Property);
    const overFillShadow = new RadialGradient(-gradientOffset, -gradientOffset, innerGradientRadius, -gradientOffset, -gradientOffset, outerGradientRadius).addColorStop(0, baseTransparentProperty).addColorStop(1, baseDarker5Property);
    const pressedFill = new RadialGradient(-gradientOffset, -gradientOffset, 0, 0, 0, outerGradientRadius).addColorStop(0, baseDarker1Property).addColorStop(0.6, baseDarker2Property).addColorStop(0.8, baseColorProperty).addColorStop(1, baseBrighter8Property);

    // Create and add the overlay that is used to add shading.
    const shadowNode = new Circle(buttonRadius, {
      stroke: !options.stroke ? baseDarker4Property : options.stroke,
      lineWidth: options.lineWidth,
      pickable: false
    });
    buttonBackground.addChild(shadowNode);
    this.maxLineWidth = shadowNode.hasStroke() && options && typeof options.lineWidth === 'number' ? options.lineWidth : 0;

    // Cache gradients
    buttonBackground.cachedPaints = [upFillHighlight, overFillHighlight, pressedFill];
    shadowNode.cachedPaints = [upFillShadow, overFillShadow];

    // Change colors to match interactionState
    function interactionStateListener(interactionState) {
      switch (interactionState) {
        case ButtonInteractionState.IDLE:
          buttonBackground.fill = upFillHighlight;
          buttonBackground.stroke = options.deselectedStroke;
          buttonBackground.lineWidth = options.deselectedLineWidth;
          buttonBackground.opacity = options.deselectedButtonOpacity;
          shadowNode.fill = upFillShadow;
          shadowNode.opacity = options.deselectedButtonOpacity;
          break;
        case ButtonInteractionState.OVER:
          buttonBackground.fill = overFillHighlight;
          buttonBackground.stroke = options.overStroke;
          buttonBackground.lineWidth = options.overLineWidth;
          buttonBackground.opacity = options.overButtonOpacity;
          shadowNode.fill = overFillShadow;
          shadowNode.opacity = options.overButtonOpacity;
          break;
        case ButtonInteractionState.PRESSED:
          buttonBackground.fill = pressedFill;
          buttonBackground.stroke = options.selectedStroke;
          buttonBackground.lineWidth = options.selectedLineWidth;
          buttonBackground.opacity = options.selectedButtonOpacity;
          shadowNode.fill = overFillShadow;
          shadowNode.opacity = options.selectedButtonOpacity;
          break;
        default:
          throw new Error(`unsupported interactionState: ${interactionState}`);
      }
    }
    interactionStateProperty.link(interactionStateListener);
    this.disposeThreeDAppearanceStrategy = () => {
      if (interactionStateProperty.hasListener(interactionStateListener)) {
        interactionStateProperty.unlink(interactionStateListener);
      }
      baseBrighter8Property.dispose();
      baseBrighter7Property.dispose();
      baseBrighter3Property.dispose();
      baseDarker1Property.dispose();
      baseDarker2Property.dispose();
      baseDarker4Property.dispose();
      baseDarker5Property.dispose();
      baseTransparentProperty.dispose();
    };
  }
  dispose() {
    this.disposeThreeDAppearanceStrategy();
  }
}
RoundButton.ThreeDAppearanceStrategy = ThreeDAppearanceStrategy;
sun.register('RoundButton', RoundButton);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEZXJpdmVkUHJvcGVydHkiLCJTaGFwZSIsIm9wdGlvbml6ZSIsIkNpcmNsZSIsIk5vZGUiLCJQYWludENvbG9yUHJvcGVydHkiLCJSYWRpYWxHcmFkaWVudCIsInN1biIsIkJ1dHRvbkludGVyYWN0aW9uU3RhdGUiLCJCdXR0b25Ob2RlIiwiSElHSExJR0hUX0dSQURJRU5UX0xFTkdUSCIsIlJvdW5kQnV0dG9uIiwiY29uc3RydWN0b3IiLCJidXR0b25Nb2RlbCIsImludGVyYWN0aW9uU3RhdGVQcm9wZXJ0eSIsInByb3ZpZGVkT3B0aW9ucyIsIm9wdGlvbnMiLCJyYWRpdXMiLCJjb250ZW50IiwibGluZVdpZHRoIiwic3Ryb2tlIiwidG91Y2hBcmVhRGlsYXRpb24iLCJtb3VzZUFyZWFEaWxhdGlvbiIsInRvdWNoQXJlYVhTaGlmdCIsInRvdWNoQXJlYVlTaGlmdCIsIm1vdXNlQXJlYVhTaGlmdCIsIm1vdXNlQXJlYVlTaGlmdCIsImFzcGVjdFJhdGlvIiwiY3Vyc29yIiwieE1hcmdpbiIsInlNYXJnaW4iLCJidXR0b25BcHBlYXJhbmNlU3RyYXRlZ3kiLCJUaHJlZURBcHBlYXJhbmNlU3RyYXRlZ3kiLCJhc3NlcnQiLCJtaW5VbnN0cm9rZWRXaWR0aCIsIm1pblVuc3Ryb2tlZEhlaWdodCIsImJ1dHRvbkFwcGVhcmFuY2VTdHJhdGVneU9wdGlvbnMiLCJidXR0b25SYWRpdXMiLCJNYXRoIiwibWF4Iiwid2lkdGgiLCJoZWlnaHQiLCJwcmV2aW91c0NvbnRlbnQiLCJtaW5TY2FsZSIsIm1pbiIsImNoaWxkcmVuIiwic2NhbGUiLCJidXR0b25CYWNrZ3JvdW5kIiwiYnV0dG9uQmFja2dyb3VuZFJhZGl1cyIsImxvY2FsQm91bmRzIiwidG91Y2hBcmVhIiwiY2lyY2xlIiwibW91c2VBcmVhIiwiZm9jdXNIaWdobGlnaHQiLCJiYXNlQ29sb3JQcm9wZXJ0eSIsImRlZmF1bHRTdHJva2UiLCJsdW1pbmFuY2VGYWN0b3IiLCJkZWZhdWx0TGluZVdpZHRoIiwidW5kZWZpbmVkIiwib3ZlclN0cm9rZSIsIm92ZXJMaW5lV2lkdGgiLCJvdmVyQnV0dG9uT3BhY2l0eSIsInNlbGVjdGVkU3Ryb2tlIiwic2VsZWN0ZWRMaW5lV2lkdGgiLCJzZWxlY3RlZEJ1dHRvbk9wYWNpdHkiLCJkZXNlbGVjdGVkU3Ryb2tlIiwiZGVzZWxlY3RlZExpbmVXaWR0aCIsImRlc2VsZWN0ZWRCdXR0b25PcGFjaXR5Iiwib3ZlckZpbGwiLCJiYXNlQnJpZ2h0ZXI4UHJvcGVydHkiLCJiYXNlQnJpZ2h0ZXI3UHJvcGVydHkiLCJiYXNlQnJpZ2h0ZXIzUHJvcGVydHkiLCJiYXNlRGFya2VyMVByb3BlcnR5IiwiYmFzZURhcmtlcjJQcm9wZXJ0eSIsImJhc2VEYXJrZXI0UHJvcGVydHkiLCJiYXNlRGFya2VyNVByb3BlcnR5IiwiYmFzZVRyYW5zcGFyZW50UHJvcGVydHkiLCJjb2xvciIsIndpdGhBbHBoYSIsImlubmVyR3JhZGllbnRSYWRpdXMiLCJvdXRlckdyYWRpZW50UmFkaXVzIiwiZ3JhZGllbnRPZmZzZXQiLCJ1cEZpbGxIaWdobGlnaHQiLCJhZGRDb2xvclN0b3AiLCJ1cEZpbGxTaGFkb3ciLCJvdmVyRmlsbEhpZ2hsaWdodCIsIm92ZXJGaWxsU2hhZG93IiwicHJlc3NlZEZpbGwiLCJzaGFkb3dOb2RlIiwicGlja2FibGUiLCJhZGRDaGlsZCIsIm1heExpbmVXaWR0aCIsImhhc1N0cm9rZSIsImNhY2hlZFBhaW50cyIsImludGVyYWN0aW9uU3RhdGVMaXN0ZW5lciIsImludGVyYWN0aW9uU3RhdGUiLCJJRExFIiwiZmlsbCIsIm9wYWNpdHkiLCJPVkVSIiwiUFJFU1NFRCIsIkVycm9yIiwibGluayIsImRpc3Bvc2VUaHJlZURBcHBlYXJhbmNlU3RyYXRlZ3kiLCJoYXNMaXN0ZW5lciIsInVubGluayIsImRpc3Bvc2UiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIlJvdW5kQnV0dG9uLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE0LTIwMjQsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIFJvdW5kQnV0dG9uIGlzIHRoZSBiYXNlIGNsYXNzIGZvciByb3VuZCBidXR0b25zLlxyXG4gKlxyXG4gKiBAYXV0aG9yIEpvaG4gQmxhbmNvIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKiBAYXV0aG9yIFNhbSBSZWlkIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKi9cclxuXHJcbmltcG9ydCBEZXJpdmVkUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vYXhvbi9qcy9EZXJpdmVkUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgVFJlYWRPbmx5UHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vYXhvbi9qcy9UUmVhZE9ubHlQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCB7IFNoYXBlIH0gZnJvbSAnLi4vLi4vLi4va2l0ZS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IG9wdGlvbml6ZSBmcm9tICcuLi8uLi8uLi9waGV0LWNvcmUvanMvb3B0aW9uaXplLmpzJztcclxuaW1wb3J0IHsgQ2lyY2xlLCBDb2xvciwgTm9kZSwgUGFpbnRhYmxlTm9kZSwgUGFpbnRDb2xvclByb3BlcnR5LCBSYWRpYWxHcmFkaWVudCwgVFBhaW50IH0gZnJvbSAnLi4vLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IHN1biBmcm9tICcuLi9zdW4uanMnO1xyXG5pbXBvcnQgQnV0dG9uSW50ZXJhY3Rpb25TdGF0ZSBmcm9tICcuL0J1dHRvbkludGVyYWN0aW9uU3RhdGUuanMnO1xyXG5pbXBvcnQgQnV0dG9uTW9kZWwgZnJvbSAnLi9CdXR0b25Nb2RlbC5qcyc7XHJcbmltcG9ydCBCdXR0b25Ob2RlLCB7IEJ1dHRvbk5vZGVPcHRpb25zLCBFeHRlcm5hbEJ1dHRvbk5vZGVPcHRpb25zIH0gZnJvbSAnLi9CdXR0b25Ob2RlLmpzJztcclxuaW1wb3J0IFJhZGlvQnV0dG9uSW50ZXJhY3Rpb25TdGF0ZSBmcm9tICcuL1JhZGlvQnV0dG9uSW50ZXJhY3Rpb25TdGF0ZS5qcyc7XHJcbmltcG9ydCBUQnV0dG9uQXBwZWFyYW5jZVN0cmF0ZWd5LCB7IFRCdXR0b25BcHBlYXJhbmNlU3RyYXRlZ3lPcHRpb25zIH0gZnJvbSAnLi9UQnV0dG9uQXBwZWFyYW5jZVN0cmF0ZWd5LmpzJztcclxuXHJcbi8vIGNvbnN0YW50c1xyXG5jb25zdCBISUdITElHSFRfR1JBRElFTlRfTEVOR1RIID0gNTsgLy8gSW4gc2NyZWVuIGNvb3Jkcywgd2hpY2ggYXJlIHJvdWdobHkgcGl4ZWxzLlxyXG5cclxudHlwZSBTZWxmT3B0aW9ucyA9IHtcclxuXHJcbiAgcmFkaXVzPzogbnVtYmVyIHwgbnVsbDtcclxuICBsaW5lV2lkdGg/OiBudW1iZXI7XHJcbiAgc3Ryb2tlPzogVFBhaW50IHwgbnVsbDsgLy8gd2hlbiBudWxsLCBhIHN0cm9rZSB3aWxsIGJlIGRlcml2ZWQgZnJvbSB0aGUgYmFzZSBjb2xvclxyXG5cclxuICAvLyBwb2ludGVyIGFyZWEgZGlsYXRpb25cclxuICB0b3VjaEFyZWFEaWxhdGlvbj86IG51bWJlcjsgLy8gcmFkaXVzIGRpbGF0aW9uIGZvciB0b3VjaCBhcmVhXHJcbiAgbW91c2VBcmVhRGlsYXRpb24/OiBudW1iZXI7IC8vIHJhZGl1cyBkaWxhdGlvbiBmb3IgbW91c2UgYXJlYVxyXG5cclxuICAvLyBwb2ludGVyIGFyZWEgc2hpZnRcclxuICB0b3VjaEFyZWFYU2hpZnQ/OiBudW1iZXI7XHJcbiAgdG91Y2hBcmVhWVNoaWZ0PzogbnVtYmVyO1xyXG4gIG1vdXNlQXJlYVhTaGlmdD86IG51bWJlcjtcclxuICBtb3VzZUFyZWFZU2hpZnQ/OiBudW1iZXI7XHJcbn07XHJcblxyXG5leHBvcnQgdHlwZSBSb3VuZEJ1dHRvbk9wdGlvbnMgPSBTZWxmT3B0aW9ucyAmIEV4dGVybmFsQnV0dG9uTm9kZU9wdGlvbnM7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBSb3VuZEJ1dHRvbiBleHRlbmRzIEJ1dHRvbk5vZGUge1xyXG5cclxuICBwdWJsaWMgc3RhdGljIFRocmVlREFwcGVhcmFuY2VTdHJhdGVneTogVEJ1dHRvbkFwcGVhcmFuY2VTdHJhdGVneTtcclxuXHJcbiAgcHJvdGVjdGVkIGNvbnN0cnVjdG9yKCBidXR0b25Nb2RlbDogQnV0dG9uTW9kZWwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICBpbnRlcmFjdGlvblN0YXRlUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PEJ1dHRvbkludGVyYWN0aW9uU3RhdGU+LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgcHJvdmlkZWRPcHRpb25zPzogUm91bmRCdXR0b25PcHRpb25zICkge1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSBvcHRpb25pemU8Um91bmRCdXR0b25PcHRpb25zLCBTZWxmT3B0aW9ucywgQnV0dG9uTm9kZU9wdGlvbnM+KCkoIHtcclxuXHJcbiAgICAgIC8vIFNlbGZPcHRpb25zXHJcbiAgICAgIHJhZGl1czogKCBwcm92aWRlZE9wdGlvbnMgJiYgcHJvdmlkZWRPcHRpb25zLmNvbnRlbnQgKSA/IG51bGwgOiAzMCxcclxuICAgICAgbGluZVdpZHRoOiAwLjUsIC8vIE9ubHkgbWVhbmluZ2Z1bCBpZiBzdHJva2UgaXMgbm9uLW51bGxcclxuICAgICAgc3Ryb2tlOiBudWxsLFxyXG4gICAgICB0b3VjaEFyZWFEaWxhdGlvbjogMCxcclxuICAgICAgbW91c2VBcmVhRGlsYXRpb246IDAsXHJcbiAgICAgIHRvdWNoQXJlYVhTaGlmdDogMCxcclxuICAgICAgdG91Y2hBcmVhWVNoaWZ0OiAwLFxyXG4gICAgICBtb3VzZUFyZWFYU2hpZnQ6IDAsXHJcbiAgICAgIG1vdXNlQXJlYVlTaGlmdDogMCxcclxuXHJcbiAgICAgIGFzcGVjdFJhdGlvOiAxLCAvLyBUaGlzIHdpbGwga2VlcCB0aGUgbWluaW11bSB3aWR0aCBhbmQgaGVpZ2h0IHRoZSBzYW1lLCBzbyBvdXIgYm91bmRpbmcgYm94IHdpbGwgYmUgc3F1YXJlXHJcblxyXG4gICAgICAvLyBCdXR0b25Ob2RlT3B0aW9uc1xyXG4gICAgICBjdXJzb3I6ICdwb2ludGVyJyxcclxuXHJcbiAgICAgIC8vIElmIHRoZXNlIGFyZSBub3QgdGhlIHNhbWUsIHRoZSBsYXJnZXIgb25lIHdpbGwgYmUgdXNlZCB0byBjYWxjdWxhdGUgdGhlIHNpemUgb2YgdGhlIGJ1dHRvblxyXG4gICAgICB4TWFyZ2luOiA1LCAvLyBNaW5pbXVtIG1hcmdpbiBpbiB4IGRpcmVjdGlvbiwgaS5lLiBvbiBsZWZ0IGFuZCByaWdodFxyXG4gICAgICB5TWFyZ2luOiA1LCAvLyBNaW5pbXVtIG1hcmdpbiBpbiB5IGRpcmVjdGlvbiwgaS5lLiBvbiB0b3AgYW5kIGJvdHRvbVxyXG5cclxuICAgICAgLy8gQ2xhc3MgdGhhdCBkZXRlcm1pbmVzIHRoZSBidXR0b24ncyBhcHBlYXJhbmNlIGZvciB0aGUgdmFsdWVzIG9mIGludGVyYWN0aW9uU3RhdGVQcm9wZXJ0eS5cclxuICAgICAgLy8gU2VlIFJvdW5kQnV0dG9uLlRocmVlREFwcGVhcmFuY2VTdHJhdGVneSBmb3IgYW4gZXhhbXBsZSBvZiB0aGUgaW50ZXJmYWNlIHJlcXVpcmVkLlxyXG4gICAgICBidXR0b25BcHBlYXJhbmNlU3RyYXRlZ3k6IFJvdW5kQnV0dG9uLlRocmVlREFwcGVhcmFuY2VTdHJhdGVneVxyXG4gICAgfSwgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgaWYgKCAhb3B0aW9ucy5jb250ZW50ICkge1xyXG4gICAgICBhc3NlcnQgJiYgYXNzZXJ0KCB0eXBlb2Ygb3B0aW9ucy5yYWRpdXMgPT09ICdudW1iZXInLCBgaW52YWxpZCByYWRpdXM6ICR7b3B0aW9ucy5yYWRpdXN9YCApO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICggb3B0aW9ucy5yYWRpdXMgKSB7XHJcbiAgICAgIGFzc2VydCAmJiBhc3NlcnQoIG9wdGlvbnMueE1hcmdpbiA8IG9wdGlvbnMucmFkaXVzLCAneE1hcmdpbiBjYW5ub3QgYmUgbGFyZ2VyIHRoYW4gcmFkaXVzJyApO1xyXG4gICAgICBhc3NlcnQgJiYgYXNzZXJ0KCBvcHRpb25zLnlNYXJnaW4gPCBvcHRpb25zLnJhZGl1cywgJ3lNYXJnaW4gY2Fubm90IGJlIGxhcmdlciB0aGFuIHJhZGl1cycgKTtcclxuXHJcbiAgICAgIG9wdGlvbnMubWluVW5zdHJva2VkV2lkdGggPSBvcHRpb25zLnJhZGl1cyAqIDI7XHJcbiAgICAgIG9wdGlvbnMubWluVW5zdHJva2VkSGVpZ2h0ID0gb3B0aW9ucy5yYWRpdXMgKiAyO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIElmIG5vIG9wdGlvbnMgd2VyZSBleHBsaWNpdGx5IHBhc3NlZCBpbiBmb3IgdGhlIGJ1dHRvbiBhcHBlYXJhbmNlIHN0cmF0ZWd5LCBwYXNzIHRocm91Z2ggdGhlIGdlbmVyYWwgYXBwZWFyYW5jZVxyXG4gICAgLy8gb3B0aW9ucy5cclxuICAgIGlmICggIW9wdGlvbnMuYnV0dG9uQXBwZWFyYW5jZVN0cmF0ZWd5T3B0aW9ucyApIHtcclxuICAgICAgb3B0aW9ucy5idXR0b25BcHBlYXJhbmNlU3RyYXRlZ3lPcHRpb25zID0ge1xyXG4gICAgICAgIHN0cm9rZTogb3B0aW9ucy5zdHJva2UsXHJcbiAgICAgICAgbGluZVdpZHRoOiBvcHRpb25zLmxpbmVXaWR0aFxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENvbXB1dGUgdGhlIHJhZGl1cyBvZiB0aGUgYnV0dG9uLiByYWRpdXMgd2lsbCBub3QgYmUgZmFsc2V5IGlmIGNvbnRlbnQgaXMgYWxzbyBmYWxzZXlcclxuICAgIGNvbnN0IGJ1dHRvblJhZGl1cyA9IG9wdGlvbnMucmFkaXVzIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLm1heCggb3B0aW9ucy5jb250ZW50IS53aWR0aCArIG9wdGlvbnMueE1hcmdpbiAqIDIsIG9wdGlvbnMuY29udGVudCEuaGVpZ2h0ICsgb3B0aW9ucy55TWFyZ2luICogMiApIC8gMjtcclxuXHJcbiAgICBpZiAoIG9wdGlvbnMuY29udGVudCAmJiBvcHRpb25zLnJhZGl1cyApIHtcclxuICAgICAgY29uc3QgcHJldmlvdXNDb250ZW50ID0gb3B0aW9ucy5jb250ZW50O1xyXG4gICAgICBjb25zdCBtaW5TY2FsZSA9IE1hdGgubWluKFxyXG4gICAgICAgICggb3B0aW9ucy5yYWRpdXMgLSBvcHRpb25zLnhNYXJnaW4gKSAqIDIgLyBwcmV2aW91c0NvbnRlbnQud2lkdGgsXHJcbiAgICAgICAgKCBvcHRpb25zLnJhZGl1cyAtIG9wdGlvbnMueU1hcmdpbiApICogMiAvIHByZXZpb3VzQ29udGVudC5oZWlnaHQgKTtcclxuXHJcbiAgICAgIG9wdGlvbnMuY29udGVudCA9IG5ldyBOb2RlKCB7XHJcbiAgICAgICAgY2hpbGRyZW46IFsgcHJldmlvdXNDb250ZW50IF0sXHJcbiAgICAgICAgc2NhbGU6IG1pblNjYWxlXHJcbiAgICAgIH0gKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDcmVhdGUgdGhlIGNpcmN1bGFyIHBhcnQgb2YgdGhlIGJ1dHRvbi5cclxuICAgIGNvbnN0IGJ1dHRvbkJhY2tncm91bmQgPSBuZXcgQ2lyY2xlKCBidXR0b25SYWRpdXMgKTtcclxuXHJcbiAgICBzdXBlciggYnV0dG9uTW9kZWwsIGJ1dHRvbkJhY2tncm91bmQsIGludGVyYWN0aW9uU3RhdGVQcm9wZXJ0eSwgb3B0aW9ucyApO1xyXG5cclxuICAgIC8vIEdldCB0aGUgYWN0dWFsIGJ1dHRvbiByYWRpdXMgYWZ0ZXIgY2FsbGluZyBzdXBlciwgc28gdGhhdCBidXR0b25BcHBlYXJhbmNlU3RyYXRlZ3kgaGFzIGFwcGxpZWQgdGhlIHN0cm9rZS5cclxuICAgIC8vIFRoaXMgYWNjb3VudHMgZm9yIHN0cm9rZSArIGxpbmVXaWR0aCwgd2hpY2ggaXMgaW1wb3J0YW50IHdoZW4gc2V0dGluZyBwb2ludGVyIGFyZWFzIGFuZCBmb2N1cyBoaWdobGlnaHQuXHJcbiAgICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL3N1bi9pc3N1ZXMvNjYwXHJcbiAgICBjb25zdCBidXR0b25CYWNrZ3JvdW5kUmFkaXVzID0gYnV0dG9uQmFja2dyb3VuZC5sb2NhbEJvdW5kcy53aWR0aCAvIDI7XHJcblxyXG4gICAgLy8gU2V0IHBvaW50ZXIgYXJlYXMuXHJcbiAgICB0aGlzLnRvdWNoQXJlYSA9IFNoYXBlLmNpcmNsZSggb3B0aW9ucy50b3VjaEFyZWFYU2hpZnQsIG9wdGlvbnMudG91Y2hBcmVhWVNoaWZ0LFxyXG4gICAgICBidXR0b25CYWNrZ3JvdW5kUmFkaXVzICsgb3B0aW9ucy50b3VjaEFyZWFEaWxhdGlvbiApO1xyXG4gICAgdGhpcy5tb3VzZUFyZWEgPSBTaGFwZS5jaXJjbGUoIG9wdGlvbnMubW91c2VBcmVhWFNoaWZ0LCBvcHRpb25zLm1vdXNlQXJlYVlTaGlmdCxcclxuICAgICAgYnV0dG9uQmFja2dyb3VuZFJhZGl1cyArIG9wdGlvbnMubW91c2VBcmVhRGlsYXRpb24gKTtcclxuXHJcbiAgICAvLyBwZG9tIC0gZm9jdXMgaGlnaGxpZ2h0IGlzIGNpcmN1bGFyIGZvciByb3VuZCBidXR0b25zLCB3aXRoIGEgbGl0dGxlIGJpdCBvZiBwYWRkaW5nXHJcbiAgICAvLyBiZXR3ZWVuIGJ1dHRvbiBzaGFwZSBhbmQgaW5uZXIgZWRnZSBvZiBoaWdobGlnaHRcclxuICAgIHRoaXMuZm9jdXNIaWdobGlnaHQgPSBTaGFwZS5jaXJjbGUoIDAsIDAsIGJ1dHRvbkJhY2tncm91bmRSYWRpdXMgKyA1ICk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogVGhyZWVEQXBwZWFyYW5jZVN0cmF0ZWd5IGlzIGEgdmFsdWUgZm9yIFJvdW5kQnV0dG9uIG9wdGlvbnMuYnV0dG9uQXBwZWFyYW5jZVN0cmF0ZWd5LiBJdCBtYWtlcyBhIHJvdW5kIGJ1dHRvblxyXG4gKiBsb29rIDNELWlzaCBieSB1c2luZyBncmFkaWVudHMgdGhhdCBjcmVhdGUgdGhlIGFwcGVhcmFuY2Ugb2YgaGlnaGxpZ2h0ZWQgYW5kIHNoYWRlZCBlZGdlcy4gVGhlIGdyYWRpZW50cyBhcmVcclxuICogc2V0IHVwIHRvIG1ha2UgdGhlIGxpZ2h0IHNvdXJjZSBhcHBlYXIgdG8gYmUgaW4gdGhlIHVwcGVyIGxlZnQuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgVGhyZWVEQXBwZWFyYW5jZVN0cmF0ZWd5IHtcclxuXHJcbiAgcHVibGljIHJlYWRvbmx5IG1heExpbmVXaWR0aDogbnVtYmVyO1xyXG5cclxuICBwcml2YXRlIHJlYWRvbmx5IGRpc3Bvc2VUaHJlZURBcHBlYXJhbmNlU3RyYXRlZ3k6ICgpID0+IHZvaWQ7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSBidXR0b25CYWNrZ3JvdW5kIC0gdGhlIE5vZGUgZm9yIHRoZSBidXR0b24ncyBiYWNrZ3JvdW5kLCBzYW5zIGNvbnRlbnRcclxuICAgKiBAcGFyYW0gaW50ZXJhY3Rpb25TdGF0ZVByb3BlcnR5XHJcbiAgICogQHBhcmFtIGJhc2VDb2xvclByb3BlcnR5XHJcbiAgICogQHBhcmFtIFtwcm92aWRlZE9wdGlvbnNdXHJcbiAgICovXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBidXR0b25CYWNrZ3JvdW5kOiBQYWludGFibGVOb2RlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgaW50ZXJhY3Rpb25TdGF0ZVByb3BlcnR5OiBUUmVhZE9ubHlQcm9wZXJ0eTxCdXR0b25JbnRlcmFjdGlvblN0YXRlIHwgUmFkaW9CdXR0b25JbnRlcmFjdGlvblN0YXRlPixcclxuICAgICAgICAgICAgICAgICAgICAgIGJhc2VDb2xvclByb3BlcnR5OiBUUmVhZE9ubHlQcm9wZXJ0eTxDb2xvcj4sXHJcbiAgICAgICAgICAgICAgICAgICAgICBwcm92aWRlZE9wdGlvbnM/OiBUQnV0dG9uQXBwZWFyYW5jZVN0cmF0ZWd5T3B0aW9ucyApIHtcclxuXHJcbiAgICAvLyBJZiBzdHJva2UgYW5kIGxpbmVXaWR0aCBleGlzdCBpbiB0aGUgcHJvdmlkZWQgb3B0aW9ucywgdGhleSBiZWNvbWUgdGhlIGRlZmF1bHQgZm9yIGFsbCBzdHJva2VzIGFuZCBsaW5lIHdpZHRocy5cclxuICAgIC8vIElmIG5vdCwgZGVmYXVsdHMgYXJlIGNyZWF0ZWQuXHJcbiAgICBjb25zdCBkZWZhdWx0U3Ryb2tlID0gKCBwcm92aWRlZE9wdGlvbnMgJiYgcHJvdmlkZWRPcHRpb25zLnN0cm9rZSApID9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICBwcm92aWRlZE9wdGlvbnMuc3Ryb2tlIDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgUGFpbnRDb2xvclByb3BlcnR5KCBiYXNlQ29sb3JQcm9wZXJ0eSwgeyBsdW1pbmFuY2VGYWN0b3I6IC0wLjQgfSApO1xyXG4gICAgY29uc3QgZGVmYXVsdExpbmVXaWR0aCA9ICggcHJvdmlkZWRPcHRpb25zICYmIHByb3ZpZGVkT3B0aW9ucy5saW5lV2lkdGggIT09IHVuZGVmaW5lZCApID9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm92aWRlZE9wdGlvbnMubGluZVdpZHRoIDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwLjM7XHJcblxyXG4gICAgY29uc3Qgb3B0aW9ucyA9IG9wdGlvbml6ZTxUQnV0dG9uQXBwZWFyYW5jZVN0cmF0ZWd5T3B0aW9ucz4oKSgge1xyXG4gICAgICBzdHJva2U6IGRlZmF1bHRTdHJva2UsXHJcbiAgICAgIGxpbmVXaWR0aDogZGVmYXVsdExpbmVXaWR0aCxcclxuICAgICAgb3ZlclN0cm9rZTogZGVmYXVsdFN0cm9rZSxcclxuICAgICAgb3ZlckxpbmVXaWR0aDogZGVmYXVsdExpbmVXaWR0aCxcclxuICAgICAgb3ZlckJ1dHRvbk9wYWNpdHk6IDEsXHJcbiAgICAgIHNlbGVjdGVkU3Ryb2tlOiBkZWZhdWx0U3Ryb2tlLFxyXG4gICAgICBzZWxlY3RlZExpbmVXaWR0aDogZGVmYXVsdExpbmVXaWR0aCxcclxuICAgICAgc2VsZWN0ZWRCdXR0b25PcGFjaXR5OiAxLFxyXG4gICAgICBkZXNlbGVjdGVkU3Ryb2tlOiBkZWZhdWx0U3Ryb2tlLFxyXG4gICAgICBkZXNlbGVjdGVkTGluZVdpZHRoOiBkZWZhdWx0TGluZVdpZHRoLFxyXG4gICAgICBkZXNlbGVjdGVkQnV0dG9uT3BhY2l0eTogMSxcclxuXHJcbiAgICAgIG92ZXJGaWxsOiBiYXNlQ29sb3JQcm9wZXJ0eVxyXG4gICAgfSwgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgLy8gRHluYW1pYyBjb2xvcnNcclxuICAgIGNvbnN0IGJhc2VCcmlnaHRlcjhQcm9wZXJ0eSA9IG5ldyBQYWludENvbG9yUHJvcGVydHkoIGJhc2VDb2xvclByb3BlcnR5LCB7IGx1bWluYW5jZUZhY3RvcjogMC44IH0gKTtcclxuICAgIGNvbnN0IGJhc2VCcmlnaHRlcjdQcm9wZXJ0eSA9IG5ldyBQYWludENvbG9yUHJvcGVydHkoIGJhc2VDb2xvclByb3BlcnR5LCB7IGx1bWluYW5jZUZhY3RvcjogMC43IH0gKTtcclxuICAgIGNvbnN0IGJhc2VCcmlnaHRlcjNQcm9wZXJ0eSA9IG5ldyBQYWludENvbG9yUHJvcGVydHkoIGJhc2VDb2xvclByb3BlcnR5LCB7IGx1bWluYW5jZUZhY3RvcjogMC4zIH0gKTtcclxuICAgIGNvbnN0IGJhc2VEYXJrZXIxUHJvcGVydHkgPSBuZXcgUGFpbnRDb2xvclByb3BlcnR5KCBiYXNlQ29sb3JQcm9wZXJ0eSwgeyBsdW1pbmFuY2VGYWN0b3I6IC0wLjEgfSApO1xyXG4gICAgY29uc3QgYmFzZURhcmtlcjJQcm9wZXJ0eSA9IG5ldyBQYWludENvbG9yUHJvcGVydHkoIGJhc2VDb2xvclByb3BlcnR5LCB7IGx1bWluYW5jZUZhY3RvcjogLTAuMiB9ICk7XHJcbiAgICBjb25zdCBiYXNlRGFya2VyNFByb3BlcnR5ID0gbmV3IFBhaW50Q29sb3JQcm9wZXJ0eSggYmFzZUNvbG9yUHJvcGVydHksIHsgbHVtaW5hbmNlRmFjdG9yOiAtMC40IH0gKTtcclxuICAgIGNvbnN0IGJhc2VEYXJrZXI1UHJvcGVydHkgPSBuZXcgUGFpbnRDb2xvclByb3BlcnR5KCBiYXNlQ29sb3JQcm9wZXJ0eSwgeyBsdW1pbmFuY2VGYWN0b3I6IC0wLjUgfSApO1xyXG4gICAgY29uc3QgYmFzZVRyYW5zcGFyZW50UHJvcGVydHkgPSBuZXcgRGVyaXZlZFByb3BlcnR5KCBbIGJhc2VDb2xvclByb3BlcnR5IF0sIGNvbG9yID0+IGNvbG9yLndpdGhBbHBoYSggMCApICk7XHJcblxyXG4gICAgLy8gU2V0IHVwIHZhcmlhYmxlcyBuZWVkZWQgdG8gY3JlYXRlIHRoZSB2YXJpb3VzIGdyYWRpZW50IGZpbGxzIGFuZCBvdGhlcndpc2UgbW9kaWZ5IHRoZSBhcHBlYXJhbmNlXHJcbiAgICBjb25zdCBidXR0b25SYWRpdXMgPSBidXR0b25CYWNrZ3JvdW5kLndpZHRoIC8gMjtcclxuICAgIGNvbnN0IGlubmVyR3JhZGllbnRSYWRpdXMgPSBidXR0b25SYWRpdXMgLSBISUdITElHSFRfR1JBRElFTlRfTEVOR1RIIC8gMjtcclxuICAgIGNvbnN0IG91dGVyR3JhZGllbnRSYWRpdXMgPSBidXR0b25SYWRpdXMgKyBISUdITElHSFRfR1JBRElFTlRfTEVOR1RIIC8gMjtcclxuICAgIGNvbnN0IGdyYWRpZW50T2Zmc2V0ID0gSElHSExJR0hUX0dSQURJRU5UX0xFTkdUSCAvIDI7XHJcblxyXG4gICAgY29uc3QgdXBGaWxsSGlnaGxpZ2h0ID0gbmV3IFJhZGlhbEdyYWRpZW50KCBncmFkaWVudE9mZnNldCwgZ3JhZGllbnRPZmZzZXQsIGlubmVyR3JhZGllbnRSYWRpdXMsIGdyYWRpZW50T2Zmc2V0LCBncmFkaWVudE9mZnNldCwgb3V0ZXJHcmFkaWVudFJhZGl1cyApXHJcbiAgICAgIC5hZGRDb2xvclN0b3AoIDAsIGJhc2VDb2xvclByb3BlcnR5IClcclxuICAgICAgLmFkZENvbG9yU3RvcCggMSwgYmFzZUJyaWdodGVyN1Byb3BlcnR5ICk7XHJcblxyXG4gICAgY29uc3QgdXBGaWxsU2hhZG93ID0gbmV3IFJhZGlhbEdyYWRpZW50KCAtZ3JhZGllbnRPZmZzZXQsIC1ncmFkaWVudE9mZnNldCwgaW5uZXJHcmFkaWVudFJhZGl1cywgLWdyYWRpZW50T2Zmc2V0LCAtZ3JhZGllbnRPZmZzZXQsIG91dGVyR3JhZGllbnRSYWRpdXMgKVxyXG4gICAgICAuYWRkQ29sb3JTdG9wKCAwLCBiYXNlVHJhbnNwYXJlbnRQcm9wZXJ0eSApXHJcbiAgICAgIC5hZGRDb2xvclN0b3AoIDEsIGJhc2VEYXJrZXI1UHJvcGVydHkgKTtcclxuXHJcbiAgICBjb25zdCBvdmVyRmlsbEhpZ2hsaWdodCA9IG5ldyBSYWRpYWxHcmFkaWVudCggZ3JhZGllbnRPZmZzZXQsIGdyYWRpZW50T2Zmc2V0LCBpbm5lckdyYWRpZW50UmFkaXVzLCBncmFkaWVudE9mZnNldCwgZ3JhZGllbnRPZmZzZXQsIG91dGVyR3JhZGllbnRSYWRpdXMgKVxyXG4gICAgICAuYWRkQ29sb3JTdG9wKCAwLCBiYXNlQnJpZ2h0ZXIzUHJvcGVydHkgKVxyXG4gICAgICAuYWRkQ29sb3JTdG9wKCAxLCBiYXNlQnJpZ2h0ZXI4UHJvcGVydHkgKTtcclxuXHJcbiAgICBjb25zdCBvdmVyRmlsbFNoYWRvdyA9IG5ldyBSYWRpYWxHcmFkaWVudCggLWdyYWRpZW50T2Zmc2V0LCAtZ3JhZGllbnRPZmZzZXQsIGlubmVyR3JhZGllbnRSYWRpdXMsIC1ncmFkaWVudE9mZnNldCwgLWdyYWRpZW50T2Zmc2V0LCBvdXRlckdyYWRpZW50UmFkaXVzIClcclxuICAgICAgLmFkZENvbG9yU3RvcCggMCwgYmFzZVRyYW5zcGFyZW50UHJvcGVydHkgKVxyXG4gICAgICAuYWRkQ29sb3JTdG9wKCAxLCBiYXNlRGFya2VyNVByb3BlcnR5ICk7XHJcblxyXG4gICAgY29uc3QgcHJlc3NlZEZpbGwgPSBuZXcgUmFkaWFsR3JhZGllbnQoIC1ncmFkaWVudE9mZnNldCwgLWdyYWRpZW50T2Zmc2V0LCAwLCAwLCAwLCBvdXRlckdyYWRpZW50UmFkaXVzIClcclxuICAgICAgLmFkZENvbG9yU3RvcCggMCwgYmFzZURhcmtlcjFQcm9wZXJ0eSApXHJcbiAgICAgIC5hZGRDb2xvclN0b3AoIDAuNiwgYmFzZURhcmtlcjJQcm9wZXJ0eSApXHJcbiAgICAgIC5hZGRDb2xvclN0b3AoIDAuOCwgYmFzZUNvbG9yUHJvcGVydHkgKVxyXG4gICAgICAuYWRkQ29sb3JTdG9wKCAxLCBiYXNlQnJpZ2h0ZXI4UHJvcGVydHkgKTtcclxuXHJcbiAgICAvLyBDcmVhdGUgYW5kIGFkZCB0aGUgb3ZlcmxheSB0aGF0IGlzIHVzZWQgdG8gYWRkIHNoYWRpbmcuXHJcbiAgICBjb25zdCBzaGFkb3dOb2RlID0gbmV3IENpcmNsZSggYnV0dG9uUmFkaXVzLCB7XHJcbiAgICAgIHN0cm9rZTogIW9wdGlvbnMuc3Ryb2tlID8gYmFzZURhcmtlcjRQcm9wZXJ0eSA6IG9wdGlvbnMuc3Ryb2tlLFxyXG4gICAgICBsaW5lV2lkdGg6IG9wdGlvbnMubGluZVdpZHRoLFxyXG4gICAgICBwaWNrYWJsZTogZmFsc2VcclxuICAgIH0gKTtcclxuICAgIGJ1dHRvbkJhY2tncm91bmQuYWRkQ2hpbGQoIHNoYWRvd05vZGUgKTtcclxuXHJcbiAgICB0aGlzLm1heExpbmVXaWR0aCA9IHNoYWRvd05vZGUuaGFzU3Ryb2tlKCkgJiYgb3B0aW9ucyAmJiB0eXBlb2Ygb3B0aW9ucy5saW5lV2lkdGggPT09ICdudW1iZXInID8gb3B0aW9ucy5saW5lV2lkdGggOiAwO1xyXG5cclxuICAgIC8vIENhY2hlIGdyYWRpZW50c1xyXG4gICAgYnV0dG9uQmFja2dyb3VuZC5jYWNoZWRQYWludHMgPSBbIHVwRmlsbEhpZ2hsaWdodCwgb3ZlckZpbGxIaWdobGlnaHQsIHByZXNzZWRGaWxsIF07XHJcbiAgICBzaGFkb3dOb2RlLmNhY2hlZFBhaW50cyA9IFsgdXBGaWxsU2hhZG93LCBvdmVyRmlsbFNoYWRvdyBdO1xyXG5cclxuICAgIC8vIENoYW5nZSBjb2xvcnMgdG8gbWF0Y2ggaW50ZXJhY3Rpb25TdGF0ZVxyXG4gICAgZnVuY3Rpb24gaW50ZXJhY3Rpb25TdGF0ZUxpc3RlbmVyKCBpbnRlcmFjdGlvblN0YXRlOiBCdXR0b25JbnRlcmFjdGlvblN0YXRlICk6IHZvaWQge1xyXG5cclxuICAgICAgc3dpdGNoKCBpbnRlcmFjdGlvblN0YXRlICkge1xyXG5cclxuICAgICAgICBjYXNlIEJ1dHRvbkludGVyYWN0aW9uU3RhdGUuSURMRTpcclxuICAgICAgICAgIGJ1dHRvbkJhY2tncm91bmQuZmlsbCA9IHVwRmlsbEhpZ2hsaWdodDtcclxuICAgICAgICAgIGJ1dHRvbkJhY2tncm91bmQuc3Ryb2tlID0gb3B0aW9ucy5kZXNlbGVjdGVkU3Ryb2tlO1xyXG4gICAgICAgICAgYnV0dG9uQmFja2dyb3VuZC5saW5lV2lkdGggPSBvcHRpb25zLmRlc2VsZWN0ZWRMaW5lV2lkdGg7XHJcbiAgICAgICAgICBidXR0b25CYWNrZ3JvdW5kLm9wYWNpdHkgPSBvcHRpb25zLmRlc2VsZWN0ZWRCdXR0b25PcGFjaXR5O1xyXG4gICAgICAgICAgc2hhZG93Tm9kZS5maWxsID0gdXBGaWxsU2hhZG93O1xyXG4gICAgICAgICAgc2hhZG93Tm9kZS5vcGFjaXR5ID0gb3B0aW9ucy5kZXNlbGVjdGVkQnV0dG9uT3BhY2l0eTtcclxuICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICBjYXNlIEJ1dHRvbkludGVyYWN0aW9uU3RhdGUuT1ZFUjpcclxuICAgICAgICAgIGJ1dHRvbkJhY2tncm91bmQuZmlsbCA9IG92ZXJGaWxsSGlnaGxpZ2h0O1xyXG4gICAgICAgICAgYnV0dG9uQmFja2dyb3VuZC5zdHJva2UgPSBvcHRpb25zLm92ZXJTdHJva2U7XHJcbiAgICAgICAgICBidXR0b25CYWNrZ3JvdW5kLmxpbmVXaWR0aCA9IG9wdGlvbnMub3ZlckxpbmVXaWR0aDtcclxuICAgICAgICAgIGJ1dHRvbkJhY2tncm91bmQub3BhY2l0eSA9IG9wdGlvbnMub3ZlckJ1dHRvbk9wYWNpdHk7XHJcbiAgICAgICAgICBzaGFkb3dOb2RlLmZpbGwgPSBvdmVyRmlsbFNoYWRvdztcclxuICAgICAgICAgIHNoYWRvd05vZGUub3BhY2l0eSA9IG9wdGlvbnMub3ZlckJ1dHRvbk9wYWNpdHk7XHJcbiAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgY2FzZSBCdXR0b25JbnRlcmFjdGlvblN0YXRlLlBSRVNTRUQ6XHJcbiAgICAgICAgICBidXR0b25CYWNrZ3JvdW5kLmZpbGwgPSBwcmVzc2VkRmlsbDtcclxuICAgICAgICAgIGJ1dHRvbkJhY2tncm91bmQuc3Ryb2tlID0gb3B0aW9ucy5zZWxlY3RlZFN0cm9rZTtcclxuICAgICAgICAgIGJ1dHRvbkJhY2tncm91bmQubGluZVdpZHRoID0gb3B0aW9ucy5zZWxlY3RlZExpbmVXaWR0aDtcclxuICAgICAgICAgIGJ1dHRvbkJhY2tncm91bmQub3BhY2l0eSA9IG9wdGlvbnMuc2VsZWN0ZWRCdXR0b25PcGFjaXR5O1xyXG4gICAgICAgICAgc2hhZG93Tm9kZS5maWxsID0gb3ZlckZpbGxTaGFkb3c7XHJcbiAgICAgICAgICBzaGFkb3dOb2RlLm9wYWNpdHkgPSBvcHRpb25zLnNlbGVjdGVkQnV0dG9uT3BhY2l0eTtcclxuICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCBgdW5zdXBwb3J0ZWQgaW50ZXJhY3Rpb25TdGF0ZTogJHtpbnRlcmFjdGlvblN0YXRlfWAgKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGludGVyYWN0aW9uU3RhdGVQcm9wZXJ0eS5saW5rKCBpbnRlcmFjdGlvblN0YXRlTGlzdGVuZXIgKTtcclxuXHJcbiAgICB0aGlzLmRpc3Bvc2VUaHJlZURBcHBlYXJhbmNlU3RyYXRlZ3kgPSAoKSA9PiB7XHJcbiAgICAgIGlmICggaW50ZXJhY3Rpb25TdGF0ZVByb3BlcnR5Lmhhc0xpc3RlbmVyKCBpbnRlcmFjdGlvblN0YXRlTGlzdGVuZXIgKSApIHtcclxuICAgICAgICBpbnRlcmFjdGlvblN0YXRlUHJvcGVydHkudW5saW5rKCBpbnRlcmFjdGlvblN0YXRlTGlzdGVuZXIgKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgYmFzZUJyaWdodGVyOFByb3BlcnR5LmRpc3Bvc2UoKTtcclxuICAgICAgYmFzZUJyaWdodGVyN1Byb3BlcnR5LmRpc3Bvc2UoKTtcclxuICAgICAgYmFzZUJyaWdodGVyM1Byb3BlcnR5LmRpc3Bvc2UoKTtcclxuICAgICAgYmFzZURhcmtlcjFQcm9wZXJ0eS5kaXNwb3NlKCk7XHJcbiAgICAgIGJhc2VEYXJrZXIyUHJvcGVydHkuZGlzcG9zZSgpO1xyXG4gICAgICBiYXNlRGFya2VyNFByb3BlcnR5LmRpc3Bvc2UoKTtcclxuICAgICAgYmFzZURhcmtlcjVQcm9wZXJ0eS5kaXNwb3NlKCk7XHJcbiAgICAgIGJhc2VUcmFuc3BhcmVudFByb3BlcnR5LmRpc3Bvc2UoKTtcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZGlzcG9zZSgpOiB2b2lkIHtcclxuICAgIHRoaXMuZGlzcG9zZVRocmVlREFwcGVhcmFuY2VTdHJhdGVneSgpO1xyXG4gIH1cclxufVxyXG5cclxuUm91bmRCdXR0b24uVGhyZWVEQXBwZWFyYW5jZVN0cmF0ZWd5ID0gVGhyZWVEQXBwZWFyYW5jZVN0cmF0ZWd5O1xyXG5cclxuc3VuLnJlZ2lzdGVyKCAnUm91bmRCdXR0b24nLCBSb3VuZEJ1dHRvbiApOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLGVBQWUsTUFBTSxxQ0FBcUM7QUFFakUsU0FBU0MsS0FBSyxRQUFRLDZCQUE2QjtBQUNuRCxPQUFPQyxTQUFTLE1BQU0sb0NBQW9DO0FBQzFELFNBQVNDLE1BQU0sRUFBU0MsSUFBSSxFQUFpQkMsa0JBQWtCLEVBQUVDLGNBQWMsUUFBZ0IsZ0NBQWdDO0FBQy9ILE9BQU9DLEdBQUcsTUFBTSxXQUFXO0FBQzNCLE9BQU9DLHNCQUFzQixNQUFNLDZCQUE2QjtBQUVoRSxPQUFPQyxVQUFVLE1BQXdELGlCQUFpQjtBQUkxRjtBQUNBLE1BQU1DLHlCQUF5QixHQUFHLENBQUMsQ0FBQyxDQUFDOztBQXFCckMsZUFBZSxNQUFNQyxXQUFXLFNBQVNGLFVBQVUs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