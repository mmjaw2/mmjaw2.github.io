// Copyright 2014-2024, University of Colorado Boulder

/**
 * RoundPushButton is a round push button, used to initiate some action.
 *
 * @author John Blanco (PhET Interactive Simulations)
 * @author Sam Reid (PhET Interactive Simulations)
 */

import InstanceRegistry from '../../../phet-core/js/documentation/InstanceRegistry.js';
import pushButtonSoundPlayer from '../../../tambo/js/shared-sound-players/pushButtonSoundPlayer.js';
import Tandem from '../../../tandem/js/Tandem.js';
import sun from '../sun.js';
import PushButtonInteractionStateProperty from './PushButtonInteractionStateProperty.js';
import PushButtonModel from './PushButtonModel.js';
import RoundButton from './RoundButton.js';
import optionize from '../../../phet-core/js/optionize.js';

//TODO https://github.com/phetsims/sun/issues/749 Let's not create PushButtonModel with these options?

export default class RoundPushButton extends RoundButton {
  // RoundButton has this.buttonModel, but we also need this.pushButtonModel, because it has additional methods

  constructor(providedOptions) {
    const options = optionize()({
      soundPlayer: pushButtonSoundPlayer,
      tandem: Tandem.REQUIRED
    }, providedOptions);

    // Save the listener and add it after creating the button model. This is done so that
    // the same code path is always used for adding listener, thus guaranteeing a consistent code path if addListener is
    // overridden, see https://github.com/phetsims/sun/issues/284.
    const listener = options.listener;
    const superOptions = _.omit(options, ['listener']);

    // Note it shares a tandem with this, so the emitter will be instrumented as a child of the button
    //TODO https://github.com/phetsims/sun/issues/749 its surprising that we can pass superOptions with irrelevant fields to PushButtonModel without TS errors
    const pushButtonModel = new PushButtonModel(superOptions);
    super(pushButtonModel, new PushButtonInteractionStateProperty(pushButtonModel), superOptions);
    this.pushButtonModel = pushButtonModel;

    // add the listener that was potentially saved above
    listener && this.addListener(listener);

    // sound generation
    const playSound = () => {
      options.soundPlayer.play();
    };
    pushButtonModel.produceSoundEmitter.addListener(playSound);
    this.disposeRoundPushButton = () => {
      pushButtonModel.produceSoundEmitter.removeListener(playSound);
      pushButtonModel.dispose();
    };

    // support for binder documentation, stripped out in builds and only runs when ?binder is specified
    assert && phet?.chipper?.queryParameters?.binder && InstanceRegistry.registerDataURL('sun', 'RoundPushButton', this);
  }
  dispose() {
    // The order of operations here is important - the view needs to be disposed first so that it is unhooked from
    // the model before the model is disposed.  If the model is disposed first, the view ends up trying to change some
    // of its Property values when it is disposed.  See https://github.com/phetsims/axon/issues/242.
    super.dispose();
    this.disposeRoundPushButton();
  }

  /**
   * Adds a listener that will be notified when the button fires.
   */
  addListener(listener) {
    this.pushButtonModel.addListener(listener);
  }

  /**
   * Removes a listener.
   */
  removeListener(listener) {
    this.pushButtonModel.removeListener(listener);
  }
}
sun.register('RoundPushButton', RoundPushButton);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJJbnN0YW5jZVJlZ2lzdHJ5IiwicHVzaEJ1dHRvblNvdW5kUGxheWVyIiwiVGFuZGVtIiwic3VuIiwiUHVzaEJ1dHRvbkludGVyYWN0aW9uU3RhdGVQcm9wZXJ0eSIsIlB1c2hCdXR0b25Nb2RlbCIsIlJvdW5kQnV0dG9uIiwib3B0aW9uaXplIiwiUm91bmRQdXNoQnV0dG9uIiwiY29uc3RydWN0b3IiLCJwcm92aWRlZE9wdGlvbnMiLCJvcHRpb25zIiwic291bmRQbGF5ZXIiLCJ0YW5kZW0iLCJSRVFVSVJFRCIsImxpc3RlbmVyIiwic3VwZXJPcHRpb25zIiwiXyIsIm9taXQiLCJwdXNoQnV0dG9uTW9kZWwiLCJhZGRMaXN0ZW5lciIsInBsYXlTb3VuZCIsInBsYXkiLCJwcm9kdWNlU291bmRFbWl0dGVyIiwiZGlzcG9zZVJvdW5kUHVzaEJ1dHRvbiIsInJlbW92ZUxpc3RlbmVyIiwiZGlzcG9zZSIsImFzc2VydCIsInBoZXQiLCJjaGlwcGVyIiwicXVlcnlQYXJhbWV0ZXJzIiwiYmluZGVyIiwicmVnaXN0ZXJEYXRhVVJMIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJSb3VuZFB1c2hCdXR0b24udHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTQtMjAyNCwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogUm91bmRQdXNoQnV0dG9uIGlzIGEgcm91bmQgcHVzaCBidXR0b24sIHVzZWQgdG8gaW5pdGlhdGUgc29tZSBhY3Rpb24uXHJcbiAqXHJcbiAqIEBhdXRob3IgSm9obiBCbGFuY28gKFBoRVQgSW50ZXJhY3RpdmUgU2ltdWxhdGlvbnMpXHJcbiAqIEBhdXRob3IgU2FtIFJlaWQgKFBoRVQgSW50ZXJhY3RpdmUgU2ltdWxhdGlvbnMpXHJcbiAqL1xyXG5cclxuaW1wb3J0IEluc3RhbmNlUmVnaXN0cnkgZnJvbSAnLi4vLi4vLi4vcGhldC1jb3JlL2pzL2RvY3VtZW50YXRpb24vSW5zdGFuY2VSZWdpc3RyeS5qcyc7XHJcbmltcG9ydCBwdXNoQnV0dG9uU291bmRQbGF5ZXIgZnJvbSAnLi4vLi4vLi4vdGFtYm8vanMvc2hhcmVkLXNvdW5kLXBsYXllcnMvcHVzaEJ1dHRvblNvdW5kUGxheWVyLmpzJztcclxuaW1wb3J0IFRhbmRlbSBmcm9tICcuLi8uLi8uLi90YW5kZW0vanMvVGFuZGVtLmpzJztcclxuaW1wb3J0IHN1biBmcm9tICcuLi9zdW4uanMnO1xyXG5pbXBvcnQgUHVzaEJ1dHRvbkludGVyYWN0aW9uU3RhdGVQcm9wZXJ0eSBmcm9tICcuL1B1c2hCdXR0b25JbnRlcmFjdGlvblN0YXRlUHJvcGVydHkuanMnO1xyXG5pbXBvcnQgUHVzaEJ1dHRvbk1vZGVsLCB7IFB1c2hCdXR0b25MaXN0ZW5lciwgUHVzaEJ1dHRvbk1vZGVsT3B0aW9ucyB9IGZyb20gJy4vUHVzaEJ1dHRvbk1vZGVsLmpzJztcclxuaW1wb3J0IFJvdW5kQnV0dG9uLCB7IFJvdW5kQnV0dG9uT3B0aW9ucyB9IGZyb20gJy4vUm91bmRCdXR0b24uanMnO1xyXG5pbXBvcnQgb3B0aW9uaXplIGZyb20gJy4uLy4uLy4uL3BoZXQtY29yZS9qcy9vcHRpb25pemUuanMnO1xyXG5pbXBvcnQgVFNvdW5kUGxheWVyIGZyb20gJy4uLy4uLy4uL3RhbWJvL2pzL1RTb3VuZFBsYXllci5qcyc7XHJcblxyXG50eXBlIFNlbGZPcHRpb25zID0ge1xyXG4gIHNvdW5kUGxheWVyPzogVFNvdW5kUGxheWVyO1xyXG59O1xyXG5cclxuLy9UT0RPIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9zdW4vaXNzdWVzLzc0OSBMZXQncyBub3QgY3JlYXRlIFB1c2hCdXR0b25Nb2RlbCB3aXRoIHRoZXNlIG9wdGlvbnM/XHJcbnR5cGUgU3VwZXJPcHRpb25zID0gUm91bmRCdXR0b25PcHRpb25zICYgUHVzaEJ1dHRvbk1vZGVsT3B0aW9ucztcclxuXHJcbmV4cG9ydCB0eXBlIFJvdW5kUHVzaEJ1dHRvbk9wdGlvbnMgPSBTZWxmT3B0aW9ucyAmIFN1cGVyT3B0aW9ucztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJvdW5kUHVzaEJ1dHRvbiBleHRlbmRzIFJvdW5kQnV0dG9uIHtcclxuXHJcbiAgLy8gUm91bmRCdXR0b24gaGFzIHRoaXMuYnV0dG9uTW9kZWwsIGJ1dCB3ZSBhbHNvIG5lZWQgdGhpcy5wdXNoQnV0dG9uTW9kZWwsIGJlY2F1c2UgaXQgaGFzIGFkZGl0aW9uYWwgbWV0aG9kc1xyXG4gIHByb3RlY3RlZCByZWFkb25seSBwdXNoQnV0dG9uTW9kZWw6IFB1c2hCdXR0b25Nb2RlbDtcclxuXHJcbiAgcHJpdmF0ZSByZWFkb25seSBkaXNwb3NlUm91bmRQdXNoQnV0dG9uOiAoKSA9PiB2b2lkO1xyXG5cclxuICBwdWJsaWMgY29uc3RydWN0b3IoIHByb3ZpZGVkT3B0aW9ucz86IFJvdW5kUHVzaEJ1dHRvbk9wdGlvbnMgKSB7XHJcblxyXG4gICAgY29uc3Qgb3B0aW9ucyA9IG9wdGlvbml6ZTxSb3VuZFB1c2hCdXR0b25PcHRpb25zLCBTZWxmT3B0aW9ucywgU3VwZXJPcHRpb25zPigpKCB7XHJcbiAgICAgIHNvdW5kUGxheWVyOiBwdXNoQnV0dG9uU291bmRQbGF5ZXIsXHJcbiAgICAgIHRhbmRlbTogVGFuZGVtLlJFUVVJUkVEXHJcbiAgICB9LCBwcm92aWRlZE9wdGlvbnMgKTtcclxuXHJcbiAgICAvLyBTYXZlIHRoZSBsaXN0ZW5lciBhbmQgYWRkIGl0IGFmdGVyIGNyZWF0aW5nIHRoZSBidXR0b24gbW9kZWwuIFRoaXMgaXMgZG9uZSBzbyB0aGF0XHJcbiAgICAvLyB0aGUgc2FtZSBjb2RlIHBhdGggaXMgYWx3YXlzIHVzZWQgZm9yIGFkZGluZyBsaXN0ZW5lciwgdGh1cyBndWFyYW50ZWVpbmcgYSBjb25zaXN0ZW50IGNvZGUgcGF0aCBpZiBhZGRMaXN0ZW5lciBpc1xyXG4gICAgLy8gb3ZlcnJpZGRlbiwgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9zdW4vaXNzdWVzLzI4NC5cclxuICAgIGNvbnN0IGxpc3RlbmVyID0gb3B0aW9ucy5saXN0ZW5lcjtcclxuICAgIGNvbnN0IHN1cGVyT3B0aW9ucyA9IF8ub21pdCggb3B0aW9ucywgWyAnbGlzdGVuZXInIF0gKTtcclxuXHJcbiAgICAvLyBOb3RlIGl0IHNoYXJlcyBhIHRhbmRlbSB3aXRoIHRoaXMsIHNvIHRoZSBlbWl0dGVyIHdpbGwgYmUgaW5zdHJ1bWVudGVkIGFzIGEgY2hpbGQgb2YgdGhlIGJ1dHRvblxyXG4gICAgLy9UT0RPIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9zdW4vaXNzdWVzLzc0OSBpdHMgc3VycHJpc2luZyB0aGF0IHdlIGNhbiBwYXNzIHN1cGVyT3B0aW9ucyB3aXRoIGlycmVsZXZhbnQgZmllbGRzIHRvIFB1c2hCdXR0b25Nb2RlbCB3aXRob3V0IFRTIGVycm9yc1xyXG4gICAgY29uc3QgcHVzaEJ1dHRvbk1vZGVsID0gbmV3IFB1c2hCdXR0b25Nb2RlbCggc3VwZXJPcHRpb25zICk7XHJcblxyXG4gICAgc3VwZXIoIHB1c2hCdXR0b25Nb2RlbCwgbmV3IFB1c2hCdXR0b25JbnRlcmFjdGlvblN0YXRlUHJvcGVydHkoIHB1c2hCdXR0b25Nb2RlbCApLCBzdXBlck9wdGlvbnMgKTtcclxuXHJcbiAgICB0aGlzLnB1c2hCdXR0b25Nb2RlbCA9IHB1c2hCdXR0b25Nb2RlbDtcclxuXHJcbiAgICAvLyBhZGQgdGhlIGxpc3RlbmVyIHRoYXQgd2FzIHBvdGVudGlhbGx5IHNhdmVkIGFib3ZlXHJcbiAgICBsaXN0ZW5lciAmJiB0aGlzLmFkZExpc3RlbmVyKCBsaXN0ZW5lciApO1xyXG5cclxuICAgIC8vIHNvdW5kIGdlbmVyYXRpb25cclxuICAgIGNvbnN0IHBsYXlTb3VuZCA9ICgpID0+IHsgb3B0aW9ucy5zb3VuZFBsYXllci5wbGF5KCk7IH07XHJcbiAgICBwdXNoQnV0dG9uTW9kZWwucHJvZHVjZVNvdW5kRW1pdHRlci5hZGRMaXN0ZW5lciggcGxheVNvdW5kICk7XHJcblxyXG4gICAgdGhpcy5kaXNwb3NlUm91bmRQdXNoQnV0dG9uID0gKCkgPT4ge1xyXG4gICAgICBwdXNoQnV0dG9uTW9kZWwucHJvZHVjZVNvdW5kRW1pdHRlci5yZW1vdmVMaXN0ZW5lciggcGxheVNvdW5kICk7XHJcbiAgICAgIHB1c2hCdXR0b25Nb2RlbC5kaXNwb3NlKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIHN1cHBvcnQgZm9yIGJpbmRlciBkb2N1bWVudGF0aW9uLCBzdHJpcHBlZCBvdXQgaW4gYnVpbGRzIGFuZCBvbmx5IHJ1bnMgd2hlbiA/YmluZGVyIGlzIHNwZWNpZmllZFxyXG4gICAgYXNzZXJ0ICYmIHBoZXQ/LmNoaXBwZXI/LnF1ZXJ5UGFyYW1ldGVycz8uYmluZGVyICYmIEluc3RhbmNlUmVnaXN0cnkucmVnaXN0ZXJEYXRhVVJMKCAnc3VuJywgJ1JvdW5kUHVzaEJ1dHRvbicsIHRoaXMgKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBvdmVycmlkZSBkaXNwb3NlKCk6IHZvaWQge1xyXG5cclxuICAgIC8vIFRoZSBvcmRlciBvZiBvcGVyYXRpb25zIGhlcmUgaXMgaW1wb3J0YW50IC0gdGhlIHZpZXcgbmVlZHMgdG8gYmUgZGlzcG9zZWQgZmlyc3Qgc28gdGhhdCBpdCBpcyB1bmhvb2tlZCBmcm9tXHJcbiAgICAvLyB0aGUgbW9kZWwgYmVmb3JlIHRoZSBtb2RlbCBpcyBkaXNwb3NlZC4gIElmIHRoZSBtb2RlbCBpcyBkaXNwb3NlZCBmaXJzdCwgdGhlIHZpZXcgZW5kcyB1cCB0cnlpbmcgdG8gY2hhbmdlIHNvbWVcclxuICAgIC8vIG9mIGl0cyBQcm9wZXJ0eSB2YWx1ZXMgd2hlbiBpdCBpcyBkaXNwb3NlZC4gIFNlZSBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMvYXhvbi9pc3N1ZXMvMjQyLlxyXG4gICAgc3VwZXIuZGlzcG9zZSgpO1xyXG4gICAgdGhpcy5kaXNwb3NlUm91bmRQdXNoQnV0dG9uKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBBZGRzIGEgbGlzdGVuZXIgdGhhdCB3aWxsIGJlIG5vdGlmaWVkIHdoZW4gdGhlIGJ1dHRvbiBmaXJlcy5cclxuICAgKi9cclxuICBwdWJsaWMgYWRkTGlzdGVuZXIoIGxpc3RlbmVyOiBQdXNoQnV0dG9uTGlzdGVuZXIgKTogdm9pZCB7XHJcbiAgICB0aGlzLnB1c2hCdXR0b25Nb2RlbC5hZGRMaXN0ZW5lciggbGlzdGVuZXIgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlbW92ZXMgYSBsaXN0ZW5lci5cclxuICAgKi9cclxuICBwdWJsaWMgcmVtb3ZlTGlzdGVuZXIoIGxpc3RlbmVyOiBQdXNoQnV0dG9uTGlzdGVuZXIgKTogdm9pZCB7XHJcbiAgICB0aGlzLnB1c2hCdXR0b25Nb2RlbC5yZW1vdmVMaXN0ZW5lciggbGlzdGVuZXIgKTtcclxuICB9XHJcbn1cclxuXHJcbnN1bi5yZWdpc3RlciggJ1JvdW5kUHVzaEJ1dHRvbicsIFJvdW5kUHVzaEJ1dHRvbiApOyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU9BLGdCQUFnQixNQUFNLHlEQUF5RDtBQUN0RixPQUFPQyxxQkFBcUIsTUFBTSxpRUFBaUU7QUFDbkcsT0FBT0MsTUFBTSxNQUFNLDhCQUE4QjtBQUNqRCxPQUFPQyxHQUFHLE1BQU0sV0FBVztBQUMzQixPQUFPQyxrQ0FBa0MsTUFBTSx5Q0FBeUM7QUFDeEYsT0FBT0MsZUFBZSxNQUFzRCxzQkFBc0I7QUFDbEcsT0FBT0MsV0FBVyxNQUE4QixrQkFBa0I7QUFDbEUsT0FBT0MsU0FBUyxNQUFNLG9DQUFvQzs7QUFPMUQ7O0FBS0EsZUFBZSxNQUFNQyxlQUFlLFNBQVNGLFdBQVcsQ0FBQztFQUV2RDs7RUFLT0csV0FBV0EsQ0FBRUMsZUFBd0MsRUFBRztJQUU3RCxNQUFNQyxPQUFPLEdBQUdKLFNBQVMsQ0FBb0QsQ0FBQyxDQUFFO01BQzlFSyxXQUFXLEVBQUVYLHFCQUFxQjtNQUNsQ1ksTUFBTSxFQUFFWCxNQUFNLENBQUNZO0lBQ2pCLENBQUMsRUFBRUosZUFBZ0IsQ0FBQzs7SUFFcEI7SUFDQTtJQUNBO0lBQ0EsTUFBTUssUUFBUSxHQUFHSixPQUFPLENBQUNJLFFBQVE7SUFDakMsTUFBTUMsWUFBWSxHQUFHQyxDQUFDLENBQUNDLElBQUksQ0FBRVAsT0FBTyxFQUFFLENBQUUsVUFBVSxDQUFHLENBQUM7O0lBRXREO0lBQ0E7SUFDQSxNQUFNUSxlQUFlLEdBQUcsSUFBSWQsZUFBZSxDQUFFVyxZQUFhLENBQUM7SUFFM0QsS0FBSyxDQUFFRyxlQUFlLEVBQUUsSUFBSWYsa0NBQWtDLENBQUVlLGVBQWdCLENBQUMsRUFBRUgsWUFBYSxDQUFDO0lBRWpHLElBQUksQ0FBQ0csZUFBZSxHQUFHQSxlQUFlOztJQUV0QztJQUNBSixRQUFRLElBQUksSUFBSSxDQUFDSyxXQUFXLENBQUVMLFFBQVMsQ0FBQzs7SUFFeEM7SUFDQSxNQUFNTSxTQUFTLEdBQUdBLENBQUEsS0FBTTtNQUFFVixPQUFPLENBQUNDLFdBQVcsQ0FBQ1UsSUFBSSxDQUFDLENBQUM7SUFBRSxDQUFDO0lBQ3ZESCxlQUFlLENBQUNJLG1CQUFtQixDQUFDSCxXQUFXLENBQUVDLFNBQVUsQ0FBQztJQUU1RCxJQUFJLENBQUNHLHNCQUFzQixHQUFHLE1BQU07TUFDbENMLGVBQWUsQ0FBQ0ksbUJBQW1CLENBQUNFLGNBQWMsQ0FBRUosU0FBVSxDQUFDO01BQy9ERixlQUFlLENBQUNPLE9BQU8sQ0FBQyxDQUFDO0lBQzNCLENBQUM7O0lBRUQ7SUFDQUMsTUFBTSxJQUFJQyxJQUFJLEVBQUVDLE9BQU8sRUFBRUMsZUFBZSxFQUFFQyxNQUFNLElBQUkvQixnQkFBZ0IsQ0FBQ2dDLGVBQWUsQ0FBRSxLQUFLLEVBQUUsaUJBQWlCLEVBQUUsSUFBSyxDQUFDO0VBQ3hIO0VBRWdCTixPQUFPQSxDQUFBLEVBQVM7SUFFOUI7SUFDQTtJQUNBO0lBQ0EsS0FBSyxDQUFDQSxPQUFPLENBQUMsQ0FBQztJQUNmLElBQUksQ0FBQ0Ysc0JBQXNCLENBQUMsQ0FBQztFQUMvQjs7RUFFQTtBQUNGO0FBQ0E7RUFDU0osV0FBV0EsQ0FBRUwsUUFBNEIsRUFBUztJQUN2RCxJQUFJLENBQUNJLGVBQWUsQ0FBQ0MsV0FBVyxDQUFFTCxRQUFTLENBQUM7RUFDOUM7O0VBRUE7QUFDRjtBQUNBO0VBQ1NVLGNBQWNBLENBQUVWLFFBQTRCLEVBQVM7SUFDMUQsSUFBSSxDQUFDSSxlQUFlLENBQUNNLGNBQWMsQ0FBRVYsUUFBUyxDQUFDO0VBQ2pEO0FBQ0Y7QUFFQVosR0FBRyxDQUFDOEIsUUFBUSxDQUFFLGlCQUFpQixFQUFFekIsZUFBZ0IsQ0FBQyIsImlnbm9yZUxpc3QiOltdfQ==