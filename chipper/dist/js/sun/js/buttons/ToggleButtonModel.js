// Copyright 2014-2024, University of Colorado Boulder

/**
 * Model for a toggle button that changes value on each "up" event when the button is released.
 *
 * @author Sam Reid (PhET Interactive Simulations)
 * @author John Blanco (PhET Interactive Simulations)
 */

import Emitter from '../../../axon/js/Emitter.js';
import optionize from '../../../phet-core/js/optionize.js';
import EventType from '../../../tandem/js/EventType.js';
import Tandem from '../../../tandem/js/Tandem.js';
import sun from '../sun.js';
import ButtonModel from './ButtonModel.js';
export default class ToggleButtonModel extends ButtonModel {
  /**
   * @param valueOff - value when the button is in the off state
   * @param valueOn - value when the button is in the on state
   * @param property - axon Property that can be either valueOff or valueOn.
   * @param [providedOptions]
   */
  constructor(valueOff, valueOn, property, providedOptions) {
    assert && assert(property.valueComparisonStrategy === 'reference', 'ToggleButtonModel depends on "===" equality for value comparison');
    const options = optionize()({
      tandem: Tandem.REQUIRED
    }, providedOptions);
    super(options);
    this.valueOff = valueOff;
    this.valueOn = valueOn;
    this.valueProperty = property;

    // Behaves like a push button (with fireOnDown:false), but toggles its state when the button is released.
    const downListener = down => {
      if ((this.overProperty.get() || this.focusedProperty.get()) && this.enabledProperty.get() && !this.interrupted) {
        if (!down) {
          this.toggle();
        }
      }
    };
    this.downProperty.link(downListener);
    this.toggledEmitter = new Emitter({
      tandem: options.tandem.createTandem('toggledEmitter'),
      phetioDocumentation: 'Emits when the button is toggled',
      phetioEventType: EventType.USER
    });
    const toggleListener = () => {
      assert && assert(this.valueProperty.value === this.valueOff || this.valueProperty.value === this.valueOn, `unrecognized value: ${this.valueProperty.value}`);
      this.valueProperty.value = this.valueProperty.value === this.valueOff ? this.valueOn : this.valueOff;
    };
    this.toggledEmitter.addListener(toggleListener);
    this.disposeToggleButtonModel = () => {
      this.downProperty.unlink(downListener);
      this.toggledEmitter.dispose();
    };
  }
  dispose() {
    this.disposeToggleButtonModel();
    super.dispose();
  }
  toggle() {
    this.toggledEmitter.emit();
    this.produceSoundEmitter.emit();
  }
}
sun.register('ToggleButtonModel', ToggleButtonModel);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJFbWl0dGVyIiwib3B0aW9uaXplIiwiRXZlbnRUeXBlIiwiVGFuZGVtIiwic3VuIiwiQnV0dG9uTW9kZWwiLCJUb2dnbGVCdXR0b25Nb2RlbCIsImNvbnN0cnVjdG9yIiwidmFsdWVPZmYiLCJ2YWx1ZU9uIiwicHJvcGVydHkiLCJwcm92aWRlZE9wdGlvbnMiLCJhc3NlcnQiLCJ2YWx1ZUNvbXBhcmlzb25TdHJhdGVneSIsIm9wdGlvbnMiLCJ0YW5kZW0iLCJSRVFVSVJFRCIsInZhbHVlUHJvcGVydHkiLCJkb3duTGlzdGVuZXIiLCJkb3duIiwib3ZlclByb3BlcnR5IiwiZ2V0IiwiZm9jdXNlZFByb3BlcnR5IiwiZW5hYmxlZFByb3BlcnR5IiwiaW50ZXJydXB0ZWQiLCJ0b2dnbGUiLCJkb3duUHJvcGVydHkiLCJsaW5rIiwidG9nZ2xlZEVtaXR0ZXIiLCJjcmVhdGVUYW5kZW0iLCJwaGV0aW9Eb2N1bWVudGF0aW9uIiwicGhldGlvRXZlbnRUeXBlIiwiVVNFUiIsInRvZ2dsZUxpc3RlbmVyIiwidmFsdWUiLCJhZGRMaXN0ZW5lciIsImRpc3Bvc2VUb2dnbGVCdXR0b25Nb2RlbCIsInVubGluayIsImRpc3Bvc2UiLCJlbWl0IiwicHJvZHVjZVNvdW5kRW1pdHRlciIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiVG9nZ2xlQnV0dG9uTW9kZWwudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTQtMjAyNCwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogTW9kZWwgZm9yIGEgdG9nZ2xlIGJ1dHRvbiB0aGF0IGNoYW5nZXMgdmFsdWUgb24gZWFjaCBcInVwXCIgZXZlbnQgd2hlbiB0aGUgYnV0dG9uIGlzIHJlbGVhc2VkLlxyXG4gKlxyXG4gKiBAYXV0aG9yIFNhbSBSZWlkIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKiBAYXV0aG9yIEpvaG4gQmxhbmNvIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKi9cclxuXHJcbmltcG9ydCBFbWl0dGVyIGZyb20gJy4uLy4uLy4uL2F4b24vanMvRW1pdHRlci5qcyc7XHJcbmltcG9ydCBURW1pdHRlciBmcm9tICcuLi8uLi8uLi9heG9uL2pzL1RFbWl0dGVyLmpzJztcclxuaW1wb3J0IFRQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi9heG9uL2pzL1RQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBvcHRpb25pemUsIHsgRW1wdHlTZWxmT3B0aW9ucyB9IGZyb20gJy4uLy4uLy4uL3BoZXQtY29yZS9qcy9vcHRpb25pemUuanMnO1xyXG5pbXBvcnQgRXZlbnRUeXBlIGZyb20gJy4uLy4uLy4uL3RhbmRlbS9qcy9FdmVudFR5cGUuanMnO1xyXG5pbXBvcnQgVGFuZGVtIGZyb20gJy4uLy4uLy4uL3RhbmRlbS9qcy9UYW5kZW0uanMnO1xyXG5pbXBvcnQgc3VuIGZyb20gJy4uL3N1bi5qcyc7XHJcbmltcG9ydCBCdXR0b25Nb2RlbCwgeyBCdXR0b25Nb2RlbE9wdGlvbnMgfSBmcm9tICcuL0J1dHRvbk1vZGVsLmpzJztcclxuXHJcbnR5cGUgU2VsZk9wdGlvbnMgPSBFbXB0eVNlbGZPcHRpb25zO1xyXG5cclxuZXhwb3J0IHR5cGUgVG9nZ2xlQnV0dG9uTW9kZWxPcHRpb25zID0gU2VsZk9wdGlvbnMgJiBCdXR0b25Nb2RlbE9wdGlvbnM7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBUb2dnbGVCdXR0b25Nb2RlbDxUPiBleHRlbmRzIEJ1dHRvbk1vZGVsIHtcclxuXHJcbiAgcHVibGljIHJlYWRvbmx5IHZhbHVlUHJvcGVydHk6IFRQcm9wZXJ0eTxUPjtcclxuICBwdWJsaWMgcmVhZG9ubHkgdmFsdWVPZmY6IFQ7XHJcbiAgcHVibGljIHJlYWRvbmx5IHZhbHVlT246IFQ7XHJcblxyXG4gIHByaXZhdGUgcmVhZG9ubHkgdG9nZ2xlZEVtaXR0ZXI6IFRFbWl0dGVyO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgZGlzcG9zZVRvZ2dsZUJ1dHRvbk1vZGVsOiAoKSA9PiB2b2lkO1xyXG5cclxuICAvKipcclxuICAgKiBAcGFyYW0gdmFsdWVPZmYgLSB2YWx1ZSB3aGVuIHRoZSBidXR0b24gaXMgaW4gdGhlIG9mZiBzdGF0ZVxyXG4gICAqIEBwYXJhbSB2YWx1ZU9uIC0gdmFsdWUgd2hlbiB0aGUgYnV0dG9uIGlzIGluIHRoZSBvbiBzdGF0ZVxyXG4gICAqIEBwYXJhbSBwcm9wZXJ0eSAtIGF4b24gUHJvcGVydHkgdGhhdCBjYW4gYmUgZWl0aGVyIHZhbHVlT2ZmIG9yIHZhbHVlT24uXHJcbiAgICogQHBhcmFtIFtwcm92aWRlZE9wdGlvbnNdXHJcbiAgICovXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCB2YWx1ZU9mZjogVCwgdmFsdWVPbjogVCwgcHJvcGVydHk6IFRQcm9wZXJ0eTxUPiwgcHJvdmlkZWRPcHRpb25zPzogVG9nZ2xlQnV0dG9uTW9kZWxPcHRpb25zICkge1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggcHJvcGVydHkudmFsdWVDb21wYXJpc29uU3RyYXRlZ3kgPT09ICdyZWZlcmVuY2UnLFxyXG4gICAgICAnVG9nZ2xlQnV0dG9uTW9kZWwgZGVwZW5kcyBvbiBcIj09PVwiIGVxdWFsaXR5IGZvciB2YWx1ZSBjb21wYXJpc29uJyApO1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSBvcHRpb25pemU8VG9nZ2xlQnV0dG9uTW9kZWxPcHRpb25zLCBTZWxmT3B0aW9ucywgQnV0dG9uTW9kZWxPcHRpb25zPigpKCB7XHJcbiAgICAgIHRhbmRlbTogVGFuZGVtLlJFUVVJUkVEXHJcbiAgICB9LCBwcm92aWRlZE9wdGlvbnMgKTtcclxuXHJcbiAgICBzdXBlciggb3B0aW9ucyApO1xyXG5cclxuICAgIHRoaXMudmFsdWVPZmYgPSB2YWx1ZU9mZjtcclxuICAgIHRoaXMudmFsdWVPbiA9IHZhbHVlT247XHJcbiAgICB0aGlzLnZhbHVlUHJvcGVydHkgPSBwcm9wZXJ0eTtcclxuXHJcbiAgICAvLyBCZWhhdmVzIGxpa2UgYSBwdXNoIGJ1dHRvbiAod2l0aCBmaXJlT25Eb3duOmZhbHNlKSwgYnV0IHRvZ2dsZXMgaXRzIHN0YXRlIHdoZW4gdGhlIGJ1dHRvbiBpcyByZWxlYXNlZC5cclxuICAgIGNvbnN0IGRvd25MaXN0ZW5lciA9ICggZG93bjogYm9vbGVhbiApID0+IHtcclxuICAgICAgaWYgKCAoIHRoaXMub3ZlclByb3BlcnR5LmdldCgpIHx8IHRoaXMuZm9jdXNlZFByb3BlcnR5LmdldCgpICkgJiYgdGhpcy5lbmFibGVkUHJvcGVydHkuZ2V0KCkgJiYgIXRoaXMuaW50ZXJydXB0ZWQgKSB7XHJcbiAgICAgICAgaWYgKCAhZG93biApIHtcclxuICAgICAgICAgIHRoaXMudG9nZ2xlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gICAgdGhpcy5kb3duUHJvcGVydHkubGluayggZG93bkxpc3RlbmVyICk7XHJcblxyXG4gICAgdGhpcy50b2dnbGVkRW1pdHRlciA9IG5ldyBFbWl0dGVyKCB7XHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAndG9nZ2xlZEVtaXR0ZXInICksXHJcbiAgICAgIHBoZXRpb0RvY3VtZW50YXRpb246ICdFbWl0cyB3aGVuIHRoZSBidXR0b24gaXMgdG9nZ2xlZCcsXHJcbiAgICAgIHBoZXRpb0V2ZW50VHlwZTogRXZlbnRUeXBlLlVTRVJcclxuICAgIH0gKTtcclxuXHJcbiAgICBjb25zdCB0b2dnbGVMaXN0ZW5lciA9ICgpID0+IHtcclxuICAgICAgYXNzZXJ0ICYmIGFzc2VydCggdGhpcy52YWx1ZVByb3BlcnR5LnZhbHVlID09PSB0aGlzLnZhbHVlT2ZmIHx8IHRoaXMudmFsdWVQcm9wZXJ0eS52YWx1ZSA9PT0gdGhpcy52YWx1ZU9uLFxyXG4gICAgICAgIGB1bnJlY29nbml6ZWQgdmFsdWU6ICR7dGhpcy52YWx1ZVByb3BlcnR5LnZhbHVlfWAgKTtcclxuXHJcbiAgICAgIHRoaXMudmFsdWVQcm9wZXJ0eS52YWx1ZSA9IHRoaXMudmFsdWVQcm9wZXJ0eS52YWx1ZSA9PT0gdGhpcy52YWx1ZU9mZiA/IHRoaXMudmFsdWVPbiA6IHRoaXMudmFsdWVPZmY7XHJcbiAgICB9O1xyXG4gICAgdGhpcy50b2dnbGVkRW1pdHRlci5hZGRMaXN0ZW5lciggdG9nZ2xlTGlzdGVuZXIgKTtcclxuXHJcbiAgICB0aGlzLmRpc3Bvc2VUb2dnbGVCdXR0b25Nb2RlbCA9ICgpID0+IHtcclxuICAgICAgdGhpcy5kb3duUHJvcGVydHkudW5saW5rKCBkb3duTGlzdGVuZXIgKTtcclxuICAgICAgdGhpcy50b2dnbGVkRW1pdHRlci5kaXNwb3NlKCk7XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgcHVibGljIG92ZXJyaWRlIGRpc3Bvc2UoKTogdm9pZCB7XHJcbiAgICB0aGlzLmRpc3Bvc2VUb2dnbGVCdXR0b25Nb2RlbCgpO1xyXG4gICAgc3VwZXIuZGlzcG9zZSgpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSB0b2dnbGUoKTogdm9pZCB7XHJcbiAgICB0aGlzLnRvZ2dsZWRFbWl0dGVyLmVtaXQoKTtcclxuICAgIHRoaXMucHJvZHVjZVNvdW5kRW1pdHRlci5lbWl0KCk7XHJcbiAgfVxyXG59XHJcblxyXG5zdW4ucmVnaXN0ZXIoICdUb2dnbGVCdXR0b25Nb2RlbCcsIFRvZ2dsZUJ1dHRvbk1vZGVsICk7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsT0FBTyxNQUFNLDZCQUE2QjtBQUdqRCxPQUFPQyxTQUFTLE1BQTRCLG9DQUFvQztBQUNoRixPQUFPQyxTQUFTLE1BQU0saUNBQWlDO0FBQ3ZELE9BQU9DLE1BQU0sTUFBTSw4QkFBOEI7QUFDakQsT0FBT0MsR0FBRyxNQUFNLFdBQVc7QUFDM0IsT0FBT0MsV0FBVyxNQUE4QixrQkFBa0I7QUFNbEUsZUFBZSxNQUFNQyxpQkFBaUIsU0FBWUQsV0FBVyxDQUFDO0VBUzVEO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtFQUNTRSxXQUFX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