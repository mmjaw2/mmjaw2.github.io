// Copyright 2016-2024, University of Colorado Boulder

/**
 * Shows a track on a slider.  Must be supplied a Node for rendering the track.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 * @author Sam Reid (PhET Interactive Simulations)
 * @author Jesse Greenberg (PhET Interactive Simulations)
 */

import Dimension2 from '../../dot/js/Dimension2.js';
import LinearFunction from '../../dot/js/LinearFunction.js';
import Range from '../../dot/js/Range.js';
import ValueChangeSoundPlayer from '../../tambo/js/sound-generators/ValueChangeSoundPlayer.js';
import optionize from '../../phet-core/js/optionize.js';
import { DragListener, Node, WidthSizable } from '../../scenery/js/imports.js';
import Tandem from '../../tandem/js/Tandem.js';
import sun from './sun.js';
import Slider from './Slider.js';
import TinyProperty from '../../axon/js/TinyProperty.js';
import DerivedProperty from '../../axon/js/DerivedProperty.js';
export default class SliderTrack extends WidthSizable(Node) {
  // For use by Slider, maps the value along the range of the track to the position along the width of the track

  // public so that clients can access Properties of the DragListener that tell us about its state
  // See https://github.com/phetsims/sun/issues/680

  // (sun-internal)

  constructor(valueProperty, trackNode, range, providedOptions) {
    super();
    this.rangeProperty = range instanceof Range ? new TinyProperty(range) : range;
    const options = optionize()({
      size: new Dimension2(100, 5),
      startDrag: _.noop,
      // called when a drag sequence starts
      drag: _.noop,
      // called at the beginning of a drag event, before any other drag work happens
      endDrag: _.noop,
      // called when a drag sequence ends
      constrainValue: _.identity,
      // called before valueProperty is set
      enabledRangeProperty: this.rangeProperty,
      soundGenerator: Slider.DEFAULT_SOUND_GENERATOR,
      valueChangeSoundGeneratorOptions: {},
      voicingOnEndResponse: _.noop,
      leftVisualOverflow: 0,
      rightVisualOverflow: 0,
      // phet-io
      tandem: Tandem.REQUIRED,
      tandemNameSuffix: 'TrackNode'
    }, providedOptions);

    // If no sound generator was provided, create the default.
    if (options.soundGenerator === Slider.DEFAULT_SOUND_GENERATOR) {
      // NOTE: We'll want to update ValueChangeSoundPlayer for dynamic ranges if it's used more for that
      options.soundGenerator = new ValueChangeSoundPlayer(this.rangeProperty.value, options.valueChangeSoundGeneratorOptions || {});
    } else if (options.soundGenerator === null) {
      options.soundGenerator = ValueChangeSoundPlayer.NO_SOUND;
    }
    this.leftVisualOverflow = options.leftVisualOverflow;
    this.rightVisualOverflow = options.rightVisualOverflow;
    this.minimumSize = options.size;
    this.minimumWidth = this.minimumSize.width;
    this.internalWidthProperty = new DerivedProperty([this.localPreferredWidthProperty], localPreferredWidth => {
      // Our preferred width should be subtracted out by the anticipated overflow, so that our size can be slightly
      // smaller.
      return (localPreferredWidth === null ? this.minimumSize.width : Math.max(this.minimumSize.width, localPreferredWidth)) - options.leftVisualOverflow - options.rightVisualOverflow;
    });
    this.sizeProperty = new DerivedProperty([this.internalWidthProperty], width => new Dimension2(width, this.minimumSize.height));

    // NOTE: Slider needs to make a lot of assumptions about how this works (in order to figure out proper layout).
    // DO NOT change without taking a CLOSE CLOSE look at Slider's layout code.
    this.valueToPositionProperty = new DerivedProperty([this.rangeProperty, this.internalWidthProperty], (range, width) => {
      return new LinearFunction(range.min, range.max, 0, width, true /* clamp */);
    });

    // click in the track to change the value, continue dragging if desired
    const handleTrackEvent = (event, trail) => {
      const oldValue = valueProperty.value;
      const transform = trail.subtrailTo(this).getTransform();
      const x = transform.inversePosition2(event.pointer.point).x;
      const value = this.valueToPositionProperty.value.inverse(x);
      const valueInRange = options.enabledRangeProperty.value.constrainValue(value);
      const newValue = options.constrainValue(valueInRange);
      valueProperty.set(newValue);

      // Down events on the track can cause value changes.  If that's what just happened, play a sound.
      if (event.type === 'down') {
        options.soundGenerator.playSoundIfThresholdReached(newValue, oldValue);
      }
    };
    this.addChild(trackNode);
    let valueOnStart = valueProperty.value;
    this.dragListener = new DragListener({
      tandem: options.tandem.createTandem('dragListener'),
      start: (event, listener) => {
        options.startDrag(event);
        valueOnStart = valueProperty.value;
        handleTrackEvent(event, listener.pressedTrail);
      },
      drag: (event, listener) => {
        options.drag(event);

        // Reuse the same handleTrackEvent but make sure the startedCallbacks call is made before the value changes
        handleTrackEvent(event, listener.pressedTrail);
      },
      end: event => {
        options.endDrag(event);
        options.voicingOnEndResponse(valueOnStart);
      }
    });
    trackNode.addInputListener(this.dragListener);
    this.mutate(options);
    this.disposeSliderTrack = () => {
      trackNode.removeInputListener(this.dragListener);
      this.dragListener.dispose();
    };
  }
  dispose() {
    this.disposeSliderTrack();
    super.dispose();
  }
}
sun.register('SliderTrack', SliderTrack);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEaW1lbnNpb24yIiwiTGluZWFyRnVuY3Rpb24iLCJSYW5nZSIsIlZhbHVlQ2hhbmdlU291bmRQbGF5ZXIiLCJvcHRpb25pemUiLCJEcmFnTGlzdGVuZXIiLCJOb2RlIiwiV2lkdGhTaXphYmxlIiwiVGFuZGVtIiwic3VuIiwiU2xpZGVyIiwiVGlueVByb3BlcnR5IiwiRGVyaXZlZFByb3BlcnR5IiwiU2xpZGVyVHJhY2siLCJjb25zdHJ1Y3RvciIsInZhbHVlUHJvcGVydHkiLCJ0cmFja05vZGUiLCJyYW5nZSIsInByb3ZpZGVkT3B0aW9ucyIsInJhbmdlUHJvcGVydHkiLCJvcHRpb25zIiwic2l6ZSIsInN0YXJ0RHJhZyIsIl8iLCJub29wIiwiZHJhZyIsImVuZERyYWciLCJjb25zdHJhaW5WYWx1ZSIsImlkZW50aXR5IiwiZW5hYmxlZFJhbmdlUHJvcGVydHkiLCJzb3VuZEdlbmVyYXRvciIsIkRFRkFVTFRfU09VTkRfR0VORVJBVE9SIiwidmFsdWVDaGFuZ2VTb3VuZEdlbmVyYXRvck9wdGlvbnMiLCJ2b2ljaW5nT25FbmRSZXNwb25zZSIsImxlZnRWaXN1YWxPdmVyZmxvdyIsInJpZ2h0VmlzdWFsT3ZlcmZsb3ciLCJ0YW5kZW0iLCJSRVFVSVJFRCIsInRhbmRlbU5hbWVTdWZmaXgiLCJ2YWx1ZSIsIk5PX1NPVU5EIiwibWluaW11bVNpemUiLCJtaW5pbXVtV2lkdGgiLCJ3aWR0aCIsImludGVybmFsV2lkdGhQcm9wZXJ0eSIsImxvY2FsUHJlZmVycmVkV2lkdGhQcm9wZXJ0eSIsImxvY2FsUHJlZmVycmVkV2lkdGgiLCJNYXRoIiwibWF4Iiwic2l6ZVByb3BlcnR5IiwiaGVpZ2h0IiwidmFsdWVUb1Bvc2l0aW9uUHJvcGVydHkiLCJtaW4iLCJoYW5kbGVUcmFja0V2ZW50IiwiZXZlbnQiLCJ0cmFpbCIsIm9sZFZhbHVlIiwidHJhbnNmb3JtIiwic3VidHJhaWxUbyIsImdldFRyYW5zZm9ybSIsIngiLCJpbnZlcnNlUG9zaXRpb24yIiwicG9pbnRlciIsInBvaW50IiwiaW52ZXJzZSIsInZhbHVlSW5SYW5nZSIsIm5ld1ZhbHVlIiwic2V0IiwidHlwZSIsInBsYXlTb3VuZElmVGhyZXNob2xkUmVhY2hlZCIsImFkZENoaWxkIiwidmFsdWVPblN0YXJ0IiwiZHJhZ0xpc3RlbmVyIiwiY3JlYXRlVGFuZGVtIiwic3RhcnQiLCJsaXN0ZW5lciIsInByZXNzZWRUcmFpbCIsImVuZCIsImFkZElucHV0TGlzdGVuZXIiLCJtdXRhdGUiLCJkaXNwb3NlU2xpZGVyVHJhY2siLCJyZW1vdmVJbnB1dExpc3RlbmVyIiwiZGlzcG9zZSIsInJlZ2lzdGVyIl0sInNvdXJjZXMiOlsiU2xpZGVyVHJhY2sudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTYtMjAyNCwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcblxyXG4vKipcclxuICogU2hvd3MgYSB0cmFjayBvbiBhIHNsaWRlci4gIE11c3QgYmUgc3VwcGxpZWQgYSBOb2RlIGZvciByZW5kZXJpbmcgdGhlIHRyYWNrLlxyXG4gKlxyXG4gKiBAYXV0aG9yIENocmlzIE1hbGxleSAoUGl4ZWxab29tLCBJbmMuKVxyXG4gKiBAYXV0aG9yIFNhbSBSZWlkIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG4gKiBAYXV0aG9yIEplc3NlIEdyZWVuYmVyZyAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcblxyXG5pbXBvcnQgVFByb3BlcnR5IGZyb20gJy4uLy4uL2F4b24vanMvVFByb3BlcnR5LmpzJztcclxuaW1wb3J0IFRSZWFkT25seVByb3BlcnR5IGZyb20gJy4uLy4uL2F4b24vanMvVFJlYWRPbmx5UHJvcGVydHkuanMnO1xyXG5pbXBvcnQgRGltZW5zaW9uMiBmcm9tICcuLi8uLi9kb3QvanMvRGltZW5zaW9uMi5qcyc7XHJcbmltcG9ydCBMaW5lYXJGdW5jdGlvbiBmcm9tICcuLi8uLi9kb3QvanMvTGluZWFyRnVuY3Rpb24uanMnO1xyXG5pbXBvcnQgUmFuZ2UgZnJvbSAnLi4vLi4vZG90L2pzL1JhbmdlLmpzJztcclxuaW1wb3J0IFZhbHVlQ2hhbmdlU291bmRQbGF5ZXIsIHsgVmFsdWVDaGFuZ2VTb3VuZFBsYXllck9wdGlvbnMgfSBmcm9tICcuLi8uLi90YW1iby9qcy9zb3VuZC1nZW5lcmF0b3JzL1ZhbHVlQ2hhbmdlU291bmRQbGF5ZXIuanMnO1xyXG5pbXBvcnQgb3B0aW9uaXplIGZyb20gJy4uLy4uL3BoZXQtY29yZS9qcy9vcHRpb25pemUuanMnO1xyXG5pbXBvcnQgeyBEcmFnTGlzdGVuZXIsIE5vZGUsIE5vZGVPcHRpb25zLCBTY2VuZXJ5RXZlbnQsIFRyYWlsLCBXaWR0aFNpemFibGUgfSBmcm9tICcuLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgVGFuZGVtIGZyb20gJy4uLy4uL3RhbmRlbS9qcy9UYW5kZW0uanMnO1xyXG5pbXBvcnQgc3VuIGZyb20gJy4vc3VuLmpzJztcclxuaW1wb3J0IFNsaWRlciBmcm9tICcuL1NsaWRlci5qcyc7XHJcbmltcG9ydCB7IFZvaWNpbmdPbkVuZFJlc3BvbnNlIH0gZnJvbSAnLi9hY2Nlc3NpYmlsaXR5L0FjY2Vzc2libGVWYWx1ZUhhbmRsZXIuanMnO1xyXG5pbXBvcnQgVGlueVByb3BlcnR5IGZyb20gJy4uLy4uL2F4b24vanMvVGlueVByb3BlcnR5LmpzJztcclxuaW1wb3J0IERlcml2ZWRQcm9wZXJ0eSBmcm9tICcuLi8uLi9heG9uL2pzL0Rlcml2ZWRQcm9wZXJ0eS5qcyc7XHJcblxyXG50eXBlIFNlbGZPcHRpb25zID0ge1xyXG4gIC8vIE5PVEU6IGZvciBiYWNrd2FyZHMtY29tcGF0aWJpbGl0eSwgdGhlIHNpemUgZG9lcyBOT1QgaW5jbHVkZSB0aGUgZXh0ZW50IG9mIHRoZSBzdHJva2UsIHNvIHRoZSB0cmFjayB3aWxsIGJlIGxhcmdlclxyXG4gIC8vIHRoYW4gdGhpcyBzaXplXHJcbiAgc2l6ZT86IERpbWVuc2lvbjI7XHJcblxyXG4gIC8vIGNhbGxlZCB3aGVuIGEgZHJhZyBzZXF1ZW5jZSBzdGFydHNcclxuICBzdGFydERyYWc/OiAoIGU6IFNjZW5lcnlFdmVudCApID0+IHZvaWQ7XHJcblxyXG4gIC8vIGNhbGxlZCBhdCB0aGUgYmVnaW5uaW5nIG9mIGEgZHJhZyBldmVudCwgYmVmb3JlIGFueSBvdGhlciBkcmFnIHdvcmsgaGFwcGVuc1xyXG4gIGRyYWc/OiAoIGU6IFNjZW5lcnlFdmVudCApID0+IHZvaWQ7XHJcblxyXG4gIC8vIGNhbGxlZCB3aGVuIGEgZHJhZyBzZXF1ZW5jZSBlbmRzXHJcbiAgZW5kRHJhZz86ICggZTogU2NlbmVyeUV2ZW50IHwgbnVsbCApID0+IHZvaWQ7XHJcblxyXG4gIC8vIGNhbGxlZCBiZWZvcmUgdmFsdWVQcm9wZXJ0eSBpcyBzZXRcclxuICBjb25zdHJhaW5WYWx1ZT86ICggbjogbnVtYmVyICkgPT4gbnVtYmVyO1xyXG5cclxuICAvLyBEZWZhdWx0cyB0byBhIGNvbnN0YW50IHJhbmdlXHJcbiAgZW5hYmxlZFJhbmdlUHJvcGVydHk/OiBUUmVhZE9ubHlQcm9wZXJ0eTxSYW5nZT47XHJcblxyXG4gIC8vIFRoaXMgaXMgdXNlZCB0byBnZW5lcmF0ZSBzb3VuZHMgd2hlbiBjbGlja2luZyBpbiB0aGUgdHJhY2suICBJZiBub3QgcHJvdmlkZWQsIHRoZSBkZWZhdWx0IHNvdW5kIGdlbmVyYXRvclxyXG4gIC8vIHdpbGwgYmUgY3JlYXRlZC4gSWYgc2V0IHRvIG51bGwsIHRoZSBzbGlkZXIgd2lsbCBnZW5lcmF0ZSBubyBzb3VuZC5cclxuICBzb3VuZEdlbmVyYXRvcj86IFZhbHVlQ2hhbmdlU291bmRQbGF5ZXIgfCBudWxsO1xyXG5cclxuICAvLyBPcHRpb25zIGZvciB0aGUgZGVmYXVsdCBzb3VuZCBnZW5lcmF0b3IuICBUaGVzZSBzaG91bGQgb25seSBiZSBwcm92aWRlZCB3aGVuIHVzaW5nIHRoZSBkZWZhdWx0LlxyXG4gIHZhbHVlQ2hhbmdlU291bmRHZW5lcmF0b3JPcHRpb25zPzogVmFsdWVDaGFuZ2VTb3VuZFBsYXllck9wdGlvbnM7XHJcblxyXG4gIC8vIEFubm91bmNlcyB0aGUgdm9pY2luZyByZXNwb25zZSBhdCB0aGUgZW5kIG9mIGFuIGludGVyYWN0aW9uLiBVc2VkIGJ5IEFjY2Vzc2libGVWYWx1ZUhhbmRsZXIsIHNlZVxyXG4gIC8vIFNsaWRlciBmb3IgYW4gZXhhbXBsZSB1c2FnZS5cclxuICB2b2ljaW5nT25FbmRSZXNwb25zZT86IFZvaWNpbmdPbkVuZFJlc3BvbnNlO1xyXG5cclxuICAvLyBTaW5jZSBvdXIgaGlzdG9yaWNhbCBzbGlkZXIgdHJhY2tzIGV4dGVuZCBQQVNUIHRoZSAwLHNpemUgcmFuZ2UgKGUuZy4gd2l0aCBzdHJva2VzKSwgYW5kIHRoaXMgaW5mb3JtYXRpb24gaXMgbmVlZGVkXHJcbiAgLy8gc28gd2UgY2FuIGNvbnRyb2wgdGhlIHNpemUgYmFzZWQgb24gb3VyIHByZWZlcnJlZFdpZHRoLiBXZSdsbCBuZWVkIHRoZSBzaXplIHRvIGJlIHNvbWV3aGF0IHNtYWxsZXIgdGhhbiBvdXJcclxuICAvLyBwcmVmZXJyZWRXaWR0aFxyXG4gIGxlZnRWaXN1YWxPdmVyZmxvdz86IG51bWJlcjtcclxuICByaWdodFZpc3VhbE92ZXJmbG93PzogbnVtYmVyO1xyXG59O1xyXG5cclxuZXhwb3J0IHR5cGUgU2xpZGVyVHJhY2tPcHRpb25zID0gU2VsZk9wdGlvbnMgJiBOb2RlT3B0aW9ucztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNsaWRlclRyYWNrIGV4dGVuZHMgV2lkdGhTaXphYmxlKCBOb2RlICkge1xyXG5cclxuICBwcm90ZWN0ZWQgcmVhZG9ubHkgbWluaW11bVNpemU6IERpbWVuc2lvbjI7XHJcbiAgcHJvdGVjdGVkIHJlYWRvbmx5IGludGVybmFsV2lkdGhQcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8bnVtYmVyPjtcclxuICBwcm90ZWN0ZWQgcmVhZG9ubHkgc2l6ZVByb3BlcnR5OiBUUmVhZE9ubHlQcm9wZXJ0eTxEaW1lbnNpb24yPjtcclxuXHJcbiAgLy8gRm9yIHVzZSBieSBTbGlkZXIsIG1hcHMgdGhlIHZhbHVlIGFsb25nIHRoZSByYW5nZSBvZiB0aGUgdHJhY2sgdG8gdGhlIHBvc2l0aW9uIGFsb25nIHRoZSB3aWR0aCBvZiB0aGUgdHJhY2tcclxuICBwdWJsaWMgcmVhZG9ubHkgdmFsdWVUb1Bvc2l0aW9uUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PExpbmVhckZ1bmN0aW9uPjtcclxuXHJcbiAgLy8gcHVibGljIHNvIHRoYXQgY2xpZW50cyBjYW4gYWNjZXNzIFByb3BlcnRpZXMgb2YgdGhlIERyYWdMaXN0ZW5lciB0aGF0IHRlbGwgdXMgYWJvdXQgaXRzIHN0YXRlXHJcbiAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9zdW4vaXNzdWVzLzY4MFxyXG4gIHB1YmxpYyByZWFkb25seSBkcmFnTGlzdGVuZXI6IERyYWdMaXN0ZW5lcjtcclxuXHJcbiAgLy8gKHN1bi1pbnRlcm5hbClcclxuICBwdWJsaWMgcmVhZG9ubHkgcmFuZ2VQcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8UmFuZ2U+O1xyXG4gIHB1YmxpYyByZWFkb25seSBsZWZ0VmlzdWFsT3ZlcmZsb3c6IG51bWJlcjtcclxuICBwdWJsaWMgcmVhZG9ubHkgcmlnaHRWaXN1YWxPdmVyZmxvdzogbnVtYmVyO1xyXG5cclxuICBwcml2YXRlIHJlYWRvbmx5IGRpc3Bvc2VTbGlkZXJUcmFjazogKCkgPT4gdm9pZDtcclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCB2YWx1ZVByb3BlcnR5OiBUUHJvcGVydHk8bnVtYmVyPiwgdHJhY2tOb2RlOiBOb2RlLCByYW5nZTogUmFuZ2UgfCBUUmVhZE9ubHlQcm9wZXJ0eTxSYW5nZT4sIHByb3ZpZGVkT3B0aW9ucz86IFNsaWRlclRyYWNrT3B0aW9ucyApIHtcclxuICAgIHN1cGVyKCk7XHJcblxyXG4gICAgdGhpcy5yYW5nZVByb3BlcnR5ID0gcmFuZ2UgaW5zdGFuY2VvZiBSYW5nZSA/IG5ldyBUaW55UHJvcGVydHkoIHJhbmdlICkgOiByYW5nZTtcclxuXHJcbiAgICBjb25zdCBvcHRpb25zID0gb3B0aW9uaXplPFNsaWRlclRyYWNrT3B0aW9ucywgU2VsZk9wdGlvbnMsIE5vZGVPcHRpb25zPigpKCB7XHJcbiAgICAgIHNpemU6IG5ldyBEaW1lbnNpb24yKCAxMDAsIDUgKSxcclxuICAgICAgc3RhcnREcmFnOiBfLm5vb3AsIC8vIGNhbGxlZCB3aGVuIGEgZHJhZyBzZXF1ZW5jZSBzdGFydHNcclxuICAgICAgZHJhZzogXy5ub29wLCAvLyBjYWxsZWQgYXQgdGhlIGJlZ2lubmluZyBvZiBhIGRyYWcgZXZlbnQsIGJlZm9yZSBhbnkgb3RoZXIgZHJhZyB3b3JrIGhhcHBlbnNcclxuICAgICAgZW5kRHJhZzogXy5ub29wLCAvLyBjYWxsZWQgd2hlbiBhIGRyYWcgc2VxdWVuY2UgZW5kc1xyXG4gICAgICBjb25zdHJhaW5WYWx1ZTogXy5pZGVudGl0eSwgLy8gY2FsbGVkIGJlZm9yZSB2YWx1ZVByb3BlcnR5IGlzIHNldFxyXG4gICAgICBlbmFibGVkUmFuZ2VQcm9wZXJ0eTogdGhpcy5yYW5nZVByb3BlcnR5LFxyXG4gICAgICBzb3VuZEdlbmVyYXRvcjogU2xpZGVyLkRFRkFVTFRfU09VTkRfR0VORVJBVE9SLFxyXG4gICAgICB2YWx1ZUNoYW5nZVNvdW5kR2VuZXJhdG9yT3B0aW9uczoge30sXHJcbiAgICAgIHZvaWNpbmdPbkVuZFJlc3BvbnNlOiBfLm5vb3AsXHJcblxyXG4gICAgICBsZWZ0VmlzdWFsT3ZlcmZsb3c6IDAsXHJcbiAgICAgIHJpZ2h0VmlzdWFsT3ZlcmZsb3c6IDAsXHJcblxyXG4gICAgICAvLyBwaGV0LWlvXHJcbiAgICAgIHRhbmRlbTogVGFuZGVtLlJFUVVJUkVELFxyXG4gICAgICB0YW5kZW1OYW1lU3VmZml4OiAnVHJhY2tOb2RlJ1xyXG4gICAgfSwgcHJvdmlkZWRPcHRpb25zICk7XHJcblxyXG4gICAgLy8gSWYgbm8gc291bmQgZ2VuZXJhdG9yIHdhcyBwcm92aWRlZCwgY3JlYXRlIHRoZSBkZWZhdWx0LlxyXG4gICAgaWYgKCBvcHRpb25zLnNvdW5kR2VuZXJhdG9yID09PSBTbGlkZXIuREVGQVVMVF9TT1VORF9HRU5FUkFUT1IgKSB7XHJcbiAgICAgIC8vIE5PVEU6IFdlJ2xsIHdhbnQgdG8gdXBkYXRlIFZhbHVlQ2hhbmdlU291bmRQbGF5ZXIgZm9yIGR5bmFtaWMgcmFuZ2VzIGlmIGl0J3MgdXNlZCBtb3JlIGZvciB0aGF0XHJcbiAgICAgIG9wdGlvbnMuc291bmRHZW5lcmF0b3IgPSBuZXcgVmFsdWVDaGFuZ2VTb3VuZFBsYXllciggdGhpcy5yYW5nZVByb3BlcnR5LnZhbHVlLCBvcHRpb25zLnZhbHVlQ2hhbmdlU291bmRHZW5lcmF0b3JPcHRpb25zIHx8IHt9ICk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICggb3B0aW9ucy5zb3VuZEdlbmVyYXRvciA9PT0gbnVsbCApIHtcclxuICAgICAgb3B0aW9ucy5zb3VuZEdlbmVyYXRvciA9IFZhbHVlQ2hhbmdlU291bmRQbGF5ZXIuTk9fU09VTkQ7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5sZWZ0VmlzdWFsT3ZlcmZsb3cgPSBvcHRpb25zLmxlZnRWaXN1YWxPdmVyZmxvdztcclxuICAgIHRoaXMucmlnaHRWaXN1YWxPdmVyZmxvdyA9IG9wdGlvbnMucmlnaHRWaXN1YWxPdmVyZmxvdztcclxuXHJcbiAgICB0aGlzLm1pbmltdW1TaXplID0gb3B0aW9ucy5zaXplO1xyXG4gICAgdGhpcy5taW5pbXVtV2lkdGggPSB0aGlzLm1pbmltdW1TaXplLndpZHRoO1xyXG4gICAgdGhpcy5pbnRlcm5hbFdpZHRoUHJvcGVydHkgPSBuZXcgRGVyaXZlZFByb3BlcnR5KCBbIHRoaXMubG9jYWxQcmVmZXJyZWRXaWR0aFByb3BlcnR5IF0sIGxvY2FsUHJlZmVycmVkV2lkdGggPT4ge1xyXG4gICAgICAvLyBPdXIgcHJlZmVycmVkIHdpZHRoIHNob3VsZCBiZSBzdWJ0cmFjdGVkIG91dCBieSB0aGUgYW50aWNpcGF0ZWQgb3ZlcmZsb3csIHNvIHRoYXQgb3VyIHNpemUgY2FuIGJlIHNsaWdodGx5XHJcbiAgICAgIC8vIHNtYWxsZXIuXHJcbiAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgIGxvY2FsUHJlZmVycmVkV2lkdGggPT09IG51bGxcclxuICAgICAgICAgICAgICAgPyB0aGlzLm1pbmltdW1TaXplLndpZHRoXHJcbiAgICAgICAgICAgICAgIDogTWF0aC5tYXgoIHRoaXMubWluaW11bVNpemUud2lkdGgsIGxvY2FsUHJlZmVycmVkV2lkdGggKVxyXG4gICAgICAgICAgICAgKSAtIG9wdGlvbnMubGVmdFZpc3VhbE92ZXJmbG93IC0gb3B0aW9ucy5yaWdodFZpc3VhbE92ZXJmbG93O1xyXG4gICAgfSApO1xyXG4gICAgdGhpcy5zaXplUHJvcGVydHkgPSBuZXcgRGVyaXZlZFByb3BlcnR5KCBbXHJcbiAgICAgIHRoaXMuaW50ZXJuYWxXaWR0aFByb3BlcnR5XHJcbiAgICBdLCB3aWR0aCA9PiBuZXcgRGltZW5zaW9uMiggd2lkdGgsIHRoaXMubWluaW11bVNpemUuaGVpZ2h0ICkgKTtcclxuXHJcbiAgICAvLyBOT1RFOiBTbGlkZXIgbmVlZHMgdG8gbWFrZSBhIGxvdCBvZiBhc3N1bXB0aW9ucyBhYm91dCBob3cgdGhpcyB3b3JrcyAoaW4gb3JkZXIgdG8gZmlndXJlIG91dCBwcm9wZXIgbGF5b3V0KS5cclxuICAgIC8vIERPIE5PVCBjaGFuZ2Ugd2l0aG91dCB0YWtpbmcgYSBDTE9TRSBDTE9TRSBsb29rIGF0IFNsaWRlcidzIGxheW91dCBjb2RlLlxyXG4gICAgdGhpcy52YWx1ZVRvUG9zaXRpb25Qcm9wZXJ0eSA9IG5ldyBEZXJpdmVkUHJvcGVydHkoIFsgdGhpcy5yYW5nZVByb3BlcnR5LCB0aGlzLmludGVybmFsV2lkdGhQcm9wZXJ0eSBdLCAoIHJhbmdlLCB3aWR0aCApID0+IHtcclxuICAgICAgcmV0dXJuIG5ldyBMaW5lYXJGdW5jdGlvbiggcmFuZ2UubWluLCByYW5nZS5tYXgsIDAsIHdpZHRoLCB0cnVlIC8qIGNsYW1wICovICk7XHJcbiAgICB9ICk7XHJcblxyXG4gICAgLy8gY2xpY2sgaW4gdGhlIHRyYWNrIHRvIGNoYW5nZSB0aGUgdmFsdWUsIGNvbnRpbnVlIGRyYWdnaW5nIGlmIGRlc2lyZWRcclxuICAgIGNvbnN0IGhhbmRsZVRyYWNrRXZlbnQgPSAoIGV2ZW50OiBTY2VuZXJ5RXZlbnQsIHRyYWlsOiBUcmFpbCApID0+IHtcclxuICAgICAgY29uc3Qgb2xkVmFsdWUgPSB2YWx1ZVByb3BlcnR5LnZhbHVlO1xyXG4gICAgICBjb25zdCB0cmFuc2Zvcm0gPSB0cmFpbC5zdWJ0cmFpbFRvKCB0aGlzICkuZ2V0VHJhbnNmb3JtKCk7XHJcbiAgICAgIGNvbnN0IHggPSB0cmFuc2Zvcm0uaW52ZXJzZVBvc2l0aW9uMiggZXZlbnQucG9pbnRlci5wb2ludCApLng7XHJcbiAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy52YWx1ZVRvUG9zaXRpb25Qcm9wZXJ0eS52YWx1ZS5pbnZlcnNlKCB4ICk7XHJcbiAgICAgIGNvbnN0IHZhbHVlSW5SYW5nZSA9IG9wdGlvbnMuZW5hYmxlZFJhbmdlUHJvcGVydHkudmFsdWUuY29uc3RyYWluVmFsdWUoIHZhbHVlICk7XHJcbiAgICAgIGNvbnN0IG5ld1ZhbHVlID0gb3B0aW9ucy5jb25zdHJhaW5WYWx1ZSggdmFsdWVJblJhbmdlICk7XHJcbiAgICAgIHZhbHVlUHJvcGVydHkuc2V0KCBuZXdWYWx1ZSApO1xyXG5cclxuICAgICAgLy8gRG93biBldmVudHMgb24gdGhlIHRyYWNrIGNhbiBjYXVzZSB2YWx1ZSBjaGFuZ2VzLiAgSWYgdGhhdCdzIHdoYXQganVzdCBoYXBwZW5lZCwgcGxheSBhIHNvdW5kLlxyXG4gICAgICBpZiAoIGV2ZW50LnR5cGUgPT09ICdkb3duJyApIHtcclxuICAgICAgICBvcHRpb25zLnNvdW5kR2VuZXJhdG9yIS5wbGF5U291bmRJZlRocmVzaG9sZFJlYWNoZWQoIG5ld1ZhbHVlLCBvbGRWYWx1ZSApO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuYWRkQ2hpbGQoIHRyYWNrTm9kZSApO1xyXG5cclxuICAgIGxldCB2YWx1ZU9uU3RhcnQgPSB2YWx1ZVByb3BlcnR5LnZhbHVlO1xyXG4gICAgdGhpcy5kcmFnTGlzdGVuZXIgPSBuZXcgRHJhZ0xpc3RlbmVyKCB7XHJcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCAnZHJhZ0xpc3RlbmVyJyApLFxyXG5cclxuICAgICAgc3RhcnQ6ICggZXZlbnQsIGxpc3RlbmVyICkgPT4ge1xyXG4gICAgICAgIG9wdGlvbnMuc3RhcnREcmFnKCBldmVudCApO1xyXG4gICAgICAgIHZhbHVlT25TdGFydCA9IHZhbHVlUHJvcGVydHkudmFsdWU7XHJcbiAgICAgICAgaGFuZGxlVHJhY2tFdmVudCggZXZlbnQsIGxpc3RlbmVyLnByZXNzZWRUcmFpbCApO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgZHJhZzogKCBldmVudCwgbGlzdGVuZXIgKSA9PiB7XHJcbiAgICAgICAgb3B0aW9ucy5kcmFnKCBldmVudCApO1xyXG5cclxuICAgICAgICAvLyBSZXVzZSB0aGUgc2FtZSBoYW5kbGVUcmFja0V2ZW50IGJ1dCBtYWtlIHN1cmUgdGhlIHN0YXJ0ZWRDYWxsYmFja3MgY2FsbCBpcyBtYWRlIGJlZm9yZSB0aGUgdmFsdWUgY2hhbmdlc1xyXG4gICAgICAgIGhhbmRsZVRyYWNrRXZlbnQoIGV2ZW50LCBsaXN0ZW5lci5wcmVzc2VkVHJhaWwgKTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIGVuZDogZXZlbnQgPT4ge1xyXG4gICAgICAgIG9wdGlvbnMuZW5kRHJhZyggZXZlbnQgKTtcclxuICAgICAgICBvcHRpb25zLnZvaWNpbmdPbkVuZFJlc3BvbnNlKCB2YWx1ZU9uU3RhcnQgKTtcclxuICAgICAgfVxyXG4gICAgfSApO1xyXG4gICAgdHJhY2tOb2RlLmFkZElucHV0TGlzdGVuZXIoIHRoaXMuZHJhZ0xpc3RlbmVyICk7XHJcblxyXG4gICAgdGhpcy5tdXRhdGUoIG9wdGlvbnMgKTtcclxuXHJcbiAgICB0aGlzLmRpc3Bvc2VTbGlkZXJUcmFjayA9ICgpID0+IHtcclxuICAgICAgdHJhY2tOb2RlLnJlbW92ZUlucHV0TGlzdGVuZXIoIHRoaXMuZHJhZ0xpc3RlbmVyICk7XHJcbiAgICAgIHRoaXMuZHJhZ0xpc3RlbmVyLmRpc3Bvc2UoKTtcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgb3ZlcnJpZGUgZGlzcG9zZSgpOiB2b2lkIHtcclxuICAgIHRoaXMuZGlzcG9zZVNsaWRlclRyYWNrKCk7XHJcbiAgICBzdXBlci5kaXNwb3NlKCk7XHJcbiAgfVxyXG59XHJcblxyXG5zdW4ucmVnaXN0ZXIoICdTbGlkZXJUcmFjaycsIFNsaWRlclRyYWNrICk7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFJQSxPQUFPQSxVQUFVLE1BQU0sNEJBQTRCO0FBQ25ELE9BQU9DLGNBQWMsTUFBTSxnQ0FBZ0M7QUFDM0QsT0FBT0MsS0FBSyxNQUFNLHVCQUF1QjtBQUN6QyxPQUFPQyxzQkFBc0IsTUFBeUMsMkRBQTJEO0FBQ2pJLE9BQU9DLFNBQVMsTUFBTSxpQ0FBaUM7QUFDdkQsU0FBU0MsWUFBWSxFQUFFQyxJQUFJLEVBQW9DQyxZQUFZLFFBQVEsNkJBQTZCO0FBQ2hILE9BQU9DLE1BQU0sTUFBTSwyQkFBMkI7QUFDOUMsT0FBT0MsR0FBRyxNQUFNLFVBQVU7QUFDMUIsT0FBT0MsTUFBTSxNQUFNLGFBQWE7QUFFaEMsT0FBT0MsWUFBWSxNQUFNLCtCQUErQjtBQUN4RCxPQUFPQyxlQUFlLE1BQU0sa0NBQWtDO0FBMEM5RCxlQUFlLE1BQU1DLFdBQVcsU0FBU04sWUFBWSxDQUFFRCxJQUFLLENBQUMsQ0FBQztFQU01RDs7RUFHQTtFQUNBOztFQUdBOztFQU9PUSxXQUFXQSxDQUFFQyxhQUFnQyxFQUFFQyxTQUFlLEVBQUVDLEtBQXVDLEVBQUVDLGVBQW9DLEVBQUc7SUFDckosS0FBSyxDQUFDLENBQUM7SUFFUCxJQUFJ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