// Copyright 2015-2024, University of Colorado Boulder

/**
 * DemosScreenView is the base class for ScreenViews that use a carousel to select a demo.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import Property from '../../../axon/js/Property.js';
import ScreenView from '../../../joist/js/ScreenView.js';
import optionize from '../../../phet-core/js/optionize.js';
import PhetFont from '../../../scenery-phet/js/PhetFont.js';
import { Node, Text } from '../../../scenery/js/imports.js';
import Tandem from '../../../tandem/js/Tandem.js';
import CarouselComboBox from '../CarouselComboBox.js';
import sun from '../sun.js';
import sunQueryParameters from '../sunQueryParameters.js';

// constants
const COMBO_BOX_ITEM_FONT = new PhetFont(14);
class DemosScreenView extends ScreenView {
  constructor(demos, providedOptions) {
    const options = optionize()({
      // DemosScreenViewOptions
      selectedDemoLabel: sunQueryParameters.component,
      cacheDemos: false,
      // ScreenViewOptions
      tandem: Tandem.OPTIONAL
    }, providedOptions);
    super(options);
    const demosParent = new Node();
    const layoutBounds = this.layoutBounds;

    // Support PhET-iO API instrumentation and API tracking
    if (Tandem.PHET_IO_ENABLED) {
      options.cacheDemos = true;
      demos.forEach(demo => {
        demo.node = demo.createNode(layoutBounds, {
          tandem: options.tandem.createTandem(`demo${demo.tandemName ? demo.tandemName : demo.label}`)
        });
        demo.node.visible = false;
        demosParent.addChild(demo.node);
      });
    }

    // All demos will be children of this node, to maintain rendering order with combo box list
    this.addChild(demosParent);

    // Sort the demos by label, so that they appear in the combo box in alphabetical order
    demos = _.sortBy(demos, demo => {
      return demo.label;
    });

    // The initial demo that is selected, allow grace for query parameter support
    const selectedDemo = options.selectedDemoLabel ? _.find(demos, demo => demo.label === options.selectedDemoLabel) || demos[0] : demos[0];

    // {Property.<Demo>} the demo that is currently selected
    const selectedDemoProperty = new Property(selectedDemo);
    const selectADemoLabel = new Text('Select a Demo:', {
      font: new PhetFont(16)
    });
    this.addChild(selectADemoLabel);

    // {ComboBoxItem[]}
    const items = demos.map(demo => {
      return {
        value: demo,
        createNode: () => new Text(demo.label, {
          font: COMBO_BOX_ITEM_FONT
        })
      };
    });
    const carouselComboBox = new CarouselComboBox(selectedDemoProperty, items, {
      tandem: options.tandem.createTandem('carouselComboBox')
    });
    this.addChild(carouselComboBox);

    // Layout, with button vertically centered on label.
    selectADemoLabel.left = this.layoutBounds.left + 20;
    carouselComboBox.left = selectADemoLabel.right + 10;
    carouselComboBox.top = this.layoutBounds.top + 20;
    selectADemoLabel.centerY = carouselComboBox.visibleBounds.centerY;

    // Make the selected demo visible
    selectedDemoProperty.link((demo, oldDemo) => {
      // clean up the previously selected demo
      if (oldDemo) {
        const oldDemoNode = oldDemo.node;
        if (options.cacheDemos) {
          // make the old demo invisible
          oldDemoNode.visible = false;
        } else {
          // Delete the old demo.  Note that this will ONLY call the dispose function on the component being demoed if
          // that component is the only thing provided as a demo node, or if the demo node is subclassed and provides
          // its own dispose function.  If the demo node is a VBox or something of that nature, the dispose function of
          // the demoed component(s) will not be invoked.  See https://github.com/phetsims/sun/issues/386.
          demosParent.removeChild(oldDemoNode);
          oldDemoNode.dispose();
          oldDemo.node = null;
        }
      }
      if (demo.node) {
        // If the selected demo has an associated node, make it visible.
        demo.node.visible = true;
      } else {
        // If the selected demo doesn't doesn't have an associated node, create it.
        demo.node = demo.createNode(layoutBounds, {
          tandem: options.tandem.createTandem(`demo${demo.tandemName ? demo.tandemName : demo.label}`)
        });
        demosParent.addChild(demo.node);
      }
    });
  }
}
sun.register('DemosScreenView', DemosScreenView);
export default DemosScreenView;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQcm9wZXJ0eSIsIlNjcmVlblZpZXciLCJvcHRpb25pemUiLCJQaGV0Rm9udCIsIk5vZGUiLCJUZXh0IiwiVGFuZGVtIiwiQ2Fyb3VzZWxDb21ib0JveCIsInN1biIsInN1blF1ZXJ5UGFyYW1ldGVycyIsIkNPTUJPX0JPWF9JVEVNX0ZPTlQiLCJEZW1vc1NjcmVlblZpZXciLCJjb25zdHJ1Y3RvciIsImRlbW9zIiwicHJvdmlkZWRPcHRpb25zIiwib3B0aW9ucyIsInNlbGVjdGVkRGVtb0xhYmVsIiwiY29tcG9uZW50IiwiY2FjaGVEZW1vcyIsInRhbmRlbSIsIk9QVElPTkFMIiwiZGVtb3NQYXJlbnQiLCJsYXlvdXRCb3VuZHMiLCJQSEVUX0lPX0VOQUJMRUQiLCJmb3JFYWNoIiwiZGVtbyIsIm5vZGUiLCJjcmVhdGVOb2RlIiwiY3JlYXRlVGFuZGVtIiwidGFuZGVtTmFtZSIsImxhYmVsIiwidmlzaWJsZSIsImFkZENoaWxkIiwiXyIsInNvcnRCeSIsInNlbGVjdGVkRGVtbyIsImZpbmQiLCJzZWxlY3RlZERlbW9Qcm9wZXJ0eSIsInNlbGVjdEFEZW1vTGFiZWwiLCJmb250IiwiaXRlbXMiLCJtYXAiLCJ2YWx1ZSIsImNhcm91c2VsQ29tYm9Cb3giLCJsZWZ0IiwicmlnaHQiLCJ0b3AiLCJjZW50ZXJZIiwidmlzaWJsZUJvdW5kcyIsImxpbmsiLCJvbGREZW1vIiwib2xkRGVtb05vZGUiLCJyZW1vdmVDaGlsZCIsImRpc3Bvc2UiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIkRlbW9zU2NyZWVuVmlldy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxNS0yMDI0LCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBEZW1vc1NjcmVlblZpZXcgaXMgdGhlIGJhc2UgY2xhc3MgZm9yIFNjcmVlblZpZXdzIHRoYXQgdXNlIGEgY2Fyb3VzZWwgdG8gc2VsZWN0IGEgZGVtby5cclxuICpcclxuICogQGF1dGhvciBDaHJpcyBNYWxsZXkgKFBpeGVsWm9vbSwgSW5jLilcclxuICovXHJcblxyXG5pbXBvcnQgUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vYXhvbi9qcy9Qcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBCb3VuZHMyIGZyb20gJy4uLy4uLy4uL2RvdC9qcy9Cb3VuZHMyLmpzJztcclxuaW1wb3J0IFNjcmVlblZpZXcsIHsgU2NyZWVuVmlld09wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi9qb2lzdC9qcy9TY3JlZW5WaWV3LmpzJztcclxuaW1wb3J0IG9wdGlvbml6ZSBmcm9tICcuLi8uLi8uLi9waGV0LWNvcmUvanMvb3B0aW9uaXplLmpzJztcclxuaW1wb3J0IFBpY2tPcHRpb25hbCBmcm9tICcuLi8uLi8uLi9waGV0LWNvcmUvanMvdHlwZXMvUGlja09wdGlvbmFsLmpzJztcclxuaW1wb3J0IFN0cmljdE9taXQgZnJvbSAnLi4vLi4vLi4vcGhldC1jb3JlL2pzL3R5cGVzL1N0cmljdE9taXQuanMnO1xyXG5pbXBvcnQgUGhldEZvbnQgZnJvbSAnLi4vLi4vLi4vc2NlbmVyeS1waGV0L2pzL1BoZXRGb250LmpzJztcclxuaW1wb3J0IHsgTm9kZSwgTm9kZU9wdGlvbnMsIFRleHQgfSBmcm9tICcuLi8uLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xyXG5pbXBvcnQgVGFuZGVtIGZyb20gJy4uLy4uLy4uL3RhbmRlbS9qcy9UYW5kZW0uanMnO1xyXG5pbXBvcnQgQ2Fyb3VzZWxDb21ib0JveCBmcm9tICcuLi9DYXJvdXNlbENvbWJvQm94LmpzJztcclxuaW1wb3J0IHN1biBmcm9tICcuLi9zdW4uanMnO1xyXG5pbXBvcnQgc3VuUXVlcnlQYXJhbWV0ZXJzIGZyb20gJy4uL3N1blF1ZXJ5UGFyYW1ldGVycy5qcyc7XHJcblxyXG4vLyBjb25zdGFudHNcclxuY29uc3QgQ09NQk9fQk9YX0lURU1fRk9OVCA9IG5ldyBQaGV0Rm9udCggMTQgKTtcclxuXHJcbmV4cG9ydCB0eXBlIFN1bkRlbW9PcHRpb25zID0gTm9kZU9wdGlvbnM7XHJcblxyXG50eXBlIERlbW9JdGVtTmFtZSA9IHN0cmluZztcclxuXHJcbmV4cG9ydCB0eXBlIERlbW9JdGVtRGF0YSA9IHtcclxuXHJcbiAgLy8gc3RyaW5nIHVzZWQgdG8gbGFiZWwgdGhlIGRlbW8gaW4gQ29tYm9Cb3hcclxuICBsYWJlbDogRGVtb0l0ZW1OYW1lO1xyXG5cclxuICAvLyBjcmVhdGVzIHRoZSBOb2RlIGZvciB0aGUgZGVtb1xyXG4gIGNyZWF0ZU5vZGU6ICggbGF5b3V0Qm91bmRzOiBCb3VuZHMyLCBvcHRpb25zOiBTdW5EZW1vT3B0aW9ucyApID0+IE5vZGU7XHJcblxyXG4gIG5vZGU/OiBOb2RlIHwgbnVsbCB8IHVuZGVmaW5lZDtcclxuXHJcbiAgdGFuZGVtTmFtZT86IHN0cmluZztcclxufTtcclxuXHJcbnR5cGUgU2VsZk9wdGlvbnMgPSB7XHJcblxyXG4gIC8vIGxhYmVsIGZpZWxkIG9mIHRoZSBEZW1vSXRlbURhdGEgdG8gYmUgc2VsZWN0ZWQgaW5pdGlhbGx5LCBkZWZhdWx0cyB0byB0aGUgZmlyc3QgZGVtbyBhZnRlciBzb3J0aW5nXHJcbiAgc2VsZWN0ZWREZW1vTGFiZWw/OiBEZW1vSXRlbU5hbWUgfCBudWxsO1xyXG5cclxuICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL3N1bi9pc3N1ZXMvMzg2XHJcbiAgLy8gdHJ1ZSA9IGNhY2hlcyBOb2RlcyBmb3IgYWxsIGRlbW9zIHRoYXQgaGF2ZSBiZWVuIHNlbGVjdGVkXHJcbiAgLy8gZmFsc2UgPSBrZWVwcyBvbmx5IHRoZSBOb2RlIGZvciB0aGUgc2VsZWN0ZWQgZGVtbyBpbiBtZW1vcnlcclxuICBjYWNoZURlbW9zPzogYm9vbGVhbjtcclxufTtcclxuXHJcbmV4cG9ydCB0eXBlIERlbW9zU2NyZWVuVmlld09wdGlvbnMgPSBTZWxmT3B0aW9ucyAmIFN0cmljdE9taXQ8U2NyZWVuVmlld09wdGlvbnMsICd0YW5kZW0nPiAmXHJcbiAgUGlja09wdGlvbmFsPFNjcmVlblZpZXdPcHRpb25zLCAndGFuZGVtJz47XHJcblxyXG5jbGFzcyBEZW1vc1NjcmVlblZpZXcgZXh0ZW5kcyBTY3JlZW5WaWV3IHtcclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBkZW1vczogRGVtb0l0ZW1EYXRhW10sIHByb3ZpZGVkT3B0aW9ucz86IERlbW9zU2NyZWVuVmlld09wdGlvbnMgKSB7XHJcblxyXG4gICAgY29uc3Qgb3B0aW9ucyA9IG9wdGlvbml6ZTxEZW1vc1NjcmVlblZpZXdPcHRpb25zLCBTZWxmT3B0aW9ucywgU2NyZWVuVmlld09wdGlvbnM+KCkoIHtcclxuXHJcbiAgICAgIC8vIERlbW9zU2NyZWVuVmlld09wdGlvbnNcclxuICAgICAgc2VsZWN0ZWREZW1vTGFiZWw6IHN1blF1ZXJ5UGFyYW1ldGVycy5jb21wb25lbnQsXHJcbiAgICAgIGNhY2hlRGVtb3M6IGZhbHNlLFxyXG5cclxuICAgICAgLy8gU2NyZWVuVmlld09wdGlvbnNcclxuICAgICAgdGFuZGVtOiBUYW5kZW0uT1BUSU9OQUxcclxuICAgIH0sIHByb3ZpZGVkT3B0aW9ucyApO1xyXG5cclxuICAgIHN1cGVyKCBvcHRpb25zICk7XHJcblxyXG4gICAgY29uc3QgZGVtb3NQYXJlbnQgPSBuZXcgTm9kZSgpO1xyXG4gICAgY29uc3QgbGF5b3V0Qm91bmRzID0gdGhpcy5sYXlvdXRCb3VuZHM7XHJcblxyXG4gICAgLy8gU3VwcG9ydCBQaEVULWlPIEFQSSBpbnN0cnVtZW50YXRpb24gYW5kIEFQSSB0cmFja2luZ1xyXG4gICAgaWYgKCBUYW5kZW0uUEhFVF9JT19FTkFCTEVEICkge1xyXG4gICAgICBvcHRpb25zLmNhY2hlRGVtb3MgPSB0cnVlO1xyXG5cclxuICAgICAgZGVtb3MuZm9yRWFjaCggZGVtbyA9PiB7XHJcbiAgICAgICAgZGVtby5ub2RlID0gZGVtby5jcmVhdGVOb2RlKCBsYXlvdXRCb3VuZHMsIHtcclxuICAgICAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCBgZGVtbyR7ZGVtby50YW5kZW1OYW1lID8gZGVtby50YW5kZW1OYW1lIDogZGVtby5sYWJlbH1gIClcclxuICAgICAgICB9ICk7XHJcbiAgICAgICAgZGVtby5ub2RlLnZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICBkZW1vc1BhcmVudC5hZGRDaGlsZCggZGVtby5ub2RlICk7XHJcbiAgICAgIH0gKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBBbGwgZGVtb3Mgd2lsbCBiZSBjaGlsZHJlbiBvZiB0aGlzIG5vZGUsIHRvIG1haW50YWluIHJlbmRlcmluZyBvcmRlciB3aXRoIGNvbWJvIGJveCBsaXN0XHJcbiAgICB0aGlzLmFkZENoaWxkKCBkZW1vc1BhcmVudCApO1xyXG5cclxuICAgIC8vIFNvcnQgdGhlIGRlbW9zIGJ5IGxhYmVsLCBzbyB0aGF0IHRoZXkgYXBwZWFyIGluIHRoZSBjb21ibyBib3ggaW4gYWxwaGFiZXRpY2FsIG9yZGVyXHJcbiAgICBkZW1vcyA9IF8uc29ydEJ5KCBkZW1vcywgZGVtbyA9PiB7XHJcbiAgICAgIHJldHVybiBkZW1vLmxhYmVsO1xyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIFRoZSBpbml0aWFsIGRlbW8gdGhhdCBpcyBzZWxlY3RlZCwgYWxsb3cgZ3JhY2UgZm9yIHF1ZXJ5IHBhcmFtZXRlciBzdXBwb3J0XHJcbiAgICBjb25zdCBzZWxlY3RlZERlbW8gPSBvcHRpb25zLnNlbGVjdGVkRGVtb0xhYmVsID9cclxuICAgICAgICAgICAgICAgICAgICAgICAgIF8uZmluZCggZGVtb3MsIGRlbW8gPT4gZGVtby5sYWJlbCA9PT0gb3B0aW9ucy5zZWxlY3RlZERlbW9MYWJlbCApIHx8IGRlbW9zWyAwIF0gOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgZGVtb3NbIDAgXTtcclxuXHJcbiAgICAvLyB7UHJvcGVydHkuPERlbW8+fSB0aGUgZGVtbyB0aGF0IGlzIGN1cnJlbnRseSBzZWxlY3RlZFxyXG4gICAgY29uc3Qgc2VsZWN0ZWREZW1vUHJvcGVydHkgPSBuZXcgUHJvcGVydHkoIHNlbGVjdGVkRGVtbyApO1xyXG5cclxuICAgIGNvbnN0IHNlbGVjdEFEZW1vTGFiZWwgPSBuZXcgVGV4dCggJ1NlbGVjdCBhIERlbW86Jywge1xyXG4gICAgICBmb250OiBuZXcgUGhldEZvbnQoIDE2IClcclxuICAgIH0gKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIHNlbGVjdEFEZW1vTGFiZWwgKTtcclxuXHJcbiAgICAvLyB7Q29tYm9Cb3hJdGVtW119XHJcbiAgICBjb25zdCBpdGVtcyA9IGRlbW9zLm1hcCggZGVtbyA9PiB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgdmFsdWU6IGRlbW8sXHJcbiAgICAgICAgY3JlYXRlTm9kZTogKCkgPT4gbmV3IFRleHQoIGRlbW8ubGFiZWwsIHsgZm9udDogQ09NQk9fQk9YX0lURU1fRk9OVCB9IClcclxuICAgICAgfTtcclxuICAgIH0gKTtcclxuXHJcbiAgICBjb25zdCBjYXJvdXNlbENvbWJvQm94ID0gbmV3IENhcm91c2VsQ29tYm9Cb3goIHNlbGVjdGVkRGVtb1Byb3BlcnR5LCBpdGVtcywge1xyXG4gICAgICB0YW5kZW06IG9wdGlvbnMudGFuZGVtLmNyZWF0ZVRhbmRlbSggJ2Nhcm91c2VsQ29tYm9Cb3gnIClcclxuICAgIH0gKTtcclxuICAgIHRoaXMuYWRkQ2hpbGQoIGNhcm91c2VsQ29tYm9Cb3ggKTtcclxuXHJcbiAgICAvLyBMYXlvdXQsIHdpdGggYnV0dG9uIHZlcnRpY2FsbHkgY2VudGVyZWQgb24gbGFiZWwuXHJcbiAgICBzZWxlY3RBRGVtb0xhYmVsLmxlZnQgPSB0aGlzLmxheW91dEJvdW5kcy5sZWZ0ICsgMjA7XHJcbiAgICBjYXJvdXNlbENvbWJvQm94LmxlZnQgPSBzZWxlY3RBRGVtb0xhYmVsLnJpZ2h0ICsgMTA7XHJcbiAgICBjYXJvdXNlbENvbWJvQm94LnRvcCA9IHRoaXMubGF5b3V0Qm91bmRzLnRvcCArIDIwO1xyXG4gICAgc2VsZWN0QURlbW9MYWJlbC5jZW50ZXJZID0gY2Fyb3VzZWxDb21ib0JveC52aXNpYmxlQm91bmRzLmNlbnRlclk7XHJcblxyXG4gICAgLy8gTWFrZSB0aGUgc2VsZWN0ZWQgZGVtbyB2aXNpYmxlXHJcbiAgICBzZWxlY3RlZERlbW9Qcm9wZXJ0eS5saW5rKCAoIGRlbW8sIG9sZERlbW8gKSA9PiB7XHJcblxyXG4gICAgICAvLyBjbGVhbiB1cCB0aGUgcHJldmlvdXNseSBzZWxlY3RlZCBkZW1vXHJcbiAgICAgIGlmICggb2xkRGVtbyApIHtcclxuXHJcbiAgICAgICAgY29uc3Qgb2xkRGVtb05vZGUgPSBvbGREZW1vLm5vZGUhO1xyXG5cclxuICAgICAgICBpZiAoIG9wdGlvbnMuY2FjaGVEZW1vcyApIHtcclxuXHJcbiAgICAgICAgICAvLyBtYWtlIHRoZSBvbGQgZGVtbyBpbnZpc2libGVcclxuICAgICAgICAgIG9sZERlbW9Ob2RlLnZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcblxyXG4gICAgICAgICAgLy8gRGVsZXRlIHRoZSBvbGQgZGVtby4gIE5vdGUgdGhhdCB0aGlzIHdpbGwgT05MWSBjYWxsIHRoZSBkaXNwb3NlIGZ1bmN0aW9uIG9uIHRoZSBjb21wb25lbnQgYmVpbmcgZGVtb2VkIGlmXHJcbiAgICAgICAgICAvLyB0aGF0IGNvbXBvbmVudCBpcyB0aGUgb25seSB0aGluZyBwcm92aWRlZCBhcyBhIGRlbW8gbm9kZSwgb3IgaWYgdGhlIGRlbW8gbm9kZSBpcyBzdWJjbGFzc2VkIGFuZCBwcm92aWRlc1xyXG4gICAgICAgICAgLy8gaXRzIG93biBkaXNwb3NlIGZ1bmN0aW9uLiAgSWYgdGhlIGRlbW8gbm9kZSBpcyBhIFZCb3ggb3Igc29tZXRoaW5nIG9mIHRoYXQgbmF0dXJlLCB0aGUgZGlzcG9zZSBmdW5jdGlvbiBvZlxyXG4gICAgICAgICAgLy8gdGhlIGRlbW9lZCBjb21wb25lbnQocykgd2lsbCBub3QgYmUgaW52b2tlZC4gIFNlZSBodHRwczovL2dpdGh1Yi5jb20vcGhldHNpbXMvc3VuL2lzc3Vlcy8zODYuXHJcbiAgICAgICAgICBkZW1vc1BhcmVudC5yZW1vdmVDaGlsZCggb2xkRGVtb05vZGUgKTtcclxuICAgICAgICAgIG9sZERlbW9Ob2RlLmRpc3Bvc2UoKTtcclxuICAgICAgICAgIG9sZERlbW8ubm9kZSA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoIGRlbW8ubm9kZSApIHtcclxuXHJcbiAgICAgICAgLy8gSWYgdGhlIHNlbGVjdGVkIGRlbW8gaGFzIGFuIGFzc29jaWF0ZWQgbm9kZSwgbWFrZSBpdCB2aXNpYmxlLlxyXG4gICAgICAgIGRlbW8ubm9kZS52aXNpYmxlID0gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuXHJcbiAgICAgICAgLy8gSWYgdGhlIHNlbGVjdGVkIGRlbW8gZG9lc24ndCBkb2Vzbid0IGhhdmUgYW4gYXNzb2NpYXRlZCBub2RlLCBjcmVhdGUgaXQuXHJcbiAgICAgICAgZGVtby5ub2RlID0gZGVtby5jcmVhdGVOb2RlKCBsYXlvdXRCb3VuZHMsIHtcclxuICAgICAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0uY3JlYXRlVGFuZGVtKCBgZGVtbyR7ZGVtby50YW5kZW1OYW1lID8gZGVtby50YW5kZW1OYW1lIDogZGVtby5sYWJlbH1gIClcclxuICAgICAgICB9ICk7XHJcbiAgICAgICAgZGVtb3NQYXJlbnQuYWRkQ2hpbGQoIGRlbW8ubm9kZSApO1xyXG4gICAgICB9XHJcbiAgICB9ICk7XHJcbiAgfVxyXG59XHJcblxyXG5zdW4ucmVnaXN0ZXIoICdEZW1vc1NjcmVlblZpZXcnLCBEZW1vc1NjcmVlblZpZXcgKTtcclxuZXhwb3J0IGRlZmF1bHQgRGVtb3NTY3JlZW5WaWV3OyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxRQUFRLE1BQU0sOEJBQThCO0FBRW5ELE9BQU9DLFVBQVUsTUFBNkIsaUNBQWlDO0FBQy9FLE9BQU9DLFNBQVMsTUFBTSxvQ0FB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