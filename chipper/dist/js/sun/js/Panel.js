// Copyright 2013-2024, University of Colorado Boulder

/**
 * Control panel around a content node.
 * Dynamically adjusts its size to fit its contents.
 *
 * @author Sam Reid (PhET Interactive Simulations)
 * @author Chris Malley (PixelZoom, Inc.)
 * @author John Blanco (PhET Interactive Simulations)
 */

import { optionize3 } from '../../phet-core/js/optionize.js';
import { isHeightSizable, isWidthSizable, LayoutConstraint, Node, Rectangle, Sizable } from '../../scenery/js/imports.js';
import sun from './sun.js';

// valid values for options.align
const ALIGN_VALUES = ['left', 'center', 'right'];
const DEFAULT_OPTIONS = {
  fill: 'white',
  stroke: 'black',
  lineWidth: 1,
  lineDash: [],
  xMargin: 5,
  yMargin: 5,
  cornerRadius: 10,
  resize: true,
  backgroundPickable: true,
  excludeInvisibleChildrenFromBounds: true,
  align: 'left',
  minWidth: 0,
  minHeight: 0
};
assert && Object.freeze(DEFAULT_OPTIONS);
export default class Panel extends Sizable(Node) {
  // These are public for use by PanelConstraint only. They should otherwise be considered private.

  static DEFAULT_PANEL_OPTIONS = DEFAULT_OPTIONS;
  constructor(content, providedOptions) {
    const options = optionize3()({}, DEFAULT_OPTIONS, providedOptions);
    assert && assert(_.includes(ALIGN_VALUES, options.align), `invalid align: ${options.align}`);
    super();
    this._content = content;
    this._backgroundContainer = new Node();

    // correct size will be set by layout
    this._background = new Rectangle(0, 0, 1, 1, {
      lineWidth: options.lineWidth,
      pickable: options.backgroundPickable,
      lineDash: options.lineDash,
      cornerRadius: options.cornerRadius
    });

    // update the fill and stroke (before layout)
    this.setStroke(options.stroke);
    this.setFill(options.fill);
    this.addChild(this._backgroundContainer);
    this.addChild(content);
    this.constraint = new PanelConstraint(this, options);
    this.constraint.updateLayout();

    // Don't update automatically if resize:false
    this.constraint.enabled = options.resize;

    // Apply options after the layout is done, so that options that use the bounds will work properly.
    this.mutate(options);
  }

  /**
   * Get the background rectangle's stroke (can be overridden)
   */
  getStroke() {
    return this._background.stroke;
  }
  get stroke() {
    return this.getStroke();
  }
  set stroke(value) {
    this.setStroke(value);
  }

  /**
   * Change the background rectangle's stroke (can be overridden)
   */
  setStroke(stroke) {
    this._background.stroke = stroke;

    // Since it depends on the stroke (if it's null, our minimum bounds get reduced)
    this.constraint && this.constraint.updateLayoutAutomatically();
  }

  /**
   * Get the background rectangle's fill (can be overridden)
   */
  getFill() {
    return this._background.fill;
  }
  get fill() {
    return this.getFill();
  }
  set fill(value) {
    this.setFill(value);
  }

  /**
   * Change the background rectangle's fill (can be overridden)
   */
  setFill(fill) {
    this._background.fill = fill;
  }
  setExcludeInvisibleChildrenFromBounds(excludeInvisibleChildrenFromBounds) {
    super.setExcludeInvisibleChildrenFromBounds(excludeInvisibleChildrenFromBounds);
    this.constraint.updateLayoutAutomatically();
  }
}
class PanelConstraint extends LayoutConstraint {
  constructor(panel, options) {
    super(panel);
    this.panel = panel;
    assert && assert(typeof options.minWidth === 'number', 'Panel minWidth should be a number');
    assert && assert(typeof options.xMargin === 'number', 'Panel xMargin should be a number');
    assert && assert(typeof options.yMargin === 'number', 'Panel yMargin should be a number');
    assert && assert(typeof options.lineWidth === 'number', 'Panel lineWidth should be a number');
    assert && assert(ALIGN_VALUES.includes(options.align), `Panel align should be one of ${ALIGN_VALUES}`);
    this.minWidth = options.minWidth;
    this.minHeight = options.minHeight;
    this.xMargin = options.xMargin;
    this.yMargin = options.yMargin;
    this.lineWidth = options.lineWidth;
    this.align = options.align;
    this.panel.localPreferredWidthProperty.lazyLink(this._updateLayoutListener);
    this.panel.localPreferredHeightProperty.lazyLink(this._updateLayoutListener);
    this.addNode(panel._content);
  }
  layout() {
    super.layout();
    const panel = this.panel;
    const content = panel._content;
    const background = panel._background;

    // We only have to account for the lineWidth in our layout if we have a stroke
    const lineWidth = panel.stroke === null ? 0 : this.lineWidth;
    const hasValidContent = panel.isChildIncludedInLayout(content);

    // Bail out (and make the background invisible) if our bounds are invalid
    panel._backgroundContainer.children = hasValidContent ? [background] : [];
    if (!hasValidContent) {
      panel.localMinimumWidth = null;
      panel.localMinimumHeight = null;
      return;
    }
    const minimumContentWidth = isWidthSizable(content) && content.minimumWidth !== null ? content.minimumWidth : content.width;
    const minimumContentHeight = isHeightSizable(content) && content.minimumHeight !== null ? content.minimumHeight : content.height;

    // Our minimum dimensions are directly determined by the content, margins and lineWidth
    // NOTE: options.minWidth does NOT include the stroke (e.g. lineWidth), left for backward compatibility.
    const minimumWidth = Math.max(this.minWidth, minimumContentWidth + 2 * this.xMargin) + lineWidth;
    const minimumHeight = Math.max(this.minHeight, minimumContentHeight + 2 * this.yMargin) + lineWidth;

    // Our resulting sizes (allow setting preferred width/height on the panel)
    const preferredWidth = Math.max(minimumWidth, panel.localPreferredWidth || 0);
    const preferredHeight = Math.max(minimumHeight, panel.localPreferredHeight || 0);

    // Determine the size available to our content
    // NOTE: We do NOT set preferred sizes of our content if we don't have a preferred size ourself!
    if (isWidthSizable(content) && panel.localPreferredWidth !== null) {
      content.preferredWidth = preferredWidth - lineWidth - 2 * this.xMargin;
    }
    if (isHeightSizable(content) && panel.localPreferredHeight !== null) {
      content.preferredHeight = preferredHeight - lineWidth - 2 * this.yMargin;
    }
    background.setRect(0, 0, preferredWidth - lineWidth, preferredHeight - lineWidth);

    // Align the content within the background. If the content width >= minWidth, then all alignments are equivalent.
    if (this.align === 'center') {
      content.center = background.center;
    } else if (this.align === 'left') {
      // Use background.rectWidth instead of background.width because they differ by the background lineWidth
      content.left = background.centerX - background.rectWidth / 2 + this.xMargin;
      content.centerY = background.centerY;
    } else {
      /* right */

      // Use background.rectWidth instead of background.width because they differ by the background lineWidth
      content.right = background.centerX + background.rectWidth / 2 - this.xMargin;
      content.centerY = background.centerY;
    }

    // Set minimums at the end
    panel.localMinimumWidth = minimumWidth;
    panel.localMinimumHeight = minimumHeight;
  }
  dispose() {
    this.panel.localPreferredWidthProperty.unlink(this._updateLayoutListener);
    this.panel.localPreferredHeightProperty.unlink(this._updateLayoutListener);
    super.dispose();
  }
}
sun.register('Panel', Panel);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJvcHRpb25pemUzIiwiaXNIZWlnaHRTaXphYmxlIiwiaXNXaWR0aFNpemFibGUiLCJMYXlvdXRDb25zdHJhaW50IiwiTm9kZSIsIlJlY3RhbmdsZSIsIlNpemFibGUiLCJzdW4iLCJBTElHTl9WQUxVRVMiLCJERUZBVUxUX09QVElPTlMiLCJmaWxsIiwic3Ryb2tlIiwibGluZVdpZHRoIiwibGluZURhc2giLCJ4TWFyZ2luIiwieU1hcmdpbiIsImNvcm5lclJhZGl1cyIsInJlc2l6ZSIsImJhY2tncm91bmRQaWNrYWJsZSIsImV4Y2x1ZGVJbnZpc2libGVDaGlsZHJlbkZyb21Cb3VuZHMiLCJhbGlnbiIsIm1pbldpZHRoIiwibWluSGVpZ2h0IiwiYXNzZXJ0IiwiT2JqZWN0IiwiZnJlZXplIiwiUGFuZWwiLCJERUZBVUxUX1BBTkVMX09QVElPTlMiLCJjb25zdHJ1Y3RvciIsImNvbnRlbnQiLCJwcm92aWRlZE9wdGlvbnMiLCJvcHRpb25zIiwiXyIsImluY2x1ZGVzIiwiX2NvbnRlbnQiLCJfYmFja2dyb3VuZENvbnRhaW5lciIsIl9iYWNrZ3JvdW5kIiwicGlja2FibGUiLCJzZXRTdHJva2UiLCJzZXRGaWxsIiwiYWRkQ2hpbGQiLCJjb25zdHJhaW50IiwiUGFuZWxDb25zdHJhaW50IiwidXBkYXRlTGF5b3V0IiwiZW5hYmxlZCIsIm11dGF0ZSIsImdldFN0cm9rZSIsInZhbHVlIiwidXBkYXRlTGF5b3V0QXV0b21hdGljYWxseSIsImdldEZpbGwiLCJzZXRFeGNsdWRlSW52aXNpYmxlQ2hpbGRyZW5Gcm9tQm91bmRzIiwicGFuZWwiLCJsb2NhbFByZWZlcnJlZFdpZHRoUHJvcGVydHkiLCJsYXp5TGluayIsIl91cGRhdGVMYXlvdXRMaXN0ZW5lciIsImxvY2FsUHJlZmVycmVkSGVpZ2h0UHJvcGVydHkiLCJhZGROb2RlIiwibGF5b3V0IiwiYmFja2dyb3VuZCIsImhhc1ZhbGlkQ29udGVudCIsImlzQ2hpbGRJbmNsdWRlZEluTGF5b3V0IiwiY2hpbGRyZW4iLCJsb2NhbE1pbmltdW1XaWR0aCIsImxvY2FsTWluaW11bUhlaWdodCIsIm1pbmltdW1Db250ZW50V2lkdGgiLCJtaW5pbXVtV2lkdGgiLCJ3aWR0aCIsIm1pbmltdW1Db250ZW50SGVpZ2h0IiwibWluaW11bUhlaWdodCIsImhlaWdodCIsIk1hdGgiLCJtYXgiLCJwcmVmZXJyZWRXaWR0aCIsImxvY2FsUHJlZmVycmVkV2lkdGgiLCJwcmVmZXJyZWRIZWlnaHQiLCJsb2NhbFByZWZlcnJlZEhlaWdodCIsInNldFJlY3QiLCJjZW50ZXIiLCJsZWZ0IiwiY2VudGVyWCIsInJlY3RXaWR0aCIsImNlbnRlclkiLCJyaWdodCIsImRpc3Bvc2UiLCJ1bmxpbmsiLCJyZWdpc3RlciJdLCJzb3VyY2VzIjpbIlBhbmVsLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDEzLTIwMjQsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIENvbnRyb2wgcGFuZWwgYXJvdW5kIGEgY29udGVudCBub2RlLlxyXG4gKiBEeW5hbWljYWxseSBhZGp1c3RzIGl0cyBzaXplIHRvIGZpdCBpdHMgY29udGVudHMuXHJcbiAqXHJcbiAqIEBhdXRob3IgU2FtIFJlaWQgKFBoRVQgSW50ZXJhY3RpdmUgU2ltdWxhdGlvbnMpXHJcbiAqIEBhdXRob3IgQ2hyaXMgTWFsbGV5IChQaXhlbFpvb20sIEluYy4pXHJcbiAqIEBhdXRob3IgSm9obiBCbGFuY28gKFBoRVQgSW50ZXJhY3RpdmUgU2ltdWxhdGlvbnMpXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgb3B0aW9uaXplMywgT3B0aW9uaXplRGVmYXVsdHMgfSBmcm9tICcuLi8uLi9waGV0LWNvcmUvanMvb3B0aW9uaXplLmpzJztcclxuaW1wb3J0IHsgaXNIZWlnaHRTaXphYmxlLCBpc1dpZHRoU2l6YWJsZSwgTGF5b3V0Q29uc3RyYWludCwgTm9kZSwgTm9kZU9wdGlvbnMsIFJlY3RhbmdsZSwgU2l6YWJsZSwgU2l6YWJsZU9wdGlvbnMsIFRQYWludCB9IGZyb20gJy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XHJcbmltcG9ydCBzdW4gZnJvbSAnLi9zdW4uanMnO1xyXG5cclxuLy8gdmFsaWQgdmFsdWVzIGZvciBvcHRpb25zLmFsaWduXHJcbmNvbnN0IEFMSUdOX1ZBTFVFUyA9IFsgJ2xlZnQnLCAnY2VudGVyJywgJ3JpZ2h0JyBdIGFzIGNvbnN0O1xyXG5cclxuZXhwb3J0IHR5cGUgUGFuZWxBbGlnbiA9IHR5cGVvZiBBTElHTl9WQUxVRVNbbnVtYmVyXTtcclxuXHJcbnR5cGUgU2VsZk9wdGlvbnMgPSB7XHJcbiAgZmlsbD86IFRQYWludDtcclxuICBzdHJva2U/OiBUUGFpbnQ7XHJcblxyXG4gIC8vIHdpZHRoIG9mIHRoZSBiYWNrZ3JvdW5kIGJvcmRlclxyXG4gIGxpbmVXaWR0aD86IG51bWJlcjtcclxuICBsaW5lRGFzaD86IG51bWJlcltdO1xyXG5cclxuICB4TWFyZ2luPzogbnVtYmVyO1xyXG4gIHlNYXJnaW4/OiBudW1iZXI7XHJcblxyXG4gIC8vIHJhZGl1cyBvZiB0aGUgcm91bmRlZCBjb3JuZXJzIG9uIHRoZSBiYWNrZ3JvdW5kXHJcbiAgY29ybmVyUmFkaXVzPzogbnVtYmVyO1xyXG5cclxuICAvLyBkeW5hbWljYWxseSByZXNpemUgd2hlbiBjb250ZW50IGJvdW5kcyBjaGFuZ2VcclxuICByZXNpemU/OiBib29sZWFuO1xyXG5cclxuICBiYWNrZ3JvdW5kUGlja2FibGU/OiBib29sZWFuO1xyXG5cclxuICAvLyBob3Jpem9udGFsIGFsaWdubWVudCBvZiBjb250ZW50IGluIHRoZSBwYW5lLCBzZWUgQUxJR05fVkFMVUVTXHJcbiAgLy8gQWxsIGFsaWdubWVudHMgYXJlIGVxdWFsIHdoZW4gdGhlIGNvbnRlbnQgd2lkdGggPj0gbWluV2lkdGhcclxuICAvLyBMZWZ0IGlzIHRoZSBkZWZhdWx0IGFsaWdubWVudCBzbyB3aGVuIHRoZXJlIGFyZSBtdWx0aXBsZSBwYW5lbHMsIHRoZWlyIGNvbnRlbnQgd2lsbCBsZWZ0IGFsaWduLCBzZWUgIzI1MlxyXG4gIGFsaWduPzogUGFuZWxBbGlnbjtcclxuXHJcbiAgLy8gbWluaW11bSB3aWR0aCBvZiB0aGUgcGFuZWwgKGxpbmVXaWR0aCB3aWxsIGFkZCB0byB0aGlzKVxyXG4gIG1pbldpZHRoPzogbnVtYmVyO1xyXG4gIG1pbkhlaWdodD86IG51bWJlcjtcclxufTtcclxuXHJcbnR5cGUgU3VwZXJPcHRpb25zID0gU2l6YWJsZU9wdGlvbnMgJiBOb2RlT3B0aW9ucztcclxuZXhwb3J0IHR5cGUgUGFuZWxPcHRpb25zID0gU2VsZk9wdGlvbnMgJiBTdXBlck9wdGlvbnM7XHJcblxyXG5jb25zdCBERUZBVUxUX09QVElPTlM6IE9wdGlvbml6ZURlZmF1bHRzPFNlbGZPcHRpb25zLCBTdXBlck9wdGlvbnM+ID0ge1xyXG4gIGZpbGw6ICd3aGl0ZScsXHJcbiAgc3Ryb2tlOiAnYmxhY2snLFxyXG4gIGxpbmVXaWR0aDogMSxcclxuICBsaW5lRGFzaDogW10sXHJcbiAgeE1hcmdpbjogNSxcclxuICB5TWFyZ2luOiA1LFxyXG4gIGNvcm5lclJhZGl1czogMTAsXHJcbiAgcmVzaXplOiB0cnVlLFxyXG4gIGJhY2tncm91bmRQaWNrYWJsZTogdHJ1ZSxcclxuICBleGNsdWRlSW52aXNpYmxlQ2hpbGRyZW5Gcm9tQm91bmRzOiB0cnVlLFxyXG4gIGFsaWduOiAnbGVmdCcsXHJcbiAgbWluV2lkdGg6IDAsXHJcbiAgbWluSGVpZ2h0OiAwXHJcbn07XHJcbmFzc2VydCAmJiBPYmplY3QuZnJlZXplKCBERUZBVUxUX09QVElPTlMgKTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBhbmVsIGV4dGVuZHMgU2l6YWJsZSggTm9kZSApIHtcclxuXHJcbiAgcHJpdmF0ZSByZWFkb25seSBjb25zdHJhaW50OiBQYW5lbENvbnN0cmFpbnQ7XHJcblxyXG4gIC8vIFRoZXNlIGFyZSBwdWJsaWMgZm9yIHVzZSBieSBQYW5lbENvbnN0cmFpbnQgb25seS4gVGhleSBzaG91bGQgb3RoZXJ3aXNlIGJlIGNvbnNpZGVyZWQgcHJpdmF0ZS5cclxuICBwdWJsaWMgcmVhZG9ubHkgX2NvbnRlbnQ6IE5vZGU7XHJcbiAgcHVibGljIHJlYWRvbmx5IF9iYWNrZ3JvdW5kQ29udGFpbmVyOiBOb2RlO1xyXG4gIHB1YmxpYyByZWFkb25seSBfYmFja2dyb3VuZDogUmVjdGFuZ2xlO1xyXG5cclxuICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IERFRkFVTFRfUEFORUxfT1BUSU9OUyA9IERFRkFVTFRfT1BUSU9OUztcclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBjb250ZW50OiBOb2RlLCBwcm92aWRlZE9wdGlvbnM/OiBQYW5lbE9wdGlvbnMgKSB7XHJcblxyXG4gICAgY29uc3Qgb3B0aW9ucyA9IG9wdGlvbml6ZTM8UGFuZWxPcHRpb25zLCBTZWxmT3B0aW9ucywgU3VwZXJPcHRpb25zPigpKCB7fSwgREVGQVVMVF9PUFRJT05TLCBwcm92aWRlZE9wdGlvbnMgKTtcclxuXHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBfLmluY2x1ZGVzKCBBTElHTl9WQUxVRVMsIG9wdGlvbnMuYWxpZ24gKSwgYGludmFsaWQgYWxpZ246ICR7b3B0aW9ucy5hbGlnbn1gICk7XHJcblxyXG4gICAgc3VwZXIoKTtcclxuXHJcbiAgICB0aGlzLl9jb250ZW50ID0gY29udGVudDtcclxuICAgIHRoaXMuX2JhY2tncm91bmRDb250YWluZXIgPSBuZXcgTm9kZSgpO1xyXG5cclxuICAgIC8vIGNvcnJlY3Qgc2l6ZSB3aWxsIGJlIHNldCBieSBsYXlvdXRcclxuICAgIHRoaXMuX2JhY2tncm91bmQgPSBuZXcgUmVjdGFuZ2xlKCAwLCAwLCAxLCAxLCB7XHJcbiAgICAgIGxpbmVXaWR0aDogb3B0aW9ucy5saW5lV2lkdGgsXHJcbiAgICAgIHBpY2thYmxlOiBvcHRpb25zLmJhY2tncm91bmRQaWNrYWJsZSxcclxuICAgICAgbGluZURhc2g6IG9wdGlvbnMubGluZURhc2gsXHJcbiAgICAgIGNvcm5lclJhZGl1czogb3B0aW9ucy5jb3JuZXJSYWRpdXNcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyB1cGRhdGUgdGhlIGZpbGwgYW5kIHN0cm9rZSAoYmVmb3JlIGxheW91dClcclxuICAgIHRoaXMuc2V0U3Ryb2tlKCBvcHRpb25zLnN0cm9rZSApO1xyXG4gICAgdGhpcy5zZXRGaWxsKCBvcHRpb25zLmZpbGwgKTtcclxuXHJcbiAgICB0aGlzLmFkZENoaWxkKCB0aGlzLl9iYWNrZ3JvdW5kQ29udGFpbmVyICk7XHJcbiAgICB0aGlzLmFkZENoaWxkKCBjb250ZW50ICk7XHJcblxyXG4gICAgdGhpcy5jb25zdHJhaW50ID0gbmV3IFBhbmVsQ29uc3RyYWludCggdGhpcywgb3B0aW9ucyApO1xyXG4gICAgdGhpcy5jb25zdHJhaW50LnVwZGF0ZUxheW91dCgpO1xyXG5cclxuICAgIC8vIERvbid0IHVwZGF0ZSBhdXRvbWF0aWNhbGx5IGlmIHJlc2l6ZTpmYWxzZVxyXG4gICAgdGhpcy5jb25zdHJhaW50LmVuYWJsZWQgPSBvcHRpb25zLnJlc2l6ZTtcclxuXHJcbiAgICAvLyBBcHBseSBvcHRpb25zIGFmdGVyIHRoZSBsYXlvdXQgaXMgZG9uZSwgc28gdGhhdCBvcHRpb25zIHRoYXQgdXNlIHRoZSBib3VuZHMgd2lsbCB3b3JrIHByb3Blcmx5LlxyXG4gICAgdGhpcy5tdXRhdGUoIG9wdGlvbnMgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCB0aGUgYmFja2dyb3VuZCByZWN0YW5nbGUncyBzdHJva2UgKGNhbiBiZSBvdmVycmlkZGVuKVxyXG4gICAqL1xyXG4gIHB1YmxpYyBnZXRTdHJva2UoKTogVFBhaW50IHtcclxuICAgIHJldHVybiB0aGlzLl9iYWNrZ3JvdW5kLnN0cm9rZTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBnZXQgc3Ryb2tlKCk6IFRQYWludCB7IHJldHVybiB0aGlzLmdldFN0cm9rZSgpOyB9XHJcblxyXG4gIHB1YmxpYyBzZXQgc3Ryb2tlKCB2YWx1ZTogVFBhaW50ICkgeyB0aGlzLnNldFN0cm9rZSggdmFsdWUgKTsgfVxyXG5cclxuICAvKipcclxuICAgKiBDaGFuZ2UgdGhlIGJhY2tncm91bmQgcmVjdGFuZ2xlJ3Mgc3Ryb2tlIChjYW4gYmUgb3ZlcnJpZGRlbilcclxuICAgKi9cclxuICBwdWJsaWMgc2V0U3Ryb2tlKCBzdHJva2U6IFRQYWludCApOiB2b2lkIHtcclxuICAgIHRoaXMuX2JhY2tncm91bmQuc3Ryb2tlID0gc3Ryb2tlO1xyXG5cclxuICAgIC8vIFNpbmNlIGl0IGRlcGVuZHMgb24gdGhlIHN0cm9rZSAoaWYgaXQncyBudWxsLCBvdXIgbWluaW11bSBib3VuZHMgZ2V0IHJlZHVjZWQpXHJcbiAgICB0aGlzLmNvbnN0cmFpbnQgJiYgdGhpcy5jb25zdHJhaW50LnVwZGF0ZUxheW91dEF1dG9tYXRpY2FsbHkoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCB0aGUgYmFja2dyb3VuZCByZWN0YW5nbGUncyBmaWxsIChjYW4gYmUgb3ZlcnJpZGRlbilcclxuICAgKi9cclxuICBwdWJsaWMgZ2V0RmlsbCgpOiBUUGFpbnQge1xyXG4gICAgcmV0dXJuIHRoaXMuX2JhY2tncm91bmQuZmlsbDtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBnZXQgZmlsbCgpOiBUUGFpbnQgeyByZXR1cm4gdGhpcy5nZXRGaWxsKCk7IH1cclxuXHJcbiAgcHVibGljIHNldCBmaWxsKCB2YWx1ZTogVFBhaW50ICkgeyB0aGlzLnNldEZpbGwoIHZhbHVlICk7IH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2hhbmdlIHRoZSBiYWNrZ3JvdW5kIHJlY3RhbmdsZSdzIGZpbGwgKGNhbiBiZSBvdmVycmlkZGVuKVxyXG4gICAqL1xyXG4gIHB1YmxpYyBzZXRGaWxsKCBmaWxsOiBUUGFpbnQgKTogdm9pZCB7XHJcbiAgICB0aGlzLl9iYWNrZ3JvdW5kLmZpbGwgPSBmaWxsO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIG92ZXJyaWRlIHNldEV4Y2x1ZGVJbnZpc2libGVDaGlsZHJlbkZyb21Cb3VuZHMoIGV4Y2x1ZGVJbnZpc2libGVDaGlsZHJlbkZyb21Cb3VuZHM6IGJvb2xlYW4gKTogdm9pZCB7XHJcbiAgICBzdXBlci5zZXRFeGNsdWRlSW52aXNpYmxlQ2hpbGRyZW5Gcm9tQm91bmRzKCBleGNsdWRlSW52aXNpYmxlQ2hpbGRyZW5Gcm9tQm91bmRzICk7XHJcbiAgICB0aGlzLmNvbnN0cmFpbnQudXBkYXRlTGF5b3V0QXV0b21hdGljYWxseSgpO1xyXG4gIH1cclxufVxyXG5cclxuY2xhc3MgUGFuZWxDb25zdHJhaW50IGV4dGVuZHMgTGF5b3V0Q29uc3RyYWludCB7XHJcblxyXG4gIHByaXZhdGUgcmVhZG9ubHkgcGFuZWw6IFBhbmVsO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgbWluV2lkdGg6IG51bWJlcjtcclxuICBwcml2YXRlIHJlYWRvbmx5IHhNYXJnaW46IG51bWJlcjtcclxuICBwcml2YXRlIHJlYWRvbmx5IHlNYXJnaW46IG51bWJlcjtcclxuICBwcml2YXRlIHJlYWRvbmx5IGxpbmVXaWR0aDogbnVtYmVyO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgYWxpZ246IFBhbmVsQWxpZ247XHJcbiAgcHJpdmF0ZSByZWFkb25seSBtaW5IZWlnaHQ6IG51bWJlcjtcclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKCBwYW5lbDogUGFuZWwsIG9wdGlvbnM6IFJlcXVpcmVkPFNlbGZPcHRpb25zPiApIHtcclxuICAgIHN1cGVyKCBwYW5lbCApO1xyXG5cclxuICAgIHRoaXMucGFuZWwgPSBwYW5lbDtcclxuXHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCB0eXBlb2Ygb3B0aW9ucy5taW5XaWR0aCA9PT0gJ251bWJlcicsICdQYW5lbCBtaW5XaWR0aCBzaG91bGQgYmUgYSBudW1iZXInICk7XHJcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCB0eXBlb2Ygb3B0aW9ucy54TWFyZ2luID09PSAnbnVtYmVyJywgJ1BhbmVsIHhNYXJnaW4gc2hvdWxkIGJlIGEgbnVtYmVyJyApO1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggdHlwZW9mIG9wdGlvbnMueU1hcmdpbiA9PT0gJ251bWJlcicsICdQYW5lbCB5TWFyZ2luIHNob3VsZCBiZSBhIG51bWJlcicgKTtcclxuICAgIGFzc2VydCAmJiBhc3NlcnQoIHR5cGVvZiBvcHRpb25zLmxpbmVXaWR0aCA9PT0gJ251bWJlcicsICdQYW5lbCBsaW5lV2lkdGggc2hvdWxkIGJlIGEgbnVtYmVyJyApO1xyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggQUxJR05fVkFMVUVTLmluY2x1ZGVzKCBvcHRpb25zLmFsaWduICksIGBQYW5lbCBhbGlnbiBzaG91bGQgYmUgb25lIG9mICR7QUxJR05fVkFMVUVTfWAgKTtcclxuXHJcbiAgICB0aGlzLm1pbldpZHRoID0gb3B0aW9ucy5taW5XaWR0aDtcclxuICAgIHRoaXMubWluSGVpZ2h0ID0gb3B0aW9ucy5taW5IZWlnaHQ7XHJcbiAgICB0aGlzLnhNYXJnaW4gPSBvcHRpb25zLnhNYXJnaW47XHJcbiAgICB0aGlzLnlNYXJnaW4gPSBvcHRpb25zLnlNYXJnaW47XHJcbiAgICB0aGlzLmxpbmVXaWR0aCA9IG9wdGlvbnMubGluZVdpZHRoO1xyXG4gICAgdGhpcy5hbGlnbiA9IG9wdGlvbnMuYWxpZ247XHJcblxyXG4gICAgdGhpcy5wYW5lbC5sb2NhbFByZWZlcnJlZFdpZHRoUHJvcGVydHkubGF6eUxpbmsoIHRoaXMuX3VwZGF0ZUxheW91dExpc3RlbmVyICk7XHJcbiAgICB0aGlzLnBhbmVsLmxvY2FsUHJlZmVycmVkSGVpZ2h0UHJvcGVydHkubGF6eUxpbmsoIHRoaXMuX3VwZGF0ZUxheW91dExpc3RlbmVyICk7XHJcblxyXG4gICAgdGhpcy5hZGROb2RlKCBwYW5lbC5fY29udGVudCApO1xyXG4gIH1cclxuXHJcbiAgcHJvdGVjdGVkIG92ZXJyaWRlIGxheW91dCgpOiB2b2lkIHtcclxuICAgIHN1cGVyLmxheW91dCgpO1xyXG5cclxuICAgIGNvbnN0IHBhbmVsID0gdGhpcy5wYW5lbDtcclxuICAgIGNvbnN0IGNvbnRlbnQgPSBwYW5lbC5fY29udGVudDtcclxuICAgIGNvbnN0IGJhY2tncm91bmQgPSBwYW5lbC5fYmFja2dyb3VuZDtcclxuXHJcbiAgICAvLyBXZSBvbmx5IGhhdmUgdG8gYWNjb3VudCBmb3IgdGhlIGxpbmVXaWR0aCBpbiBvdXIgbGF5b3V0IGlmIHdlIGhhdmUgYSBzdHJva2VcclxuICAgIGNvbnN0IGxpbmVXaWR0aCA9IHBhbmVsLnN0cm9rZSA9PT0gbnVsbCA/IDAgOiB0aGlzLmxpbmVXaWR0aDtcclxuXHJcbiAgICBjb25zdCBoYXNWYWxpZENvbnRlbnQgPSBwYW5lbC5pc0NoaWxkSW5jbHVkZWRJbkxheW91dCggY29udGVudCApO1xyXG5cclxuICAgIC8vIEJhaWwgb3V0IChhbmQgbWFrZSB0aGUgYmFja2dyb3VuZCBpbnZpc2libGUpIGlmIG91ciBib3VuZHMgYXJlIGludmFsaWRcclxuICAgIHBhbmVsLl9iYWNrZ3JvdW5kQ29udGFpbmVyLmNoaWxkcmVuID0gaGFzVmFsaWRDb250ZW50ID8gWyBiYWNrZ3JvdW5kIF0gOiBbXTtcclxuICAgIGlmICggIWhhc1ZhbGlkQ29udGVudCApIHtcclxuICAgICAgcGFuZWwubG9jYWxNaW5pbXVtV2lkdGggPSBudWxsO1xyXG4gICAgICBwYW5lbC5sb2NhbE1pbmltdW1IZWlnaHQgPSBudWxsO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgbWluaW11bUNvbnRlbnRXaWR0aCA9ICggaXNXaWR0aFNpemFibGUoIGNvbnRlbnQgKSAmJiBjb250ZW50Lm1pbmltdW1XaWR0aCAhPT0gbnVsbCApID8gY29udGVudC5taW5pbXVtV2lkdGggOiBjb250ZW50LndpZHRoO1xyXG4gICAgY29uc3QgbWluaW11bUNvbnRlbnRIZWlnaHQgPSAoIGlzSGVpZ2h0U2l6YWJsZSggY29udGVudCApICYmIGNvbnRlbnQubWluaW11bUhlaWdodCAhPT0gbnVsbCApID8gY29udGVudC5taW5pbXVtSGVpZ2h0IDogY29udGVudC5oZWlnaHQ7XHJcblxyXG4gICAgLy8gT3VyIG1pbmltdW0gZGltZW5zaW9ucyBhcmUgZGlyZWN0bHkgZGV0ZXJtaW5lZCBieSB0aGUgY29udGVudCwgbWFyZ2lucyBhbmQgbGluZVdpZHRoXHJcbiAgICAvLyBOT1RFOiBvcHRpb25zLm1pbldpZHRoIGRvZXMgTk9UIGluY2x1ZGUgdGhlIHN0cm9rZSAoZS5nLiBsaW5lV2lkdGgpLCBsZWZ0IGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5LlxyXG4gICAgY29uc3QgbWluaW11bVdpZHRoID0gTWF0aC5tYXgoIHRoaXMubWluV2lkdGgsIG1pbmltdW1Db250ZW50V2lkdGggKyAoIDIgKiB0aGlzLnhNYXJnaW4gKSApICsgbGluZVdpZHRoO1xyXG4gICAgY29uc3QgbWluaW11bUhlaWdodCA9IE1hdGgubWF4KCB0aGlzLm1pbkhlaWdodCwgbWluaW11bUNvbnRlbnRIZWlnaHQgKyAoIDIgKiB0aGlzLnlNYXJnaW4gKSApICsgbGluZVdpZHRoO1xyXG5cclxuICAgIC8vIE91ciByZXN1bHRpbmcgc2l6ZXMgKGFsbG93IHNldHRpbmcgcHJlZmVycmVkIHdpZHRoL2hlaWdodCBvbiB0aGUgcGFuZWwpXHJcbiAgICBjb25zdCBwcmVmZXJyZWRXaWR0aDogbnVtYmVyID0gTWF0aC5tYXgoIG1pbmltdW1XaWR0aCwgcGFuZWwubG9jYWxQcmVmZXJyZWRXaWR0aCB8fCAwICk7XHJcbiAgICBjb25zdCBwcmVmZXJyZWRIZWlnaHQ6IG51bWJlciA9IE1hdGgubWF4KCBtaW5pbXVtSGVpZ2h0LCBwYW5lbC5sb2NhbFByZWZlcnJlZEhlaWdodCB8fCAwICk7XHJcblxyXG4gICAgLy8gRGV0ZXJtaW5lIHRoZSBzaXplIGF2YWlsYWJsZSB0byBvdXIgY29udGVudFxyXG4gICAgLy8gTk9URTogV2UgZG8gTk9UIHNldCBwcmVmZXJyZWQgc2l6ZXMgb2Ygb3VyIGNvbnRlbnQgaWYgd2UgZG9uJ3QgaGF2ZSBhIHByZWZlcnJlZCBzaXplIG91cnNlbGYhXHJcbiAgICBpZiAoIGlzV2lkdGhTaXphYmxlKCBjb250ZW50ICkgJiYgcGFuZWwubG9jYWxQcmVmZXJyZWRXaWR0aCAhPT0gbnVsbCApIHtcclxuICAgICAgY29udGVudC5wcmVmZXJyZWRXaWR0aCA9IHByZWZlcnJlZFdpZHRoIC0gbGluZVdpZHRoIC0gMiAqIHRoaXMueE1hcmdpbjtcclxuICAgIH1cclxuICAgIGlmICggaXNIZWlnaHRTaXphYmxlKCBjb250ZW50ICkgJiYgcGFuZWwubG9jYWxQcmVmZXJyZWRIZWlnaHQgIT09IG51bGwgKSB7XHJcbiAgICAgIGNvbnRlbnQucHJlZmVycmVkSGVpZ2h0ID0gcHJlZmVycmVkSGVpZ2h0IC0gbGluZVdpZHRoIC0gMiAqIHRoaXMueU1hcmdpbjtcclxuICAgIH1cclxuXHJcbiAgICBiYWNrZ3JvdW5kLnNldFJlY3QoIDAsIDAsIHByZWZlcnJlZFdpZHRoIC0gbGluZVdpZHRoLCBwcmVmZXJyZWRIZWlnaHQgLSBsaW5lV2lkdGggKTtcclxuXHJcbiAgICAvLyBBbGlnbiB0aGUgY29udGVudCB3aXRoaW4gdGhlIGJhY2tncm91bmQuIElmIHRoZSBjb250ZW50IHdpZHRoID49IG1pbldpZHRoLCB0aGVuIGFsbCBhbGlnbm1lbnRzIGFyZSBlcXVpdmFsZW50LlxyXG4gICAgaWYgKCB0aGlzLmFsaWduID09PSAnY2VudGVyJyApIHtcclxuICAgICAgY29udGVudC5jZW50ZXIgPSBiYWNrZ3JvdW5kLmNlbnRlcjtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKCB0aGlzLmFsaWduID09PSAnbGVmdCcgKSB7XHJcblxyXG4gICAgICAvLyBVc2UgYmFja2dyb3VuZC5yZWN0V2lkdGggaW5zdGVhZCBvZiBiYWNrZ3JvdW5kLndpZHRoIGJlY2F1c2UgdGhleSBkaWZmZXIgYnkgdGhlIGJhY2tncm91bmQgbGluZVdpZHRoXHJcbiAgICAgIGNvbnRlbnQubGVmdCA9IGJhY2tncm91bmQuY2VudGVyWCAtIGJhY2tncm91bmQucmVjdFdpZHRoIC8gMiArIHRoaXMueE1hcmdpbjtcclxuICAgICAgY29udGVudC5jZW50ZXJZID0gYmFja2dyb3VuZC5jZW50ZXJZO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7IC8qIHJpZ2h0ICovXHJcblxyXG4gICAgICAvLyBVc2UgYmFja2dyb3VuZC5yZWN0V2lkdGggaW5zdGVhZCBvZiBiYWNrZ3JvdW5kLndpZHRoIGJlY2F1c2UgdGhleSBkaWZmZXIgYnkgdGhlIGJhY2tncm91bmQgbGluZVdpZHRoXHJcbiAgICAgIGNvbnRlbnQucmlnaHQgPSBiYWNrZ3JvdW5kLmNlbnRlclggKyBiYWNrZ3JvdW5kLnJlY3RXaWR0aCAvIDIgLSB0aGlzLnhNYXJnaW47XHJcbiAgICAgIGNvbnRlbnQuY2VudGVyWSA9IGJhY2tncm91bmQuY2VudGVyWTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBTZXQgbWluaW11bXMgYXQgdGhlIGVuZFxyXG4gICAgcGFuZWwubG9jYWxNaW5pbXVtV2lkdGggPSBtaW5pbXVtV2lkdGg7XHJcbiAgICBwYW5lbC5sb2NhbE1pbmltdW1IZWlnaHQgPSBtaW5pbXVtSGVpZ2h0O1xyXG4gIH1cclxuXHJcbiAgcHVibGljIG92ZXJyaWRlIGRpc3Bvc2UoKTogdm9pZCB7XHJcbiAgICB0aGlzLnBhbmVsLmxvY2FsUHJlZmVycmVkV2lkdGhQcm9wZXJ0eS51bmxpbmsoIHRoaXMuX3VwZGF0ZUxheW91dExpc3RlbmVyICk7XHJcbiAgICB0aGlzLnBhbmVsLmxvY2FsUHJlZmVycmVkSGVpZ2h0UHJvcGVydHkudW5saW5rKCB0aGlzLl91cGRhdGVMYXlvdXRMaXN0ZW5lciApO1xyXG5cclxuICAgIHN1cGVyLmRpc3Bvc2UoKTtcclxuICB9XHJcbn1cclxuXHJcbnN1bi5yZWdpc3RlciggJ1BhbmVsJywgUGFuZWwgKTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsU0FBU0EsVUFBVSxRQUEyQixpQ0FBaUM7QUFDL0UsU0FBU0MsZUFBZSxFQUFFQyxjQUFjLEVBQUVDLGdCQUFnQixFQUFFQyxJQUFJ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