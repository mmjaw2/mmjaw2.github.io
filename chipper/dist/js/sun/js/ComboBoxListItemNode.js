// Copyright 2019-2024, University of Colorado Boulder

/**
 * Node for an item in a combo box list.
 * Responsible for highlighting itself when the pointer is over it.
 * Typically instantiated by ComboBox, not by client code.
 *
 * @author Chris Malley (PixelZoom, Inc.)
 */

import { Shape } from '../../kite/js/imports.js';
import optionize from '../../phet-core/js/optionize.js';
import { IndexedNodeIO, ManualConstraint, Node, PressListener, Rectangle, Voicing } from '../../scenery/js/imports.js';
import Tandem from '../../tandem/js/Tandem.js';
import sun from './sun.js';
import SunConstants from './SunConstants.js';
import Property from '../../axon/js/Property.js';
import PatternStringProperty from '../../axon/js/PatternStringProperty.js';
import DerivedProperty from '../../axon/js/DerivedProperty.js';
export default class ComboBoxListItemNode extends Voicing(Node) {
  // when true, the next voicing focus listener will supply the response needed when opening the comboBox.
  // It will then set this back to false.

  constructor(item, node, a11yNameProperty, highlightWidthProperty, highlightHeightProperty, providedOptions) {
    const options = optionize()({
      cursor: 'pointer',
      align: 'left',
      xMargin: 6,
      highlightFill: 'rgb( 245, 245, 245 )',
      highlightCornerRadius: 4,
      // pdom
      tagName: 'li',
      focusable: true,
      ariaRole: 'option',
      // the `li` with ariaRole `option` does not get click events on iOS VoiceOver, so position
      // elements so they receive pointer events
      positionInPDOM: true,
      // voicing
      voicingFocusListener: () => this.comboBoxListItemNodeVoicingFocusListener(),
      comboBoxVoicingNameResponsePattern: SunConstants.VALUE_NAMED_PLACEHOLDER,
      // phet-io
      tandem: Tandem.REQUIRED,
      tandemNameSuffix: 'Item',
      // Together, these options make it possible to reorder the combo box items in studio, and save a customized
      // simulation with the new order.
      phetioType: IndexedNodeIO,
      phetioState: true,
      visiblePropertyOptions: {
        phetioFeatured: true
      }
    }, providedOptions);

    // @ts-expect-error convert Property into string
    options.comboBoxVoicingNameResponsePattern = options.comboBoxVoicingNameResponsePattern.get ?
    // @ts-expect-error convert Property into string
    options.comboBoxVoicingNameResponsePattern.get() : options.comboBoxVoicingNameResponsePattern;

    // Don't test the contents of strings when ?stringTest is enabled
    assert && assert(!!phet.chipper.queryParameters.stringTest ||
    // @ts-expect-error is a string now.
    options.comboBoxVoicingNameResponsePattern.includes('{{value}}'), 'value needs to be filled in');

    // Highlight that is shown when the pointer is over this item. This is not the a11y focus rectangle.
    const highlightRectangle = new Rectangle({
      cornerRadius: options.highlightCornerRadius
    });

    // Wrapper for the item's Node. Do not transform item.node because it is shared with ComboBoxButton!
    const itemNodeWrapper = new Node({
      children: [node]
    });

    // Adjust the size when the highlight size changes.
    const highlightWidthListener = width => {
      highlightRectangle.rectWidth = width;
      itemNodeWrapper.maxWidth = width;
    };
    highlightWidthProperty.link(highlightWidthListener);
    const highlightHeightListener = height => {
      highlightRectangle.rectHeight = height;
      itemNodeWrapper.maxHeight = height;
    };
    highlightHeightProperty.link(highlightHeightListener);
    options.children = [highlightRectangle, itemNodeWrapper];
    super(options);
    this._supplyOpenResponseOnNextFocus = false;

    // Assume that item.node may change (as in ComboBoxDisplay) and adjust layout dynamically.
    // See https://github.com/phetsims/scenery-phet/issues/482
    ManualConstraint.create(this, [highlightRectangle, itemNodeWrapper], (highlightProxy, itemProxy) => {
      if (options.align === 'left') {
        itemProxy.left = highlightProxy.left + options.xMargin;
      } else if (options.align === 'right') {
        itemProxy.right = highlightProxy.right - options.xMargin;
      } else {
        itemProxy.centerX = highlightProxy.centerX;
      }
      itemProxy.centerY = highlightProxy.centerY;
    });
    const emptyA11yNameProperty = new DerivedProperty([a11yNameProperty], a11yName => {
      return a11yName ? a11yName : '';
    });

    // TODO: Allow comboBoxVoicingNameResponsePattern to change, see https://github.com/phetsims/sun/issues/865
    const patternProperty = typeof options.comboBoxVoicingNameResponsePattern === 'string' ? new Property(options.comboBoxVoicingNameResponsePattern) : options.comboBoxVoicingNameResponsePattern;
    // TODO: It seems unlinks are missing, and the existing code was broken, see https://github.com/phetsims/sun/issues/865
    const patternStringProperty = new PatternStringProperty(patternProperty, {
      value: emptyA11yNameProperty
    }, {
      tandem: Tandem.OPT_OUT
    });
    this.voicingNameResponse = patternStringProperty;
    const a11yNameListener = a11yName => {
      // pdom: get innerContent from the item
      this.innerContent = a11yName;
      this.voicingObjectResponse = a11yName;
    };
    a11yNameProperty.link(a11yNameListener);
    this.item = item;

    // pdom focus highlight is fitted to this Node's bounds, so that it doesn't overlap other items in the list box
    this.localBoundsProperty.link(localBounds => {
      this.focusHighlight = Shape.bounds(localBounds);
    });
    const pressListener = new PressListener({
      attach: false,
      tandem: Tandem.OPT_OUT
    });
    this.addInputListener(pressListener);

    // Show highlight when pointer is over this item.
    // Change fill instead of visibility so that we don't end up with vertical pointer gaps in the list
    pressListener.looksOverProperty.link(pressed => {
      highlightRectangle.fill = pressed ? options.highlightFill : null;
    });
    this.disposeComboBoxListItemNode = () => {
      pressListener.dispose();
      patternStringProperty.dispose();
      emptyA11yNameProperty.dispose();
      a11yNameProperty.unlink(a11yNameListener);
      highlightWidthProperty.unlink(highlightWidthListener);
      highlightHeightProperty.unlink(highlightHeightListener);
    };
  }

  /**
   * Ask for the voicing response for opening the ComboBox upon next focus, but only for the very next focus event.
   */
  supplyOpenResponseOnNextFocus() {
    this._supplyOpenResponseOnNextFocus = true;
  }

  /**
   * Free memory references to avoid leaks.
   */
  dispose() {
    this.disposeComboBoxListItemNode();
    super.dispose();
  }

  /**
   * A custom focus listener for this type, with conditional support for providing a normal focus vs an "open" response.
   */
  comboBoxListItemNodeVoicingFocusListener() {
    this.voicingSpeakFullResponse({
      nameResponse: this._supplyOpenResponseOnNextFocus ? this.voicingNameResponse : null,
      objectResponse: this._supplyOpenResponseOnNextFocus ? null : this.voicingObjectResponse,
      contextResponse: null,
      hintResponse: this._supplyOpenResponseOnNextFocus ? this.voicingHintResponse : null
    });
    this._supplyOpenResponseOnNextFocus = false;
  }
}
sun.register('ComboBoxListItemNode', ComboBoxListItemNode);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTaGFwZSIsIm9wdGlvbml6ZSIsIkluZGV4ZWROb2RlSU8iLCJNYW51YWxDb25zdHJhaW50IiwiTm9kZSIsIlByZXNzTGlzdGVuZXIiLCJSZWN0YW5nbGUiLCJWb2ljaW5nIiwiVGFuZGVtIiwic3VuIiwiU3VuQ29uc3RhbnRzIiwiUHJvcGVydHkiLCJQYXR0ZXJuU3RyaW5nUHJvcGVydHkiLCJEZXJpdmVkUHJvcGVydHkiLCJDb21ib0JveExpc3RJdGVtTm9kZSIsImNvbnN0cnVjdG9yIiwiaXRlbSIsIm5vZGUiLCJhMTF5TmFtZVByb3BlcnR5IiwiaGlnaGxpZ2h0V2lkdGhQcm9wZXJ0eSIsImhpZ2hsaWdodEhlaWdodFByb3BlcnR5IiwicHJvdmlkZWRPcHRpb25zIiwib3B0aW9ucyIsImN1cnNvciIsImFsaWduIiwieE1hcmdpbiIsImhpZ2hsaWdodEZpbGwiLCJoaWdobGlnaHRDb3JuZXJSYWRpdXMiLCJ0YWdOYW1lIiwiZm9jdXNhYmxlIiwiYXJpYVJvbGUiLCJwb3NpdGlvbkluUERPTSIsInZvaWNpbmdGb2N1c0xpc3RlbmVyIiwiY29tYm9Cb3hMaXN0SXRlbU5vZGVWb2ljaW5nRm9jdXNMaXN0ZW5lciIsImNvbWJvQm94Vm9pY2luZ05hbWVSZXNwb25zZVBhdHRlcm4iLCJWQUxVRV9OQU1FRF9QTEFDRUhPTERFUiIsInRhbmRlbSIsIlJFUVVJUkVEIiwidGFuZGVtTmFtZVN1ZmZpeCIsInBoZXRpb1R5cGUiLCJwaGV0aW9TdGF0ZSIsInZpc2libGVQcm9wZXJ0eU9wdGlvbnMiLCJwaGV0aW9GZWF0dXJlZCIsImdldCIsImFzc2VydCIsInBoZXQiLCJjaGlwcGVyIiwicXVlcnlQYXJhbWV0ZXJzIiwic3RyaW5nVGVzdCIsImluY2x1ZGVzIiwiaGlnaGxpZ2h0UmVjdGFuZ2xlIiwiY29ybmVyUmFkaXVzIiwiaXRlbU5vZGVXcmFwcGVyIiwiY2hpbGRyZW4iLCJoaWdobGlnaHRXaWR0aExpc3RlbmVyIiwid2lkdGgiLCJyZWN0V2lkdGgiLCJtYXhXaWR0aCIsImxpbmsiLCJoaWdobGlnaHRIZWlnaHRMaXN0ZW5lciIsImhlaWdodCIsInJlY3RIZWlnaHQiLCJtYXhIZWlnaHQiLCJfc3VwcGx5T3BlblJlc3BvbnNlT25OZXh0Rm9jdXMiLCJjcmVhdGUiLCJoaWdobGlnaHRQcm94eSIsIml0ZW1Qcm94eSIsImxlZnQiLCJyaWdodCIsImNlbnRlclgiLCJjZW50ZXJZIiwiZW1wdHlBMTF5TmFtZVByb3BlcnR5IiwiYTExeU5hbWUiLCJwYXR0ZXJuUHJvcGVydHkiLCJwYXR0ZXJuU3RyaW5nUHJvcGVydHkiLCJ2YWx1ZSIsIk9QVF9PVVQiLCJ2b2ljaW5nTmFtZVJlc3BvbnNlIiwiYTExeU5hbWVMaXN0ZW5lciIsImlubmVyQ29udGVudCIsInZvaWNpbmdPYmplY3RSZXNwb25zZSIsImxvY2FsQm91bmRzUHJvcGVydHkiLCJsb2NhbEJvdW5kcyIsImZvY3VzSGlnaGxpZ2h0IiwiYm91bmRzIiwicHJlc3NMaXN0ZW5lciIsImF0dGFjaCIsImFkZElucHV0TGlzdGVuZXIiLCJsb29rc092ZXJQcm9wZXJ0eSIsInByZXNzZWQiLCJmaWxsIiwiZGlzcG9zZUNvbWJvQm94TGlzdEl0ZW1Ob2RlIiwiZGlzcG9zZSIsInVubGluayIsInN1cHBseU9wZW5SZXNwb25zZU9uTmV4dEZvY3VzIiwidm9pY2luZ1NwZWFrRnVsbFJlc3BvbnNlIiwibmFtZVJlc3BvbnNlIiwib2JqZWN0UmVzcG9uc2UiLCJjb250ZXh0UmVzcG9uc2UiLCJoaW50UmVzcG9uc2UiLCJ2b2ljaW5nSGludFJlc3BvbnNlIiwicmVnaXN0ZXIiXSwic291cmNlcyI6WyJDb21ib0JveExpc3RJdGVtTm9kZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxOS0yMDI0LCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBOb2RlIGZvciBhbiBpdGVtIGluIGEgY29tYm8gYm94IGxpc3QuXHJcbiAqIFJlc3BvbnNpYmxlIGZvciBoaWdobGlnaHRpbmcgaXRzZWxmIHdoZW4gdGhlIHBvaW50ZXIgaXMgb3ZlciBpdC5cclxuICogVHlwaWNhbGx5IGluc3RhbnRpYXRlZCBieSBDb21ib0JveCwgbm90IGJ5IGNsaWVudCBjb2RlLlxyXG4gKlxyXG4gKiBAYXV0aG9yIENocmlzIE1hbGxleSAoUGl4ZWxab29tLCBJbmMuKVxyXG4gKi9cclxuXHJcbmltcG9ydCB7IFNoYXBlIH0gZnJvbSAnLi4vLi4va2l0ZS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IFN0cmljdE9taXQgZnJvbSAnLi4vLi4vcGhldC1jb3JlL2pzL3R5cGVzL1N0cmljdE9taXQuanMnO1xyXG5pbXBvcnQgb3B0aW9uaXplIGZyb20gJy4uLy4uL3BoZXQtY29yZS9qcy9vcHRpb25pemUuanMnO1xyXG5pbXBvcnQgeyBJbmRleGVkTm9kZUlPLCBNYW51YWxDb25zdHJhaW50LCBOb2RlLCBOb2RlT3B0aW9ucywgUHJlc3NMaXN0ZW5lciwgUmVjdGFuZ2xlLCBUUGFpbnQsIFZvaWNpbmcsIFZvaWNpbmdPcHRpb25zIH0gZnJvbSAnLi4vLi4vc2NlbmVyeS9qcy9pbXBvcnRzLmpzJztcclxuaW1wb3J0IFRhbmRlbSBmcm9tICcuLi8uLi90YW5kZW0vanMvVGFuZGVtLmpzJztcclxuaW1wb3J0IHN1biBmcm9tICcuL3N1bi5qcyc7XHJcbmltcG9ydCBTdW5Db25zdGFudHMgZnJvbSAnLi9TdW5Db25zdGFudHMuanMnO1xyXG5pbXBvcnQgVFJlYWRPbmx5UHJvcGVydHkgZnJvbSAnLi4vLi4vYXhvbi9qcy9UUmVhZE9ubHlQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCBQcm9wZXJ0eSBmcm9tICcuLi8uLi9heG9uL2pzL1Byb3BlcnR5LmpzJztcclxuaW1wb3J0IFBhdHRlcm5TdHJpbmdQcm9wZXJ0eSBmcm9tICcuLi8uLi9heG9uL2pzL1BhdHRlcm5TdHJpbmdQcm9wZXJ0eS5qcyc7XHJcbmltcG9ydCB7IENvbWJvQm94SXRlbU5vTm9kZSB9IGZyb20gJy4vQ29tYm9Cb3guanMnO1xyXG5pbXBvcnQgRGVyaXZlZFByb3BlcnR5IGZyb20gJy4uLy4uL2F4b24vanMvRGVyaXZlZFByb3BlcnR5LmpzJztcclxuXHJcbnR5cGUgU2VsZk9wdGlvbnMgPSB7XHJcbiAgYWxpZ24/OiAnbGVmdCcgfCAncmlnaHQnIHwgJ2NlbnRlcic7XHJcblxyXG4gIC8vIG1hcmdpbiBiZXR3ZWVuIHRoZSBpdGVtIGFuZCB0aGUgaGlnaGxpZ2h0IGVkZ2VcclxuICB4TWFyZ2luPzogbnVtYmVyO1xyXG5cclxuICAvLyBoaWdobGlnaHQgYmVoaW5kIHRoZSBpdGVtXHJcbiAgaGlnaGxpZ2h0RmlsbD86IFRQYWludDtcclxuXHJcbiAgLy8gY29ybmVyIHJhZGl1cyBmb3IgdGhlIGhpZ2hsaWdodFxyXG4gIGhpZ2hsaWdodENvcm5lclJhZGl1cz86IG51bWJlcjtcclxuXHJcbiAgY29tYm9Cb3hWb2ljaW5nTmFtZVJlc3BvbnNlUGF0dGVybj86IFRSZWFkT25seVByb3BlcnR5PHN0cmluZz4gfCBzdHJpbmc7XHJcbn07XHJcbnR5cGUgUGFyZW50T3B0aW9ucyA9IFZvaWNpbmdPcHRpb25zICYgTm9kZU9wdGlvbnM7XHJcbmV4cG9ydCB0eXBlIENvbWJvQm94TGlzdEl0ZW1Ob2RlT3B0aW9ucyA9IFNlbGZPcHRpb25zICYgU3RyaWN0T21pdDxQYXJlbnRPcHRpb25zLCAnY2hpbGRyZW4nIHwgJ2lubmVyQ29udGVudCc+O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ29tYm9Cb3hMaXN0SXRlbU5vZGU8VD4gZXh0ZW5kcyBWb2ljaW5nKCBOb2RlICkge1xyXG5cclxuICAvLyB3aGVuIHRydWUsIHRoZSBuZXh0IHZvaWNpbmcgZm9jdXMgbGlzdGVuZXIgd2lsbCBzdXBwbHkgdGhlIHJlc3BvbnNlIG5lZWRlZCB3aGVuIG9wZW5pbmcgdGhlIGNvbWJvQm94LlxyXG4gIC8vIEl0IHdpbGwgdGhlbiBzZXQgdGhpcyBiYWNrIHRvIGZhbHNlLlxyXG4gIHByaXZhdGUgX3N1cHBseU9wZW5SZXNwb25zZU9uTmV4dEZvY3VzOiBib29sZWFuO1xyXG5cclxuICBwdWJsaWMgcmVhZG9ubHkgaXRlbTogQ29tYm9Cb3hJdGVtTm9Ob2RlPFQ+O1xyXG5cclxuICBwcml2YXRlIHJlYWRvbmx5IGRpc3Bvc2VDb21ib0JveExpc3RJdGVtTm9kZTogKCkgPT4gdm9pZDtcclxuXHJcbiAgcHVibGljIGNvbnN0cnVjdG9yKFxyXG4gICAgaXRlbTogQ29tYm9Cb3hJdGVtTm9Ob2RlPFQ+LFxyXG4gICAgbm9kZTogTm9kZSxcclxuICAgIGExMXlOYW1lUHJvcGVydHk6IFRSZWFkT25seVByb3BlcnR5PHN0cmluZyB8IG51bGw+LFxyXG4gICAgaGlnaGxpZ2h0V2lkdGhQcm9wZXJ0eTogVFJlYWRPbmx5UHJvcGVydHk8bnVtYmVyPixcclxuICAgIGhpZ2hsaWdodEhlaWdodFByb3BlcnR5OiBUUmVhZE9ubHlQcm9wZXJ0eTxudW1iZXI+LFxyXG4gICAgcHJvdmlkZWRPcHRpb25zPzogQ29tYm9Cb3hMaXN0SXRlbU5vZGVPcHRpb25zXHJcbiAgKSB7XHJcblxyXG4gICAgY29uc3Qgb3B0aW9ucyA9IG9wdGlvbml6ZTxDb21ib0JveExpc3RJdGVtTm9kZU9wdGlvbnMsIFNlbGZPcHRpb25zLCBQYXJlbnRPcHRpb25zPigpKCB7XHJcblxyXG4gICAgICBjdXJzb3I6ICdwb2ludGVyJyxcclxuICAgICAgYWxpZ246ICdsZWZ0JyxcclxuICAgICAgeE1hcmdpbjogNixcclxuICAgICAgaGlnaGxpZ2h0RmlsbDogJ3JnYiggMjQ1LCAyNDUsIDI0NSApJyxcclxuICAgICAgaGlnaGxpZ2h0Q29ybmVyUmFkaXVzOiA0LFxyXG5cclxuICAgICAgLy8gcGRvbVxyXG4gICAgICB0YWdOYW1lOiAnbGknLFxyXG4gICAgICBmb2N1c2FibGU6IHRydWUsXHJcbiAgICAgIGFyaWFSb2xlOiAnb3B0aW9uJyxcclxuXHJcbiAgICAgIC8vIHRoZSBgbGlgIHdpdGggYXJpYVJvbGUgYG9wdGlvbmAgZG9lcyBub3QgZ2V0IGNsaWNrIGV2ZW50cyBvbiBpT1MgVm9pY2VPdmVyLCBzbyBwb3NpdGlvblxyXG4gICAgICAvLyBlbGVtZW50cyBzbyB0aGV5IHJlY2VpdmUgcG9pbnRlciBldmVudHNcclxuICAgICAgcG9zaXRpb25JblBET006IHRydWUsXHJcblxyXG4gICAgICAvLyB2b2ljaW5nXHJcbiAgICAgIHZvaWNpbmdGb2N1c0xpc3RlbmVyOiAoKSA9PiB0aGlzLmNvbWJvQm94TGlzdEl0ZW1Ob2RlVm9pY2luZ0ZvY3VzTGlzdGVuZXIoKSxcclxuICAgICAgY29tYm9Cb3hWb2ljaW5nTmFtZVJlc3BvbnNlUGF0dGVybjogU3VuQ29uc3RhbnRzLlZBTFVFX05BTUVEX1BMQUNFSE9MREVSLFxyXG5cclxuICAgICAgLy8gcGhldC1pb1xyXG4gICAgICB0YW5kZW06IFRhbmRlbS5SRVFVSVJFRCxcclxuICAgICAgdGFuZGVtTmFtZVN1ZmZpeDogJ0l0ZW0nLFxyXG5cclxuICAgICAgLy8gVG9nZXRoZXIsIHRoZXNlIG9wdGlvbnMgbWFrZSBpdCBwb3NzaWJsZSB0byByZW9yZGVyIHRoZSBjb21ibyBib3ggaXRlbXMgaW4gc3R1ZGlvLCBhbmQgc2F2ZSBhIGN1c3RvbWl6ZWRcclxuICAgICAgLy8gc2ltdWxhdGlvbiB3aXRoIHRoZSBuZXcgb3JkZXIuXHJcbiAgICAgIHBoZXRpb1R5cGU6IEluZGV4ZWROb2RlSU8sXHJcbiAgICAgIHBoZXRpb1N0YXRlOiB0cnVlLFxyXG4gICAgICB2aXNpYmxlUHJvcGVydHlPcHRpb25zOiB7IHBoZXRpb0ZlYXR1cmVkOiB0cnVlIH1cclxuICAgIH0sIHByb3ZpZGVkT3B0aW9ucyApO1xyXG5cclxuICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgY29udmVydCBQcm9wZXJ0eSBpbnRvIHN0cmluZ1xyXG4gICAgb3B0aW9ucy5jb21ib0JveFZvaWNpbmdOYW1lUmVzcG9uc2VQYXR0ZXJuID0gb3B0aW9ucy5jb21ib0JveFZvaWNpbmdOYW1lUmVzcG9uc2VQYXR0ZXJuLmdldCA/XHJcbiAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgY29udmVydCBQcm9wZXJ0eSBpbnRvIHN0cmluZ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5jb21ib0JveFZvaWNpbmdOYW1lUmVzcG9uc2VQYXR0ZXJuLmdldCgpIDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuY29tYm9Cb3hWb2ljaW5nTmFtZVJlc3BvbnNlUGF0dGVybjtcclxuXHJcbiAgICAvLyBEb24ndCB0ZXN0IHRoZSBjb250ZW50cyBvZiBzdHJpbmdzIHdoZW4gP3N0cmluZ1Rlc3QgaXMgZW5hYmxlZFxyXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggISFwaGV0LmNoaXBwZXIucXVlcnlQYXJhbWV0ZXJzLnN0cmluZ1Rlc3QgfHxcclxuICAgICAgICAgICAgICAgICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgaXMgYSBzdHJpbmcgbm93LlxyXG4gICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5jb21ib0JveFZvaWNpbmdOYW1lUmVzcG9uc2VQYXR0ZXJuLmluY2x1ZGVzKCAne3t2YWx1ZX19JyApLFxyXG4gICAgICAndmFsdWUgbmVlZHMgdG8gYmUgZmlsbGVkIGluJyApO1xyXG5cclxuICAgIC8vIEhpZ2hsaWdodCB0aGF0IGlzIHNob3duIHdoZW4gdGhlIHBvaW50ZXIgaXMgb3ZlciB0aGlzIGl0ZW0uIFRoaXMgaXMgbm90IHRoZSBhMTF5IGZvY3VzIHJlY3RhbmdsZS5cclxuICAgIGNvbnN0IGhpZ2hsaWdodFJlY3RhbmdsZSA9IG5ldyBSZWN0YW5nbGUoIHtcclxuICAgICAgY29ybmVyUmFkaXVzOiBvcHRpb25zLmhpZ2hsaWdodENvcm5lclJhZGl1c1xyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIFdyYXBwZXIgZm9yIHRoZSBpdGVtJ3MgTm9kZS4gRG8gbm90IHRyYW5zZm9ybSBpdGVtLm5vZGUgYmVjYXVzZSBpdCBpcyBzaGFyZWQgd2l0aCBDb21ib0JveEJ1dHRvbiFcclxuICAgIGNvbnN0IGl0ZW1Ob2RlV3JhcHBlciA9IG5ldyBOb2RlKCB7XHJcbiAgICAgIGNoaWxkcmVuOiBbIG5vZGUgXVxyXG4gICAgfSApO1xyXG5cclxuICAgIC8vIEFkanVzdCB0aGUgc2l6ZSB3aGVuIHRoZSBoaWdobGlnaHQgc2l6ZSBjaGFuZ2VzLlxyXG4gICAgY29uc3QgaGlnaGxpZ2h0V2lkdGhMaXN0ZW5lciA9ICggd2lkdGg6IG51bWJlciApID0+IHtcclxuICAgICAgaGlnaGxpZ2h0UmVjdGFuZ2xlLnJlY3RXaWR0aCA9IHdpZHRoO1xyXG4gICAgICBpdGVtTm9kZVdyYXBwZXIubWF4V2lkdGggPSB3aWR0aDtcclxuICAgIH07XHJcbiAgICBoaWdobGlnaHRXaWR0aFByb3BlcnR5LmxpbmsoIGhpZ2hsaWdodFdpZHRoTGlzdGVuZXIgKTtcclxuICAgIGNvbnN0IGhpZ2hsaWdodEhlaWdodExpc3RlbmVyID0gKCBoZWlnaHQ6IG51bWJlciApID0+IHtcclxuICAgICAgaGlnaGxpZ2h0UmVjdGFuZ2xlLnJlY3RIZWlnaHQgPSBoZWlnaHQ7XHJcbiAgICAgIGl0ZW1Ob2RlV3JhcHBlci5tYXhIZWlnaHQgPSBoZWlnaHQ7XHJcbiAgICB9O1xyXG4gICAgaGlnaGxpZ2h0SGVpZ2h0UHJvcGVydHkubGluayggaGlnaGxpZ2h0SGVpZ2h0TGlzdGVuZXIgKTtcclxuXHJcbiAgICBvcHRpb25zLmNoaWxkcmVuID0gWyBoaWdobGlnaHRSZWN0YW5nbGUsIGl0ZW1Ob2RlV3JhcHBlciBdO1xyXG5cclxuICAgIHN1cGVyKCBvcHRpb25zICk7XHJcbiAgICB0aGlzLl9zdXBwbHlPcGVuUmVzcG9uc2VPbk5leHRGb2N1cyA9IGZhbHNlO1xyXG5cclxuICAgIC8vIEFzc3VtZSB0aGF0IGl0ZW0ubm9kZSBtYXkgY2hhbmdlIChhcyBpbiBDb21ib0JveERpc3BsYXkpIGFuZCBhZGp1c3QgbGF5b3V0IGR5bmFtaWNhbGx5LlxyXG4gICAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9zY2VuZXJ5LXBoZXQvaXNzdWVzLzQ4MlxyXG4gICAgTWFudWFsQ29uc3RyYWludC5jcmVhdGUoIHRoaXMsIFsgaGlnaGxpZ2h0UmVjdGFuZ2xlLCBpdGVtTm9kZVdyYXBwZXIgXSwgKCBoaWdobGlnaHRQcm94eSwgaXRlbVByb3h5ICkgPT4ge1xyXG4gICAgICBpZiAoIG9wdGlvbnMuYWxpZ24gPT09ICdsZWZ0JyApIHtcclxuICAgICAgICBpdGVtUHJveHkubGVmdCA9IGhpZ2hsaWdodFByb3h5LmxlZnQgKyBvcHRpb25zLnhNYXJnaW47XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSBpZiAoIG9wdGlvbnMuYWxpZ24gPT09ICdyaWdodCcgKSB7XHJcbiAgICAgICAgaXRlbVByb3h5LnJpZ2h0ID0gaGlnaGxpZ2h0UHJveHkucmlnaHQgLSBvcHRpb25zLnhNYXJnaW47XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgaXRlbVByb3h5LmNlbnRlclggPSBoaWdobGlnaHRQcm94eS5jZW50ZXJYO1xyXG4gICAgICB9XHJcbiAgICAgIGl0ZW1Qcm94eS5jZW50ZXJZID0gaGlnaGxpZ2h0UHJveHkuY2VudGVyWTtcclxuICAgIH0gKTtcclxuXHJcbiAgICBjb25zdCBlbXB0eUExMXlOYW1lUHJvcGVydHkgPSBuZXcgRGVyaXZlZFByb3BlcnR5KCBbIGExMXlOYW1lUHJvcGVydHkgXSwgKCBhMTF5TmFtZTogc3RyaW5nIHwgbnVsbCApID0+IHtcclxuICAgICAgcmV0dXJuIGExMXlOYW1lID8gYTExeU5hbWUgOiAnJztcclxuICAgIH0gKTtcclxuXHJcbiAgICAvLyBUT0RPOiBBbGxvdyBjb21ib0JveFZvaWNpbmdOYW1lUmVzcG9uc2VQYXR0ZXJuIHRvIGNoYW5nZSwgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9zdW4vaXNzdWVzLzg2NVxyXG4gICAgY29uc3QgcGF0dGVyblByb3BlcnR5ID0gdHlwZW9mIG9wdGlvbnMuY29tYm9Cb3hWb2ljaW5nTmFtZVJlc3BvbnNlUGF0dGVybiA9PT0gJ3N0cmluZycgP1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IFByb3BlcnR5KCBvcHRpb25zLmNvbWJvQm94Vm9pY2luZ05hbWVSZXNwb25zZVBhdHRlcm4gKSA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmNvbWJvQm94Vm9pY2luZ05hbWVSZXNwb25zZVBhdHRlcm47XHJcbiAgICAvLyBUT0RPOiBJdCBzZWVtcyB1bmxpbmtzIGFyZSBtaXNzaW5nLCBhbmQgdGhlIGV4aXN0aW5nIGNvZGUgd2FzIGJyb2tlbiwgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9zdW4vaXNzdWVzLzg2NVxyXG4gICAgY29uc3QgcGF0dGVyblN0cmluZ1Byb3BlcnR5ID0gbmV3IFBhdHRlcm5TdHJpbmdQcm9wZXJ0eSggcGF0dGVyblByb3BlcnR5LCB7XHJcbiAgICAgIHZhbHVlOiBlbXB0eUExMXlOYW1lUHJvcGVydHlcclxuICAgIH0sIHsgdGFuZGVtOiBUYW5kZW0uT1BUX09VVCB9ICk7XHJcbiAgICB0aGlzLnZvaWNpbmdOYW1lUmVzcG9uc2UgPSBwYXR0ZXJuU3RyaW5nUHJvcGVydHk7XHJcblxyXG4gICAgY29uc3QgYTExeU5hbWVMaXN0ZW5lciA9ICggYTExeU5hbWU6IHN0cmluZyB8IG51bGwgKSA9PiB7XHJcbiAgICAgIC8vIHBkb206IGdldCBpbm5lckNvbnRlbnQgZnJvbSB0aGUgaXRlbVxyXG4gICAgICB0aGlzLmlubmVyQ29udGVudCA9IGExMXlOYW1lO1xyXG4gICAgICB0aGlzLnZvaWNpbmdPYmplY3RSZXNwb25zZSA9IGExMXlOYW1lO1xyXG4gICAgfTtcclxuICAgIGExMXlOYW1lUHJvcGVydHkubGluayggYTExeU5hbWVMaXN0ZW5lciApO1xyXG5cclxuICAgIHRoaXMuaXRlbSA9IGl0ZW07XHJcblxyXG4gICAgLy8gcGRvbSBmb2N1cyBoaWdobGlnaHQgaXMgZml0dGVkIHRvIHRoaXMgTm9kZSdzIGJvdW5kcywgc28gdGhhdCBpdCBkb2Vzbid0IG92ZXJsYXAgb3RoZXIgaXRlbXMgaW4gdGhlIGxpc3QgYm94XHJcbiAgICB0aGlzLmxvY2FsQm91bmRzUHJvcGVydHkubGluayggbG9jYWxCb3VuZHMgPT4ge1xyXG4gICAgICB0aGlzLmZvY3VzSGlnaGxpZ2h0ID0gU2hhcGUuYm91bmRzKCBsb2NhbEJvdW5kcyApO1xyXG4gICAgfSApO1xyXG5cclxuICAgIGNvbnN0IHByZXNzTGlzdGVuZXIgPSBuZXcgUHJlc3NMaXN0ZW5lcigge1xyXG4gICAgICBhdHRhY2g6IGZhbHNlLFxyXG4gICAgICB0YW5kZW06IFRhbmRlbS5PUFRfT1VUXHJcbiAgICB9ICk7XHJcbiAgICB0aGlzLmFkZElucHV0TGlzdGVuZXIoIHByZXNzTGlzdGVuZXIgKTtcclxuXHJcbiAgICAvLyBTaG93IGhpZ2hsaWdodCB3aGVuIHBvaW50ZXIgaXMgb3ZlciB0aGlzIGl0ZW0uXHJcbiAgICAvLyBDaGFuZ2UgZmlsbCBpbnN0ZWFkIG9mIHZpc2liaWxpdHkgc28gdGhhdCB3ZSBkb24ndCBlbmQgdXAgd2l0aCB2ZXJ0aWNhbCBwb2ludGVyIGdhcHMgaW4gdGhlIGxpc3RcclxuICAgIHByZXNzTGlzdGVuZXIubG9va3NPdmVyUHJvcGVydHkubGluayggcHJlc3NlZCA9PiB7XHJcbiAgICAgIGhpZ2hsaWdodFJlY3RhbmdsZS5maWxsID0gcHJlc3NlZCA/IG9wdGlvbnMuaGlnaGxpZ2h0RmlsbCA6IG51bGw7XHJcbiAgICB9ICk7XHJcblxyXG4gICAgdGhpcy5kaXNwb3NlQ29tYm9Cb3hMaXN0SXRlbU5vZGUgPSAoKSA9PiB7XHJcbiAgICAgIHByZXNzTGlzdGVuZXIuZGlzcG9zZSgpO1xyXG4gICAgICBwYXR0ZXJuU3RyaW5nUHJvcGVydHkuZGlzcG9zZSgpO1xyXG4gICAgICBlbXB0eUExMXlOYW1lUHJvcGVydHkuZGlzcG9zZSgpO1xyXG4gICAgICBhMTF5TmFtZVByb3BlcnR5LnVubGluayggYTExeU5hbWVMaXN0ZW5lciApO1xyXG4gICAgICBoaWdobGlnaHRXaWR0aFByb3BlcnR5LnVubGluayggaGlnaGxpZ2h0V2lkdGhMaXN0ZW5lciApO1xyXG4gICAgICBoaWdobGlnaHRIZWlnaHRQcm9wZXJ0eS51bmxpbmsoIGhpZ2hsaWdodEhlaWdodExpc3RlbmVyICk7XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQXNrIGZvciB0aGUgdm9pY2luZyByZXNwb25zZSBmb3Igb3BlbmluZyB0aGUgQ29tYm9Cb3ggdXBvbiBuZXh0IGZvY3VzLCBidXQgb25seSBmb3IgdGhlIHZlcnkgbmV4dCBmb2N1cyBldmVudC5cclxuICAgKi9cclxuICBwdWJsaWMgc3VwcGx5T3BlblJlc3BvbnNlT25OZXh0Rm9jdXMoKTogdm9pZCB7XHJcbiAgICB0aGlzLl9zdXBwbHlPcGVuUmVzcG9uc2VPbk5leHRGb2N1cyA9IHRydWU7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGcmVlIG1lbW9yeSByZWZlcmVuY2VzIHRvIGF2b2lkIGxlYWtzLlxyXG4gICAqL1xyXG4gIHB1YmxpYyBvdmVycmlkZSBkaXNwb3NlKCk6IHZvaWQge1xyXG4gICAgdGhpcy5kaXNwb3NlQ29tYm9Cb3hMaXN0SXRlbU5vZGUoKTtcclxuICAgIHN1cGVyLmRpc3Bvc2UoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEEgY3VzdG9tIGZvY3VzIGxpc3RlbmVyIGZvciB0aGlzIHR5cGUsIHdpdGggY29uZGl0aW9uYWwgc3VwcG9ydCBmb3IgcHJvdmlkaW5nIGEgbm9ybWFsIGZvY3VzIHZzIGFuIFwib3BlblwiIHJlc3BvbnNlLlxyXG4gICAqL1xyXG4gIHByaXZhdGUgY29tYm9Cb3hMaXN0SXRlbU5vZGVWb2ljaW5nRm9jdXNMaXN0ZW5lcigpOiB2b2lkIHtcclxuICAgIHRoaXMudm9pY2luZ1NwZWFrRnVsbFJlc3BvbnNlKCB7XHJcbiAgICAgIG5hbWVSZXNwb25zZTogdGhpcy5fc3VwcGx5T3BlblJlc3BvbnNlT25OZXh0Rm9jdXMgPyB0aGlzLnZvaWNpbmdOYW1lUmVzcG9uc2UgOiBudWxsLFxyXG4gICAgICBvYmplY3RSZXNwb25zZTogdGhpcy5fc3VwcGx5T3BlblJlc3BvbnNlT25OZXh0Rm9jdXMgPyBudWxsIDogdGhpcy52b2ljaW5nT2JqZWN0UmVzcG9uc2UsXHJcbiAgICAgIGNvbnRleHRSZXNwb25zZTogbnVsbCxcclxuICAgICAgaGludFJlc3BvbnNlOiB0aGlzLl9zdXBwbHlPcGVuUmVzcG9uc2VPbk5leHRGb2N1cyA/IHRoaXMudm9pY2luZ0hpbnRSZXNwb25zZSA6IG51bGxcclxuICAgIH0gKTtcclxuICAgIHRoaXMuX3N1cHBseU9wZW5SZXNwb25zZU9uTmV4dEZvY3VzID0gZmFsc2U7XHJcbiAgfVxyXG59XHJcblxyXG5zdW4ucmVnaXN0ZXIoICdDb21ib0JveExpc3RJdGVtTm9kZScsIENvbWJvQm94TGlzdEl0ZW1Ob2RlICk7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxTQUFTQSxLQUFLLFFBQVEsMEJBQTBCO0FBRWhELE9BQU9DLFNBQVMsTUFBTSxpQ0FBaUM7QUFDdkQsU0FBU0MsYUFBYSxFQUFFQyxnQkFBZ0IsRUFBRUMsSUFBSSxFQUFlQyxhQUFhLEVBQUVDLFNBQVMsRUFBVUMsT0FBTyxRQUF3Qiw2QkFBNkI7QUFDM0osT0FBT0MsTUFBTSxNQUFNLDJCQUEyQjtBQUM5QyxPQUFPQyxHQUFHLE1BQU0sVUFBVTtBQUMxQixPQUFPQyxZQUFZLE1BQU0sbUJBQW1CO0FBRTVDLE9BQU9DLFFBQVEsTUFBTSwyQkFBMkI7QUFDaEQsT0FBT0MscUJBQXFCLE1BQU0sd0NBQXdDO0FBRTFFLE9BQU9DLGVBQWUsTUFBTSxrQ0FBa0M7QUFtQjlELGVBQWUsTUFBTUMsb0JBQW9CLFNBQVlQLE9BQU8sQ0FBRUgsSUFBSyxDQUFDLENBQUM7RUFFbkU7RUFDQTs7RUFPT1csV0FBV0EsQ0FDaEJDLElBQTJCLEVBQzNCQyxJQUFVLEVBQ1ZDLGdCQUFrRCxFQUNsREMsc0JBQWlELEVBQ2pEQyx1QkFBa0Qs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