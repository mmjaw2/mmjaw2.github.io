// Copyright 2017, University of Colorado Boulder

/**
 * For `grunt create-release`, see Gruntfile for details
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

const SimVersion = require('../common/SimVersion');
const build = require('../common/build');
const copyFile = require('../common/copyFile');
const getBranch = require('../common/getBranch');
const gitAdd = require('../common/gitAdd');
const gitCheckout = require('../common/gitCheckout');
const gitCommit = require('../common/gitCommit');
const gitCreateBranch = require('../common/gitCreateBranch');
const gitIsClean = require('../common/gitIsClean');
const gitPush = require('../common/gitPush');
const hasRemoteBranch = require('../common/hasRemoteBranch');
const npmUpdate = require('../common/npmUpdate');
const setRepoVersion = require('../common/setRepoVersion');
const setRepoSupportedBrands = require('../common/setRepoSupportedBrands');
const updateHTMLVersion = require('../common/updateHTMLVersion');
const assert = require('assert');
const grunt = require('grunt');
const winston = require('../../../../../../perennial-alias/node_modules/winston');

/**
 * For `grunt create-release`, see Gruntfile for details
 * @public
 *
 * @param {string} repo - The repository name
 * @param {string} branch - The branch to create (should be {{MAJOR}}.{{MINOR}})
 * @param {string[]} brands - the supported brands in the release
 * @param {string} [message] - Optional message to append to the brands/version-increment commit.
 * @returns {Promise}
 */
module.exports = async function createRelease(repo, branch, brands, message) {
  const major = Number(branch.split('.')[0]);
  const minor = Number(branch.split('.')[1]);
  assert(major > 0, 'Major version for a branch should be greater than zero');
  assert(minor >= 0, 'Minor version for a branch should be greater than (or equal) to zero');
  assert(Array.isArray(brands), 'supported brands required');
  assert(brands.length >= 1, 'must have a supported brand');
  const currentBranch = await getBranch(repo);
  if (currentBranch !== 'main') {
    grunt.fail.fatal(`Should be on main to create a release branch, not: ${currentBranch ? currentBranch : '(detached head)'}`);
  }
  const hasBranchAlready = await hasRemoteBranch(repo, branch);
  if (hasBranchAlready) {
    grunt.fail.fatal('Branch already exists, aborting');
  }
  const newVersion = new SimVersion(major, minor, 0, {
    testType: 'rc',
    testNumber: 0
  });
  const isClean = await gitIsClean(repo);
  if (!isClean) {
    throw new Error(`Unclean status in ${repo}, cannot create release branch`);
  }
  winston.info('Setting the release branch version to rc.0 so it will auto-increment to rc.1 for the first RC deployment');

  // Create the branch, update the version info
  await gitCreateBranch(repo, branch);
  await setRepoSupportedBrands(repo, brands);
  await setRepoVersion(repo, newVersion, message);
  await gitPush(repo, branch);

  // Update dependencies.json for the release branch
  await npmUpdate(repo);
  await npmUpdate('chipper');
  await npmUpdate('perennial-alias');
  const brand = brands[0];
  await build(repo, {
    brands: [brand]
  });
  await copyFile(`../${repo}/build/${brand}/dependencies.json`, `../${repo}/dependencies.json`);
  await gitAdd(repo, 'dependencies.json');
  await gitCommit(repo, `updated dependencies.json for version ${newVersion.toString()}`);
  await gitPush(repo, branch);

  // Update the version info in main
  await gitCheckout(repo, 'main');
  await setRepoVersion(repo, new SimVersion(major, minor + 1, 0, {
    testType: 'dev',
    testNumber: 0
  }), message);
  await updateHTMLVersion(repo);
  await gitPush(repo, 'main');

  // Go back to the branch (as they may want to do a deploy)
  await gitCheckout(repo, branch);
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTaW1WZXJzaW9uIiwicmVxdWlyZSIsImJ1aWxkIiwiY29weUZpbGUiLCJnZXRCcmFuY2giLCJnaXRBZGQiLCJnaXRDaGVja291dCIsImdpdENvbW1pdCIsImdpdENyZWF0ZUJyYW5jaCIsImdpdElzQ2xlYW4iLCJnaXRQdXNoIiwiaGFzUmVtb3RlQnJhbmNoIiwibnBtVXBkYXRlIiwic2V0UmVwb1ZlcnNpb24iLCJzZXRSZXBvU3VwcG9ydGVkQnJhbmRzIiwidXBkYXRlSFRNTFZlcnNpb24iLCJhc3NlcnQiLCJncnVudCIsIndpbnN0b24iLCJtb2R1bGUiLCJleHBvcnRzIiwiY3JlYXRlUmVsZWFzZSIsInJlcG8iLCJicmFuY2giLCJicmFuZHMiLCJtZXNzYWdlIiwibWFqb3IiLCJOdW1iZXIiLCJzcGxpdCIsIm1pbm9yIiwiQXJyYXkiLCJpc0FycmF5IiwibGVuZ3RoIiwiY3VycmVudEJyYW5jaCIsImZhaWwiLCJmYXRhbCIsImhhc0JyYW5jaEFscmVhZHkiLCJuZXdWZXJzaW9uIiwidGVzdFR5cGUiLCJ0ZXN0TnVtYmVyIiwiaXNDbGVhbiIsIkVycm9yIiwiaW5mbyIsImJyYW5kIiwidG9TdHJpbmciXSwic291cmNlcyI6WyJjcmVhdGVSZWxlYXNlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE3LCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBGb3IgYGdydW50IGNyZWF0ZS1yZWxlYXNlYCwgc2VlIEdydW50ZmlsZSBmb3IgZGV0YWlsc1xyXG4gKlxyXG4gKiBAYXV0aG9yIEpvbmF0aGFuIE9sc29uIDxqb25hdGhhbi5vbHNvbkBjb2xvcmFkby5lZHU+XHJcbiAqL1xyXG5cclxuY29uc3QgU2ltVmVyc2lvbiA9IHJlcXVpcmUoICcuLi9jb21tb24vU2ltVmVyc2lvbicgKTtcclxuY29uc3QgYnVpbGQgPSByZXF1aXJlKCAnLi4vY29tbW9uL2J1aWxkJyApO1xyXG5jb25zdCBjb3B5RmlsZSA9IHJlcXVpcmUoICcuLi9jb21tb24vY29weUZpbGUnICk7XHJcbmNvbnN0IGdldEJyYW5jaCA9IHJlcXVpcmUoICcuLi9jb21tb24vZ2V0QnJhbmNoJyApO1xyXG5jb25zdCBnaXRBZGQgPSByZXF1aXJlKCAnLi4vY29tbW9uL2dpdEFkZCcgKTtcclxuY29uc3QgZ2l0Q2hlY2tvdXQgPSByZXF1aXJlKCAnLi4vY29tbW9uL2dpdENoZWNrb3V0JyApO1xyXG5jb25zdCBnaXRDb21taXQgPSByZXF1aXJlKCAnLi4vY29tbW9uL2dpdENvbW1pdCcgKTtcclxuY29uc3QgZ2l0Q3JlYXRlQnJhbmNoID0gcmVxdWlyZSggJy4uL2NvbW1vbi9naXRDcmVhdGVCcmFuY2gnICk7XHJcbmNvbnN0IGdpdElzQ2xlYW4gPSByZXF1aXJlKCAnLi4vY29tbW9uL2dpdElzQ2xlYW4nICk7XHJcbmNvbnN0IGdpdFB1c2ggPSByZXF1aXJlKCAnLi4vY29tbW9uL2dpdFB1c2gnICk7XHJcbmNvbnN0IGhhc1JlbW90ZUJyYW5jaCA9IHJlcXVpcmUoICcuLi9jb21tb24vaGFzUmVtb3RlQnJhbmNoJyApO1xyXG5jb25zdCBucG1VcGRhdGUgPSByZXF1aXJlKCAnLi4vY29tbW9uL25wbVVwZGF0ZScgKTtcclxuY29uc3Qgc2V0UmVwb1ZlcnNpb24gPSByZXF1aXJlKCAnLi4vY29tbW9uL3NldFJlcG9WZXJzaW9uJyApO1xyXG5jb25zdCBzZXRSZXBvU3VwcG9ydGVkQnJhbmRzID0gcmVxdWlyZSggJy4uL2NvbW1vbi9zZXRSZXBvU3VwcG9ydGVkQnJhbmRzJyApO1xyXG5jb25zdCB1cGRhdGVIVE1MVmVyc2lvbiA9IHJlcXVpcmUoICcuLi9jb21tb24vdXBkYXRlSFRNTFZlcnNpb24nICk7XHJcbmNvbnN0IGFzc2VydCA9IHJlcXVpcmUoICdhc3NlcnQnICk7XHJcbmNvbnN0IGdydW50ID0gcmVxdWlyZSggJ2dydW50JyApO1xyXG5jb25zdCB3aW5zdG9uID0gcmVxdWlyZSggJ3dpbnN0b24nICk7XHJcblxyXG4vKipcclxuICogRm9yIGBncnVudCBjcmVhdGUtcmVsZWFzZWAsIHNlZSBHcnVudGZpbGUgZm9yIGRldGFpbHNcclxuICogQHB1YmxpY1xyXG4gKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gcmVwbyAtIFRoZSByZXBvc2l0b3J5IG5hbWVcclxuICogQHBhcmFtIHtzdHJpbmd9IGJyYW5jaCAtIFRoZSBicmFuY2ggdG8gY3JlYXRlIChzaG91bGQgYmUge3tNQUpPUn19Lnt7TUlOT1J9fSlcclxuICogQHBhcmFtIHtzdHJpbmdbXX0gYnJhbmRzIC0gdGhlIHN1cHBvcnRlZCBicmFuZHMgaW4gdGhlIHJlbGVhc2VcclxuICogQHBhcmFtIHtzdHJpbmd9IFttZXNzYWdlXSAtIE9wdGlvbmFsIG1lc3NhZ2UgdG8gYXBwZW5kIHRvIHRoZSBicmFuZHMvdmVyc2lvbi1pbmNyZW1lbnQgY29tbWl0LlxyXG4gKiBAcmV0dXJucyB7UHJvbWlzZX1cclxuICovXHJcbm1vZHVsZS5leHBvcnRzID0gYXN5bmMgZnVuY3Rpb24gY3JlYXRlUmVsZWFzZSggcmVwbywgYnJhbmNoLCBicmFuZHMsIG1lc3NhZ2UgKSB7XHJcbiAgY29uc3QgbWFqb3IgPSBOdW1iZXIoIGJyYW5jaC5zcGxpdCggJy4nIClbIDAgXSApO1xyXG4gIGNvbnN0IG1pbm9yID0gTnVtYmVyKCBicmFuY2guc3BsaXQoICcuJyApWyAxIF0gKTtcclxuICBhc3NlcnQoIG1ham9yID4gMCwgJ01ham9yIHZlcnNpb24gZm9yIGEgYnJhbmNoIHNob3VsZCBiZSBncmVhdGVyIHRoYW4gemVybycgKTtcclxuICBhc3NlcnQoIG1pbm9yID49IDAsICdNaW5vciB2ZXJzaW9uIGZvciBhIGJyYW5jaCBzaG91bGQgYmUgZ3JlYXRlciB0aGFuIChvciBlcXVhbCkgdG8gemVybycgKTtcclxuXHJcbiAgYXNzZXJ0KCBBcnJheS5pc0FycmF5KCBicmFuZHMgKSwgJ3N1cHBvcnRlZCBicmFuZHMgcmVxdWlyZWQnICk7XHJcbiAgYXNzZXJ0KCBicmFuZHMubGVuZ3RoID49IDEsICdtdXN0IGhhdmUgYSBzdXBwb3J0ZWQgYnJhbmQnICk7XHJcblxyXG4gIGNvbnN0IGN1cnJlbnRCcmFuY2ggPSBhd2FpdCBnZXRCcmFuY2goIHJlcG8gKTtcclxuICBpZiAoIGN1cnJlbnRCcmFuY2ggIT09ICdtYWluJyApIHtcclxuICAgIGdydW50LmZhaWwuZmF0YWwoIGBTaG91bGQgYmUgb24gbWFpbiB0byBjcmVhdGUgYSByZWxlYXNlIGJyYW5jaCwgbm90OiAke2N1cnJlbnRCcmFuY2ggPyBjdXJyZW50QnJhbmNoIDogJyhkZXRhY2hlZCBoZWFkKSd9YCApO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgaGFzQnJhbmNoQWxyZWFkeSA9IGF3YWl0IGhhc1JlbW90ZUJyYW5jaCggcmVwbywgYnJhbmNoICk7XHJcbiAgaWYgKCBoYXNCcmFuY2hBbHJlYWR5ICkge1xyXG4gICAgZ3J1bnQuZmFpbC5mYXRhbCggJ0JyYW5jaCBhbHJlYWR5IGV4aXN0cywgYWJvcnRpbmcnICk7XHJcbiAgfVxyXG5cclxuICBjb25zdCBuZXdWZXJzaW9uID0gbmV3IFNpbVZlcnNpb24oIG1ham9yLCBtaW5vciwgMCwge1xyXG4gICAgdGVzdFR5cGU6ICdyYycsXHJcbiAgICB0ZXN0TnVtYmVyOiAwXHJcbiAgfSApO1xyXG5cclxuICBjb25zdCBpc0NsZWFuID0gYXdhaXQgZ2l0SXNDbGVhbiggcmVwbyApO1xyXG4gIGlmICggIWlzQ2xlYW4gKSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoIGBVbmNsZWFuIHN0YXR1cyBpbiAke3JlcG99LCBjYW5ub3QgY3JlYXRlIHJlbGVhc2UgYnJhbmNoYCApO1xyXG4gIH1cclxuXHJcbiAgd2luc3Rvbi5pbmZvKCAnU2V0dGluZyB0aGUgcmVsZWFzZSBicmFuY2ggdmVyc2lvbiB0byByYy4wIHNvIGl0IHdpbGwgYXV0by1pbmNyZW1lbnQgdG8gcmMuMSBmb3IgdGhlIGZpcnN0IFJDIGRlcGxveW1lbnQnICk7XHJcblxyXG4gIC8vIENyZWF0ZSB0aGUgYnJhbmNoLCB1cGRhdGUgdGhlIHZlcnNpb24gaW5mb1xyXG4gIGF3YWl0IGdpdENyZWF0ZUJyYW5jaCggcmVwbywgYnJhbmNoICk7XHJcbiAgYXdhaXQgc2V0UmVwb1N1cHBvcnRlZEJyYW5kcyggcmVwbywgYnJhbmRzICk7XHJcbiAgYXdhaXQgc2V0UmVwb1ZlcnNpb24oIHJlcG8sIG5ld1ZlcnNpb24sIG1lc3NhZ2UgKTtcclxuICBhd2FpdCBnaXRQdXNoKCByZXBvLCBicmFuY2ggKTtcclxuXHJcbiAgLy8gVXBkYXRlIGRlcGVuZGVuY2llcy5qc29uIGZvciB0aGUgcmVsZWFzZSBicmFuY2hcclxuICBhd2FpdCBucG1VcGRhdGUoIHJlcG8gKTtcclxuICBhd2FpdCBucG1VcGRhdGUoICdjaGlwcGVyJyApO1xyXG4gIGF3YWl0IG5wbVVwZGF0ZSggJ3BlcmVubmlhbC1hbGlhcycgKTtcclxuXHJcbiAgY29uc3QgYnJhbmQgPSBicmFuZHNbIDAgXTtcclxuICBhd2FpdCBidWlsZCggcmVwbywge1xyXG4gICAgYnJhbmRzOiBbIGJyYW5kIF1cclxuICB9ICk7XHJcbiAgYXdhaXQgY29weUZpbGUoIGAuLi8ke3JlcG99L2J1aWxkLyR7YnJhbmR9L2RlcGVuZGVuY2llcy5qc29uYCwgYC4uLyR7cmVwb30vZGVwZW5kZW5jaWVzLmpzb25gICk7XHJcbiAgYXdhaXQgZ2l0QWRkKCByZXBvLCAnZGVwZW5kZW5jaWVzLmpzb24nICk7XHJcbiAgYXdhaXQgZ2l0Q29tbWl0KCByZXBvLCBgdXBkYXRlZCBkZXBlbmRlbmNpZXMuanNvbiBmb3IgdmVyc2lvbiAke25ld1ZlcnNpb24udG9TdHJpbmcoKX1gICk7XHJcbiAgYXdhaXQgZ2l0UHVzaCggcmVwbywgYnJhbmNoICk7XHJcblxyXG4gIC8vIFVwZGF0ZSB0aGUgdmVyc2lvbiBpbmZvIGluIG1haW5cclxuICBhd2FpdCBnaXRDaGVja291dCggcmVwbywgJ21haW4nICk7XHJcbiAgYXdhaXQgc2V0UmVwb1ZlcnNpb24oIHJlcG8sIG5ldyBTaW1WZXJzaW9uKCBtYWpvciwgbWlub3IgKyAxLCAwLCB7XHJcbiAgICB0ZXN0VHlwZTogJ2RldicsXHJcbiAgICB0ZXN0TnVtYmVyOiAwXHJcbiAgfSApLCBtZXNzYWdlICk7XHJcbiAgYXdhaXQgdXBkYXRlSFRNTFZlcnNpb24oIHJlcG8gKTtcclxuICBhd2FpdCBnaXRQdXNoKCByZXBvLCAnbWFpbicgKTtcclxuXHJcbiAgLy8gR28gYmFjayB0byB0aGUgYnJhbmNoIChhcyB0aGV5IG1heSB3YW50IHRvIGRvIGEgZGVwbG95KVxyXG4gIGF3YWl0IGdpdENoZWNrb3V0KCByZXBvLCBicmFuY2ggKTtcclxufTsiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsTUFBTUEsVUFBVSxHQUFHQyxPQUFPLENBQUUsc0JBQXVCLENBQUM7QUFDcEQsTUFBTUMsS0FBSyxHQUFHRCxPQUFPLENBQUUsaUJBQWtCLENBQUM7QUFDMUMsTUFBTUUsUUFBUSxHQUFHRixPQUFPLENBQUUsb0JBQXFCLENBQUM7QUFDaEQsTUFBTUcsU0FBUyxHQUFHSCxPQUFPLENBQUUscUJBQXNCLENBQUM7QUFDbEQsTUFBTUksTUFBTSxHQUFHSixPQUFPLENBQUUsa0JBQW1CLENBQUM7QUFDNUMsTUFBTUssV0FBVyxHQUFHTCxPQUFPLENBQUUsdUJBQXdCLENBQUM7QUFDdEQsTUFBTU0sU0FBUyxHQUFHTixPQUFPLENBQUUscUJBQXNCLENBQUM7QUFDbEQsTUFBTU8sZUFBZSxHQUFHUCxPQUFPLENBQUUsMkJBQTRCLENBQUM7QUFDOUQsTUFBTVEsVUFBVSxHQUFHUixPQUFPLENBQUUsc0JBQXVCLENBQUM7QUFDcEQsTUFBTVMsT0FBTyxHQUFHVCxPQUFPLENBQUUsbUJBQW9CLENBQUM7QUFDOUMsTUFBTVUsZUFBZSxHQUFHVixPQUFPLENBQUUsMkJBQTRCLENBQUM7QUFDOUQsTUFBTVcsU0FBUyxHQUFHWCxPQUFPLENBQUUscUJBQXNCLENBQUM7QUFDbEQsTUFBTVksY0FBYyxHQUFHWixPQUFPLENBQUUsMEJBQTJCLENBQUM7QUFDNUQsTUFBTWEsc0JBQXNC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