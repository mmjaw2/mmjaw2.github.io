// Copyright 2022, University of Colorado Boulder

/**
 * Returns a list of simulation repos that have been published (does NOT include prototypes)
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

const simMetadata = require('./simMetadata');
const simPhetioMetadata = require('./simPhetioMetadata');
const _ = require('lodash');

/**
 * Returns a list of simulation repos that have been published (does NOT include prototypes)
 * @public
 *
 * @returns {Promise<Array.<string>>}
 */
module.exports = async function () {
  const publishedRepos = [];
  const metadata = await simMetadata({
    includePrototypes: false
  });
  metadata.projects.forEach(projectData => {
    if (projectData.name.startsWith('html/')) {
      publishedRepos.push(projectData.name.substring('html/'.length));
    }
  });
  (await simPhetioMetadata({
    active: true,
    latest: true
  })).filter(simData => simData.active && simData.latest).forEach(simData => {
    publishedRepos.push(simData.name);
  });
  return _.uniq(publishedRepos).sort();
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJzaW1NZXRhZGF0YSIsInJlcXVpcmUiLCJzaW1QaGV0aW9NZXRhZGF0YSIsIl8iLCJtb2R1bGUiLCJleHBvcnRzIiwicHVibGlzaGVkUmVwb3MiLCJtZXRhZGF0YSIsImluY2x1ZGVQcm90b3R5cGVzIiwicHJvamVjdHMiLCJmb3JFYWNoIiwicHJvamVjdERhdGEiLCJuYW1lIiwic3RhcnRzV2l0aCIsInB1c2giLCJzdWJzdHJpbmciLCJsZW5ndGgiLCJhY3RpdmUiLCJsYXRlc3QiLCJmaWx0ZXIiLCJzaW1EYXRhIiwidW5pcSIsInNvcnQiXSwic291cmNlcyI6WyJnZXRQdWJsaXNoZWRTaW1zLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDIyLCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBSZXR1cm5zIGEgbGlzdCBvZiBzaW11bGF0aW9uIHJlcG9zIHRoYXQgaGF2ZSBiZWVuIHB1Ymxpc2hlZCAoZG9lcyBOT1QgaW5jbHVkZSBwcm90b3R5cGVzKVxyXG4gKlxyXG4gKiBAYXV0aG9yIEpvbmF0aGFuIE9sc29uIDxqb25hdGhhbi5vbHNvbkBjb2xvcmFkby5lZHU+XHJcbiAqL1xyXG5cclxuY29uc3Qgc2ltTWV0YWRhdGEgPSByZXF1aXJlKCAnLi9zaW1NZXRhZGF0YScgKTtcclxuY29uc3Qgc2ltUGhldGlvTWV0YWRhdGEgPSByZXF1aXJlKCAnLi9zaW1QaGV0aW9NZXRhZGF0YScgKTtcclxuY29uc3QgXyA9IHJlcXVpcmUoICdsb2Rhc2gnICk7XHJcblxyXG4vKipcclxuICogUmV0dXJucyBhIGxpc3Qgb2Ygc2ltdWxhdGlvbiByZXBvcyB0aGF0IGhhdmUgYmVlbiBwdWJsaXNoZWQgKGRvZXMgTk9UIGluY2x1ZGUgcHJvdG90eXBlcylcclxuICogQHB1YmxpY1xyXG4gKlxyXG4gKiBAcmV0dXJucyB7UHJvbWlzZTxBcnJheS48c3RyaW5nPj59XHJcbiAqL1xyXG5tb2R1bGUuZXhwb3J0cyA9IGFzeW5jIGZ1bmN0aW9uKCkge1xyXG4gIGNvbnN0IHB1Ymxpc2hlZFJlcG9zID0gW107XHJcblxyXG4gIGNvbnN0IG1ldGFkYXRhID0gYXdhaXQgc2ltTWV0YWRhdGEoIHtcclxuICAgIGluY2x1ZGVQcm90b3R5cGVzOiBmYWxzZVxyXG4gIH0gKTtcclxuICBtZXRhZGF0YS5wcm9qZWN0cy5mb3JFYWNoKCBwcm9qZWN0RGF0YSA9PiB7XHJcbiAgICBpZiAoIHByb2plY3REYXRhLm5hbWUuc3RhcnRzV2l0aCggJ2h0bWwvJyApICkge1xyXG4gICAgICBwdWJsaXNoZWRSZXBvcy5wdXNoKCBwcm9qZWN0RGF0YS5uYW1lLnN1YnN0cmluZyggJ2h0bWwvJy5sZW5ndGggKSApO1xyXG4gICAgfVxyXG4gIH0gKTtcclxuXHJcbiAgKCBhd2FpdCBzaW1QaGV0aW9NZXRhZGF0YSgge1xyXG4gICAgYWN0aXZlOiB0cnVlLFxyXG4gICAgbGF0ZXN0OiB0cnVlXHJcbiAgfSApICkuZmlsdGVyKCBzaW1EYXRhID0+IHNpbURhdGEuYWN0aXZlICYmIHNpbURhdGEubGF0ZXN0ICkuZm9yRWFjaCggc2ltRGF0YSA9PiB7XHJcbiAgICBwdWJsaXNoZWRSZXBvcy5wdXNoKCBzaW1EYXRhLm5hbWUgKTtcclxuICB9ICk7XHJcblxyXG4gIHJldHVybiBfLnVuaXEoIHB1Ymxpc2hlZFJlcG9zICkuc29ydCgpO1xyXG59OyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxNQUFNQSxXQUFXLEdBQUdDLE9BQU8sQ0FBRSxlQUFnQixDQUFDO0FBQzlDLE1BQU1DLGlCQUFpQixHQUFHRCxPQUFPLENBQUUscUJBQXNCLENBQUM7QUFDMUQsTUFBTUUsQ0FBQyxHQUFHRixPQUFPLENBQUUsUUFBUyxDQUFDOztBQUU3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQUcsTUFBTSxDQUFDQyxPQUFPLEdBQUcsa0JBQWlCO0VBQ2hDLE1BQU1DLGNBQWMsR0FBRyxFQUFFO0VBRXpCLE1BQU1DLFFBQVEsR0FBRyxNQUFNUCxXQUFXLENBQUU7SUFDbENRLGlCQUFpQixFQUFFO0VBQ3JCLENBQUUsQ0FBQztFQUNIRCxRQUFRLENBQUNFLFFBQVEsQ0FBQ0MsT0FBTyxDQUFFQyxXQUFXLElBQUk7SUFDeEMsSUFBS0EsV0FBVyxDQUFDQyxJQUFJLENBQUNDLFVBQVUsQ0FBRSxPQUFRLENBQUMsRUFBRztNQUM1Q1AsY0FBYyxDQUFDUSxJQUFJLENBQUVILFdBQVcsQ0FBQ0MsSUFBSSxDQUFDRyxTQUFTLENBQUUsT0FBTyxDQUFDQyxNQUFPLENBQUUsQ0FBQztJQUNyRTtFQUNGLENBQUUsQ0FBQztFQUVILENBQUUsTUFBTWQsaUJBQWlCLENBQUU7SUFDekJlLE1BQU0sRUFBRSxJQUFJO0lBQ1pDLE1BQU0sRUFBRTtFQUNWLENBQUUsQ0FBQyxFQUFHQyxNQUFNLENBQUVDLE9BQU8sSUFBSUEsT0FBTyxDQUFDSCxNQUFNLElBQUlHLE9BQU8sQ0FBQ0YsTUFBTyxDQUFDLENBQUNSLE9BQU8sQ0FBRVUsT0FBTyxJQUFJO0lBQzlFZCxjQUFjLENBQUNRLElBQUksQ0FBRU0sT0FBTyxDQUFDUixJQUFLLENBQUM7RUFDckMsQ0FBRSxDQUFDO0VBRUgsT0FBT1QsQ0FBQyxDQUFDa0IsSUFBSSxDQUFFZixjQUFlLENBQUMsQ0FBQ2dCLElBQUksQ0FBQyxDQUFDO0FBQ3hDLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=