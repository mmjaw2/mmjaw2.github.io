// Copyright 2017-2018, University of Colorado Boulder
// @author Matt Pennington (PhET Interactive Simulations)

const constants = require('./constants');
const fs = require('graceful-fs'); // eslint-disable-line require-statement-match
const winston = require('../../../../../../perennial-alias/node_modules/winston');
const writeFile = require('../common/writeFile');
const parseScreenNames = require('./parseScreenNames');

/**
 * Create a [sim name].xml file in the live sim directory in htdocs. This file tells the website which
 * translations exist for a given sim. It is used by the "synchronize" method in Project.java in the website code.
 * @param simName
 * @param version
 * @param checkoutDir
 */
module.exports = async function (simName, version, checkoutDir) {
  const translatedStringFilesDir = `${checkoutDir}/babel/${simName}`;
  const englishStringsFile = `${simName}-strings_en.json`;
  const stringFiles = [{
    name: englishStringsFile,
    locale: constants.ENGLISH_LOCALE
  }];

  // pull all the string filenames and locales from babel and store in stringFiles array
  try {
    const files = fs.readdirSync(translatedStringFilesDir);
    for (let i = 0; i < files.length; i++) {
      const filename = files[i];
      const firstUnderscoreIndex = filename.indexOf('_');
      const periodIndex = filename.indexOf('.');
      const locale = filename.substring(firstUnderscoreIndex + 1, periodIndex);
      // Don't process English twice!
      if (locale !== constants.ENGLISH_LOCALE) {
        stringFiles.push({
          name: filename,
          locale: locale
        });
      }
    }
  } catch (e) {
    winston.log('warn', 'no directory for the given sim exists in babel');
  }

  // try opening the english strings file so we can read the english strings
  let englishStrings;
  try {
    englishStrings = JSON.parse(fs.readFileSync(`${checkoutDir}/${simName}/${englishStringsFile}`, {
      encoding: 'utf-8'
    }));
  } catch (e) {
    throw new Error('English strings file not found');
  }
  const simTitleKey = `${simName}.title`; // all sims must have a key of this form
  if (!englishStrings[simTitleKey]) {
    throw new Error('No key for sim title');
  }

  // create xml, making a simulation tag for each language
  let finalXML = `<?xml version="1.0" encoding="utf-8" ?>\n<project name="${simName}">\n<simulations>`;
  const screenNames = await parseScreenNames.parseScreenNames(simName, stringFiles.map(f => f.locale), checkoutDir);
  for (let j = 0; j < stringFiles.length; j++) {
    const stringFile = stringFiles[j];
    const languageJSON = stringFile.locale === constants.ENGLISH_LOCALE ? englishStrings : JSON.parse(fs.readFileSync(`${translatedStringFilesDir}/${stringFile.name}`, {
      encoding: 'utf-8'
    }));
    const simHTML = `${constants.HTML_SIMS_DIRECTORY + simName}/${version}/${simName}_${stringFile.locale}.html`;
    if (fs.existsSync(simHTML)) {
      const localizedSimTitle = languageJSON[simTitleKey] ? languageJSON[simTitleKey].value : englishStrings[simTitleKey].value;
      finalXML = finalXML.concat(`<simulation name="${simName}" locale="${stringFile.locale}">\n` + `<title><![CDATA[${localizedSimTitle}]]></title>\n`);
      if (screenNames && screenNames[stringFile.locale]) {
        finalXML = finalXML.concat('<screens>\n');
        screenNames[stringFile.locale].forEach((screenName, index) => {
          finalXML = finalXML.concat(`<screenName position="${index + 1}"><![CDATA[${screenName}]]></screenName>\n`);
        });
        finalXML = finalXML.concat('</screens>\n');
      }
      finalXML = finalXML.concat('</simulation>\n');
    }
  }
  finalXML = finalXML.concat('</simulations>\n</project>');
  const xmlFilepath = `${constants.HTML_SIMS_DIRECTORY + simName}/${version}/${simName}.xml`;
  try {
    await writeFile(xmlFilepath, finalXML);
  } catch (err) {
    console.error('Error writing xml file', err);
    throw err;
  }
  winston.log('info', 'wrote XML file');
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb25zdGFudHMiLCJyZXF1aXJlIiwiZnMiLCJ3aW5zdG9uIiwid3JpdGVGaWxlIiwicGFyc2VTY3JlZW5OYW1lcyIsIm1vZHVsZSIsImV4cG9ydHMiLCJzaW1OYW1lIiwidmVyc2lvbiIsImNoZWNrb3V0RGlyIiwidHJhbnNsYXRlZFN0cmluZ0ZpbGVzRGlyIiwiZW5nbGlzaFN0cmluZ3NGaWxlIiwic3RyaW5nRmlsZXMiLCJuYW1lIiwibG9jYWxlIiwiRU5HTElTSF9MT0NBTEUiLCJmaWxlcyIsInJlYWRkaXJTeW5jIiwiaSIsImxlbmd0aCIsImZpbGVuYW1lIiwiZmlyc3RVbmRlcnNjb3JlSW5kZXgiLCJpbmRleE9mIiwicGVyaW9kSW5kZXgiLCJzdWJzdHJpbmciLCJwdXNoIiwiZSIsImxvZyIsImVuZ2xpc2hTdHJpbmdzIiwiSlNPTiIsInBhcnNlIiwicmVhZEZpbGVTeW5jIiwiZW5jb2RpbmciLCJFcnJvciIsInNpbVRpdGxlS2V5IiwiZmluYWxYTUwiLCJzY3JlZW5OYW1lcyIsIm1hcCIsImYiLCJqIiwic3RyaW5nRmlsZSIsImxhbmd1YWdlSlNPTiIsInNpbUhUTUwiLCJIVE1MX1NJTVNfRElSRUNUT1JZIiwiZXhpc3RzU3luYyIsImxvY2FsaXplZFNpbVRpdGxlIiwidmFsdWUiLCJjb25jYXQiLCJmb3JFYWNoIiwic2NyZWVuTmFtZSIsImluZGV4IiwieG1sRmlsZXBhdGgiLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiXSwic291cmNlcyI6WyJjcmVhdGVUcmFuc2xhdGlvbnNYTUwuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTctMjAxOCwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXHJcbi8vIEBhdXRob3IgTWF0dCBQZW5uaW5ndG9uIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxyXG5cclxuXHJcbmNvbnN0IGNvbnN0YW50cyA9IHJlcXVpcmUoICcuL2NvbnN0YW50cycgKTtcclxuY29uc3QgZnMgPSByZXF1aXJlKCAnZ3JhY2VmdWwtZnMnICk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgcmVxdWlyZS1zdGF0ZW1lbnQtbWF0Y2hcclxuY29uc3Qgd2luc3RvbiA9IHJlcXVpcmUoICd3aW5zdG9uJyApO1xyXG5jb25zdCB3cml0ZUZpbGUgPSByZXF1aXJlKCAnLi4vY29tbW9uL3dyaXRlRmlsZScgKTtcclxuY29uc3QgcGFyc2VTY3JlZW5OYW1lcyA9IHJlcXVpcmUoICcuL3BhcnNlU2NyZWVuTmFtZXMnICk7XHJcblxyXG4vKipcclxuICogQ3JlYXRlIGEgW3NpbSBuYW1lXS54bWwgZmlsZSBpbiB0aGUgbGl2ZSBzaW0gZGlyZWN0b3J5IGluIGh0ZG9jcy4gVGhpcyBmaWxlIHRlbGxzIHRoZSB3ZWJzaXRlIHdoaWNoXHJcbiAqIHRyYW5zbGF0aW9ucyBleGlzdCBmb3IgYSBnaXZlbiBzaW0uIEl0IGlzIHVzZWQgYnkgdGhlIFwic3luY2hyb25pemVcIiBtZXRob2QgaW4gUHJvamVjdC5qYXZhIGluIHRoZSB3ZWJzaXRlIGNvZGUuXHJcbiAqIEBwYXJhbSBzaW1OYW1lXHJcbiAqIEBwYXJhbSB2ZXJzaW9uXHJcbiAqIEBwYXJhbSBjaGVja291dERpclxyXG4gKi9cclxubW9kdWxlLmV4cG9ydHMgPSBhc3luYyBmdW5jdGlvbiggc2ltTmFtZSwgdmVyc2lvbiwgY2hlY2tvdXREaXIgKSB7XHJcbiAgY29uc3QgdHJhbnNsYXRlZFN0cmluZ0ZpbGVzRGlyID0gYCR7Y2hlY2tvdXREaXJ9L2JhYmVsLyR7c2ltTmFtZX1gO1xyXG4gIGNvbnN0IGVuZ2xpc2hTdHJpbmdzRmlsZSA9IGAke3NpbU5hbWV9LXN0cmluZ3NfZW4uanNvbmA7XHJcbiAgY29uc3Qgc3RyaW5nRmlsZXMgPSBbIHsgbmFtZTogZW5nbGlzaFN0cmluZ3NGaWxlLCBsb2NhbGU6IGNvbnN0YW50cy5FTkdMSVNIX0xPQ0FMRSB9IF07XHJcblxyXG4gIC8vIHB1bGwgYWxsIHRoZSBzdHJpbmcgZmlsZW5hbWVzIGFuZCBsb2NhbGVzIGZyb20gYmFiZWwgYW5kIHN0b3JlIGluIHN0cmluZ0ZpbGVzIGFycmF5XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGZpbGVzID0gZnMucmVhZGRpclN5bmMoIHRyYW5zbGF0ZWRTdHJpbmdGaWxlc0RpciApO1xyXG4gICAgZm9yICggbGV0IGkgPSAwOyBpIDwgZmlsZXMubGVuZ3RoOyBpKysgKSB7XHJcbiAgICAgIGNvbnN0IGZpbGVuYW1lID0gZmlsZXNbIGkgXTtcclxuICAgICAgY29uc3QgZmlyc3RVbmRlcnNjb3JlSW5kZXggPSBmaWxlbmFtZS5pbmRleE9mKCAnXycgKTtcclxuICAgICAgY29uc3QgcGVyaW9kSW5kZXggPSBmaWxlbmFtZS5pbmRleE9mKCAnLicgKTtcclxuICAgICAgY29uc3QgbG9jYWxlID0gZmlsZW5hbWUuc3Vic3RyaW5nKCBmaXJzdFVuZGVyc2NvcmVJbmRleCArIDEsIHBlcmlvZEluZGV4ICk7XHJcbiAgICAgIC8vIERvbid0IHByb2Nlc3MgRW5nbGlzaCB0d2ljZSFcclxuICAgICAgaWYgKCBsb2NhbGUgIT09IGNvbnN0YW50cy5FTkdMSVNIX0xPQ0FMRSApIHtcclxuICAgICAgICBzdHJpbmdGaWxlcy5wdXNoKCB7IG5hbWU6IGZpbGVuYW1lLCBsb2NhbGU6IGxvY2FsZSB9ICk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbiAgY2F0Y2goIGUgKSB7XHJcbiAgICB3aW5zdG9uLmxvZyggJ3dhcm4nLCAnbm8gZGlyZWN0b3J5IGZvciB0aGUgZ2l2ZW4gc2ltIGV4aXN0cyBpbiBiYWJlbCcgKTtcclxuICB9XHJcblxyXG4gIC8vIHRyeSBvcGVuaW5nIHRoZSBlbmdsaXNoIHN0cmluZ3MgZmlsZSBzbyB3ZSBjYW4gcmVhZCB0aGUgZW5nbGlzaCBzdHJpbmdzXHJcbiAgbGV0IGVuZ2xpc2hTdHJpbmdzO1xyXG4gIHRyeSB7XHJcbiAgICBlbmdsaXNoU3RyaW5ncyA9IEpTT04ucGFyc2UoIGZzLnJlYWRGaWxlU3luYyggYCR7Y2hlY2tvdXREaXJ9LyR7c2ltTmFtZX0vJHtlbmdsaXNoU3RyaW5nc0ZpbGV9YCwgeyBlbmNvZGluZzogJ3V0Zi04JyB9ICkgKTtcclxuICB9XHJcbiAgY2F0Y2goIGUgKSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoICdFbmdsaXNoIHN0cmluZ3MgZmlsZSBub3QgZm91bmQnICk7XHJcbiAgfVxyXG5cclxuICBjb25zdCBzaW1UaXRsZUtleSA9IGAke3NpbU5hbWV9LnRpdGxlYDsgLy8gYWxsIHNpbXMgbXVzdCBoYXZlIGEga2V5IG9mIHRoaXMgZm9ybVxyXG4gIGlmICggIWVuZ2xpc2hTdHJpbmdzWyBzaW1UaXRsZUtleSBdICkge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKCAnTm8ga2V5IGZvciBzaW0gdGl0bGUnICk7XHJcbiAgfVxyXG5cclxuICAvLyBjcmVhdGUgeG1sLCBtYWtpbmcgYSBzaW11bGF0aW9uIHRhZyBmb3IgZWFjaCBsYW5ndWFnZVxyXG4gIGxldCBmaW5hbFhNTCA9IGA8P3htbCB2ZXJzaW9uPVwiMS4wXCIgZW5jb2Rpbmc9XCJ1dGYtOFwiID8+XFxuPHByb2plY3QgbmFtZT1cIiR7c2ltTmFtZX1cIj5cXG48c2ltdWxhdGlvbnM+YDtcclxuXHJcbiAgY29uc3Qgc2NyZWVuTmFtZXMgPSBhd2FpdCBwYXJzZVNjcmVlbk5hbWVzLnBhcnNlU2NyZWVuTmFtZXMoIHNpbU5hbWUsIHN0cmluZ0ZpbGVzLm1hcCggZiA9PiBmLmxvY2FsZSApLCBjaGVja291dERpciApO1xyXG5cclxuICBmb3IgKCBsZXQgaiA9IDA7IGogPCBzdHJpbmdGaWxlcy5sZW5ndGg7IGorKyApIHtcclxuICAgIGNvbnN0IHN0cmluZ0ZpbGUgPSBzdHJpbmdGaWxlc1sgaiBdO1xyXG4gICAgY29uc3QgbGFuZ3VhZ2VKU09OID0gKCBzdHJpbmdGaWxlLmxvY2FsZSA9PT0gY29uc3RhbnRzLkVOR0xJU0hfTE9DQUxFICkgPyBlbmdsaXNoU3RyaW5ncyA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICBKU09OLnBhcnNlKCBmcy5yZWFkRmlsZVN5bmMoIGAke3RyYW5zbGF0ZWRTdHJpbmdGaWxlc0Rpcn0vJHtzdHJpbmdGaWxlLm5hbWV9YCwgeyBlbmNvZGluZzogJ3V0Zi04JyB9ICkgKTtcclxuXHJcbiAgICBjb25zdCBzaW1IVE1MID0gYCR7Y29uc3RhbnRzLkhUTUxfU0lNU19ESVJFQ1RPUlkgKyBzaW1OYW1lfS8ke3ZlcnNpb259LyR7c2ltTmFtZX1fJHtzdHJpbmdGaWxlLmxvY2FsZX0uaHRtbGA7XHJcblxyXG4gICAgaWYgKCBmcy5leGlzdHNTeW5jKCBzaW1IVE1MICkgKSB7XHJcbiAgICAgIGNvbnN0IGxvY2FsaXplZFNpbVRpdGxlID0gKCBsYW5ndWFnZUpTT05bIHNpbVRpdGxlS2V5IF0gKSA/IGxhbmd1YWdlSlNPTlsgc2ltVGl0bGVLZXkgXS52YWx1ZSA6IGVuZ2xpc2hTdHJpbmdzWyBzaW1UaXRsZUtleSBdLnZhbHVlO1xyXG4gICAgICBmaW5hbFhNTCA9IGZpbmFsWE1MLmNvbmNhdCggYDxzaW11bGF0aW9uIG5hbWU9XCIke3NpbU5hbWV9XCIgbG9jYWxlPVwiJHtzdHJpbmdGaWxlLmxvY2FsZX1cIj5cXG5gICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGA8dGl0bGU+PCFbQ0RBVEFbJHtsb2NhbGl6ZWRTaW1UaXRsZX1dXT48L3RpdGxlPlxcbmAgKTtcclxuICAgICAgaWYgKCBzY3JlZW5OYW1lcyAmJiBzY3JlZW5OYW1lc1sgc3RyaW5nRmlsZS5sb2NhbGUgXSApIHtcclxuICAgICAgICBmaW5hbFhNTCA9IGZpbmFsWE1MLmNvbmNhdCggJzxzY3JlZW5zPlxcbicgKTtcclxuICAgICAgICBzY3JlZW5OYW1lc1sgc3RyaW5nRmlsZS5sb2NhbGUgXS5mb3JFYWNoKCAoIHNjcmVlbk5hbWUsIGluZGV4ICkgPT4ge1xyXG4gICAgICAgICAgZmluYWxYTUwgPSBmaW5hbFhNTC5jb25jYXQoIGA8c2NyZWVuTmFtZSBwb3NpdGlvbj1cIiR7aW5kZXggKyAxfVwiPjwhW0NEQVRBWyR7c2NyZWVuTmFtZX1dXT48L3NjcmVlbk5hbWU+XFxuYCApO1xyXG4gICAgICAgIH0gKTtcclxuICAgICAgICBmaW5hbFhNTCA9IGZpbmFsWE1MLmNvbmNhdCggJzwvc2NyZWVucz5cXG4nICk7XHJcbiAgICAgIH1cclxuICAgICAgZmluYWxYTUwgPSBmaW5hbFhNTC5jb25jYXQoICc8L3NpbXVsYXRpb24+XFxuJyApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZmluYWxYTUwgPSBmaW5hbFhNTC5jb25jYXQoICc8L3NpbXVsYXRpb25zPlxcbjwvcHJvamVjdD4nICk7XHJcblxyXG4gIGNvbnN0IHhtbEZpbGVwYXRoID0gYCR7Y29uc3RhbnRzLkhUTUxfU0lNU19ESVJFQ1RPUlkgKyBzaW1OYW1lfS8ke3ZlcnNpb259LyR7c2ltTmFtZX0ueG1sYDtcclxuICB0cnkge1xyXG4gICAgYXdhaXQgd3JpdGVGaWxlKCB4bWxGaWxlcGF0aCwgZmluYWxYTUwgKTtcclxuICB9XHJcbiAgY2F0Y2goIGVyciApIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoICdFcnJvciB3cml0aW5nIHhtbCBmaWxlJywgZXJyICk7XHJcbiAgICB0aHJvdyBlcnI7XHJcbiAgfVxyXG4gIHdpbnN0b24ubG9nKCAnaW5mbycsICd3cm90ZSBYTUwgZmlsZScgKTtcclxufTsiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7O0FBR0EsTUFBTUEsU0FBUyxHQUFHQyxPQUFPLENBQUUsYUFBYyxDQUFDO0FBQzFDLE1BQU1DLEVBQUUsR0FBR0QsT0FBTyxDQUFFLGFBQWMsQ0FBQyxDQUFDLENBQUM7QUFDckMsTUFBTUUsT0FBTyxHQUFHRixPQUFPLENBQUUsU0FBVSxDQUFDO0FBQ3BDLE1BQU1HLFNBQVMsR0FBR0gsT0FBTyxDQUFFLHFCQUFzQixDQUFDO0FBQ2xELE1BQU1JLGdCQUFnQixHQUFHSixPQUFPLENBQUUsb0JBQXFCLENBQUM7O0FBRXhEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0FLLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHLGdCQUFnQkMsT0FBTyxFQUFF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QkFBbUIsR0FBR3BDLE9BQVEsSUFBR0MsT0FBUSxJQUFHRCxPQUFRLElBQUdpQyxVQUFVLENBQUMxQixNQUFPLE9BQU07SUFFNUcsSUFBS2IsRUFBRSxDQUFDMkMsVUFBVSxDQUFFRixPQUFRLENBQUMsRUFBRztNQUM5QixNQUFNRyxpQkFBaUIsR0FBS0osWUFBWSxDQUFFUCxXQUFXLENBQUUsR0FBS08sWUFBWSxDQUFFUCxXQUFXLENBQUUsQ0FBQ1ksS0FBSyxHQUFHbEIsY0FBYyxDQUFFTSxXQUFXLENBQUUsQ0FBQ1ksS0FBSztNQUNuSVgsUUFBUSxHQUFHQSxRQUFRLENBQUNZLE1BQU0sQ0FBRyxxQkFBb0J4QyxPQUFRLGFBQVlpQyxVQUFVLENBQUMxQixNQUFPLE1BQUssR0FDL0QsbUJBQWtCK0IsaUJBQWtCLGVBQWUsQ0FBQztNQUNqRixJQUFLVCxXQUFXLElBQUlBLFdBQVcsQ0FBRUksVUFBVSxDQUFDMUIsTUFBTSxDQUFFLEVBQUc7UUFDckRxQixRQUFRLEdBQUdBLFFBQVEsQ0FBQ1ksTUFBTSxDQUFFLGFBQWMsQ0FBQztRQUMzQ1gsV0FBVyxDQUFFSSxVQUFVLENBQUMxQixNQUFNLENBQUUsQ0FBQ2tDLE9BQU8sQ0FBRSxDQUFFQyxVQUFVLEVBQUVDLEtBQUssS0FBTTtVQUNqRWYsUUFBUSxHQUFHQSxRQUFRLENBQUNZLE1BQU0sQ0FBRyx5QkFBd0JHLEtBQUssR0FBRyxDQUFFLGNBQWFELFVBQVcsb0JBQW9CLENBQUM7UUFDOUcsQ0FBRSxDQUFDO1FBQ0hkLFFBQVEsR0FBR0EsUUFBUSxDQUFDWSxNQUFNLENBQUUsY0FBZSxDQUFDO01BQzlDO01BQ0FaLFFBQVEsR0FBR0EsUUFBUSxDQUFDWSxNQUFNLENBQUUsaUJBQWtCLENBQUM7SUFDakQ7RUFDRjtFQUVBWixRQUFRLEdBQUdBLFFBQVEsQ0FBQ1ksTUFBTSxDQUFFLDRCQUE2QixDQUFDO0VBRTFELE1BQU1JLFdBQVcsR0FBSSxHQUFFcEQsU0FBUyxDQUFDNEMsbUJBQW1CLEdBQUdwQyxPQUFRLElBQUdDLE9BQVEsSUFBR0QsT0FBUSxNQUFLO0VBQzFGLElBQUk7SUFDRixNQUFNSixTQUFTLENBQUVnRCxXQUFXLEVBQUVoQixRQUFTLENBQUM7RUFDMUMsQ0FBQyxDQUNELE9BQU9pQixHQUFHLEVBQUc7SUFDWEMsT0FBTyxDQUFDQyxLQUFLLENBQUUsd0JBQXdCLEVBQUVGLEdBQUksQ0FBQztJQUM5QyxNQUFNQSxHQUFHO0VBQ1g7RUFDQWxELE9BQU8sQ0FBQ3lCLEdBQUcsQ0FBRSxNQUFNLEVBQUUsZ0JBQWlCLENBQUM7QUFDekMsQ0FBQyIsImlnbm9yZUxpc3QiOltdfQ==