// Copyright 2023-2024, University of Colorado Boulder

/* eslint-env node */

/**
 * Minifies a WGSL string
 *
 * IDEA: could look at places where abstract int/float could be swapped in for the explicit types
 * IDEA: could wrap long builtin function calls with a shorter named function (but that might reduce performance?)
 * IDEA: looking at you, bitcast!!!
 * IDEA: vec2(0.0, 0.0) => vec2(0.0) (and similar) -- doesn't happen often enough to bother
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

const REPLACEMENT_MAP = {
  'vec2<i32>': 'vec2i',
  'vec3<i32>': 'vec3i',
  'vec4<i32>': 'vec4i',
  'vec2<u32>': 'vec2u',
  'vec3<u32>': 'vec3u',
  'vec4<u32>': 'vec4u',
  'vec2<f32>': 'vec2f',
  'vec3<f32>': 'vec3f',
  'vec4<f32>': 'vec4f',
  'vec2<f16>': 'vec2h',
  'vec3<f16>': 'vec3h',
  'vec4<f16>': 'vec4h',
  'mat2x2<f32>': 'mat2x2f',
  'mat2x3<f32>': 'mat2x3f',
  'mat2x4<f32>': 'mat2x4f',
  'mat3x2<f32>': 'mat3x2f',
  'mat3x3<f32>': 'mat3x3f',
  'mat3x4<f32>': 'mat3x4f',
  'mat4x2<f32>': 'mat4x2f',
  'mat4x3<f32>': 'mat4x3f',
  'mat4x4<f32>': 'mat4x4f',
  'mat2x2<f16>': 'mat2x2h',
  'mat2x3<f16>': 'mat2x3h',
  'mat2x4<f16>': 'mat2x4h',
  'mat3x2<f16>': 'mat3x2h',
  'mat3x3<f16>': 'mat3x3h',
  'mat3x4<f16>': 'mat3x4h',
  'mat4x2<f16>': 'mat4x2h',
  'mat4x3<f16>': 'mat4x3h',
  'mat4x4<f16>': 'mat4x4h'
};
const wgslMinify = str => {
  str = str.replace(/\r\n/g, '\n');

  // // Naga does not yet recognize `const` but web does not allow global `let`.
  str = str.replace(/\nlet /g, '\nconst ');

  // According to WGSL spec:
  // line breaks: \u000A\u000B\u000C\u000D\u0085\u2028\u2029
  // white space: \u0020\u0009\u000A\u000B\u000C\u000D\u0085\u200E\u200F\u2028\u2029

  const linebreak = '[\u000A\u000B\u000C\u000D\u0085\u2028\u2029]';
  const whitespace = '[\u0020\u0009\u0085\u200E\u200F\u2028\u2029]'; // don't include most the linebreak ones
  const linebreakOrWhitespace = '[\u000A\u000B\u000C\u000D\u0085\u2028\u2029\u0020\u0009\u0085\u200E\u200F]';

  // Collapse newlines
  str = str.replace(new RegExp(`${whitespace}*${linebreak}+${whitespace}*`, 'g'), '\n');
  str = str.trim();

  // Collapse other whitespace
  str = str.replace(new RegExp(`${whitespace}+`, 'g'), ' ');

  // Semicolon + newline => semicolon
  str = str.replace(new RegExp(`;${linebreak}`, 'g'), ';');

  // Comma + newline => comma
  str = str.replace(new RegExp(`,${linebreak}`, 'g'), ',');

  // whitespace around {}
  str = str.replace(new RegExp(`${linebreakOrWhitespace}*([\\{\\}])${linebreakOrWhitespace}*`, 'g'), (_, m) => m);

  // Remove whitespace after :;,
  str = str.replace(new RegExp(`([:;,])${linebreakOrWhitespace}+`, 'g'), (_, m) => m);

  // Remove trailing commas before }])
  str = str.replace(new RegExp(',([\\}\\]\\)])', 'g'), (_, m) => m);

  // It's safe to remove whitespace before '-', however Firefox's tokenizer doesn't like 'x-1u' (presumably identifier + literal number, no operator)
  // So we'll only replace whitespace after '-' if it's not followed by a digit
  str = str.replace(new RegExp(`${linebreakOrWhitespace}*-`, 'g'), '-');
  str = str.replace(new RegExp(`-${linebreakOrWhitespace}+([^0-9])`, 'g'), (_, m) => `-${m}`);

  // Operators don't need whitespace around them in general
  str = str.replace(new RegExp(`${linebreakOrWhitespace}*([\\+\\*/<>&\\|=\\(\\)!])${linebreakOrWhitespace}*`, 'g'), (_, m) => m);

  // e.g. 0.5 => .5, 10.0 => 10.
  str = str.replace(/\d+\.\d+/g, m => {
    if (m.endsWith('.0')) {
      m = m.substring(0, m.length - 1);
    }
    if (m.startsWith('0.') && m.length > 2) {
      m = m.substring(1);
    }
    return m;
  });

  // Replace hex literals with decimal literals if they are shorter
  str = str.replace(/0x([0-9abcdefABCDEF]+)u/g, (m, digits) => {
    const str = '' + parseInt(digits, 16) + 'u';
    if (str.length < m.length) {
      return str;
    } else {
      return m;
    }
  });

  // Detect cases where abstract int can be used safely, instead of the explicit ones
  // str = str.replace( /(==|!=)([0-9.])+[uif]/g, ( m, op, digits ) => {
  //   return `${op}${digits}`;
  // } );

  // Replace some predeclared aliases (vec2<f32> => vec2f)
  Object.keys(REPLACEMENT_MAP).forEach(key => {
    // eslint-disable-next-line no-constant-condition
    while (true) {
      const match = new RegExp(`[^\\w](${key})[^\\w]`, 'g').exec(str);
      if (match) {
        const index0 = match.index + 1;
        const index1 = index0 + key.length;
        const before = str.substring(0, index0);
        const after = str.substring(index1);
        str = before + REPLACEMENT_MAP[key] + after;
      } else {
        break;
      }
    }
  });
  return str;
};
module.exports = wgslMinify;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJSRVBMQUNFTUVOVF9NQVAiLCJ3Z3NsTWluaWZ5Iiwic3RyIiwicmVwbGFjZSIsImxpbmVicmVhayIsIndoaXRlc3BhY2UiLCJsaW5lYnJlYWtPcldoaXRlc3BhY2UiLCJSZWdFeHAiLCJ0cmltIiwiXyIsIm0iLCJlbmRzV2l0aCIsInN1YnN0cmluZyIsImxlbmd0aCIsInN0YXJ0c1dpdGgiLCJkaWdpdHMiLCJwYXJzZUludCIsIk9iamVjdCIsImtleXMiLCJmb3JFYWNoIiwia2V5IiwibWF0Y2giLCJleGVjIiwiaW5kZXgwIiwiaW5kZXgiLCJpbmRleDEiLCJiZWZvcmUiLCJhZnRlciIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlcyI6WyJ3Z3NsTWluaWZ5LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDIzLTIwMjQsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyogZXNsaW50LWVudiBub2RlICovXHJcblxyXG4vKipcclxuICogTWluaWZpZXMgYSBXR1NMIHN0cmluZ1xyXG4gKlxyXG4gKiBJREVBOiBjb3VsZCBsb29rIGF0IHBsYWNlcyB3aGVyZSBhYnN0cmFjdCBpbnQvZmxvYXQgY291bGQgYmUgc3dhcHBlZCBpbiBmb3IgdGhlIGV4cGxpY2l0IHR5cGVzXHJcbiAqIElERUE6IGNvdWxkIHdyYXAgbG9uZyBidWlsdGluIGZ1bmN0aW9uIGNhbGxzIHdpdGggYSBzaG9ydGVyIG5hbWVkIGZ1bmN0aW9uIChidXQgdGhhdCBtaWdodCByZWR1Y2UgcGVyZm9ybWFuY2U/KVxyXG4gKiBJREVBOiBsb29raW5nIGF0IHlvdSwgYml0Y2FzdCEhIVxyXG4gKiBJREVBOiB2ZWMyKDAuMCwgMC4wKSA9PiB2ZWMyKDAuMCkgKGFuZCBzaW1pbGFyKSAtLSBkb2Vzbid0IGhhcHBlbiBvZnRlbiBlbm91Z2ggdG8gYm90aGVyXHJcbiAqXHJcbiAqIEBhdXRob3IgSm9uYXRoYW4gT2xzb24gPGpvbmF0aGFuLm9sc29uQGNvbG9yYWRvLmVkdT5cclxuICovXHJcblxyXG5jb25zdCBSRVBMQUNFTUVOVF9NQVAgPSB7XHJcbiAgJ3ZlYzI8aTMyPic6ICd2ZWMyaScsXHJcbiAgJ3ZlYzM8aTMyPic6ICd2ZWMzaScsXHJcbiAgJ3ZlYzQ8aTMyPic6ICd2ZWM0aScsXHJcbiAgJ3ZlYzI8dTMyPic6ICd2ZWMydScsXHJcbiAgJ3ZlYzM8dTMyPic6ICd2ZWMzdScsXHJcbiAgJ3ZlYzQ8dTMyPic6ICd2ZWM0dScsXHJcbiAgJ3ZlYzI8ZjMyPic6ICd2ZWMyZicsXHJcbiAgJ3ZlYzM8ZjMyPic6ICd2ZWMzZicsXHJcbiAgJ3ZlYzQ8ZjMyPic6ICd2ZWM0ZicsXHJcbiAgJ3ZlYzI8ZjE2Pic6ICd2ZWMyaCcsXHJcbiAgJ3ZlYzM8ZjE2Pic6ICd2ZWMzaCcsXHJcbiAgJ3ZlYzQ8ZjE2Pic6ICd2ZWM0aCcsXHJcbiAgJ21hdDJ4MjxmMzI+JzogJ21hdDJ4MmYnLFxyXG4gICdtYXQyeDM8ZjMyPic6ICdtYXQyeDNmJyxcclxuICAnbWF0Mng0PGYzMj4nOiAnbWF0Mng0ZicsXHJcbiAgJ21hdDN4MjxmMzI+JzogJ21hdDN4MmYnLFxyXG4gICdtYXQzeDM8ZjMyPic6ICdtYXQzeDNmJyxcclxuICAnbWF0M3g0PGYzMj4nOiAnbWF0M3g0ZicsXHJcbiAgJ21hdDR4MjxmMzI+JzogJ21hdDR4MmYnLFxyXG4gICdtYXQ0eDM8ZjMyPic6ICdtYXQ0eDNmJyxcclxuICAnbWF0NHg0PGYzMj4nOiAnbWF0NHg0ZicsXHJcbiAgJ21hdDJ4MjxmMTY+JzogJ21hdDJ4MmgnLFxyXG4gICdtYXQyeDM8ZjE2Pic6ICdtYXQyeDNoJyxcclxuICAnbWF0Mng0PGYxNj4nOiAnbWF0Mng0aCcsXHJcbiAgJ21hdDN4MjxmMTY+JzogJ21hdDN4MmgnLFxyXG4gICdtYXQzeDM8ZjE2Pic6ICdtYXQzeDNoJyxcclxuICAnbWF0M3g0PGYxNj4nOiAnbWF0M3g0aCcsXHJcbiAgJ21hdDR4MjxmMTY+JzogJ21hdDR4MmgnLFxyXG4gICdtYXQ0eDM8ZjE2Pic6ICdtYXQ0eDNoJyxcclxuICAnbWF0NHg0PGYxNj4nOiAnbWF0NHg0aCdcclxufTtcclxuXHJcbmNvbnN0IHdnc2xNaW5pZnkgPSBzdHIgPT4ge1xyXG4gIHN0ciA9IHN0ci5yZXBsYWNlKCAvXFxyXFxuL2csICdcXG4nICk7XHJcblxyXG4gIC8vIC8vIE5hZ2EgZG9lcyBub3QgeWV0IHJlY29nbml6ZSBgY29uc3RgIGJ1dCB3ZWIgZG9lcyBub3QgYWxsb3cgZ2xvYmFsIGBsZXRgLlxyXG4gIHN0ciA9IHN0ci5yZXBsYWNlKCAvXFxubGV0IC9nLCAnXFxuY29uc3QgJyApO1xyXG5cclxuICAvLyBBY2NvcmRpbmcgdG8gV0dTTCBzcGVjOlxyXG4gIC8vIGxpbmUgYnJlYWtzOiBcXHUwMDBBXFx1MDAwQlxcdTAwMENcXHUwMDBEXFx1MDA4NVxcdTIwMjhcXHUyMDI5XHJcbiAgLy8gd2hpdGUgc3BhY2U6IFxcdTAwMjBcXHUwMDA5XFx1MDAwQVxcdTAwMEJcXHUwMDBDXFx1MDAwRFxcdTAwODVcXHUyMDBFXFx1MjAwRlxcdTIwMjhcXHUyMDI5XHJcblxyXG4gIGNvbnN0IGxpbmVicmVhayA9ICdbXFx1MDAwQVxcdTAwMEJcXHUwMDBDXFx1MDAwRFxcdTAwODVcXHUyMDI4XFx1MjAyOV0nO1xyXG4gIGNvbnN0IHdoaXRlc3BhY2UgPSAnW1xcdTAwMjBcXHUwMDA5XFx1MDA4NVxcdTIwMEVcXHUyMDBGXFx1MjAyOFxcdTIwMjldJzsgLy8gZG9uJ3QgaW5jbHVkZSBtb3N0IHRoZSBsaW5lYnJlYWsgb25lc1xyXG4gIGNvbnN0IGxpbmVicmVha09yV2hpdGVzcGFjZSA9ICdbXFx1MDAwQVxcdTAwMEJcXHUwMDBDXFx1MDAwRFxcdTAwODVcXHUyMDI4XFx1MjAyOVxcdTAwMjBcXHUwMDA5XFx1MDA4NVxcdTIwMEVcXHUyMDBGXSc7XHJcblxyXG4gIC8vIENvbGxhcHNlIG5ld2xpbmVzXHJcbiAgc3RyID0gc3RyLnJlcGxhY2UoIG5ldyBSZWdFeHAoIGAke3doaXRlc3BhY2V9KiR7bGluZWJyZWFrfSske3doaXRlc3BhY2V9KmAsICdnJyApLCAnXFxuJyApO1xyXG4gIHN0ciA9IHN0ci50cmltKCk7XHJcblxyXG4gIC8vIENvbGxhcHNlIG90aGVyIHdoaXRlc3BhY2VcclxuICBzdHIgPSBzdHIucmVwbGFjZSggbmV3IFJlZ0V4cCggYCR7d2hpdGVzcGFjZX0rYCwgJ2cnICksICcgJyApO1xyXG5cclxuICAvLyBTZW1pY29sb24gKyBuZXdsaW5lID0+IHNlbWljb2xvblxyXG4gIHN0ciA9IHN0ci5yZXBsYWNlKCBuZXcgUmVnRXhwKCBgOyR7bGluZWJyZWFrfWAsICdnJyApLCAnOycgKTtcclxuXHJcbiAgLy8gQ29tbWEgKyBuZXdsaW5lID0+IGNvbW1hXHJcbiAgc3RyID0gc3RyLnJlcGxhY2UoIG5ldyBSZWdFeHAoIGAsJHtsaW5lYnJlYWt9YCwgJ2cnICksICcsJyApO1xyXG5cclxuICAvLyB3aGl0ZXNwYWNlIGFyb3VuZCB7fVxyXG4gIHN0ciA9IHN0ci5yZXBsYWNlKCBuZXcgUmVnRXhwKCBgJHtsaW5lYnJlYWtPcldoaXRlc3BhY2V9KihbXFxcXHtcXFxcfV0pJHtsaW5lYnJlYWtPcldoaXRlc3BhY2V9KmAsICdnJyApLCAoIF8sIG0gKSA9PiBtICk7XHJcblxyXG4gIC8vIFJlbW92ZSB3aGl0ZXNwYWNlIGFmdGVyIDo7LFxyXG4gIHN0ciA9IHN0ci5yZXBsYWNlKCBuZXcgUmVnRXhwKCBgKFs6OyxdKSR7bGluZWJyZWFrT3JXaGl0ZXNwYWNlfStgLCAnZycgKSwgKCBfLCBtICkgPT4gbSApO1xyXG5cclxuICAvLyBSZW1vdmUgdHJhaWxpbmcgY29tbWFzIGJlZm9yZSB9XSlcclxuICBzdHIgPSBzdHIucmVwbGFjZSggbmV3IFJlZ0V4cCggJywoW1xcXFx9XFxcXF1cXFxcKV0pJywgJ2cnICksICggXywgbSApID0+IG0gKTtcclxuXHJcbiAgLy8gSXQncyBzYWZlIHRvIHJlbW92ZSB3aGl0ZXNwYWNlIGJlZm9yZSAnLScsIGhvd2V2ZXIgRmlyZWZveCdzIHRva2VuaXplciBkb2Vzbid0IGxpa2UgJ3gtMXUnIChwcmVzdW1hYmx5IGlkZW50aWZpZXIgKyBsaXRlcmFsIG51bWJlciwgbm8gb3BlcmF0b3IpXHJcbiAgLy8gU28gd2UnbGwgb25seSByZXBsYWNlIHdoaXRlc3BhY2UgYWZ0ZXIgJy0nIGlmIGl0J3Mgbm90IGZvbGxvd2VkIGJ5IGEgZGlnaXRcclxuICBzdHIgPSBzdHIucmVwbGFjZSggbmV3IFJlZ0V4cCggYCR7bGluZWJyZWFrT3JXaGl0ZXNwYWNlfSotYCwgJ2cnICksICctJyApO1xyXG4gIHN0ciA9IHN0ci5yZXBsYWNlKCBuZXcgUmVnRXhwKCBgLSR7bGluZWJyZWFrT3JXaGl0ZXNwYWNlfSsoW14wLTldKWAsICdnJyApLCAoIF8sIG0gKSA9PiBgLSR7bX1gICk7XHJcblxyXG4gIC8vIE9wZXJhdG9ycyBkb24ndCBuZWVkIHdoaXRlc3BhY2UgYXJvdW5kIHRoZW0gaW4gZ2VuZXJhbFxyXG4gIHN0ciA9IHN0ci5yZXBsYWNlKCBuZXcgUmVnRXhwKCBgJHtsaW5lYnJlYWtPcldoaXRlc3BhY2V9KihbXFxcXCtcXFxcKi88PiZcXFxcfD1cXFxcKFxcXFwpIV0pJHtsaW5lYnJlYWtPcldoaXRlc3BhY2V9KmAsICdnJyApLCAoIF8sIG0gKSA9PiBtICk7XHJcblxyXG4gIC8vIGUuZy4gMC41ID0+IC41LCAxMC4wID0+IDEwLlxyXG4gIHN0ciA9IHN0ci5yZXBsYWNlKCAvXFxkK1xcLlxcZCsvZywgbSA9PiB7XHJcbiAgICBpZiAoIG0uZW5kc1dpdGgoICcuMCcgKSApIHtcclxuICAgICAgbSA9IG0uc3Vic3RyaW5nKCAwLCBtLmxlbmd0aCAtIDEgKTtcclxuICAgIH1cclxuICAgIGlmICggbS5zdGFydHNXaXRoKCAnMC4nICkgJiYgbS5sZW5ndGggPiAyICkge1xyXG4gICAgICBtID0gbS5zdWJzdHJpbmcoIDEgKTtcclxuICAgIH1cclxuICAgIHJldHVybiBtO1xyXG4gIH0gKTtcclxuXHJcbiAgLy8gUmVwbGFjZSBoZXggbGl0ZXJhbHMgd2l0aCBkZWNpbWFsIGxpdGVyYWxzIGlmIHRoZXkgYXJlIHNob3J0ZXJcclxuICBzdHIgPSBzdHIucmVwbGFjZSggLzB4KFswLTlhYmNkZWZBQkNERUZdKyl1L2csICggbSwgZGlnaXRzICkgPT4ge1xyXG4gICAgY29uc3Qgc3RyID0gJycgKyBwYXJzZUludCggZGlnaXRzLCAxNiApICsgJ3UnO1xyXG4gICAgaWYgKCBzdHIubGVuZ3RoIDwgbS5sZW5ndGggKSB7XHJcbiAgICAgIHJldHVybiBzdHI7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgcmV0dXJuIG07XHJcbiAgICB9XHJcbiAgfSApO1xyXG5cclxuICAvLyBEZXRlY3QgY2FzZXMgd2hlcmUgYWJzdHJhY3QgaW50IGNhbiBiZSB1c2VkIHNhZmVseSwgaW5zdGVhZCBvZiB0aGUgZXhwbGljaXQgb25lc1xyXG4gIC8vIHN0ciA9IHN0ci5yZXBsYWNlKCAvKD09fCE9KShbMC05Ll0pK1t1aWZdL2csICggbSwgb3AsIGRpZ2l0cyApID0+IHtcclxuICAvLyAgIHJldHVybiBgJHtvcH0ke2RpZ2l0c31gO1xyXG4gIC8vIH0gKTtcclxuXHJcbiAgLy8gUmVwbGFjZSBzb21lIHByZWRlY2xhcmVkIGFsaWFzZXMgKHZlYzI8ZjMyPiA9PiB2ZWMyZilcclxuICBPYmplY3Qua2V5cyggUkVQTEFDRU1FTlRfTUFQICkuZm9yRWFjaCgga2V5ID0+IHtcclxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zdGFudC1jb25kaXRpb25cclxuICAgIHdoaWxlICggdHJ1ZSApIHtcclxuICAgICAgY29uc3QgbWF0Y2ggPSBuZXcgUmVnRXhwKCBgW15cXFxcd10oJHtrZXl9KVteXFxcXHddYCwgJ2cnICkuZXhlYyggc3RyICk7XHJcblxyXG4gICAgICBpZiAoIG1hdGNoICkge1xyXG4gICAgICAgIGNvbnN0IGluZGV4MCA9IG1hdGNoLmluZGV4ICsgMTtcclxuICAgICAgICBjb25zdCBpbmRleDEgPSBpbmRleDAgKyBrZXkubGVuZ3RoO1xyXG4gICAgICAgIGNvbnN0IGJlZm9yZSA9IHN0ci5zdWJzdHJpbmcoIDAsIGluZGV4MCApO1xyXG4gICAgICAgIGNvbnN0IGFmdGVyID0gc3RyLnN1YnN0cmluZyggaW5kZXgxICk7XHJcbiAgICAgICAgc3RyID0gYmVmb3JlICsgUkVQTEFDRU1FTlRfTUFQWyBrZXkgXSArIGFmdGVyO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSApO1xyXG5cclxuICByZXR1cm4gc3RyO1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSB3Z3NsTWluaWZ5OyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsTUFBTUEsZUFBZSxHQUFHO0VBQ3RCLFdBQVcsRUFBRSxPQUFPO0VBQ3BCLFdBQVcsRUFBRSxPQUFPO0VBQ3BCLFdBQVcsRUFBRSxPQUFPO0VBQ3BCLFdBQVcsRUFBRSxPQUFPO0VBQ3BCLFdBQVcsRUFBRSxPQUFPO0VBQ3BCLFdBQVcsRUFBRSxPQUFPO0VBQ3BCLFdBQVcsRUFBRSxPQUFPO0VBQ3BCLFdBQVcsRUFBRSxPQUFPO0VBQ3BCLFdBQVcsRUFBRSxPQUFPO0VBQ3BCLFdBQVcsRUFBRSxPQUFPO0VBQ3BCLFdBQVcsRUFBRSxPQUFPO0VBQ3BCLFdBQVcsRUFBRSxPQUFPO0VBQ3BCLGFBQWEsRUFBRSxTQUFTO0VBQ3hCLGFBQWEsRUFBRSxTQUFTO0VBQ3hCLGFBQWEsRUFBRSxTQUFTO0VBQ3hCLGFBQWEsRUFBRSxTQUFTO0VBQ3hCLGFBQWEsRUFBRSxTQUFTO0VBQ3hCLGFBQWEsRUFBRSxTQUFTO0VBQ3hCLGFBQWEsRUFBRSxTQUFTO0VBQ3hCLGFBQWEsRUFBRSxTQUFTO0VBQ3hCLGFBQWEsRUFBRSxTQUFTO0VBQ3hCLGFBQWEsRUFBRSxTQUFTO0VBQ3hCLGFBQWEsRUFBRSxTQUFTO0VBQ3hCLGFBQWEsRUFBRSxTQUFTO0VBQ3hCLGFBQWEsRUFBRSxTQUFTO0VBQ3hCLGFBQWEsRUFB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