// Copyright 2015-2024, University of Colorado Boulder

/**
 * Grunt task that determines created and last modified dates from git, and updates copyright statements accordingly,
 * see #403
 *
 * @author Sam Reid (PhET Interactive Simulations)
 */

const grunt = require('grunt');
const updateCopyrightDate = require('./updateCopyrightDate');

/**
 * @public
 * @param {string} repo - The repository name for the files to update
 * @param {function} predicate - takes a repo-relative path {string} and returns {boolean} if the path should be updated.
 * @returns {Promise}
 */
module.exports = async function (repo, predicate = () => true) {
  let relativeFiles = [];
  grunt.file.recurse(`../${repo}`, (abspath, rootdir, subdir, filename) => {
    relativeFiles.push(`${subdir}/${filename}`);
  });
  relativeFiles = relativeFiles.filter(file => file.startsWith('js/')).filter(predicate);
  for (const relativeFile of relativeFiles) {
    await updateCopyrightDate(repo, relativeFile);
  }
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJncnVudCIsInJlcXVpcmUiLCJ1cGRhdGVDb3B5cmlnaHREYXRlIiwibW9kdWxlIiwiZXhwb3J0cyIsInJlcG8iLCJwcmVkaWNhdGUiLCJyZWxhdGl2ZUZpbGVzIiwiZmlsZSIsInJlY3Vyc2UiLCJhYnNwYXRoIiwicm9vdGRpciIsInN1YmRpciIsImZpbGVuYW1lIiwicHVzaCIsImZpbHRlciIsInN0YXJ0c1dpdGgiLCJyZWxhdGl2ZUZpbGUiXSwic291cmNlcyI6WyJ1cGRhdGVDb3B5cmlnaHREYXRlcy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxNS0yMDI0LCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcclxuXHJcbi8qKlxyXG4gKiBHcnVudCB0YXNrIHRoYXQgZGV0ZXJtaW5lcyBjcmVhdGVkIGFuZCBsYXN0IG1vZGlmaWVkIGRhdGVzIGZyb20gZ2l0LCBhbmQgdXBkYXRlcyBjb3B5cmlnaHQgc3RhdGVtZW50cyBhY2NvcmRpbmdseSxcclxuICogc2VlICM0MDNcclxuICpcclxuICogQGF1dGhvciBTYW0gUmVpZCAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcclxuICovXHJcblxyXG5cclxuY29uc3QgZ3J1bnQgPSByZXF1aXJlKCAnZ3J1bnQnICk7XHJcbmNvbnN0IHVwZGF0ZUNvcHlyaWdodERhdGUgPSByZXF1aXJlKCAnLi91cGRhdGVDb3B5cmlnaHREYXRlJyApO1xyXG5cclxuLyoqXHJcbiAqIEBwdWJsaWNcclxuICogQHBhcmFtIHtzdHJpbmd9IHJlcG8gLSBUaGUgcmVwb3NpdG9yeSBuYW1lIGZvciB0aGUgZmlsZXMgdG8gdXBkYXRlXHJcbiAqIEBwYXJhbSB7ZnVuY3Rpb259IHByZWRpY2F0ZSAtIHRha2VzIGEgcmVwby1yZWxhdGl2ZSBwYXRoIHtzdHJpbmd9IGFuZCByZXR1cm5zIHtib29sZWFufSBpZiB0aGUgcGF0aCBzaG91bGQgYmUgdXBkYXRlZC5cclxuICogQHJldHVybnMge1Byb21pc2V9XHJcbiAqL1xyXG5tb2R1bGUuZXhwb3J0cyA9IGFzeW5jIGZ1bmN0aW9uKCByZXBvLCBwcmVkaWNhdGUgPSAoKSA9PiB0cnVlICkge1xyXG4gIGxldCByZWxhdGl2ZUZpbGVzID0gW107XHJcbiAgZ3J1bnQuZmlsZS5yZWN1cnNlKCBgLi4vJHtyZXBvfWAsICggYWJzcGF0aCwgcm9vdGRpciwgc3ViZGlyLCBmaWxlbmFtZSApID0+IHtcclxuICAgIHJlbGF0aXZlRmlsZXMucHVzaCggYCR7c3ViZGlyfS8ke2ZpbGVuYW1lfWAgKTtcclxuICB9ICk7XHJcbiAgcmVsYXRpdmVGaWxlcyA9IHJlbGF0aXZlRmlsZXMuZmlsdGVyKCBmaWxlID0+IGZpbGUuc3RhcnRzV2l0aCggJ2pzLycgKSApLmZpbHRlciggcHJlZGljYXRlICk7XHJcblxyXG4gIGZvciAoIGNvbnN0IHJlbGF0aXZlRmlsZSBvZiByZWxhdGl2ZUZpbGVzICkge1xyXG4gICAgYXdhaXQgdXBkYXRlQ29weXJpZ2h0RGF0ZSggcmVwbywgcmVsYXRpdmVGaWxlICk7XHJcbiAgfVxyXG59OyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUdBLE1BQU1BLEtBQUssR0FBR0MsT0FBTyxDQUFFLE9BQVEsQ0FBQztBQUNoQyxNQUFNQyxtQkFBbUIsR0FBR0QsT0FBTyxDQUFFLHVCQUF3QixDQUFDOztBQUU5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQUUsTUFBTSxDQUFDQyxPQUFPLEdBQUcsZ0JBQWdCQyxJQUFJLEVBQUVDLFNBQVMsR0FBR0EsQ0FBQSxLQUFNLElBQUksRUFBRztFQUM5RCxJQUFJQyxhQUFhLEdBQUcsRUFBRTtFQUN0QlAsS0FBSyxDQUFDUSxJQUFJLENBQUNDLE9BQU8sQ0FBRyxNQUFLSixJQUFLLEVBQUMsRUFBRSxDQUFFSyxPQUFPLEVBQUVDLE9BQU8sRUFBRUMsTUFBTSxFQUFFQyxRQUFRLEtBQU07SUFDMUVOLGFBQWEsQ0FBQ08sSUFBSSxDQUFHLEdBQUVGLE1BQU8sSUFBR0MsUUFBUyxFQUFFLENBQUM7RUFDL0MsQ0FBRSxDQUFDO0VBQ0hOLGFBQWEsR0FBR0EsYUFBYSxDQUFDUSxNQUFNLENBQUVQLElBQUksSUFBSUEsSUFBSSxDQUFDUSxVQUFVLENBQUUsS0FBTSxDQUFFLENBQUMsQ0FBQ0QsTUFBTSxDQUFFVCxTQUFVLENBQUM7RUFFNUYsS0FBTSxNQUFNVyxZQUFZLElBQUlWLGFBQWEsRUFBRztJQUMxQyxNQUFNTCxtQkFBbUIsQ0FBRUcsSUFBSSxFQUFFWSxZQUFhLENBQUM7RUFDakQ7QUFDRixDQUFDIiwiaWdub3JlTGlzdCI6W119